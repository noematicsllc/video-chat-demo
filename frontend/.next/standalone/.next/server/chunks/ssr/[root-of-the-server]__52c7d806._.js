module.exports=[88947,(a,b,c)=>{b.exports=a.x("stream",()=>require("stream"))},21011,(a,b,c)=>{var d=a.r(88947).Stream,e=a.r(24361);function f(){this.source=null,this.dataSize=0,this.maxDataSize=1048576,this.pauseStream=!0,this._maxDataSizeExceeded=!1,this._released=!1,this._bufferedEvents=[]}b.exports=f,e.inherits(f,d),f.create=function(a,b){var c=new this;for(var d in b=b||{})c[d]=b[d];c.source=a;var e=a.emit;return a.emit=function(){return c._handleEmit(arguments),e.apply(a,arguments)},a.on("error",function(){}),c.pauseStream&&a.pause(),c},Object.defineProperty(f.prototype,"readable",{configurable:!0,enumerable:!0,get:function(){return this.source.readable}}),f.prototype.setEncoding=function(){return this.source.setEncoding.apply(this.source,arguments)},f.prototype.resume=function(){this._released||this.release(),this.source.resume()},f.prototype.pause=function(){this.source.pause()},f.prototype.release=function(){this._released=!0,this._bufferedEvents.forEach((function(a){this.emit.apply(this,a)}).bind(this)),this._bufferedEvents=[]},f.prototype.pipe=function(){var a=d.prototype.pipe.apply(this,arguments);return this.resume(),a},f.prototype._handleEmit=function(a){this._released?this.emit.apply(this,a):("data"===a[0]&&(this.dataSize+=a[1].length,this._checkIfMaxDataSizeExceeded()),this._bufferedEvents.push(a))},f.prototype._checkIfMaxDataSizeExceeded=function(){if(!this._maxDataSizeExceeded&&!(this.dataSize<=this.maxDataSize)){this._maxDataSizeExceeded=!0;var a="DelayedStream#maxDataSize of "+this.maxDataSize+" bytes exceeded.";this.emit("error",Error(a))}}},48803,(a,b,c)=>{var d=a.r(24361),e=a.r(88947).Stream,f=a.r(21011);function g(){this.writable=!1,this.readable=!0,this.dataSize=0,this.maxDataSize=2097152,this.pauseStreams=!0,this._released=!1,this._streams=[],this._currentStream=null,this._insideLoop=!1,this._pendingNext=!1}b.exports=g,d.inherits(g,e),g.create=function(a){var b=new this;for(var c in a=a||{})b[c]=a[c];return b},g.isStreamLike=function(a){return"function"!=typeof a&&"string"!=typeof a&&"boolean"!=typeof a&&"number"!=typeof a&&!Buffer.isBuffer(a)},g.prototype.append=function(a){if(g.isStreamLike(a)){if(!(a instanceof f)){var b=f.create(a,{maxDataSize:1/0,pauseStream:this.pauseStreams});a.on("data",this._checkDataSize.bind(this)),a=b}this._handleErrors(a),this.pauseStreams&&a.pause()}return this._streams.push(a),this},g.prototype.pipe=function(a,b){return e.prototype.pipe.call(this,a,b),this.resume(),a},g.prototype._getNext=function(){if(this._currentStream=null,this._insideLoop){this._pendingNext=!0;return}this._insideLoop=!0;try{do this._pendingNext=!1,this._realGetNext();while(this._pendingNext)}finally{this._insideLoop=!1}},g.prototype._realGetNext=function(){var a=this._streams.shift();void 0===a?this.end():"function"!=typeof a?this._pipeNext(a):a((function(a){g.isStreamLike(a)&&(a.on("data",this._checkDataSize.bind(this)),this._handleErrors(a)),this._pipeNext(a)}).bind(this))},g.prototype._pipeNext=function(a){if(this._currentStream=a,g.isStreamLike(a)){a.on("end",this._getNext.bind(this)),a.pipe(this,{end:!1});return}this.write(a),this._getNext()},g.prototype._handleErrors=function(a){var b=this;a.on("error",function(a){b._emitError(a)})},g.prototype.write=function(a){this.emit("data",a)},g.prototype.pause=function(){this.pauseStreams&&(this.pauseStreams&&this._currentStream&&"function"==typeof this._currentStream.pause&&this._currentStream.pause(),this.emit("pause"))},g.prototype.resume=function(){this._released||(this._released=!0,this.writable=!0,this._getNext()),this.pauseStreams&&this._currentStream&&"function"==typeof this._currentStream.resume&&this._currentStream.resume(),this.emit("resume")},g.prototype.end=function(){this._reset(),this.emit("end")},g.prototype.destroy=function(){this._reset(),this.emit("close")},g.prototype._reset=function(){this.writable=!1,this._streams=[],this._currentStream=null},g.prototype._checkDataSize=function(){if(this._updateDataSize(),!(this.dataSize<=this.maxDataSize)){var a="DelayedStream#maxDataSize of "+this.maxDataSize+" bytes exceeded.";this._emitError(Error(a))}},g.prototype._updateDataSize=function(){this.dataSize=0;var a=this;this._streams.forEach(function(b){b.dataSize&&(a.dataSize+=b.dataSize)}),this._currentStream&&this._currentStream.dataSize&&(this.dataSize+=this._currentStream.dataSize)},g.prototype._emitError=function(a){this._reset(),this.emit("error",a)}},21517,(a,b,c)=>{b.exports=a.x("http",()=>require("http"))},24836,(a,b,c)=>{b.exports=a.x("https",()=>require("https"))},92509,(a,b,c)=>{b.exports=a.x("url",()=>require("url"))},22734,(a,b,c)=>{b.exports=a.x("fs",()=>require("fs"))},54799,(a,b,c)=>{b.exports=a.x("crypto",()=>require("crypto"))},78900,a=>{a.v(JSON.parse('{"application/1d-interleaved-parityfec":{"source":"iana"},"application/3gpdash-qoe-report+xml":{"source":"iana","charset":"UTF-8","compressible":true},"application/3gpp-ims+xml":{"source":"iana","compressible":true},"application/3gpphal+json":{"source":"iana","compressible":true},"application/3gpphalforms+json":{"source":"iana","compressible":true},"application/a2l":{"source":"iana"},"application/ace+cbor":{"source":"iana"},"application/activemessage":{"source":"iana"},"application/activity+json":{"source":"iana","compressible":true},"application/alto-costmap+json":{"source":"iana","compressible":true},"application/alto-costmapfilter+json":{"source":"iana","compressible":true},"application/alto-directory+json":{"source":"iana","compressible":true},"application/alto-endpointcost+json":{"source":"iana","compressible":true},"application/alto-endpointcostparams+json":{"source":"iana","compressible":true},"application/alto-endpointprop+json":{"source":"iana","compressible":true},"application/alto-endpointpropparams+json":{"source":"iana","compressible":true},"application/alto-error+json":{"source":"iana","compressible":true},"application/alto-networkmap+json":{"source":"iana","compressible":true},"application/alto-networkmapfilter+json":{"source":"iana","compressible":true},"application/alto-updatestreamcontrol+json":{"source":"iana","compressible":true},"application/alto-updatestreamparams+json":{"source":"iana","compressible":true},"application/aml":{"source":"iana"},"application/andrew-inset":{"source":"iana","extensions":["ez"]},"application/applefile":{"source":"iana"},"application/applixware":{"source":"apache","extensions":["aw"]},"application/at+jwt":{"source":"iana"},"application/atf":{"source":"iana"},"application/atfx":{"source":"iana"},"application/atom+xml":{"source":"iana","compressible":true,"extensions":["atom"]},"application/atomcat+xml":{"source":"iana","compressible":true,"extensions":["atomcat"]},"application/atomdeleted+xml":{"source":"iana","compressible":true,"extensions":["atomdeleted"]},"application/atomicmail":{"source":"iana"},"application/atomsvc+xml":{"source":"iana","compressible":true,"extensions":["atomsvc"]},"application/atsc-dwd+xml":{"source":"iana","compressible":true,"extensions":["dwd"]},"application/atsc-dynamic-event-message":{"source":"iana"},"application/atsc-held+xml":{"source":"iana","compressible":true,"extensions":["held"]},"application/atsc-rdt+json":{"source":"iana","compressible":true},"application/atsc-rsat+xml":{"source":"iana","compressible":true,"extensions":["rsat"]},"application/atxml":{"source":"iana"},"application/auth-policy+xml":{"source":"iana","compressible":true},"application/bacnet-xdd+zip":{"source":"iana","compressible":false},"application/batch-smtp":{"source":"iana"},"application/bdoc":{"compressible":false,"extensions":["bdoc"]},"application/beep+xml":{"source":"iana","charset":"UTF-8","compressible":true},"application/calendar+json":{"source":"iana","compressible":true},"application/calendar+xml":{"source":"iana","compressible":true,"extensions":["xcs"]},"application/call-completion":{"source":"iana"},"application/cals-1840":{"source":"iana"},"application/captive+json":{"source":"iana","compressible":true},"application/cbor":{"source":"iana"},"application/cbor-seq":{"source":"iana"},"application/cccex":{"source":"iana"},"application/ccmp+xml":{"source":"iana","compressible":true},"application/ccxml+xml":{"source":"iana","compressible":true,"extensions":["ccxml"]},"application/cdfx+xml":{"source":"iana","compressible":true,"extensions":["cdfx"]},"application/cdmi-capability":{"source":"iana","extensions":["cdmia"]},"application/cdmi-container":{"source":"iana","extensions":["cdmic"]},"application/cdmi-domain":{"source":"iana","extensions":["cdmid"]},"application/cdmi-object":{"source":"iana","extensions":["cdmio"]},"application/cdmi-queue":{"source":"iana","extensions":["cdmiq"]},"application/cdni":{"source":"iana"},"application/cea":{"source":"iana"},"application/cea-2018+xml":{"source":"iana","compressible":true},"application/cellml+xml":{"source":"iana","compressible":true},"application/cfw":{"source":"iana"},"application/city+json":{"source":"iana","compressible":true},"application/clr":{"source":"iana"},"application/clue+xml":{"source":"iana","compressible":true},"application/clue_info+xml":{"source":"iana","compressible":true},"application/cms":{"source":"iana"},"application/cnrp+xml":{"source":"iana","compressible":true},"application/coap-group+json":{"source":"iana","compressible":true},"application/coap-payload":{"source":"iana"},"application/commonground":{"source":"iana"},"application/conference-info+xml":{"source":"iana","compressible":true},"application/cose":{"source":"iana"},"application/cose-key":{"source":"iana"},"application/cose-key-set":{"source":"iana"},"application/cpl+xml":{"source":"iana","compressible":true,"extensions":["cpl"]},"application/csrattrs":{"source":"iana"},"application/csta+xml":{"source":"iana","compressible":true},"application/cstadata+xml":{"source":"iana","compressible":true},"application/csvm+json":{"source":"iana","compressible":true},"application/cu-seeme":{"source":"apache","extensions":["cu"]},"application/cwt":{"source":"iana"},"application/cybercash":{"source":"iana"},"application/dart":{"compressible":true},"application/dash+xml":{"source":"iana","compressible":true,"extensions":["mpd"]},"application/dash-patch+xml":{"source":"iana","compressible":true,"extensions":["mpp"]},"application/dashdelta":{"source":"iana"},"application/davmount+xml":{"source":"iana","compressible":true,"extensions":["davmount"]},"application/dca-rft":{"source":"iana"},"application/dcd":{"source":"iana"},"application/dec-dx":{"source":"iana"},"application/dialog-info+xml":{"source":"iana","compressible":true},"application/dicom":{"source":"iana"},"application/dicom+json":{"source":"iana","compressible":true},"application/dicom+xml":{"source":"iana","compressible":true},"application/dii":{"source":"iana"},"application/dit":{"source":"iana"},"application/dns":{"source":"iana"},"application/dns+json":{"source":"iana","compressible":true},"application/dns-message":{"source":"iana"},"application/docbook+xml":{"source":"apache","compressible":true,"extensions":["dbk"]},"application/dots+cbor":{"source":"iana"},"application/dskpp+xml":{"source":"iana","compressible":true},"application/dssc+der":{"source":"iana","extensions":["dssc"]},"application/dssc+xml":{"source":"iana","compressible":true,"extensions":["xdssc"]},"application/dvcs":{"source":"iana"},"application/ecmascript":{"source":"iana","compressible":true,"extensions":["es","ecma"]},"application/edi-consent":{"source":"iana"},"application/edi-x12":{"source":"iana","compressible":false},"application/edifact":{"source":"iana","compressible":false},"application/efi":{"source":"iana"},"application/elm+json":{"source":"iana","charset":"UTF-8","compressible":true},"application/elm+xml":{"source":"iana","compressible":true},"application/emergencycalldata.cap+xml":{"source":"iana","charset":"UTF-8","compressible":true},"application/emergencycalldata.comment+xml":{"source":"iana","compressible":true},"application/emergencycalldata.control+xml":{"source":"iana","compressible":true},"application/emergencycalldata.deviceinfo+xml":{"source":"iana","compressible":true},"application/emergencycalldata.ecall.msd":{"source":"iana"},"application/emergencycalldata.providerinfo+xml":{"source":"iana","compressible":true},"application/emergencycalldata.serviceinfo+xml":{"source":"iana","compressible":true},"application/emergencycalldata.subscriberinfo+xml":{"source":"iana","compressible":true},"application/emergencycalldata.veds+xml":{"source":"iana","compressible":true},"application/emma+xml":{"source":"iana","compressible":true,"extensions":["emma"]},"application/emotionml+xml":{"source":"iana","compressible":true,"extensions":["emotionml"]},"application/encaprtp":{"source":"iana"},"application/epp+xml":{"source":"iana","compressible":true},"application/epub+zip":{"source":"iana","compressible":false,"extensions":["epub"]},"application/eshop":{"source":"iana"},"application/exi":{"source":"iana","extensions":["exi"]},"application/expect-ct-report+json":{"source":"iana","compressible":true},"application/express":{"source":"iana","extensions":["exp"]},"application/fastinfoset":{"source":"iana"},"application/fastsoap":{"source":"iana"},"application/fdt+xml":{"source":"iana","compressible":true,"extensions":["fdt"]},"application/fhir+json":{"source":"iana","charset":"UTF-8","compressible":true},"application/fhir+xml":{"source":"iana","charset":"UTF-8","compressible":true},"application/fido.trusted-apps+json":{"compressible":true},"application/fits":{"source":"iana"},"application/flexfec":{"source":"iana"},"application/font-sfnt":{"source":"iana"},"application/font-tdpfr":{"source":"iana","extensions":["pfr"]},"application/font-woff":{"source":"iana","compressible":false},"application/framework-attributes+xml":{"source":"iana","compressible":true},"application/geo+json":{"source":"iana","compressible":true,"extensions":["geojson"]},"application/geo+json-seq":{"source":"iana"},"application/geopackage+sqlite3":{"source":"iana"},"application/geoxacml+xml":{"source":"iana","compressible":true},"application/gltf-buffer":{"source":"iana"},"application/gml+xml":{"source":"iana","compressible":true,"extensions":["gml"]},"application/gpx+xml":{"source":"apache","compressible":true,"extensions":["gpx"]},"application/gxf":{"source":"apache","extensions":["gxf"]},"application/gzip":{"source":"iana","compressible":false,"extensions":["gz"]},"application/h224":{"source":"iana"},"application/held+xml":{"source":"iana","compressible":true},"application/hjson":{"extensions":["hjson"]},"application/http":{"source":"iana"},"application/hyperstudio":{"source":"iana","extensions":["stk"]},"application/ibe-key-request+xml":{"source":"iana","compressible":true},"application/ibe-pkg-reply+xml":{"source":"iana","compressible":true},"application/ibe-pp-data":{"source":"iana"},"application/iges":{"source":"iana"},"application/im-iscomposing+xml":{"source":"iana","charset":"UTF-8","compressible":true},"application/index":{"source":"iana"},"application/index.cmd":{"source":"iana"},"application/index.obj":{"source":"iana"},"application/index.response":{"source":"iana"},"application/index.vnd":{"source":"iana"},"application/inkml+xml":{"source":"iana","compressible":true,"extensions":["ink","inkml"]},"application/iotp":{"source":"iana"},"application/ipfix":{"source":"iana","extensions":["ipfix"]},"application/ipp":{"source":"iana"},"application/isup":{"source":"iana"},"application/its+xml":{"source":"iana","compressible":true,"extensions":["its"]},"application/java-archive":{"source":"apache","compressible":false,"extensions":["jar","war","ear"]},"application/java-serialized-object":{"source":"apache","compressible":false,"extensions":["ser"]},"application/java-vm":{"source":"apache","compressible":false,"extensions":["class"]},"application/javascript":{"source":"iana","charset":"UTF-8","compressible":true,"extensions":["js","mjs"]},"application/jf2feed+json":{"source":"iana","compressible":true},"application/jose":{"source":"iana"},"application/jose+json":{"source":"iana","compressible":true},"application/jrd+json":{"source":"iana","compressible":true},"application/jscalendar+json":{"source":"iana","compressible":true},"application/json":{"source":"iana","charset":"UTF-8","compressible":true,"extensions":["json","map"]},"application/json-patch+json":{"source":"iana","compressible":true},"application/json-seq":{"source":"iana"},"application/json5":{"extensions":["json5"]},"application/jsonml+json":{"source":"apache","compressible":true,"extensions":["jsonml"]},"application/jwk+json":{"source":"iana","compressible":true},"application/jwk-set+json":{"source":"iana","compressible":true},"application/jwt":{"source":"iana"},"application/kpml-request+xml":{"source":"iana","compressible":true},"application/kpml-response+xml":{"source":"iana","compressible":true},"application/ld+json":{"source":"iana","compressible":true,"extensions":["jsonld"]},"application/lgr+xml":{"source":"iana","compressible":true,"extensions":["lgr"]},"application/link-format":{"source":"iana"},"application/load-control+xml":{"source":"iana","compressible":true},"application/lost+xml":{"source":"iana","compressible":true,"extensions":["lostxml"]},"application/lostsync+xml":{"source":"iana","compressible":true},"application/lpf+zip":{"source":"iana","compressible":false},"application/lxf":{"source":"iana"},"application/mac-binhex40":{"source":"iana","extensions":["hqx"]},"application/mac-compactpro":{"source":"apache","extensions":["cpt"]},"application/macwriteii":{"source":"iana"},"application/mads+xml":{"source":"iana","compressible":true,"extensions":["mads"]},"application/manifest+json":{"source":"iana","charset":"UTF-8","compressible":true,"extensions":["webmanifest"]},"application/marc":{"source":"iana","extensions":["mrc"]},"application/marcxml+xml":{"source":"iana","compressible":true,"extensions":["mrcx"]},"application/mathematica":{"source":"iana","extensions":["ma","nb","mb"]},"application/mathml+xml":{"source":"iana","compressible":true,"extensions":["mathml"]},"application/mathml-content+xml":{"source":"iana","compressible":true},"application/mathml-presentation+xml":{"source":"iana","compressible":true},"application/mbms-associated-procedure-description+xml":{"source":"iana","compressible":true},"application/mbms-deregister+xml":{"source":"iana","compressible":true},"application/mbms-envelope+xml":{"source":"iana","compressible":true},"application/mbms-msk+xml":{"source":"iana","compressible":true},"application/mbms-msk-response+xml":{"source":"iana","compressible":true},"application/mbms-protection-description+xml":{"source":"iana","compressible":true},"application/mbms-reception-report+xml":{"source":"iana","compressible":true},"application/mbms-register+xml":{"source":"iana","compressible":true},"application/mbms-register-response+xml":{"source":"iana","compressible":true},"application/mbms-schedule+xml":{"source":"iana","compressible":true},"application/mbms-user-service-description+xml":{"source":"iana","compressible":true},"application/mbox":{"source":"iana","extensions":["mbox"]},"application/media-policy-dataset+xml":{"source":"iana","compressible":true,"extensions":["mpf"]},"application/media_control+xml":{"source":"iana","compressible":true},"application/mediaservercontrol+xml":{"source":"iana","compressible":true,"extensions":["mscml"]},"application/merge-patch+json":{"source":"iana","compressible":true},"application/metalink+xml":{"source":"apache","compressible":true,"extensions":["metalink"]},"application/metalink4+xml":{"source":"iana","compressible":true,"extensions":["meta4"]},"application/mets+xml":{"source":"iana","compressible":true,"extensions":["mets"]},"application/mf4":{"source":"iana"},"application/mikey":{"source":"iana"},"application/mipc":{"source":"iana"},"application/missing-blocks+cbor-seq":{"source":"iana"},"application/mmt-aei+xml":{"source":"iana","compressible":true,"extensions":["maei"]},"application/mmt-usd+xml":{"source":"iana","compressible":true,"extensions":["musd"]},"application/mods+xml":{"source":"iana","compressible":true,"extensions":["mods"]},"application/moss-keys":{"source":"iana"},"application/moss-signature":{"source":"iana"},"application/mosskey-data":{"source":"iana"},"application/mosskey-request":{"source":"iana"},"application/mp21":{"source":"iana","extensions":["m21","mp21"]},"application/mp4":{"source":"iana","extensions":["mp4s","m4p"]},"application/mpeg4-generic":{"source":"iana"},"application/mpeg4-iod":{"source":"iana"},"application/mpeg4-iod-xmt":{"source":"iana"},"application/mrb-consumer+xml":{"source":"iana","compressible":true},"application/mrb-publish+xml":{"source":"iana","compressible":true},"application/msc-ivr+xml":{"source":"iana","charset":"UTF-8","compressible":true},"application/msc-mixer+xml":{"source":"iana","charset":"UTF-8","compressible":true},"application/msword":{"source":"iana","compressible":false,"extensions":["doc","dot"]},"application/mud+json":{"source":"iana","compressible":true},"application/multipart-core":{"source":"iana"},"application/mxf":{"source":"iana","extensions":["mxf"]},"application/n-quads":{"source":"iana","extensions":["nq"]},"application/n-triples":{"source":"iana","extensions":["nt"]},"application/nasdata":{"source":"iana"},"application/news-checkgroups":{"source":"iana","charset":"US-ASCII"},"application/news-groupinfo":{"source":"iana","charset":"US-ASCII"},"application/news-transmission":{"source":"iana"},"application/nlsml+xml":{"source":"iana","compressible":true},"application/node":{"source":"iana","extensions":["cjs"]},"application/nss":{"source":"iana"},"application/oauth-authz-req+jwt":{"source":"iana"},"application/oblivious-dns-message":{"source":"iana"},"application/ocsp-request":{"source":"iana"},"application/ocsp-response":{"source":"iana"},"application/octet-stream":{"source":"iana","compressible":false,"extensions":["bin","dms","lrf","mar","so","dist","distz","pkg","bpk","dump","elc","deploy","exe","dll","deb","dmg","iso","img","msi","msp","msm","buffer"]},"application/oda":{"source":"iana","extensions":["oda"]},"application/odm+xml":{"source":"iana","compressible":true},"application/odx":{"source":"iana"},"application/oebps-package+xml":{"source":"iana","compressible":true,"extensions":["opf"]},"application/ogg":{"source":"iana","compressible":false,"extensions":["ogx"]},"application/omdoc+xml":{"source":"apache","compressible":true,"extensions":["omdoc"]},"application/onenote":{"source":"apache","extensions":["onetoc","onetoc2","onetmp","onepkg"]},"application/opc-nodeset+xml":{"source":"iana","compressible":true},"application/oscore":{"source":"iana"},"application/oxps":{"source":"iana","extensions":["oxps"]},"application/p21":{"source":"iana"},"application/p21+zip":{"source":"iana","compressible":false},"application/p2p-overlay+xml":{"source":"iana","compressible":true,"extensions":["relo"]},"application/parityfec":{"source":"iana"},"application/passport":{"source":"iana"},"application/patch-ops-error+xml":{"source":"iana","compressible":true,"extensions":["xer"]},"application/pdf":{"source":"iana","compressible":false,"extensions":["pdf"]},"application/pdx":{"source":"iana"},"application/pem-certificate-chain":{"source":"iana"},"application/pgp-encrypted":{"source":"iana","compressible":false,"extensions":["pgp"]},"application/pgp-keys":{"source":"iana","extensions":["asc"]},"application/pgp-signature":{"source":"iana","extensions":["asc","sig"]},"application/pics-rules":{"source":"apache","extensions":["prf"]},"application/pidf+xml":{"source":"iana","charset":"UTF-8","compressible":true},"application/pidf-diff+xml":{"source":"iana","charset":"UTF-8","compressible":true},"application/pkcs10":{"source":"iana","extensions":["p10"]},"application/pkcs12":{"source":"iana"},"application/pkcs7-mime":{"source":"iana","extensions":["p7m","p7c"]},"application/pkcs7-signature":{"source":"iana","extensions":["p7s"]},"application/pkcs8":{"source":"iana","extensions":["p8"]},"application/pkcs8-encrypted":{"source":"iana"},"application/pkix-attr-cert":{"source":"iana","extensions":["ac"]},"application/pkix-cert":{"source":"iana","extensions":["cer"]},"application/pkix-crl":{"source":"iana","extensions":["crl"]},"application/pkix-pkipath":{"source":"iana","extensions":["pkipath"]},"application/pkixcmp":{"source":"iana","extensions":["pki"]},"application/pls+xml":{"source":"iana","compressible":true,"extensions":["pls"]},"application/poc-settings+xml":{"source":"iana","charset":"UTF-8","compressible":true},"application/postscript":{"source":"iana","compressible":true,"extensions":["ai","eps","ps"]},"application/ppsp-tracker+json":{"source":"iana","compressible":true},"application/problem+json":{"source":"iana","compressible":true},"application/problem+xml":{"source":"iana","compressible":true},"application/provenance+xml":{"source":"iana","compressible":true,"extensions":["provx"]},"application/prs.alvestrand.titrax-sheet":{"source":"iana"},"application/prs.cww":{"source":"iana","extensions":["cww"]},"application/prs.cyn":{"source":"iana","charset":"7-BIT"},"application/prs.hpub+zip":{"source":"iana","compressible":false},"application/prs.nprend":{"source":"iana"},"application/prs.plucker":{"source":"iana"},"application/prs.rdf-xml-crypt":{"source":"iana"},"application/prs.xsf+xml":{"source":"iana","compressible":true},"application/pskc+xml":{"source":"iana","compressible":true,"extensions":["pskcxml"]},"application/pvd+json":{"source":"iana","compressible":true},"application/qsig":{"source":"iana"},"application/raml+yaml":{"compressible":true,"extensions":["raml"]},"application/raptorfec":{"source":"iana"},"application/rdap+json":{"source":"iana","compressible":true},"application/rdf+xml":{"source":"iana","compressible":true,"extensions":["rdf","owl"]},"application/reginfo+xml":{"source":"iana","compressible":true,"extensions":["rif"]},"application/relax-ng-compact-syntax":{"source":"iana","extensions":["rnc"]},"application/remote-printing":{"source":"iana"},"application/reputon+json":{"source":"iana","compressible":true},"application/resource-lists+xml":{"source":"iana","compressible":true,"extensions":["rl"]},"application/resource-lists-diff+xml":{"source":"iana","compressible":true,"extensions":["rld"]},"application/rfc+xml":{"source":"iana","compressible":true},"application/riscos":{"source":"iana"},"application/rlmi+xml":{"source":"iana","compressible":true},"application/rls-services+xml":{"source":"iana","compressible":true,"extensions":["rs"]},"application/route-apd+xml":{"source":"iana","compressible":true,"extensions":["rapd"]},"application/route-s-tsid+xml":{"source":"iana","compressible":true,"extensions":["sls"]},"application/route-usd+xml":{"source":"iana","compressible":true,"extensions":["rusd"]},"application/rpki-ghostbusters":{"source":"iana","extensions":["gbr"]},"application/rpki-manifest":{"source":"iana","extensions":["mft"]},"application/rpki-publication":{"source":"iana"},"application/rpki-roa":{"source":"iana","extensions":["roa"]},"application/rpki-updown":{"source":"iana"},"application/rsd+xml":{"source":"apache","compressible":true,"extensions":["rsd"]},"application/rss+xml":{"source":"apache","compressible":true,"extensions":["rss"]},"application/rtf":{"source":"iana","compressible":true,"extensions":["rtf"]},"application/rtploopback":{"source":"iana"},"application/rtx":{"source":"iana"},"application/samlassertion+xml":{"source":"iana","compressible":true},"application/samlmetadata+xml":{"source":"iana","compressible":true},"application/sarif+json":{"source":"iana","compressible":true},"application/sarif-external-properties+json":{"source":"iana","compressible":true},"application/sbe":{"source":"iana"},"application/sbml+xml":{"source":"iana","compressible":true,"extensions":["sbml"]},"application/scaip+xml":{"source":"iana","compressible":true},"application/scim+json":{"source":"iana","compressible":true},"application/scvp-cv-request":{"source":"iana","extensions":["scq"]},"application/scvp-cv-response":{"source":"iana","extensions":["scs"]},"application/scvp-vp-request":{"source":"iana","extensions":["spq"]},"application/scvp-vp-response":{"source":"iana","extensions":["spp"]},"application/sdp":{"source":"iana","extensions":["sdp"]},"application/secevent+jwt":{"source":"iana"},"application/senml+cbor":{"source":"iana"},"application/senml+json":{"source":"iana","compressible":true},"application/senml+xml":{"source":"iana","compressible":true,"extensions":["senmlx"]},"application/senml-etch+cbor":{"source":"iana"},"application/senml-etch+json":{"source":"iana","compressible":true},"application/senml-exi":{"source":"iana"},"application/sensml+cbor":{"source":"iana"},"application/sensml+json":{"source":"iana","compressible":true},"application/sensml+xml":{"source":"iana","compressible":true,"extensions":["sensmlx"]},"application/sensml-exi":{"source":"iana"},"application/sep+xml":{"source":"iana","compressible":true},"application/sep-exi":{"source":"iana"},"application/session-info":{"source":"iana"},"application/set-payment":{"source":"iana"},"application/set-payment-initiation":{"source":"iana","extensions":["setpay"]},"application/set-registration":{"source":"iana"},"application/set-registration-initiation":{"source":"iana","extensions":["setreg"]},"application/sgml":{"source":"iana"},"application/sgml-open-catalog":{"source":"iana"},"application/shf+xml":{"source":"iana","compressible":true,"extensions":["shf"]},"application/sieve":{"source":"iana","extensions":["siv","sieve"]},"application/simple-filter+xml":{"source":"iana","compressible":true},"application/simple-message-summary":{"source":"iana"},"application/simplesymbolcontainer":{"source":"iana"},"application/sipc":{"source":"iana"},"application/slate":{"source":"iana"},"application/smil":{"source":"iana"},"application/smil+xml":{"source":"iana","compressible":true,"extensions":["smi","smil"]},"application/smpte336m":{"source":"iana"},"application/soap+fastinfoset":{"source":"iana"},"application/soap+xml":{"source":"iana","compressible":true},"application/sparql-query":{"source":"iana","extensions":["rq"]},"application/sparql-results+xml":{"source":"iana","compressible":true,"extensions":["srx"]},"application/spdx+json":{"source":"iana","compressible":true},"application/spirits-event+xml":{"source":"iana","compressible":true},"application/sql":{"source":"iana"},"application/srgs":{"source":"iana","extensions":["gram"]},"application/srgs+xml":{"source":"iana","compressible":true,"extensions":["grxml"]},"application/sru+xml":{"source":"iana","compressible":true,"extensions":["sru"]},"application/ssdl+xml":{"source":"apache","compressible":true,"extensions":["ssdl"]},"application/ssml+xml":{"source":"iana","compressible":true,"extensions":["ssml"]},"application/stix+json":{"source":"iana","compressible":true},"application/swid+xml":{"source":"iana","compressible":true,"extensions":["swidtag"]},"application/tamp-apex-update":{"source":"iana"},"application/tamp-apex-update-confirm":{"source":"iana"},"application/tamp-community-update":{"source":"iana"},"application/tamp-community-update-confirm":{"source":"iana"},"application/tamp-error":{"source":"iana"},"application/tamp-sequence-adjust":{"source":"iana"},"application/tamp-sequence-adjust-confirm":{"source":"iana"},"application/tamp-status-query":{"source":"iana"},"application/tamp-status-response":{"source":"iana"},"application/tamp-update":{"source":"iana"},"application/tamp-update-confirm":{"source":"iana"},"application/tar":{"compressible":true},"application/taxii+json":{"source":"iana","compressible":true},"application/td+json":{"source":"iana","compressible":true},"application/tei+xml":{"source":"iana","compressible":true,"extensions":["tei","teicorpus"]},"application/tetra_isi":{"source":"iana"},"application/thraud+xml":{"source":"iana","compressible":true,"extensions":["tfi"]},"application/timestamp-query":{"source":"iana"},"application/timestamp-reply":{"source":"iana"},"application/timestamped-data":{"source":"iana","extensions":["tsd"]},"application/tlsrpt+gzip":{"source":"iana"},"application/tlsrpt+json":{"source":"iana","compressible":true},"application/tnauthlist":{"source":"iana"},"application/token-introspection+jwt":{"source":"iana"},"application/toml":{"compressible":true,"extensions":["toml"]},"application/trickle-ice-sdpfrag":{"source":"iana"},"application/trig":{"source":"iana","extensions":["trig"]},"application/ttml+xml":{"source":"iana","compressible":true,"extensions":["ttml"]},"application/tve-trigger":{"source":"iana"},"application/tzif":{"source":"iana"},"application/tzif-leap":{"source":"iana"},"application/ubjson":{"compressible":false,"extensions":["ubj"]},"application/ulpfec":{"source":"iana"},"application/urc-grpsheet+xml":{"source":"iana","compressible":true},"application/urc-ressheet+xml":{"source":"iana","compressible":true,"extensions":["rsheet"]},"application/urc-targetdesc+xml":{"source":"iana","compressible":true,"extensions":["td"]},"application/urc-uisocketdesc+xml":{"source":"iana","compressible":true},"application/vcard+json":{"source":"iana","compressible":true},"application/vcard+xml":{"source":"iana","compressible":true},"application/vemmi":{"source":"iana"},"application/vividence.scriptfile":{"source":"apache"},"application/vnd.1000minds.decision-model+xml":{"source":"iana","compressible":true,"extensions":["1km"]},"application/vnd.3gpp-prose+xml":{"source":"iana","compressible":true},"application/vnd.3gpp-prose-pc3ch+xml":{"source":"iana","compressible":true},"application/vnd.3gpp-v2x-local-service-information":{"source":"iana"},"application/vnd.3gpp.5gnas":{"source":"iana"},"application/vnd.3gpp.access-transfer-events+xml":{"source":"iana","compressible":true},"application/vnd.3gpp.bsf+xml":{"source":"iana","compressible":true},"application/vnd.3gpp.gmop+xml":{"source":"iana","compressible":true},"application/vnd.3gpp.gtpc":{"source":"iana"},"application/vnd.3gpp.interworking-data":{"source":"iana"},"application/vnd.3gpp.lpp":{"source":"iana"},"application/vnd.3gpp.mc-signalling-ear":{"source":"iana"},"application/vnd.3gpp.mcdata-affiliation-command+xml":{"source":"iana","compressible":true},"application/vnd.3gpp.mcdata-info+xml":{"source":"iana","compressible":true},"application/vnd.3gpp.mcdata-payload":{"source":"iana"},"application/vnd.3gpp.mcdata-service-config+xml":{"source":"iana","compressible":true},"application/vnd.3gpp.mcdata-signalling":{"source":"iana"},"application/vnd.3gpp.mcdata-ue-config+xml":{"source":"iana","compressible":true},"application/vnd.3gpp.mcdata-user-profile+xml":{"source":"iana","compressible":true},"application/vnd.3gpp.mcptt-affiliation-command+xml":{"source":"iana","compressible":true},"application/vnd.3gpp.mcptt-floor-request+xml":{"source":"iana","compressible":true},"application/vnd.3gpp.mcptt-info+xml":{"source":"iana","compressible":true},"application/vnd.3gpp.mcptt-location-info+xml":{"source":"iana","compressible":true},"application/vnd.3gpp.mcptt-mbms-usage-info+xml":{"source":"iana","compressible":true},"application/vnd.3gpp.mcptt-service-config+xml":{"source":"iana","compressible":true},"application/vnd.3gpp.mcptt-signed+xml":{"source":"iana","compressible":true},"application/vnd.3gpp.mcptt-ue-config+xml":{"source":"iana","compressible":true},"application/vnd.3gpp.mcptt-ue-init-config+xml":{"source":"iana","compressible":true},"application/vnd.3gpp.mcptt-user-profile+xml":{"source":"iana","compressible":true},"application/vnd.3gpp.mcvideo-affiliation-command+xml":{"source":"iana","compressible":true},"application/vnd.3gpp.mcvideo-affiliation-info+xml":{"source":"iana","compressible":true},"application/vnd.3gpp.mcvideo-info+xml":{"source":"iana","compressible":true},"application/vnd.3gpp.mcvideo-location-info+xml":{"source":"iana","compressible":true},"application/vnd.3gpp.mcvideo-mbms-usage-info+xml":{"source":"iana","compressible":true},"application/vnd.3gpp.mcvideo-service-config+xml":{"source":"iana","compressible":true},"application/vnd.3gpp.mcvideo-transmission-request+xml":{"source":"iana","compressible":true},"application/vnd.3gpp.mcvideo-ue-config+xml":{"source":"iana","compressible":true},"application/vnd.3gpp.mcvideo-user-profile+xml":{"source":"iana","compressible":true},"application/vnd.3gpp.mid-call+xml":{"source":"iana","compressible":true},"application/vnd.3gpp.ngap":{"source":"iana"},"application/vnd.3gpp.pfcp":{"source":"iana"},"application/vnd.3gpp.pic-bw-large":{"source":"iana","extensions":["plb"]},"application/vnd.3gpp.pic-bw-small":{"source":"iana","extensions":["psb"]},"application/vnd.3gpp.pic-bw-var":{"source":"iana","extensions":["pvb"]},"application/vnd.3gpp.s1ap":{"source":"iana"},"application/vnd.3gpp.sms":{"source":"iana"},"application/vnd.3gpp.sms+xml":{"source":"iana","compressible":true},"application/vnd.3gpp.srvcc-ext+xml":{"source":"iana","compressible":true},"application/vnd.3gpp.srvcc-info+xml":{"source":"iana","compressible":true},"application/vnd.3gpp.state-and-event-info+xml":{"source":"iana","compressible":true},"application/vnd.3gpp.ussd+xml":{"source":"iana","compressible":true},"application/vnd.3gpp2.bcmcsinfo+xml":{"source":"iana","compressible":true},"application/vnd.3gpp2.sms":{"source":"iana"},"application/vnd.3gpp2.tcap":{"source":"iana","extensions":["tcap"]},"application/vnd.3lightssoftware.imagescal":{"source":"iana"},"application/vnd.3m.post-it-notes":{"source":"iana","extensions":["pwn"]},"application/vnd.accpac.simply.aso":{"source":"iana","extensions":["aso"]},"application/vnd.accpac.simply.imp":{"source":"iana","extensions":["imp"]},"application/vnd.acucobol":{"source":"iana","extensions":["acu"]},"application/vnd.acucorp":{"source":"iana","extensions":["atc","acutc"]},"application/vnd.adobe.air-application-installer-package+zip":{"source":"apache","compressible":false,"extensions":["air"]},"application/vnd.adobe.flash.movie":{"source":"iana"},"application/vnd.adobe.formscentral.fcdt":{"source":"iana","extensions":["fcdt"]},"application/vnd.adobe.fxp":{"source":"iana","extensions":["fxp","fxpl"]},"application/vnd.adobe.partial-upload":{"source":"iana"},"application/vnd.adobe.xdp+xml":{"source":"iana","compressible":true,"extensions":["xdp"]},"application/vnd.adobe.xfdf":{"source":"iana","extensions":["xfdf"]},"application/vnd.aether.imp":{"source":"iana"},"application/vnd.afpc.afplinedata":{"source":"iana"},"application/vnd.afpc.afplinedata-pagedef":{"source":"iana"},"application/vnd.afpc.cmoca-cmresource":{"source":"iana"},"application/vnd.afpc.foca-charset":{"source":"iana"},"application/vnd.afpc.foca-codedfont":{"source":"iana"},"application/vnd.afpc.foca-codepage":{"source":"iana"},"application/vnd.afpc.modca":{"source":"iana"},"application/vnd.afpc.modca-cmtable":{"source":"iana"},"application/vnd.afpc.modca-formdef":{"source":"iana"},"application/vnd.afpc.modca-mediummap":{"source":"iana"},"application/vnd.afpc.modca-objectcontainer":{"source":"iana"},"application/vnd.afpc.modca-overlay":{"source":"iana"},"application/vnd.afpc.modca-pagesegment":{"source":"iana"},"application/vnd.age":{"source":"iana","extensions":["age"]},"application/vnd.ah-barcode":{"source":"iana"},"application/vnd.ahead.space":{"source":"iana","extensions":["ahead"]},"application/vnd.airzip.filesecure.azf":{"source":"iana","extensions":["azf"]},"application/vnd.airzip.filesecure.azs":{"source":"iana","extensions":["azs"]},"application/vnd.amadeus+json":{"source":"iana","compressible":true},"application/vnd.amazon.ebook":{"source":"apache","extensions":["azw"]},"application/vnd.amazon.mobi8-ebook":{"source":"iana"},"application/vnd.americandynamics.acc":{"source":"iana","extensions":["acc"]},"application/vnd.amiga.ami":{"source":"iana","extensions":["ami"]},"application/vnd.amundsen.maze+xml":{"source":"iana","compressible":true},"application/vnd.android.ota":{"source":"iana"},"application/vnd.android.package-archive":{"source":"apache","compressible":false,"extensions":["apk"]},"application/vnd.anki":{"source":"iana"},"application/vnd.anser-web-certificate-issue-initiation":{"source":"iana","extensions":["cii"]},"application/vnd.anser-web-funds-transfer-initiation":{"source":"apache","extensions":["fti"]},"application/vnd.antix.game-component":{"source":"iana","extensions":["atx"]},"application/vnd.apache.arrow.file":{"source":"iana"},"application/vnd.apache.arrow.stream":{"source":"iana"},"application/vnd.apache.thrift.binary":{"source":"iana"},"application/vnd.apache.thrift.compact":{"source":"iana"},"application/vnd.apache.thrift.json":{"source":"iana"},"application/vnd.api+json":{"source":"iana","compressible":true},"application/vnd.aplextor.warrp+json":{"source":"iana","compressible":true},"application/vnd.apothekende.reservation+json":{"source":"iana","compressible":true},"application/vnd.apple.installer+xml":{"source":"iana","compressible":true,"extensions":["mpkg"]},"application/vnd.apple.keynote":{"source":"iana","extensions":["key"]},"application/vnd.apple.mpegurl":{"source":"iana","extensions":["m3u8"]},"application/vnd.apple.numbers":{"source":"iana","extensions":["numbers"]},"application/vnd.apple.pages":{"source":"iana","extensions":["pages"]},"application/vnd.apple.pkpass":{"compressible":false,"extensions":["pkpass"]},"application/vnd.arastra.swi":{"source":"iana"},"application/vnd.aristanetworks.swi":{"source":"iana","extensions":["swi"]},"application/vnd.artisan+json":{"source":"iana","compressible":true},"application/vnd.artsquare":{"source":"iana"},"application/vnd.astraea-software.iota":{"source":"iana","extensions":["iota"]},"application/vnd.audiograph":{"source":"iana","extensions":["aep"]},"application/vnd.autopackage":{"source":"iana"},"application/vnd.avalon+json":{"source":"iana","compressible":true},"application/vnd.avistar+xml":{"source":"iana","compressible":true},"application/vnd.balsamiq.bmml+xml":{"source":"iana","compressible":true,"extensions":["bmml"]},"application/vnd.balsamiq.bmpr":{"source":"iana"},"application/vnd.banana-accounting":{"source":"iana"},"application/vnd.bbf.usp.error":{"source":"iana"},"application/vnd.bbf.usp.msg":{"source":"iana"},"application/vnd.bbf.usp.msg+json":{"source":"iana","compressible":true},"application/vnd.bekitzur-stech+json":{"source":"iana","compressible":true},"application/vnd.bint.med-content":{"source":"iana"},"application/vnd.biopax.rdf+xml":{"source":"iana","compressible":true},"application/vnd.blink-idb-value-wrapper":{"source":"iana"},"application/vnd.blueice.multipass":{"source":"iana","extensions":["mpm"]},"application/vnd.bluetooth.ep.oob":{"source":"iana"},"application/vnd.bluetooth.le.oob":{"source":"iana"},"application/vnd.bmi":{"source":"iana","extensions":["bmi"]},"application/vnd.bpf":{"source":"iana"},"application/vnd.bpf3":{"source":"iana"},"application/vnd.businessobjects":{"source":"iana","extensions":["rep"]},"application/vnd.byu.uapi+json":{"source":"iana","compressible":true},"application/vnd.cab-jscript":{"source":"iana"},"application/vnd.canon-cpdl":{"source":"iana"},"application/vnd.canon-lips":{"source":"iana"},"application/vnd.capasystems-pg+json":{"source":"iana","compressible":true},"application/vnd.cendio.thinlinc.clientconf":{"source":"iana"},"application/vnd.century-systems.tcp_stream":{"source":"iana"},"application/vnd.chemdraw+xml":{"source":"iana","compressible":true,"extensions":["cdxml"]},"application/vnd.chess-pgn":{"source":"iana"},"application/vnd.chipnuts.karaoke-mmd":{"source":"iana","extensions":["mmd"]},"application/vnd.ciedi":{"source":"iana"},"application/vnd.cinderella":{"source":"iana","extensions":["cdy"]},"application/vnd.cirpack.isdn-ext":{"source":"iana"},"application/vnd.citationstyles.style+xml":{"source":"iana","compressible":true,"extensions":["csl"]},"application/vnd.claymore":{"source":"iana","extensions":["cla"]},"application/vnd.cloanto.rp9":{"source":"iana","extensions":["rp9"]},"application/vnd.clonk.c4group":{"source":"iana","extensions":["c4g","c4d","c4f","c4p","c4u"]},"application/vnd.cluetrust.cartomobile-config":{"source":"iana","extensions":["c11amc"]},"application/vnd.cluetrust.cartomobile-config-pkg":{"source":"iana","extensions":["c11amz"]},"application/vnd.coffeescript":{"source":"iana"},"application/vnd.collabio.xodocuments.document":{"source":"iana"},"application/vnd.collabio.xodocuments.document-template":{"source":"iana"},"application/vnd.collabio.xodocuments.presentation":{"source":"iana"},"application/vnd.collabio.xodocuments.presentation-template":{"source":"iana"},"application/vnd.collabio.xodocuments.spreadsheet":{"source":"iana"},"application/vnd.collabio.xodocuments.spreadsheet-template":{"source":"iana"},"application/vnd.collection+json":{"source":"iana","compressible":true},"application/vnd.collection.doc+json":{"source":"iana","compressible":true},"application/vnd.collection.next+json":{"source":"iana","compressible":true},"application/vnd.comicbook+zip":{"source":"iana","compressible":false},"application/vnd.comicbook-rar":{"source":"iana"},"application/vnd.commerce-battelle":{"source":"iana"},"application/vnd.commonspace":{"source":"iana","extensions":["csp"]},"application/vnd.contact.cmsg":{"source":"iana","extensions":["cdbcmsg"]},"application/vnd.coreos.ignition+json":{"source":"iana","compressible":true},"application/vnd.cosmocaller":{"source":"iana","extensions":["cmc"]},"application/vnd.crick.clicker":{"source":"iana","extensions":["clkx"]},"application/vnd.crick.clicker.keyboard":{"source":"iana","extensions":["clkk"]},"application/vnd.crick.clicker.palette":{"source":"iana","extensions":["clkp"]},"application/vnd.crick.clicker.template":{"source":"iana","extensions":["clkt"]},"application/vnd.crick.clicker.wordbank":{"source":"iana","extensions":["clkw"]},"application/vnd.criticaltools.wbs+xml":{"source":"iana","compressible":true,"extensions":["wbs"]},"application/vnd.cryptii.pipe+json":{"source":"iana","compressible":true},"application/vnd.crypto-shade-file":{"source":"iana"},"application/vnd.cryptomator.encrypted":{"source":"iana"},"application/vnd.cryptomator.vault":{"source":"iana"},"application/vnd.ctc-posml":{"source":"iana","extensions":["pml"]},"application/vnd.ctct.ws+xml":{"source":"iana","compressible":true},"application/vnd.cups-pdf":{"source":"iana"},"application/vnd.cups-postscript":{"source":"iana"},"application/vnd.cups-ppd":{"source":"iana","extensions":["ppd"]},"application/vnd.cups-raster":{"source":"iana"},"application/vnd.cups-raw":{"source":"iana"},"application/vnd.curl":{"source":"iana"},"application/vnd.curl.car":{"source":"apache","extensions":["car"]},"application/vnd.curl.pcurl":{"source":"apache","extensions":["pcurl"]},"application/vnd.cyan.dean.root+xml":{"source":"iana","compressible":true},"application/vnd.cybank":{"source":"iana"},"application/vnd.cyclonedx+json":{"source":"iana","compressible":true},"application/vnd.cyclonedx+xml":{"source":"iana","compressible":true},"application/vnd.d2l.coursepackage1p0+zip":{"source":"iana","compressible":false},"application/vnd.d3m-dataset":{"source":"iana"},"application/vnd.d3m-problem":{"source":"iana"},"application/vnd.dart":{"source":"iana","compressible":true,"extensions":["dart"]},"application/vnd.data-vision.rdz":{"source":"iana","extensions":["rdz"]},"application/vnd.datapackage+json":{"source":"iana","compressible":true},"application/vnd.dataresource+json":{"source":"iana","compressible":true},"application/vnd.dbf":{"source":"iana","extensions":["dbf"]},"application/vnd.debian.binary-package":{"source":"iana"},"application/vnd.dece.data":{"source":"iana","extensions":["uvf","uvvf","uvd","uvvd"]},"application/vnd.dece.ttml+xml":{"source":"iana","compressible":true,"extensions":["uvt","uvvt"]},"application/vnd.dece.unspecified":{"source":"iana","extensions":["uvx","uvvx"]},"application/vnd.dece.zip":{"source":"iana","extensions":["uvz","uvvz"]},"application/vnd.denovo.fcselayout-link":{"source":"iana","extensions":["fe_launch"]},"application/vnd.desmume.movie":{"source":"iana"},"application/vnd.dir-bi.plate-dl-nosuffix":{"source":"iana"},"application/vnd.dm.delegation+xml":{"source":"iana","compressible":true},"application/vnd.dna":{"source":"iana","extensions":["dna"]},"application/vnd.document+json":{"source":"iana","compressible":true},"application/vnd.dolby.mlp":{"source":"apache","extensions":["mlp"]},"application/vnd.dolby.mobile.1":{"source":"iana"},"application/vnd.dolby.mobile.2":{"source":"iana"},"application/vnd.doremir.scorecloud-binary-document":{"source":"iana"},"application/vnd.dpgraph":{"source":"iana","extensions":["dpg"]},"application/vnd.dreamfactory":{"source":"iana","extensions":["dfac"]},"application/vnd.drive+json":{"source":"iana","compressible":true},"application/vnd.ds-keypoint":{"source":"apache","extensions":["kpxx"]},"application/vnd.dtg.local":{"source":"iana"},"application/vnd.dtg.local.flash":{"source":"iana"},"application/vnd.dtg.local.html":{"source":"iana"},"application/vnd.dvb.ait":{"source":"iana","extensions":["ait"]},"application/vnd.dvb.dvbisl+xml":{"source":"iana","compressible":true},"application/vnd.dvb.dvbj":{"source":"iana"},"application/vnd.dvb.esgcontainer":{"source":"iana"},"application/vnd.dvb.ipdcdftnotifaccess":{"source":"iana"},"application/vnd.dvb.ipdcesgaccess":{"source":"iana"},"application/vnd.dvb.ipdcesgaccess2":{"source":"iana"},"application/vnd.dvb.ipdcesgpdd":{"source":"iana"},"application/vnd.dvb.ipdcroaming":{"source":"iana"},"application/vnd.dvb.iptv.alfec-base":{"source":"iana"},"application/vnd.dvb.iptv.alfec-enhancement":{"source":"iana"},"application/vnd.dvb.notif-aggregate-root+xml":{"source":"iana","compressible":true},"application/vnd.dvb.notif-container+xml":{"source":"iana","compressible":true},"application/vnd.dvb.notif-generic+xml":{"source":"iana","compressible":true},"application/vnd.dvb.notif-ia-msglist+xml":{"source":"iana","compressible":true},"application/vnd.dvb.notif-ia-registration-request+xml":{"source":"iana","compressible":true},"application/vnd.dvb.notif-ia-registration-response+xml":{"source":"iana","compressible":true},"application/vnd.dvb.notif-init+xml":{"source":"iana","compressible":true},"application/vnd.dvb.pfr":{"source":"iana"},"application/vnd.dvb.service":{"source":"iana","extensions":["svc"]},"application/vnd.dxr":{"source":"iana"},"application/vnd.dynageo":{"source":"iana","extensions":["geo"]},"application/vnd.dzr":{"source":"iana"},"application/vnd.easykaraoke.cdgdownload":{"source":"iana"},"application/vnd.ecdis-update":{"source":"iana"},"application/vnd.ecip.rlp":{"source":"iana"},"application/vnd.eclipse.ditto+json":{"source":"iana","compressible":true},"application/vnd.ecowin.chart":{"source":"iana","extensions":["mag"]},"application/vnd.ecowin.filerequest":{"source":"iana"},"application/vnd.ecowin.fileupdate":{"source":"iana"},"application/vnd.ecowin.series":{"source":"iana"},"application/vnd.ecowin.seriesrequest":{"source":"iana"},"application/vnd.ecowin.seriesupdate":{"source":"iana"},"application/vnd.efi.img":{"source":"iana"},"application/vnd.efi.iso":{"source":"iana"},"application/vnd.emclient.accessrequest+xml":{"source":"iana","compressible":true},"application/vnd.enliven":{"source":"iana","extensions":["nml"]},"application/vnd.enphase.envoy":{"source":"iana"},"application/vnd.eprints.data+xml":{"source":"iana","compressible":true},"application/vnd.epson.esf":{"source":"iana","extensions":["esf"]},"application/vnd.epson.msf":{"source":"iana","extensions":["msf"]},"application/vnd.epson.quickanime":{"source":"iana","extensions":["qam"]},"application/vnd.epson.salt":{"source":"iana","extensions":["slt"]},"application/vnd.epson.ssf":{"source":"iana","extensions":["ssf"]},"application/vnd.ericsson.quickcall":{"source":"iana"},"application/vnd.espass-espass+zip":{"source":"iana","compressible":false},"application/vnd.eszigno3+xml":{"source":"iana","compressible":true,"extensions":["es3","et3"]},"application/vnd.etsi.aoc+xml":{"source":"iana","compressible":true},"application/vnd.etsi.asic-e+zip":{"source":"iana","compressible":false},"application/vnd.etsi.asic-s+zip":{"source":"iana","compressible":false},"application/vnd.etsi.cug+xml":{"source":"iana","compressible":true},"application/vnd.etsi.iptvcommand+xml":{"source":"iana","compressible":true},"application/vnd.etsi.iptvdiscovery+xml":{"source":"iana","compressible":true},"application/vnd.etsi.iptvprofile+xml":{"source":"iana","compressible":true},"application/vnd.etsi.iptvsad-bc+xml":{"source":"iana","compressible":true},"application/vnd.etsi.iptvsad-cod+xml":{"source":"iana","compressible":true},"application/vnd.etsi.iptvsad-npvr+xml":{"source":"iana","compressible":true},"application/vnd.etsi.iptvservice+xml":{"source":"iana","compressible":true},"application/vnd.etsi.iptvsync+xml":{"source":"iana","compressible":true},"application/vnd.etsi.iptvueprofile+xml":{"source":"iana","compressible":true},"application/vnd.etsi.mcid+xml":{"source":"iana","compressible":true},"application/vnd.etsi.mheg5":{"source":"iana"},"application/vnd.etsi.overload-control-policy-dataset+xml":{"source":"iana","compressible":true},"application/vnd.etsi.pstn+xml":{"source":"iana","compressible":true},"application/vnd.etsi.sci+xml":{"source":"iana","compressible":true},"application/vnd.etsi.simservs+xml":{"source":"iana","compressible":true},"application/vnd.etsi.timestamp-token":{"source":"iana"},"application/vnd.etsi.tsl+xml":{"source":"iana","compressible":true},"application/vnd.etsi.tsl.der":{"source":"iana"},"application/vnd.eu.kasparian.car+json":{"source":"iana","compressible":true},"application/vnd.eudora.data":{"source":"iana"},"application/vnd.evolv.ecig.profile":{"source":"iana"},"application/vnd.evolv.ecig.settings":{"source":"iana"},"application/vnd.evolv.ecig.theme":{"source":"iana"},"application/vnd.exstream-empower+zip":{"source":"iana","compressible":false},"application/vnd.exstream-package":{"source":"iana"},"application/vnd.ezpix-album":{"source":"iana","extensions":["ez2"]},"application/vnd.ezpix-package":{"source":"iana","extensions":["ez3"]},"application/vnd.f-secure.mobile":{"source":"iana"},"application/vnd.familysearch.gedcom+zip":{"source":"iana","compressible":false},"application/vnd.fastcopy-disk-image":{"source":"iana"},"application/vnd.fdf":{"source":"iana","extensions":["fdf"]},"application/vnd.fdsn.mseed":{"source":"iana","extensions":["mseed"]},"application/vnd.fdsn.seed":{"source":"iana","extensions":["seed","dataless"]},"application/vnd.ffsns":{"source":"iana"},"application/vnd.ficlab.flb+zip":{"source":"iana","compressible":false},"application/vnd.filmit.zfc":{"source":"iana"},"application/vnd.fints":{"source":"iana"},"application/vnd.firemonkeys.cloudcell":{"source":"iana"},"application/vnd.flographit":{"source":"iana","extensions":["gph"]},"application/vnd.fluxtime.clip":{"source":"iana","extensions":["ftc"]},"application/vnd.font-fontforge-sfd":{"source":"iana"},"application/vnd.framemaker":{"source":"iana","extensions":["fm","frame","maker","book"]},"application/vnd.frogans.fnc":{"source":"iana","extensions":["fnc"]},"application/vnd.frogans.ltf":{"source":"iana","extensions":["ltf"]},"application/vnd.fsc.weblaunch":{"source":"iana","extensions":["fsc"]},"application/vnd.fujifilm.fb.docuworks":{"source":"iana"},"application/vnd.fujifilm.fb.docuworks.binder":{"source":"iana"},"application/vnd.fujifilm.fb.docuworks.container":{"source":"iana"},"application/vnd.fujifilm.fb.jfi+xml":{"source":"iana","compressible":true},"application/vnd.fujitsu.oasys":{"source":"iana","extensions":["oas"]},"application/vnd.fujitsu.oasys2":{"source":"iana","extensions":["oa2"]},"application/vnd.fujitsu.oasys3":{"source":"iana","extensions":["oa3"]},"application/vnd.fujitsu.oasysgp":{"source":"iana","extensions":["fg5"]},"application/vnd.fujitsu.oasysprs":{"source":"iana","extensions":["bh2"]},"application/vnd.fujixerox.art-ex":{"source":"iana"},"application/vnd.fujixerox.art4":{"source":"iana"},"application/vnd.fujixerox.ddd":{"source":"iana","extensions":["ddd"]},"application/vnd.fujixerox.docuworks":{"source":"iana","extensions":["xdw"]},"application/vnd.fujixerox.docuworks.binder":{"source":"iana","extensions":["xbd"]},"application/vnd.fujixerox.docuworks.container":{"source":"iana"},"application/vnd.fujixerox.hbpl":{"source":"iana"},"application/vnd.fut-misnet":{"source":"iana"},"application/vnd.futoin+cbor":{"source":"iana"},"application/vnd.futoin+json":{"source":"iana","compressible":true},"application/vnd.fuzzysheet":{"source":"iana","extensions":["fzs"]},"application/vnd.genomatix.tuxedo":{"source":"iana","extensions":["txd"]},"application/vnd.gentics.grd+json":{"source":"iana","compressible":true},"application/vnd.geo+json":{"source":"iana","compressible":true},"application/vnd.geocube+xml":{"source":"iana","compressible":true},"application/vnd.geogebra.file":{"source":"iana","extensions":["ggb"]},"application/vnd.geogebra.slides":{"source":"iana"},"application/vnd.geogebra.tool":{"source":"iana","extensions":["ggt"]},"application/vnd.geometry-explorer":{"source":"iana","extensions":["gex","gre"]},"application/vnd.geonext":{"source":"iana","extensions":["gxt"]},"application/vnd.geoplan":{"source":"iana","extensions":["g2w"]},"application/vnd.geospace":{"source":"iana","extensions":["g3w"]},"application/vnd.gerber":{"source":"iana"},"application/vnd.globalplatform.card-content-mgt":{"source":"iana"},"application/vnd.globalplatform.card-content-mgt-response":{"source":"iana"},"application/vnd.gmx":{"source":"iana","extensions":["gmx"]},"application/vnd.google-apps.document":{"compressible":false,"extensions":["gdoc"]},"application/vnd.google-apps.presentation":{"compressible":false,"extensions":["gslides"]},"application/vnd.google-apps.spreadsheet":{"compressible":false,"extensions":["gsheet"]},"application/vnd.google-earth.kml+xml":{"source":"iana","compressible":true,"extensions":["kml"]},"application/vnd.google-earth.kmz":{"source":"iana","compressible":false,"extensions":["kmz"]},"application/vnd.gov.sk.e-form+xml":{"source":"iana","compressible":true},"application/vnd.gov.sk.e-form+zip":{"source":"iana","compressible":false},"application/vnd.gov.sk.xmldatacontainer+xml":{"source":"iana","compressible":true},"application/vnd.grafeq":{"source":"iana","extensions":["gqf","gqs"]},"application/vnd.gridmp":{"source":"iana"},"application/vnd.groove-account":{"source":"iana","extensions":["gac"]},"application/vnd.groove-help":{"source":"iana","extensions":["ghf"]},"application/vnd.groove-identity-message":{"source":"iana","extensions":["gim"]},"application/vnd.groove-injector":{"source":"iana","extensions":["grv"]},"application/vnd.groove-tool-message":{"source":"iana","extensions":["gtm"]},"application/vnd.groove-tool-template":{"source":"iana","extensions":["tpl"]},"application/vnd.groove-vcard":{"source":"iana","extensions":["vcg"]},"application/vnd.hal+json":{"source":"iana","compressible":true},"application/vnd.hal+xml":{"source":"iana","compressible":true,"extensions":["hal"]},"application/vnd.handheld-entertainment+xml":{"source":"iana","compressible":true,"extensions":["zmm"]},"application/vnd.hbci":{"source":"iana","extensions":["hbci"]},"application/vnd.hc+json":{"source":"iana","compressible":true},"application/vnd.hcl-bireports":{"source":"iana"},"application/vnd.hdt":{"source":"iana"},"application/vnd.heroku+json":{"source":"iana","compressible":true},"application/vnd.hhe.lesson-player":{"source":"iana","extensions":["les"]},"application/vnd.hl7cda+xml":{"source":"iana","charset":"UTF-8","compressible":true},"application/vnd.hl7v2+xml":{"source":"iana","charset":"UTF-8","compressible":true},"application/vnd.hp-hpgl":{"source":"iana","extensions":["hpgl"]},"application/vnd.hp-hpid":{"source":"iana","extensions":["hpid"]},"application/vnd.hp-hps":{"source":"iana","extensions":["hps"]},"application/vnd.hp-jlyt":{"source":"iana","extensions":["jlt"]},"application/vnd.hp-pcl":{"source":"iana","extensions":["pcl"]},"application/vnd.hp-pclxl":{"source":"iana","extensions":["pclxl"]},"application/vnd.httphone":{"source":"iana"},"application/vnd.hydrostatix.sof-data":{"source":"iana","extensions":["sfd-hdstx"]},"application/vnd.hyper+json":{"source":"iana","compressible":true},"application/vnd.hyper-item+json":{"source":"iana","compressible":true},"application/vnd.hyperdrive+json":{"source":"iana","compressible":true},"application/vnd.hzn-3d-crossword":{"source":"iana"},"application/vnd.ibm.afplinedata":{"source":"iana"},"application/vnd.ibm.electronic-media":{"source":"iana"},"application/vnd.ibm.minipay":{"source":"iana","extensions":["mpy"]},"application/vnd.ibm.modcap":{"source":"iana","extensions":["afp","listafp","list3820"]},"application/vnd.ibm.rights-management":{"source":"iana","extensions":["irm"]},"application/vnd.ibm.secure-container":{"source":"iana","extensions":["sc"]},"application/vnd.iccprofile":{"source":"iana","extensions":["icc","icm"]},"application/vnd.ieee.1905":{"source":"iana"},"application/vnd.igloader":{"source":"iana","extensions":["igl"]},"application/vnd.imagemeter.folder+zip":{"source":"iana","compressible":false},"application/vnd.imagemeter.image+zip":{"source":"iana","compressible":false},"application/vnd.immervision-ivp":{"source":"iana","extensions":["ivp"]},"application/vnd.immervision-ivu":{"source":"iana","extensions":["ivu"]},"application/vnd.ims.imsccv1p1":{"source":"iana"},"application/vnd.ims.imsccv1p2":{"source":"iana"},"application/vnd.ims.imsccv1p3":{"source":"iana"},"application/vnd.ims.lis.v2.result+json":{"source":"iana","compressible":true},"application/vnd.ims.lti.v2.toolconsumerprofile+json":{"source":"iana","compressible":true},"application/vnd.ims.lti.v2.toolproxy+json":{"source":"iana","compressible":true},"application/vnd.ims.lti.v2.toolproxy.id+json":{"source":"iana","compressible":true},"application/vnd.ims.lti.v2.toolsettings+json":{"source":"iana","compressible":true},"application/vnd.ims.lti.v2.toolsettings.simple+json":{"source":"iana","compressible":true},"application/vnd.informedcontrol.rms+xml":{"source":"iana","compressible":true},"application/vnd.informix-visionary":{"source":"iana"},"application/vnd.infotech.project":{"source":"iana"},"application/vnd.infotech.project+xml":{"source":"iana","compressible":true},"application/vnd.innopath.wamp.notification":{"source":"iana"},"application/vnd.insors.igm":{"source":"iana","extensions":["igm"]},"application/vnd.intercon.formnet":{"source":"iana","extensions":["xpw","xpx"]},"application/vnd.intergeo":{"source":"iana","extensions":["i2g"]},"application/vnd.intertrust.digibox":{"source":"iana"},"application/vnd.intertrust.nncp":{"source":"iana"},"application/vnd.intu.qbo":{"source":"iana","extensions":["qbo"]},"application/vnd.intu.qfx":{"source":"iana","extensions":["qfx"]},"application/vnd.iptc.g2.catalogitem+xml":{"source":"iana","compressible":true},"application/vnd.iptc.g2.conceptitem+xml":{"source":"iana","compressible":true},"application/vnd.iptc.g2.knowledgeitem+xml":{"source":"iana","compressible":true},"application/vnd.iptc.g2.newsitem+xml":{"source":"iana","compressible":true},"application/vnd.iptc.g2.newsmessage+xml":{"source":"iana","compressible":true},"application/vnd.iptc.g2.packageitem+xml":{"source":"iana","compressible":true},"application/vnd.iptc.g2.planningitem+xml":{"source":"iana","compressible":true},"application/vnd.ipunplugged.rcprofile":{"source":"iana","extensions":["rcprofile"]},"application/vnd.irepository.package+xml":{"source":"iana","compressible":true,"extensions":["irp"]},"application/vnd.is-xpr":{"source":"iana","extensions":["xpr"]},"application/vnd.isac.fcs":{"source":"iana","extensions":["fcs"]},"application/vnd.iso11783-10+zip":{"source":"iana","compressible":false},"application/vnd.jam":{"source":"iana","extensions":["jam"]},"application/vnd.japannet-directory-service":{"source":"iana"},"application/vnd.japannet-jpnstore-wakeup":{"source":"iana"},"application/vnd.japannet-payment-wakeup":{"source":"iana"},"application/vnd.japannet-registration":{"source":"iana"},"application/vnd.japannet-registration-wakeup":{"source":"iana"},"application/vnd.japannet-setstore-wakeup":{"source":"iana"},"application/vnd.japannet-verification":{"source":"iana"},"application/vnd.japannet-verification-wakeup":{"source":"iana"},"application/vnd.jcp.javame.midlet-rms":{"source":"iana","extensions":["rms"]},"application/vnd.jisp":{"source":"iana","extensions":["jisp"]},"application/vnd.joost.joda-archive":{"source":"iana","extensions":["joda"]},"application/vnd.jsk.isdn-ngn":{"source":"iana"},"application/vnd.kahootz":{"source":"iana","extensions":["ktz","ktr"]},"application/vnd.kde.karbon":{"source":"iana","extensions":["karbon"]},"application/vnd.kde.kchart":{"source":"iana","extensions":["chrt"]},"application/vnd.kde.kformula":{"source":"iana","extensions":["kfo"]},"application/vnd.kde.kivio":{"source":"iana","extensions":["flw"]},"application/vnd.kde.kontour":{"source":"iana","extensions":["kon"]},"application/vnd.kde.kpresenter":{"source":"iana","extensions":["kpr","kpt"]},"application/vnd.kde.kspread":{"source":"iana","extensions":["ksp"]},"application/vnd.kde.kword":{"source":"iana","extensions":["kwd","kwt"]},"application/vnd.kenameaapp":{"source":"iana","extensions":["htke"]},"application/vnd.kidspiration":{"source":"iana","extensions":["kia"]},"application/vnd.kinar":{"source":"iana","extensions":["kne","knp"]},"application/vnd.koan":{"source":"iana","extensions":["skp","skd","skt","skm"]},"application/vnd.kodak-descriptor":{"source":"iana","extensions":["sse"]},"application/vnd.las":{"source":"iana"},"application/vnd.las.las+json":{"source":"iana","compressible":true},"application/vnd.las.las+xml":{"source":"iana","compressible":true,"extensions":["lasxml"]},"application/vnd.laszip":{"source":"iana"},"application/vnd.leap+json":{"source":"iana","compressible":true},"application/vnd.liberty-request+xml":{"source":"iana","compressible":true},"application/vnd.llamagraphics.life-balance.desktop":{"source":"iana","extensions":["lbd"]},"application/vnd.llamagraphics.life-balance.exchange+xml":{"source":"iana","compressible":true,"extensions":["lbe"]},"application/vnd.logipipe.circuit+zip":{"source":"iana","compressible":false},"application/vnd.loom":{"source":"iana"},"application/vnd.lotus-1-2-3":{"source":"iana","extensions":["123"]},"application/vnd.lotus-approach":{"source":"iana","extensions":["apr"]},"application/vnd.lotus-freelance":{"source":"iana","extensions":["pre"]},"application/vnd.lotus-notes":{"source":"iana","extensions":["nsf"]},"application/vnd.lotus-organizer":{"source":"iana","extensions":["org"]},"application/vnd.lotus-screencam":{"source":"iana","extensions":["scm"]},"application/vnd.lotus-wordpro":{"source":"iana","extensions":["lwp"]},"application/vnd.macports.portpkg":{"source":"iana","extensions":["portpkg"]},"application/vnd.mapbox-vector-tile":{"source":"iana","extensions":["mvt"]},"application/vnd.marlin.drm.actiontoken+xml":{"source":"iana","compressible":true},"application/vnd.marlin.drm.conftoken+xml":{"source":"iana","compressible":true},"application/vnd.marlin.drm.license+xml":{"source":"iana","compressible":true},"application/vnd.marlin.drm.mdcf":{"source":"iana"},"application/vnd.mason+json":{"source":"iana","compressible":true},"application/vnd.maxar.archive.3tz+zip":{"source":"iana","compressible":false},"application/vnd.maxmind.maxmind-db":{"source":"iana"},"application/vnd.mcd":{"source":"iana","extensions":["mcd"]},"application/vnd.medcalcdata":{"source":"iana","extensions":["mc1"]},"application/vnd.mediastation.cdkey":{"source":"iana","extensions":["cdkey"]},"application/vnd.meridian-slingshot":{"source":"iana"},"application/vnd.mfer":{"source":"iana","extensions":["mwf"]},"application/vnd.mfmp":{"source":"iana","extensions":["mfm"]},"application/vnd.micro+json":{"source":"iana","compressible":true},"application/vnd.micrografx.flo":{"source":"iana","extensions":["flo"]},"application/vnd.micrografx.igx":{"source":"iana","extensions":["igx"]},"application/vnd.microsoft.portable-executable":{"source":"iana"},"application/vnd.microsoft.windows.thumbnail-cache":{"source":"iana"},"application/vnd.miele+json":{"source":"iana","compressible":true},"application/vnd.mif":{"source":"iana","extensions":["mif"]},"application/vnd.minisoft-hp3000-save":{"source":"iana"},"application/vnd.mitsubishi.misty-guard.trustweb":{"source":"iana"},"application/vnd.mobius.daf":{"source":"iana","extensions":["daf"]},"application/vnd.mobius.dis":{"source":"iana","extensions":["dis"]},"application/vnd.mobius.mbk":{"source":"iana","extensions":["mbk"]},"application/vnd.mobius.mqy":{"source":"iana","extensions":["mqy"]},"application/vnd.mobius.msl":{"source":"iana","extensions":["msl"]},"application/vnd.mobius.plc":{"source":"iana","extensions":["plc"]},"application/vnd.mobius.txf":{"source":"iana","extensions":["txf"]},"application/vnd.mophun.application":{"source":"iana","extensions":["mpn"]},"application/vnd.mophun.certificate":{"source":"iana","extensions":["mpc"]},"application/vnd.motorola.flexsuite":{"source":"iana"},"application/vnd.motorola.flexsuite.adsi":{"source":"iana"},"application/vnd.motorola.flexsuite.fis":{"source":"iana"},"application/vnd.motorola.flexsuite.gotap":{"source":"iana"},"application/vnd.motorola.flexsuite.kmr":{"source":"iana"},"application/vnd.motorola.flexsuite.ttc":{"source":"iana"},"application/vnd.motorola.flexsuite.wem":{"source":"iana"},"application/vnd.motorola.iprm":{"source":"iana"},"application/vnd.mozilla.xul+xml":{"source":"iana","compressible":true,"extensions":["xul"]},"application/vnd.ms-3mfdocument":{"source":"iana"},"application/vnd.ms-artgalry":{"source":"iana","extensions":["cil"]},"application/vnd.ms-asf":{"source":"iana"},"application/vnd.ms-cab-compressed":{"source":"iana","extensions":["cab"]},"application/vnd.ms-color.iccprofile":{"source":"apache"},"application/vnd.ms-excel":{"source":"iana","compressible":false,"extensions":["xls","xlm","xla","xlc","xlt","xlw"]},"application/vnd.ms-excel.addin.macroenabled.12":{"source":"iana","extensions":["xlam"]},"application/vnd.ms-excel.sheet.binary.macroenabled.12":{"source":"iana","extensions":["xlsb"]},"application/vnd.ms-excel.sheet.macroenabled.12":{"source":"iana","extensions":["xlsm"]},"application/vnd.ms-excel.template.macroenabled.12":{"source":"iana","extensions":["xltm"]},"application/vnd.ms-fontobject":{"source":"iana","compressible":true,"extensions":["eot"]},"application/vnd.ms-htmlhelp":{"source":"iana","extensions":["chm"]},"application/vnd.ms-ims":{"source":"iana","extensions":["ims"]},"application/vnd.ms-lrm":{"source":"iana","extensions":["lrm"]},"application/vnd.ms-office.activex+xml":{"source":"iana","compressible":true},"application/vnd.ms-officetheme":{"source":"iana","extensions":["thmx"]},"application/vnd.ms-opentype":{"source":"apache","compressible":true},"application/vnd.ms-outlook":{"compressible":false,"extensions":["msg"]},"application/vnd.ms-package.obfuscated-opentype":{"source":"apache"},"application/vnd.ms-pki.seccat":{"source":"apache","extensions":["cat"]},"application/vnd.ms-pki.stl":{"source":"apache","extensions":["stl"]},"application/vnd.ms-playready.initiator+xml":{"source":"iana","compressible":true},"application/vnd.ms-powerpoint":{"source":"iana","compressible":false,"extensions":["ppt","pps","pot"]},"application/vnd.ms-powerpoint.addin.macroenabled.12":{"source":"iana","extensions":["ppam"]},"application/vnd.ms-powerpoint.presentation.macroenabled.12":{"source":"iana","extensions":["pptm"]},"application/vnd.ms-powerpoint.slide.macroenabled.12":{"source":"iana","extensions":["sldm"]},"application/vnd.ms-powerpoint.slideshow.macroenabled.12":{"source":"iana","extensions":["ppsm"]},"application/vnd.ms-powerpoint.template.macroenabled.12":{"source":"iana","extensions":["potm"]},"application/vnd.ms-printdevicecapabilities+xml":{"source":"iana","compressible":true},"application/vnd.ms-printing.printticket+xml":{"source":"apache","compressible":true},"application/vnd.ms-printschematicket+xml":{"source":"iana","compressible":true},"application/vnd.ms-project":{"source":"iana","extensions":["mpp","mpt"]},"application/vnd.ms-tnef":{"source":"iana"},"application/vnd.ms-windows.devicepairing":{"source":"iana"},"application/vnd.ms-windows.nwprinting.oob":{"source":"iana"},"application/vnd.ms-windows.printerpairing":{"source":"iana"},"application/vnd.ms-windows.wsd.oob":{"source":"iana"},"application/vnd.ms-wmdrm.lic-chlg-req":{"source":"iana"},"application/vnd.ms-wmdrm.lic-resp":{"source":"iana"},"application/vnd.ms-wmdrm.meter-chlg-req":{"source":"iana"},"application/vnd.ms-wmdrm.meter-resp":{"source":"iana"},"application/vnd.ms-word.document.macroenabled.12":{"source":"iana","extensions":["docm"]},"application/vnd.ms-word.template.macroenabled.12":{"source":"iana","extensions":["dotm"]},"application/vnd.ms-works":{"source":"iana","extensions":["wps","wks","wcm","wdb"]},"application/vnd.ms-wpl":{"source":"iana","extensions":["wpl"]},"application/vnd.ms-xpsdocument":{"source":"iana","compressible":false,"extensions":["xps"]},"application/vnd.msa-disk-image":{"source":"iana"},"application/vnd.mseq":{"source":"iana","extensions":["mseq"]},"application/vnd.msign":{"source":"iana"},"application/vnd.multiad.creator":{"source":"iana"},"application/vnd.multiad.creator.cif":{"source":"iana"},"application/vnd.music-niff":{"source":"iana"},"application/vnd.musician":{"source":"iana","extensions":["mus"]},"application/vnd.muvee.style":{"source":"iana","extensions":["msty"]},"application/vnd.mynfc":{"source":"iana","extensions":["taglet"]},"application/vnd.nacamar.ybrid+json":{"source":"iana","compressible":true},"application/vnd.ncd.control":{"source":"iana"},"application/vnd.ncd.reference":{"source":"iana"},"application/vnd.nearst.inv+json":{"source":"iana","compressible":true},"application/vnd.nebumind.line":{"source":"iana"},"application/vnd.nervana":{"source":"iana"},"application/vnd.netfpx":{"source":"iana"},"application/vnd.neurolanguage.nlu":{"source":"iana","extensions":["nlu"]},"application/vnd.nimn":{"source":"iana"},"application/vnd.nintendo.nitro.rom":{"source":"iana"},"application/vnd.nintendo.snes.rom":{"source":"iana"},"application/vnd.nitf":{"source":"iana","extensions":["ntf","nitf"]},"application/vnd.noblenet-directory":{"source":"iana","extensions":["nnd"]},"application/vnd.noblenet-sealer":{"source":"iana","extensions":["nns"]},"application/vnd.noblenet-web":{"source":"iana","extensions":["nnw"]},"application/vnd.nokia.catalogs":{"source":"iana"},"application/vnd.nokia.conml+wbxml":{"source":"iana"},"application/vnd.nokia.conml+xml":{"source":"iana","compressible":true},"application/vnd.nokia.iptv.config+xml":{"source":"iana","compressible":true},"application/vnd.nokia.isds-radio-presets":{"source":"iana"},"application/vnd.nokia.landmark+wbxml":{"source":"iana"},"application/vnd.nokia.landmark+xml":{"source":"iana","compressible":true},"application/vnd.nokia.landmarkcollection+xml":{"source":"iana","compressible":true},"application/vnd.nokia.n-gage.ac+xml":{"source":"iana","compressible":true,"extensions":["ac"]},"application/vnd.nokia.n-gage.data":{"source":"iana","extensions":["ngdat"]},"application/vnd.nokia.n-gage.symbian.install":{"source":"iana","extensions":["n-gage"]},"application/vnd.nokia.ncd":{"source":"iana"},"application/vnd.nokia.pcd+wbxml":{"source":"iana"},"application/vnd.nokia.pcd+xml":{"source":"iana","compressible":true},"application/vnd.nokia.radio-preset":{"source":"iana","extensions":["rpst"]},"application/vnd.nokia.radio-presets":{"source":"iana","extensions":["rpss"]},"application/vnd.novadigm.edm":{"source":"iana","extensions":["edm"]},"application/vnd.novadigm.edx":{"source":"iana","extensions":["edx"]},"application/vnd.novadigm.ext":{"source":"iana","extensions":["ext"]},"application/vnd.ntt-local.content-share":{"source":"iana"},"application/vnd.ntt-local.file-transfer":{"source":"iana"},"application/vnd.ntt-local.ogw_remote-access":{"source":"iana"},"application/vnd.ntt-local.sip-ta_remote":{"source":"iana"},"application/vnd.ntt-local.sip-ta_tcp_stream":{"source":"iana"},"application/vnd.oasis.opendocument.chart":{"source":"iana","extensions":["odc"]},"application/vnd.oasis.opendocument.chart-template":{"source":"iana","extensions":["otc"]},"application/vnd.oasis.opendocument.database":{"source":"iana","extensions":["odb"]},"application/vnd.oasis.opendocument.formula":{"source":"iana","extensions":["odf"]},"application/vnd.oasis.opendocument.formula-template":{"source":"iana","extensions":["odft"]},"application/vnd.oasis.opendocument.graphics":{"source":"iana","compressible":false,"extensions":["odg"]},"application/vnd.oasis.opendocument.graphics-template":{"source":"iana","extensions":["otg"]},"application/vnd.oasis.opendocument.image":{"source":"iana","extensions":["odi"]},"application/vnd.oasis.opendocument.image-template":{"source":"iana","extensions":["oti"]},"application/vnd.oasis.opendocument.presentation":{"source":"iana","compressible":false,"extensions":["odp"]},"application/vnd.oasis.opendocument.presentation-template":{"source":"iana","extensions":["otp"]},"application/vnd.oasis.opendocument.spreadsheet":{"source":"iana","compressible":false,"extensions":["ods"]},"application/vnd.oasis.opendocument.spreadsheet-template":{"source":"iana","extensions":["ots"]},"application/vnd.oasis.opendocument.text":{"source":"iana","compressible":false,"extensions":["odt"]},"application/vnd.oasis.opendocument.text-master":{"source":"iana","extensions":["odm"]},"application/vnd.oasis.opendocument.text-template":{"source":"iana","extensions":["ott"]},"application/vnd.oasis.opendocument.text-web":{"source":"iana","extensions":["oth"]},"application/vnd.obn":{"source":"iana"},"application/vnd.ocf+cbor":{"source":"iana"},"application/vnd.oci.image.manifest.v1+json":{"source":"iana","compressible":true},"application/vnd.oftn.l10n+json":{"source":"iana","compressible":true},"application/vnd.oipf.contentaccessdownload+xml":{"source":"iana","compressible":true},"application/vnd.oipf.contentaccessstreaming+xml":{"source":"iana","compressible":true},"application/vnd.oipf.cspg-hexbinary":{"source":"iana"},"application/vnd.oipf.dae.svg+xml":{"source":"iana","compressible":true},"application/vnd.oipf.dae.xhtml+xml":{"source":"iana","compressible":true},"application/vnd.oipf.mippvcontrolmessage+xml":{"source":"iana","compressible":true},"application/vnd.oipf.pae.gem":{"source":"iana"},"application/vnd.oipf.spdiscovery+xml":{"source":"iana","compressible":true},"application/vnd.oipf.spdlist+xml":{"source":"iana","compressible":true},"application/vnd.oipf.ueprofile+xml":{"source":"iana","compressible":true},"application/vnd.oipf.userprofile+xml":{"source":"iana","compressible":true},"application/vnd.olpc-sugar":{"source":"iana","extensions":["xo"]},"application/vnd.oma-scws-config":{"source":"iana"},"application/vnd.oma-scws-http-request":{"source":"iana"},"application/vnd.oma-scws-http-response":{"source":"iana"},"application/vnd.oma.bcast.associated-procedure-parameter+xml":{"source":"iana","compressible":true},"application/vnd.oma.bcast.drm-trigger+xml":{"source":"iana","compressible":true},"application/vnd.oma.bcast.imd+xml":{"source":"iana","compressible":true},"application/vnd.oma.bcast.ltkm":{"source":"iana"},"application/vnd.oma.bcast.notification+xml":{"source":"iana","compressible":true},"application/vnd.oma.bcast.provisioningtrigger":{"source":"iana"},"application/vnd.oma.bcast.sgboot":{"source":"iana"},"application/vnd.oma.bcast.sgdd+xml":{"source":"iana","compressible":true},"application/vnd.oma.bcast.sgdu":{"source":"iana"},"application/vnd.oma.bcast.simple-symbol-container":{"source":"iana"},"application/vnd.oma.bcast.smartcard-trigger+xml":{"source":"iana","compressible":true},"application/vnd.oma.bcast.sprov+xml":{"source":"iana","compressible":true},"application/vnd.oma.bcast.stkm":{"source":"iana"},"application/vnd.oma.cab-address-book+xml":{"source":"iana","compressible":true},"application/vnd.oma.cab-feature-handler+xml":{"source":"iana","compressible":true},"application/vnd.oma.cab-pcc+xml":{"source":"iana","compressible":true},"application/vnd.oma.cab-subs-invite+xml":{"source":"iana","compressible":true},"application/vnd.oma.cab-user-prefs+xml":{"source":"iana","compressible":true},"application/vnd.oma.dcd":{"source":"iana"},"application/vnd.oma.dcdc":{"source":"iana"},"application/vnd.oma.dd2+xml":{"source":"iana","compressible":true,"extensions":["dd2"]},"application/vnd.oma.drm.risd+xml":{"source":"iana","compressible":true},"application/vnd.oma.group-usage-list+xml":{"source":"iana","compressible":true},"application/vnd.oma.lwm2m+cbor":{"source":"iana"},"application/vnd.oma.lwm2m+json":{"source":"iana","compressible":true},"application/vnd.oma.lwm2m+tlv":{"source":"iana"},"application/vnd.oma.pal+xml":{"source":"iana","compressible":true},"application/vnd.oma.poc.detailed-progress-report+xml":{"source":"iana","compressible":true},"application/vnd.oma.poc.final-report+xml":{"source":"iana","compressible":true},"application/vnd.oma.poc.groups+xml":{"source":"iana","compressible":true},"application/vnd.oma.poc.invocation-descriptor+xml":{"source":"iana","compressible":true},"application/vnd.oma.poc.optimized-progress-report+xml":{"source":"iana","compressible":true},"application/vnd.oma.push":{"source":"iana"},"application/vnd.oma.scidm.messages+xml":{"source":"iana","compressible":true},"application/vnd.oma.xcap-directory+xml":{"source":"iana","compressible":true},"application/vnd.omads-email+xml":{"source":"iana","charset":"UTF-8","compressible":true},"application/vnd.omads-file+xml":{"source":"iana","charset":"UTF-8","compressible":true},"application/vnd.omads-folder+xml":{"source":"iana","charset":"UTF-8","compressible":true},"application/vnd.omaloc-supl-init":{"source":"iana"},"application/vnd.onepager":{"source":"iana"},"application/vnd.onepagertamp":{"source":"iana"},"application/vnd.onepagertamx":{"source":"iana"},"application/vnd.onepagertat":{"source":"iana"},"application/vnd.onepagertatp":{"source":"iana"},"application/vnd.onepagertatx":{"source":"iana"},"application/vnd.openblox.game+xml":{"source":"iana","compressible":true,"extensions":["obgx"]},"application/vnd.openblox.game-binary":{"source":"iana"},"application/vnd.openeye.oeb":{"source":"iana"},"application/vnd.openofficeorg.extension":{"source":"apache","extensions":["oxt"]},"application/vnd.openstreetmap.data+xml":{"source":"iana","compressible":true,"extensions":["osm"]},"application/vnd.opentimestamps.ots":{"source":"iana"},"application/vnd.openxmlformats-officedocument.custom-properties+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.customxmlproperties+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.drawing+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.drawingml.chart+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.drawingml.diagramcolors+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.drawingml.diagramdata+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.drawingml.diagramlayout+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.drawingml.diagramstyle+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.extended-properties+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.presentationml.commentauthors+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.presentationml.comments+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.presentationml.handoutmaster+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.presentationml.notesmaster+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.presentationml.notesslide+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.presentationml.presentation":{"source":"iana","compressible":false,"extensions":["pptx"]},"application/vnd.openxmlformats-officedocument.presentationml.presentation.main+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.presentationml.presprops+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.presentationml.slide":{"source":"iana","extensions":["sldx"]},"application/vnd.openxmlformats-officedocument.presentationml.slide+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.presentationml.slidelayout+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.presentationml.slidemaster+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.presentationml.slideshow":{"source":"iana","extensions":["ppsx"]},"application/vnd.openxmlformats-officedocument.presentationml.slideshow.main+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.presentationml.slideupdateinfo+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.presentationml.tablestyles+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.presentationml.tags+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.presentationml.template":{"source":"iana","extensions":["potx"]},"application/vnd.openxmlformats-officedocument.presentationml.template.main+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.presentationml.viewprops+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.spreadsheetml.calcchain+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.spreadsheetml.externallink+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotcachedefinition+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotcacherecords+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.spreadsheetml.pivottable+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.spreadsheetml.querytable+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.spreadsheetml.revisionheaders+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.spreadsheetml.revisionlog+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedstrings+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":{"source":"iana","compressible":false,"extensions":["xlsx"]},"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetmetadata+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.spreadsheetml.tablesinglecells+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.spreadsheetml.template":{"source":"iana","extensions":["xltx"]},"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.spreadsheetml.usernames+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.spreadsheetml.volatiledependencies+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.theme+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.themeoverride+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.vmldrawing":{"source":"iana"},"application/vnd.openxmlformats-officedocument.wordprocessingml.comments+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.wordprocessingml.document":{"source":"iana","compressible":false,"extensions":["docx"]},"application/vnd.openxmlformats-officedocument.wordprocessingml.document.glossary+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.wordprocessingml.endnotes+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.wordprocessingml.fonttable+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.wordprocessingml.footnotes+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.wordprocessingml.numbering+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.wordprocessingml.settings+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.wordprocessingml.styles+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.wordprocessingml.template":{"source":"iana","extensions":["dotx"]},"application/vnd.openxmlformats-officedocument.wordprocessingml.template.main+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.wordprocessingml.websettings+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-package.core-properties+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-package.digital-signature-xmlsignature+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-package.relationships+xml":{"source":"iana","compressible":true},"application/vnd.oracle.resource+json":{"source":"iana","compressible":true},"application/vnd.orange.indata":{"source":"iana"},"application/vnd.osa.netdeploy":{"source":"iana"},"application/vnd.osgeo.mapguide.package":{"source":"iana","extensions":["mgp"]},"application/vnd.osgi.bundle":{"source":"iana"},"application/vnd.osgi.dp":{"source":"iana","extensions":["dp"]},"application/vnd.osgi.subsystem":{"source":"iana","extensions":["esa"]},"application/vnd.otps.ct-kip+xml":{"source":"iana","compressible":true},"application/vnd.oxli.countgraph":{"source":"iana"},"application/vnd.pagerduty+json":{"source":"iana","compressible":true},"application/vnd.palm":{"source":"iana","extensions":["pdb","pqa","oprc"]},"application/vnd.panoply":{"source":"iana"},"application/vnd.paos.xml":{"source":"iana"},"application/vnd.patentdive":{"source":"iana"},"application/vnd.patientecommsdoc":{"source":"iana"},"application/vnd.pawaafile":{"source":"iana","extensions":["paw"]},"application/vnd.pcos":{"source":"iana"},"application/vnd.pg.format":{"source":"iana","extensions":["str"]},"application/vnd.pg.osasli":{"source":"iana","extensions":["ei6"]},"application/vnd.piaccess.application-licence":{"source":"iana"},"application/vnd.picsel":{"source":"iana","extensions":["efif"]},"application/vnd.pmi.widget":{"source":"iana","extensions":["wg"]},"application/vnd.poc.group-advertisement+xml":{"source":"iana","compressible":true},"application/vnd.pocketlearn":{"source":"iana","extensions":["plf"]},"application/vnd.powerbuilder6":{"source":"iana","extensions":["pbd"]},"application/vnd.powerbuilder6-s":{"source":"iana"},"application/vnd.powerbuilder7":{"source":"iana"},"application/vnd.powerbuilder7-s":{"source":"iana"},"application/vnd.powerbuilder75":{"source":"iana"},"application/vnd.powerbuilder75-s":{"source":"iana"},"application/vnd.preminet":{"source":"iana"},"application/vnd.previewsystems.box":{"source":"iana","extensions":["box"]},"application/vnd.proteus.magazine":{"source":"iana","extensions":["mgz"]},"application/vnd.psfs":{"source":"iana"},"application/vnd.publishare-delta-tree":{"source":"iana","extensions":["qps"]},"application/vnd.pvi.ptid1":{"source":"iana","extensions":["ptid"]},"application/vnd.pwg-multiplexed":{"source":"iana"},"application/vnd.pwg-xhtml-print+xml":{"source":"iana","compressible":true},"application/vnd.qualcomm.brew-app-res":{"source":"iana"},"application/vnd.quarantainenet":{"source":"iana"},"application/vnd.quark.quarkxpress":{"source":"iana","extensions":["qxd","qxt","qwd","qwt","qxl","qxb"]},"application/vnd.quobject-quoxdocument":{"source":"iana"},"application/vnd.radisys.moml+xml":{"source":"iana","compressible":true},"application/vnd.radisys.msml+xml":{"source":"iana","compressible":true},"application/vnd.radisys.msml-audit+xml":{"source":"iana","compressible":true},"application/vnd.radisys.msml-audit-conf+xml":{"source":"iana","compressible":true},"application/vnd.radisys.msml-audit-conn+xml":{"source":"iana","compressible":true},"application/vnd.radisys.msml-audit-dialog+xml":{"source":"iana","compressible":true},"application/vnd.radisys.msml-audit-stream+xml":{"source":"iana","compressible":true},"application/vnd.radisys.msml-conf+xml":{"source":"iana","compressible":true},"application/vnd.radisys.msml-dialog+xml":{"source":"iana","compressible":true},"application/vnd.radisys.msml-dialog-base+xml":{"source":"iana","compressible":true},"application/vnd.radisys.msml-dialog-fax-detect+xml":{"source":"iana","compressible":true},"application/vnd.radisys.msml-dialog-fax-sendrecv+xml":{"source":"iana","compressible":true},"application/vnd.radisys.msml-dialog-group+xml":{"source":"iana","compressible":true},"application/vnd.radisys.msml-dialog-speech+xml":{"source":"iana","compressible":true},"application/vnd.radisys.msml-dialog-transform+xml":{"source":"iana","compressible":true},"application/vnd.rainstor.data":{"source":"iana"},"application/vnd.rapid":{"source":"iana"},"application/vnd.rar":{"source":"iana","extensions":["rar"]},"application/vnd.realvnc.bed":{"source":"iana","extensions":["bed"]},"application/vnd.recordare.musicxml":{"source":"iana","extensions":["mxl"]},"application/vnd.recordare.musicxml+xml":{"source":"iana","compressible":true,"extensions":["musicxml"]},"application/vnd.renlearn.rlprint":{"source":"iana"},"application/vnd.resilient.logic":{"source":"iana"},"application/vnd.restful+json":{"source":"iana","compressible":true},"application/vnd.rig.cryptonote":{"source":"iana","extensions":["cryptonote"]},"application/vnd.rim.cod":{"source":"apache","extensions":["cod"]},"application/vnd.rn-realmedia":{"source":"apache","extensions":["rm"]},"application/vnd.rn-realmedia-vbr":{"source":"apache","extensions":["rmvb"]},"application/vnd.route66.link66+xml":{"source":"iana","compressible":true,"extensions":["link66"]},"application/vnd.rs-274x":{"source":"iana"},"application/vnd.ruckus.download":{"source":"iana"},"application/vnd.s3sms":{"source":"iana"},"application/vnd.sailingtracker.track":{"source":"iana","extensions":["st"]},"application/vnd.sar":{"source":"iana"},"application/vnd.sbm.cid":{"source":"iana"},"application/vnd.sbm.mid2":{"source":"iana"},"application/vnd.scribus":{"source":"iana"},"application/vnd.sealed.3df":{"source":"iana"},"application/vnd.sealed.csf":{"source":"iana"},"application/vnd.sealed.doc":{"source":"iana"},"application/vnd.sealed.eml":{"source":"iana"},"application/vnd.sealed.mht":{"source":"iana"},"application/vnd.sealed.net":{"source":"iana"},"application/vnd.sealed.ppt":{"source":"iana"},"application/vnd.sealed.tiff":{"source":"iana"},"application/vnd.sealed.xls":{"source":"iana"},"application/vnd.sealedmedia.softseal.html":{"source":"iana"},"application/vnd.sealedmedia.softseal.pdf":{"source":"iana"},"application/vnd.seemail":{"source":"iana","extensions":["see"]},"application/vnd.seis+json":{"source":"iana","compressible":true},"application/vnd.sema":{"source":"iana","extensions":["sema"]},"application/vnd.semd":{"source":"iana","extensions":["semd"]},"application/vnd.semf":{"source":"iana","extensions":["semf"]},"application/vnd.shade-save-file":{"source":"iana"},"application/vnd.shana.informed.formdata":{"source":"iana","extensions":["ifm"]},"application/vnd.shana.informed.formtemplate":{"source":"iana","extensions":["itp"]},"application/vnd.shana.informed.interchange":{"source":"iana","extensions":["iif"]},"application/vnd.shana.informed.package":{"source":"iana","extensions":["ipk"]},"application/vnd.shootproof+json":{"source":"iana","compressible":true},"application/vnd.shopkick+json":{"source":"iana","compressible":true},"application/vnd.shp":{"source":"iana"},"application/vnd.shx":{"source":"iana"},"application/vnd.sigrok.session":{"source":"iana"},"application/vnd.simtech-mindmapper":{"source":"iana","extensions":["twd","twds"]},"application/vnd.siren+json":{"source":"iana","compressible":true},"application/vnd.smaf":{"source":"iana","extensions":["mmf"]},"application/vnd.smart.notebook":{"source":"iana"},"application/vnd.smart.teacher":{"source":"iana","extensions":["teacher"]},"application/vnd.snesdev-page-table":{"source":"iana"},"application/vnd.software602.filler.form+xml":{"source":"iana","compressible":true,"extensions":["fo"]},"application/vnd.software602.filler.form-xml-zip":{"source":"iana"},"application/vnd.solent.sdkm+xml":{"source":"iana","compressible":true,"extensions":["sdkm","sdkd"]},"application/vnd.spotfire.dxp":{"source":"iana","extensions":["dxp"]},"application/vnd.spotfire.sfs":{"source":"iana","extensions":["sfs"]},"application/vnd.sqlite3":{"source":"iana"},"application/vnd.sss-cod":{"source":"iana"},"application/vnd.sss-dtf":{"source":"iana"},"application/vnd.sss-ntf":{"source":"iana"},"application/vnd.stardivision.calc":{"source":"apache","extensions":["sdc"]},"application/vnd.stardivision.draw":{"source":"apache","extensions":["sda"]},"application/vnd.stardivision.impress":{"source":"apache","extensions":["sdd"]},"application/vnd.stardivision.math":{"source":"apache","extensions":["smf"]},"application/vnd.stardivision.writer":{"source":"apache","extensions":["sdw","vor"]},"application/vnd.stardivision.writer-global":{"source":"apache","extensions":["sgl"]},"application/vnd.stepmania.package":{"source":"iana","extensions":["smzip"]},"application/vnd.stepmania.stepchart":{"source":"iana","extensions":["sm"]},"application/vnd.street-stream":{"source":"iana"},"application/vnd.sun.wadl+xml":{"source":"iana","compressible":true,"extensions":["wadl"]},"application/vnd.sun.xml.calc":{"source":"apache","extensions":["sxc"]},"application/vnd.sun.xml.calc.template":{"source":"apache","extensions":["stc"]},"application/vnd.sun.xml.draw":{"source":"apache","extensions":["sxd"]},"application/vnd.sun.xml.draw.template":{"source":"apache","extensions":["std"]},"application/vnd.sun.xml.impress":{"source":"apache","extensions":["sxi"]},"application/vnd.sun.xml.impress.template":{"source":"apache","extensions":["sti"]},"application/vnd.sun.xml.math":{"source":"apache","extensions":["sxm"]},"application/vnd.sun.xml.writer":{"source":"apache","extensions":["sxw"]},"application/vnd.sun.xml.writer.global":{"source":"apache","extensions":["sxg"]},"application/vnd.sun.xml.writer.template":{"source":"apache","extensions":["stw"]},"application/vnd.sus-calendar":{"source":"iana","extensions":["sus","susp"]},"application/vnd.svd":{"source":"iana","extensions":["svd"]},"application/vnd.swiftview-ics":{"source":"iana"},"application/vnd.sycle+xml":{"source":"iana","compressible":true},"application/vnd.syft+json":{"source":"iana","compressible":true},"application/vnd.symbian.install":{"source":"apache","extensions":["sis","sisx"]},"application/vnd.syncml+xml":{"source":"iana","charset":"UTF-8","compressible":true,"extensions":["xsm"]},"application/vnd.syncml.dm+wbxml":{"source":"iana","charset":"UTF-8","extensions":["bdm"]},"application/vnd.syncml.dm+xml":{"source":"iana","charset":"UTF-8","compressible":true,"extensions":["xdm"]},"application/vnd.syncml.dm.notification":{"source":"iana"},"application/vnd.syncml.dmddf+wbxml":{"source":"iana"},"application/vnd.syncml.dmddf+xml":{"source":"iana","charset":"UTF-8","compressible":true,"extensions":["ddf"]},"application/vnd.syncml.dmtnds+wbxml":{"source":"iana"},"application/vnd.syncml.dmtnds+xml":{"source":"iana","charset":"UTF-8","compressible":true},"application/vnd.syncml.ds.notification":{"source":"iana"},"application/vnd.tableschema+json":{"source":"iana","compressible":true},"application/vnd.tao.intent-module-archive":{"source":"iana","extensions":["tao"]},"application/vnd.tcpdump.pcap":{"source":"iana","extensions":["pcap","cap","dmp"]},"application/vnd.think-cell.ppttc+json":{"source":"iana","compressible":true},"application/vnd.tmd.mediaflex.api+xml":{"source":"iana","compressible":true},"application/vnd.tml":{"source":"iana"},"application/vnd.tmobile-livetv":{"source":"iana","extensions":["tmo"]},"application/vnd.tri.onesource":{"source":"iana"},"application/vnd.trid.tpt":{"source":"iana","extensions":["tpt"]},"application/vnd.triscape.mxs":{"source":"iana","extensions":["mxs"]},"application/vnd.trueapp":{"source":"iana","extensions":["tra"]},"application/vnd.truedoc":{"source":"iana"},"application/vnd.ubisoft.webplayer":{"source":"iana"},"application/vnd.ufdl":{"source":"iana","extensions":["ufd","ufdl"]},"application/vnd.uiq.theme":{"source":"iana","extensions":["utz"]},"application/vnd.umajin":{"source":"iana","extensions":["umj"]},"application/vnd.unity":{"source":"iana","extensions":["unityweb"]},"application/vnd.uoml+xml":{"source":"iana","compressible":true,"extensions":["uoml"]},"application/vnd.uplanet.alert":{"source":"iana"},"application/vnd.uplanet.alert-wbxml":{"source":"iana"},"application/vnd.uplanet.bearer-choice":{"source":"iana"},"application/vnd.uplanet.bearer-choice-wbxml":{"source":"iana"},"application/vnd.uplanet.cacheop":{"source":"iana"},"application/vnd.uplanet.cacheop-wbxml":{"source":"iana"},"application/vnd.uplanet.channel":{"source":"iana"},"application/vnd.uplanet.channel-wbxml":{"source":"iana"},"application/vnd.uplanet.list":{"source":"iana"},"application/vnd.uplanet.list-wbxml":{"source":"iana"},"application/vnd.uplanet.listcmd":{"source":"iana"},"application/vnd.uplanet.listcmd-wbxml":{"source":"iana"},"application/vnd.uplanet.signal":{"source":"iana"},"application/vnd.uri-map":{"source":"iana"},"application/vnd.valve.source.material":{"source":"iana"},"application/vnd.vcx":{"source":"iana","extensions":["vcx"]},"application/vnd.vd-study":{"source":"iana"},"application/vnd.vectorworks":{"source":"iana"},"application/vnd.vel+json":{"source":"iana","compressible":true},"application/vnd.verimatrix.vcas":{"source":"iana"},"application/vnd.veritone.aion+json":{"source":"iana","compressible":true},"application/vnd.veryant.thin":{"source":"iana"},"application/vnd.ves.encrypted":{"source":"iana"},"application/vnd.vidsoft.vidconference":{"source":"iana"},"application/vnd.visio":{"source":"iana","extensions":["vsd","vst","vss","vsw"]},"application/vnd.visionary":{"source":"iana","extensions":["vis"]},"application/vnd.vividence.scriptfile":{"source":"iana"},"application/vnd.vsf":{"source":"iana","extensions":["vsf"]},"application/vnd.wap.sic":{"source":"iana"},"application/vnd.wap.slc":{"source":"iana"},"application/vnd.wap.wbxml":{"source":"iana","charset":"UTF-8","extensions":["wbxml"]},"application/vnd.wap.wmlc":{"source":"iana","extensions":["wmlc"]},"application/vnd.wap.wmlscriptc":{"source":"iana","extensions":["wmlsc"]},"application/vnd.webturbo":{"source":"iana","extensions":["wtb"]},"application/vnd.wfa.dpp":{"source":"iana"},"application/vnd.wfa.p2p":{"source":"iana"},"application/vnd.wfa.wsc":{"source":"iana"},"application/vnd.windows.devicepairing":{"source":"iana"},"application/vnd.wmc":{"source":"iana"},"application/vnd.wmf.bootstrap":{"source":"iana"},"application/vnd.wolfram.mathematica":{"source":"iana"},"application/vnd.wolfram.mathematica.package":{"source":"iana"},"application/vnd.wolfram.player":{"source":"iana","extensions":["nbp"]},"application/vnd.wordperfect":{"source":"iana","extensions":["wpd"]},"application/vnd.wqd":{"source":"iana","extensions":["wqd"]},"application/vnd.wrq-hp3000-labelled":{"source":"iana"},"application/vnd.wt.stf":{"source":"iana","extensions":["stf"]},"application/vnd.wv.csp+wbxml":{"source":"iana"},"application/vnd.wv.csp+xml":{"source":"iana","compressible":true},"application/vnd.wv.ssp+xml":{"source":"iana","compressible":true},"application/vnd.xacml+json":{"source":"iana","compressible":true},"application/vnd.xara":{"source":"iana","extensions":["xar"]},"application/vnd.xfdl":{"source":"iana","extensions":["xfdl"]},"application/vnd.xfdl.webform":{"source":"iana"},"application/vnd.xmi+xml":{"source":"iana","compressible":true},"application/vnd.xmpie.cpkg":{"source":"iana"},"application/vnd.xmpie.dpkg":{"source":"iana"},"application/vnd.xmpie.plan":{"source":"iana"},"application/vnd.xmpie.ppkg":{"source":"iana"},"application/vnd.xmpie.xlim":{"source":"iana"},"application/vnd.yamaha.hv-dic":{"source":"iana","extensions":["hvd"]},"application/vnd.yamaha.hv-script":{"source":"iana","extensions":["hvs"]},"application/vnd.yamaha.hv-voice":{"source":"iana","extensions":["hvp"]},"application/vnd.yamaha.openscoreformat":{"source":"iana","extensions":["osf"]},"application/vnd.yamaha.openscoreformat.osfpvg+xml":{"source":"iana","compressible":true,"extensions":["osfpvg"]},"application/vnd.yamaha.remote-setup":{"source":"iana"},"application/vnd.yamaha.smaf-audio":{"source":"iana","extensions":["saf"]},"application/vnd.yamaha.smaf-phrase":{"source":"iana","extensions":["spf"]},"application/vnd.yamaha.through-ngn":{"source":"iana"},"application/vnd.yamaha.tunnel-udpencap":{"source":"iana"},"application/vnd.yaoweme":{"source":"iana"},"application/vnd.yellowriver-custom-menu":{"source":"iana","extensions":["cmp"]},"application/vnd.youtube.yt":{"source":"iana"},"application/vnd.zul":{"source":"iana","extensions":["zir","zirz"]},"application/vnd.zzazz.deck+xml":{"source":"iana","compressible":true,"extensions":["zaz"]},"application/voicexml+xml":{"source":"iana","compressible":true,"extensions":["vxml"]},"application/voucher-cms+json":{"source":"iana","compressible":true},"application/vq-rtcpxr":{"source":"iana"},"application/wasm":{"source":"iana","compressible":true,"extensions":["wasm"]},"application/watcherinfo+xml":{"source":"iana","compressible":true,"extensions":["wif"]},"application/webpush-options+json":{"source":"iana","compressible":true},"application/whoispp-query":{"source":"iana"},"application/whoispp-response":{"source":"iana"},"application/widget":{"source":"iana","extensions":["wgt"]},"application/winhlp":{"source":"apache","extensions":["hlp"]},"application/wita":{"source":"iana"},"application/wordperfect5.1":{"source":"iana"},"application/wsdl+xml":{"source":"iana","compressible":true,"extensions":["wsdl"]},"application/wspolicy+xml":{"source":"iana","compressible":true,"extensions":["wspolicy"]},"application/x-7z-compressed":{"source":"apache","compressible":false,"extensions":["7z"]},"application/x-abiword":{"source":"apache","extensions":["abw"]},"application/x-ace-compressed":{"source":"apache","extensions":["ace"]},"application/x-amf":{"source":"apache"},"application/x-apple-diskimage":{"source":"apache","extensions":["dmg"]},"application/x-arj":{"compressible":false,"extensions":["arj"]},"application/x-authorware-bin":{"source":"apache","extensions":["aab","x32","u32","vox"]},"application/x-authorware-map":{"source":"apache","extensions":["aam"]},"application/x-authorware-seg":{"source":"apache","extensions":["aas"]},"application/x-bcpio":{"source":"apache","extensions":["bcpio"]},"application/x-bdoc":{"compressible":false,"extensions":["bdoc"]},"application/x-bittorrent":{"source":"apache","extensions":["torrent"]},"application/x-blorb":{"source":"apache","extensions":["blb","blorb"]},"application/x-bzip":{"source":"apache","compressible":false,"extensions":["bz"]},"application/x-bzip2":{"source":"apache","compressible":false,"extensions":["bz2","boz"]},"application/x-cbr":{"source":"apache","extensions":["cbr","cba","cbt","cbz","cb7"]},"application/x-cdlink":{"source":"apache","extensions":["vcd"]},"application/x-cfs-compressed":{"source":"apache","extensions":["cfs"]},"application/x-chat":{"source":"apache","extensions":["chat"]},"application/x-chess-pgn":{"source":"apache","extensions":["pgn"]},"application/x-chrome-extension":{"extensions":["crx"]},"application/x-cocoa":{"source":"nginx","extensions":["cco"]},"application/x-compress":{"source":"apache"},"application/x-conference":{"source":"apache","extensions":["nsc"]},"application/x-cpio":{"source":"apache","extensions":["cpio"]},"application/x-csh":{"source":"apache","extensions":["csh"]},"application/x-deb":{"compressible":false},"application/x-debian-package":{"source":"apache","extensions":["deb","udeb"]},"application/x-dgc-compressed":{"source":"apache","extensions":["dgc"]},"application/x-director":{"source":"apache","extensions":["dir","dcr","dxr","cst","cct","cxt","w3d","fgd","swa"]},"application/x-doom":{"source":"apache","extensions":["wad"]},"application/x-dtbncx+xml":{"source":"apache","compressible":true,"extensions":["ncx"]},"application/x-dtbook+xml":{"source":"apache","compressible":true,"extensions":["dtb"]},"application/x-dtbresource+xml":{"source":"apache","compressible":true,"extensions":["res"]},"application/x-dvi":{"source":"apache","compressible":false,"extensions":["dvi"]},"application/x-envoy":{"source":"apache","extensions":["evy"]},"application/x-eva":{"source":"apache","extensions":["eva"]},"application/x-font-bdf":{"source":"apache","extensions":["bdf"]},"application/x-font-dos":{"source":"apache"},"application/x-font-framemaker":{"source":"apache"},"application/x-font-ghostscript":{"source":"apache","extensions":["gsf"]},"application/x-font-libgrx":{"source":"apache"},"application/x-font-linux-psf":{"source":"apache","extensions":["psf"]},"application/x-font-pcf":{"source":"apache","extensions":["pcf"]},"application/x-font-snf":{"source":"apache","extensions":["snf"]},"application/x-font-speedo":{"source":"apache"},"application/x-font-sunos-news":{"source":"apache"},"application/x-font-type1":{"source":"apache","extensions":["pfa","pfb","pfm","afm"]},"application/x-font-vfont":{"source":"apache"},"application/x-freearc":{"source":"apache","extensions":["arc"]},"application/x-futuresplash":{"source":"apache","extensions":["spl"]},"application/x-gca-compressed":{"source":"apache","extensions":["gca"]},"application/x-glulx":{"source":"apache","extensions":["ulx"]},"application/x-gnumeric":{"source":"apache","extensions":["gnumeric"]},"application/x-gramps-xml":{"source":"apache","extensions":["gramps"]},"application/x-gtar":{"source":"apache","extensions":["gtar"]},"application/x-gzip":{"source":"apache"},"application/x-hdf":{"source":"apache","extensions":["hdf"]},"application/x-httpd-php":{"compressible":true,"extensions":["php"]},"application/x-install-instructions":{"source":"apache","extensions":["install"]},"application/x-iso9660-image":{"source":"apache","extensions":["iso"]},"application/x-iwork-keynote-sffkey":{"extensions":["key"]},"application/x-iwork-numbers-sffnumbers":{"extensions":["numbers"]},"application/x-iwork-pages-sffpages":{"extensions":["pages"]},"application/x-java-archive-diff":{"source":"nginx","extensions":["jardiff"]},"application/x-java-jnlp-file":{"source":"apache","compressible":false,"extensions":["jnlp"]},"application/x-javascript":{"compressible":true},"application/x-keepass2":{"extensions":["kdbx"]},"application/x-latex":{"source":"apache","compressible":false,"extensions":["latex"]},"application/x-lua-bytecode":{"extensions":["luac"]},"application/x-lzh-compressed":{"source":"apache","extensions":["lzh","lha"]},"application/x-makeself":{"source":"nginx","extensions":["run"]},"application/x-mie":{"source":"apache","extensions":["mie"]},"application/x-mobipocket-ebook":{"source":"apache","extensions":["prc","mobi"]},"application/x-mpegurl":{"compressible":false},"application/x-ms-application":{"source":"apache","extensions":["application"]},"application/x-ms-shortcut":{"source":"apache","extensions":["lnk"]},"application/x-ms-wmd":{"source":"apache","extensions":["wmd"]},"application/x-ms-wmz":{"source":"apache","extensions":["wmz"]},"application/x-ms-xbap":{"source":"apache","extensions":["xbap"]},"application/x-msaccess":{"source":"apache","extensions":["mdb"]},"application/x-msbinder":{"source":"apache","extensions":["obd"]},"application/x-mscardfile":{"source":"apache","extensions":["crd"]},"application/x-msclip":{"source":"apache","extensions":["clp"]},"application/x-msdos-program":{"extensions":["exe"]},"application/x-msdownload":{"source":"apache","extensions":["exe","dll","com","bat","msi"]},"application/x-msmediaview":{"source":"apache","extensions":["mvb","m13","m14"]},"application/x-msmetafile":{"source":"apache","extensions":["wmf","wmz","emf","emz"]},"application/x-msmoney":{"source":"apache","extensions":["mny"]},"application/x-mspublisher":{"source":"apache","extensions":["pub"]},"application/x-msschedule":{"source":"apache","extensions":["scd"]},"application/x-msterminal":{"source":"apache","extensions":["trm"]},"application/x-mswrite":{"source":"apache","extensions":["wri"]},"application/x-netcdf":{"source":"apache","extensions":["nc","cdf"]},"application/x-ns-proxy-autoconfig":{"compressible":true,"extensions":["pac"]},"application/x-nzb":{"source":"apache","extensions":["nzb"]},"application/x-perl":{"source":"nginx","extensions":["pl","pm"]},"application/x-pilot":{"source":"nginx","extensions":["prc","pdb"]},"application/x-pkcs12":{"source":"apache","compressible":false,"extensions":["p12","pfx"]},"application/x-pkcs7-certificates":{"source":"apache","extensions":["p7b","spc"]},"application/x-pkcs7-certreqresp":{"source":"apache","extensions":["p7r"]},"application/x-pki-message":{"source":"iana"},"application/x-rar-compressed":{"source":"apache","compressible":false,"extensions":["rar"]},"application/x-redhat-package-manager":{"source":"nginx","extensions":["rpm"]},"application/x-research-info-systems":{"source":"apache","extensions":["ris"]},"application/x-sea":{"source":"nginx","extensions":["sea"]},"application/x-sh":{"source":"apache","compressible":true,"extensions":["sh"]},"application/x-shar":{"source":"apache","extensions":["shar"]},"application/x-shockwave-flash":{"source":"apache","compressible":false,"extensions":["swf"]},"application/x-silverlight-app":{"source":"apache","extensions":["xap"]},"application/x-sql":{"source":"apache","extensions":["sql"]},"application/x-stuffit":{"source":"apache","compressible":false,"extensions":["sit"]},"application/x-stuffitx":{"source":"apache","extensions":["sitx"]},"application/x-subrip":{"source":"apache","extensions":["srt"]},"application/x-sv4cpio":{"source":"apache","extensions":["sv4cpio"]},"application/x-sv4crc":{"source":"apache","extensions":["sv4crc"]},"application/x-t3vm-image":{"source":"apache","extensions":["t3"]},"application/x-tads":{"source":"apache","extensions":["gam"]},"application/x-tar":{"source":"apache","compressible":true,"extensions":["tar"]},"application/x-tcl":{"source":"apache","extensions":["tcl","tk"]},"application/x-tex":{"source":"apache","extensions":["tex"]},"application/x-tex-tfm":{"source":"apache","extensions":["tfm"]},"application/x-texinfo":{"source":"apache","extensions":["texinfo","texi"]},"application/x-tgif":{"source":"apache","extensions":["obj"]},"application/x-ustar":{"source":"apache","extensions":["ustar"]},"application/x-virtualbox-hdd":{"compressible":true,"extensions":["hdd"]},"application/x-virtualbox-ova":{"compressible":true,"extensions":["ova"]},"application/x-virtualbox-ovf":{"compressible":true,"extensions":["ovf"]},"application/x-virtualbox-vbox":{"compressible":true,"extensions":["vbox"]},"application/x-virtualbox-vbox-extpack":{"compressible":false,"extensions":["vbox-extpack"]},"application/x-virtualbox-vdi":{"compressible":true,"extensions":["vdi"]},"application/x-virtualbox-vhd":{"compressible":true,"extensions":["vhd"]},"application/x-virtualbox-vmdk":{"compressible":true,"extensions":["vmdk"]},"application/x-wais-source":{"source":"apache","extensions":["src"]},"application/x-web-app-manifest+json":{"compressible":true,"extensions":["webapp"]},"application/x-www-form-urlencoded":{"source":"iana","compressible":true},"application/x-x509-ca-cert":{"source":"iana","extensions":["der","crt","pem"]},"application/x-x509-ca-ra-cert":{"source":"iana"},"application/x-x509-next-ca-cert":{"source":"iana"},"application/x-xfig":{"source":"apache","extensions":["fig"]},"application/x-xliff+xml":{"source":"apache","compressible":true,"extensions":["xlf"]},"application/x-xpinstall":{"source":"apache","compressible":false,"extensions":["xpi"]},"application/x-xz":{"source":"apache","extensions":["xz"]},"application/x-zmachine":{"source":"apache","extensions":["z1","z2","z3","z4","z5","z6","z7","z8"]},"application/x400-bp":{"source":"iana"},"application/xacml+xml":{"source":"iana","compressible":true},"application/xaml+xml":{"source":"apache","compressible":true,"extensions":["xaml"]},"application/xcap-att+xml":{"source":"iana","compressible":true,"extensions":["xav"]},"application/xcap-caps+xml":{"source":"iana","compressible":true,"extensions":["xca"]},"application/xcap-diff+xml":{"source":"iana","compressible":true,"extensions":["xdf"]},"application/xcap-el+xml":{"source":"iana","compressible":true,"extensions":["xel"]},"application/xcap-error+xml":{"source":"iana","compressible":true},"application/xcap-ns+xml":{"source":"iana","compressible":true,"extensions":["xns"]},"application/xcon-conference-info+xml":{"source":"iana","compressible":true},"application/xcon-conference-info-diff+xml":{"source":"iana","compressible":true},"application/xenc+xml":{"source":"iana","compressible":true,"extensions":["xenc"]},"application/xhtml+xml":{"source":"iana","compressible":true,"extensions":["xhtml","xht"]},"application/xhtml-voice+xml":{"source":"apache","compressible":true},"application/xliff+xml":{"source":"iana","compressible":true,"extensions":["xlf"]},"application/xml":{"source":"iana","compressible":true,"extensions":["xml","xsl","xsd","rng"]},"application/xml-dtd":{"source":"iana","compressible":true,"extensions":["dtd"]},"application/xml-external-parsed-entity":{"source":"iana"},"application/xml-patch+xml":{"source":"iana","compressible":true},"application/xmpp+xml":{"source":"iana","compressible":true},"application/xop+xml":{"source":"iana","compressible":true,"extensions":["xop"]},"application/xproc+xml":{"source":"apache","compressible":true,"extensions":["xpl"]},"application/xslt+xml":{"source":"iana","compressible":true,"extensions":["xsl","xslt"]},"application/xspf+xml":{"source":"apache","compressible":true,"extensions":["xspf"]},"application/xv+xml":{"source":"iana","compressible":true,"extensions":["mxml","xhvml","xvml","xvm"]},"application/yang":{"source":"iana","extensions":["yang"]},"application/yang-data+json":{"source":"iana","compressible":true},"application/yang-data+xml":{"source":"iana","compressible":true},"application/yang-patch+json":{"source":"iana","compressible":true},"application/yang-patch+xml":{"source":"iana","compressible":true},"application/yin+xml":{"source":"iana","compressible":true,"extensions":["yin"]},"application/zip":{"source":"iana","compressible":false,"extensions":["zip"]},"application/zlib":{"source":"iana"},"application/zstd":{"source":"iana"},"audio/1d-interleaved-parityfec":{"source":"iana"},"audio/32kadpcm":{"source":"iana"},"audio/3gpp":{"source":"iana","compressible":false,"extensions":["3gpp"]},"audio/3gpp2":{"source":"iana"},"audio/aac":{"source":"iana"},"audio/ac3":{"source":"iana"},"audio/adpcm":{"source":"apache","extensions":["adp"]},"audio/amr":{"source":"iana","extensions":["amr"]},"audio/amr-wb":{"source":"iana"},"audio/amr-wb+":{"source":"iana"},"audio/aptx":{"source":"iana"},"audio/asc":{"source":"iana"},"audio/atrac-advanced-lossless":{"source":"iana"},"audio/atrac-x":{"source":"iana"},"audio/atrac3":{"source":"iana"},"audio/basic":{"source":"iana","compressible":false,"extensions":["au","snd"]},"audio/bv16":{"source":"iana"},"audio/bv32":{"source":"iana"},"audio/clearmode":{"source":"iana"},"audio/cn":{"source":"iana"},"audio/dat12":{"source":"iana"},"audio/dls":{"source":"iana"},"audio/dsr-es201108":{"source":"iana"},"audio/dsr-es202050":{"source":"iana"},"audio/dsr-es202211":{"source":"iana"},"audio/dsr-es202212":{"source":"iana"},"audio/dv":{"source":"iana"},"audio/dvi4":{"source":"iana"},"audio/eac3":{"source":"iana"},"audio/encaprtp":{"source":"iana"},"audio/evrc":{"source":"iana"},"audio/evrc-qcp":{"source":"iana"},"audio/evrc0":{"source":"iana"},"audio/evrc1":{"source":"iana"},"audio/evrcb":{"source":"iana"},"audio/evrcb0":{"source":"iana"},"audio/evrcb1":{"source":"iana"},"audio/evrcnw":{"source":"iana"},"audio/evrcnw0":{"source":"iana"},"audio/evrcnw1":{"source":"iana"},"audio/evrcwb":{"source":"iana"},"audio/evrcwb0":{"source":"iana"},"audio/evrcwb1":{"source":"iana"},"audio/evs":{"source":"iana"},"audio/flexfec":{"source":"iana"},"audio/fwdred":{"source":"iana"},"audio/g711-0":{"source":"iana"},"audio/g719":{"source":"iana"},"audio/g722":{"source":"iana"},"audio/g7221":{"source":"iana"},"audio/g723":{"source":"iana"},"audio/g726-16":{"source":"iana"},"audio/g726-24":{"source":"iana"},"audio/g726-32":{"source":"iana"},"audio/g726-40":{"source":"iana"},"audio/g728":{"source":"iana"},"audio/g729":{"source":"iana"},"audio/g7291":{"source":"iana"},"audio/g729d":{"source":"iana"},"audio/g729e":{"source":"iana"},"audio/gsm":{"source":"iana"},"audio/gsm-efr":{"source":"iana"},"audio/gsm-hr-08":{"source":"iana"},"audio/ilbc":{"source":"iana"},"audio/ip-mr_v2.5":{"source":"iana"},"audio/isac":{"source":"apache"},"audio/l16":{"source":"iana"},"audio/l20":{"source":"iana"},"audio/l24":{"source":"iana","compressible":false},"audio/l8":{"source":"iana"},"audio/lpc":{"source":"iana"},"audio/melp":{"source":"iana"},"audio/melp1200":{"source":"iana"},"audio/melp2400":{"source":"iana"},"audio/melp600":{"source":"iana"},"audio/mhas":{"source":"iana"},"audio/midi":{"source":"apache","extensions":["mid","midi","kar","rmi"]},"audio/mobile-xmf":{"source":"iana","extensions":["mxmf"]},"audio/mp3":{"compressible":false,"extensions":["mp3"]},"audio/mp4":{"source":"iana","compressible":false,"extensions":["m4a","mp4a"]},"audio/mp4a-latm":{"source":"iana"},"audio/mpa":{"source":"iana"},"audio/mpa-robust":{"source":"iana"},"audio/mpeg":{"source":"iana","compressible":false,"extensions":["mpga","mp2","mp2a","mp3","m2a","m3a"]},"audio/mpeg4-generic":{"source":"iana"},"audio/musepack":{"source":"apache"},"audio/ogg":{"source":"iana","compressible":false,"extensions":["oga","ogg","spx","opus"]},"audio/opus":{"source":"iana"},"audio/parityfec":{"source":"iana"},"audio/pcma":{"source":"iana"},"audio/pcma-wb":{"source":"iana"},"audio/pcmu":{"source":"iana"},"audio/pcmu-wb":{"source":"iana"},"audio/prs.sid":{"source":"iana"},"audio/qcelp":{"source":"iana"},"audio/raptorfec":{"source":"iana"},"audio/red":{"source":"iana"},"audio/rtp-enc-aescm128":{"source":"iana"},"audio/rtp-midi":{"source":"iana"},"audio/rtploopback":{"source":"iana"},"audio/rtx":{"source":"iana"},"audio/s3m":{"source":"apache","extensions":["s3m"]},"audio/scip":{"source":"iana"},"audio/silk":{"source":"apache","extensions":["sil"]},"audio/smv":{"source":"iana"},"audio/smv-qcp":{"source":"iana"},"audio/smv0":{"source":"iana"},"audio/sofa":{"source":"iana"},"audio/sp-midi":{"source":"iana"},"audio/speex":{"source":"iana"},"audio/t140c":{"source":"iana"},"audio/t38":{"source":"iana"},"audio/telephone-event":{"source":"iana"},"audio/tetra_acelp":{"source":"iana"},"audio/tetra_acelp_bb":{"source":"iana"},"audio/tone":{"source":"iana"},"audio/tsvcis":{"source":"iana"},"audio/uemclip":{"source":"iana"},"audio/ulpfec":{"source":"iana"},"audio/usac":{"source":"iana"},"audio/vdvi":{"source":"iana"},"audio/vmr-wb":{"source":"iana"},"audio/vnd.3gpp.iufp":{"source":"iana"},"audio/vnd.4sb":{"source":"iana"},"audio/vnd.audiokoz":{"source":"iana"},"audio/vnd.celp":{"source":"iana"},"audio/vnd.cisco.nse":{"source":"iana"},"audio/vnd.cmles.radio-events":{"source":"iana"},"audio/vnd.cns.anp1":{"source":"iana"},"audio/vnd.cns.inf1":{"source":"iana"},"audio/vnd.dece.audio":{"source":"iana","extensions":["uva","uvva"]},"audio/vnd.digital-winds":{"source":"iana","extensions":["eol"]},"audio/vnd.dlna.adts":{"source":"iana"},"audio/vnd.dolby.heaac.1":{"source":"iana"},"audio/vnd.dolby.heaac.2":{"source":"iana"},"audio/vnd.dolby.mlp":{"source":"iana"},"audio/vnd.dolby.mps":{"source":"iana"},"audio/vnd.dolby.pl2":{"source":"iana"},"audio/vnd.dolby.pl2x":{"source":"iana"},"audio/vnd.dolby.pl2z":{"source":"iana"},"audio/vnd.dolby.pulse.1":{"source":"iana"},"audio/vnd.dra":{"source":"iana","extensions":["dra"]},"audio/vnd.dts":{"source":"iana","extensions":["dts"]},"audio/vnd.dts.hd":{"source":"iana","extensions":["dtshd"]},"audio/vnd.dts.uhd":{"source":"iana"},"audio/vnd.dvb.file":{"source":"iana"},"audio/vnd.everad.plj":{"source":"iana"},"audio/vnd.hns.audio":{"source":"iana"},"audio/vnd.lucent.voice":{"source":"iana","extensions":["lvp"]},"audio/vnd.ms-playready.media.pya":{"source":"iana","extensions":["pya"]},"audio/vnd.nokia.mobile-xmf":{"source":"iana"},"audio/vnd.nortel.vbk":{"source":"iana"},"audio/vnd.nuera.ecelp4800":{"source":"iana","extensions":["ecelp4800"]},"audio/vnd.nuera.ecelp7470":{"source":"iana","extensions":["ecelp7470"]},"audio/vnd.nuera.ecelp9600":{"source":"iana","extensions":["ecelp9600"]},"audio/vnd.octel.sbc":{"source":"iana"},"audio/vnd.presonus.multitrack":{"source":"iana"},"audio/vnd.qcelp":{"source":"iana"},"audio/vnd.rhetorex.32kadpcm":{"source":"iana"},"audio/vnd.rip":{"source":"iana","extensions":["rip"]},"audio/vnd.rn-realaudio":{"compressible":false},"audio/vnd.sealedmedia.softseal.mpeg":{"source":"iana"},"audio/vnd.vmx.cvsd":{"source":"iana"},"audio/vnd.wave":{"compressible":false},"audio/vorbis":{"source":"iana","compressible":false},"audio/vorbis-config":{"source":"iana"},"audio/wav":{"compressible":false,"extensions":["wav"]},"audio/wave":{"compressible":false,"extensions":["wav"]},"audio/webm":{"source":"apache","compressible":false,"extensions":["weba"]},"audio/x-aac":{"source":"apache","compressible":false,"extensions":["aac"]},"audio/x-aiff":{"source":"apache","extensions":["aif","aiff","aifc"]},"audio/x-caf":{"source":"apache","compressible":false,"extensions":["caf"]},"audio/x-flac":{"source":"apache","extensions":["flac"]},"audio/x-m4a":{"source":"nginx","extensions":["m4a"]},"audio/x-matroska":{"source":"apache","extensions":["mka"]},"audio/x-mpegurl":{"source":"apache","extensions":["m3u"]},"audio/x-ms-wax":{"source":"apache","extensions":["wax"]},"audio/x-ms-wma":{"source":"apache","extensions":["wma"]},"audio/x-pn-realaudio":{"source":"apache","extensions":["ram","ra"]},"audio/x-pn-realaudio-plugin":{"source":"apache","extensions":["rmp"]},"audio/x-realaudio":{"source":"nginx","extensions":["ra"]},"audio/x-tta":{"source":"apache"},"audio/x-wav":{"source":"apache","extensions":["wav"]},"audio/xm":{"source":"apache","extensions":["xm"]},"chemical/x-cdx":{"source":"apache","extensions":["cdx"]},"chemical/x-cif":{"source":"apache","extensions":["cif"]},"chemical/x-cmdf":{"source":"apache","extensions":["cmdf"]},"chemical/x-cml":{"source":"apache","extensions":["cml"]},"chemical/x-csml":{"source":"apache","extensions":["csml"]},"chemical/x-pdb":{"source":"apache"},"chemical/x-xyz":{"source":"apache","extensions":["xyz"]},"font/collection":{"source":"iana","extensions":["ttc"]},"font/otf":{"source":"iana","compressible":true,"extensions":["otf"]},"font/sfnt":{"source":"iana"},"font/ttf":{"source":"iana","compressible":true,"extensions":["ttf"]},"font/woff":{"source":"iana","extensions":["woff"]},"font/woff2":{"source":"iana","extensions":["woff2"]},"image/aces":{"source":"iana","extensions":["exr"]},"image/apng":{"compressible":false,"extensions":["apng"]},"image/avci":{"source":"iana","extensions":["avci"]},"image/avcs":{"source":"iana","extensions":["avcs"]},"image/avif":{"source":"iana","compressible":false,"extensions":["avif"]},"image/bmp":{"source":"iana","compressible":true,"extensions":["bmp"]},"image/cgm":{"source":"iana","extensions":["cgm"]},"image/dicom-rle":{"source":"iana","extensions":["drle"]},"image/emf":{"source":"iana","extensions":["emf"]},"image/fits":{"source":"iana","extensions":["fits"]},"image/g3fax":{"source":"iana","extensions":["g3"]},"image/gif":{"source":"iana","compressible":false,"extensions":["gif"]},"image/heic":{"source":"iana","extensions":["heic"]},"image/heic-sequence":{"source":"iana","extensions":["heics"]},"image/heif":{"source":"iana","extensions":["heif"]},"image/heif-sequence":{"source":"iana","extensions":["heifs"]},"image/hej2k":{"source":"iana","extensions":["hej2"]},"image/hsj2":{"source":"iana","extensions":["hsj2"]},"image/ief":{"source":"iana","extensions":["ief"]},"image/jls":{"source":"iana","extensions":["jls"]},"image/jp2":{"source":"iana","compressible":false,"extensions":["jp2","jpg2"]},"image/jpeg":{"source":"iana","compressible":false,"extensions":["jpeg","jpg","jpe"]},"image/jph":{"source":"iana","extensions":["jph"]},"image/jphc":{"source":"iana","extensions":["jhc"]},"image/jpm":{"source":"iana","compressible":false,"extensions":["jpm"]},"image/jpx":{"source":"iana","compressible":false,"extensions":["jpx","jpf"]},"image/jxr":{"source":"iana","extensions":["jxr"]},"image/jxra":{"source":"iana","extensions":["jxra"]},"image/jxrs":{"source":"iana","extensions":["jxrs"]},"image/jxs":{"source":"iana","extensions":["jxs"]},"image/jxsc":{"source":"iana","extensions":["jxsc"]},"image/jxsi":{"source":"iana","extensions":["jxsi"]},"image/jxss":{"source":"iana","extensions":["jxss"]},"image/ktx":{"source":"iana","extensions":["ktx"]},"image/ktx2":{"source":"iana","extensions":["ktx2"]},"image/naplps":{"source":"iana"},"image/pjpeg":{"compressible":false},"image/png":{"source":"iana","compressible":false,"extensions":["png"]},"image/prs.btif":{"source":"iana","extensions":["btif"]},"image/prs.pti":{"source":"iana","extensions":["pti"]},"image/pwg-raster":{"source":"iana"},"image/sgi":{"source":"apache","extensions":["sgi"]},"image/svg+xml":{"source":"iana","compressible":true,"extensions":["svg","svgz"]},"image/t38":{"source":"iana","extensions":["t38"]},"image/tiff":{"source":"iana","compressible":false,"extensions":["tif","tiff"]},"image/tiff-fx":{"source":"iana","extensions":["tfx"]},"image/vnd.adobe.photoshop":{"source":"iana","compressible":true,"extensions":["psd"]},"image/vnd.airzip.accelerator.azv":{"source":"iana","extensions":["azv"]},"image/vnd.cns.inf2":{"source":"iana"},"image/vnd.dece.graphic":{"source":"iana","extensions":["uvi","uvvi","uvg","uvvg"]},"image/vnd.djvu":{"source":"iana","extensions":["djvu","djv"]},"image/vnd.dvb.subtitle":{"source":"iana","extensions":["sub"]},"image/vnd.dwg":{"source":"iana","extensions":["dwg"]},"image/vnd.dxf":{"source":"iana","extensions":["dxf"]},"image/vnd.fastbidsheet":{"source":"iana","extensions":["fbs"]},"image/vnd.fpx":{"source":"iana","extensions":["fpx"]},"image/vnd.fst":{"source":"iana","extensions":["fst"]},"image/vnd.fujixerox.edmics-mmr":{"source":"iana","extensions":["mmr"]},"image/vnd.fujixerox.edmics-rlc":{"source":"iana","extensions":["rlc"]},"image/vnd.globalgraphics.pgb":{"source":"iana"},"image/vnd.microsoft.icon":{"source":"iana","compressible":true,"extensions":["ico"]},"image/vnd.mix":{"source":"iana"},"image/vnd.mozilla.apng":{"source":"iana"},"image/vnd.ms-dds":{"compressible":true,"extensions":["dds"]},"image/vnd.ms-modi":{"source":"iana","extensions":["mdi"]},"image/vnd.ms-photo":{"source":"apache","extensions":["wdp"]},"image/vnd.net-fpx":{"source":"iana","extensions":["npx"]},"image/vnd.pco.b16":{"source":"iana","extensions":["b16"]},"image/vnd.radiance":{"source":"iana"},"image/vnd.sealed.png":{"source":"iana"},"image/vnd.sealedmedia.softseal.gif":{"source":"iana"},"image/vnd.sealedmedia.softseal.jpg":{"source":"iana"},"image/vnd.svf":{"source":"iana"},"image/vnd.tencent.tap":{"source":"iana","extensions":["tap"]},"image/vnd.valve.source.texture":{"source":"iana","extensions":["vtf"]},"image/vnd.wap.wbmp":{"source":"iana","extensions":["wbmp"]},"image/vnd.xiff":{"source":"iana","extensions":["xif"]},"image/vnd.zbrush.pcx":{"source":"iana","extensions":["pcx"]},"image/webp":{"source":"apache","extensions":["webp"]},"image/wmf":{"source":"iana","extensions":["wmf"]},"image/x-3ds":{"source":"apache","extensions":["3ds"]},"image/x-cmu-raster":{"source":"apache","extensions":["ras"]},"image/x-cmx":{"source":"apache","extensions":["cmx"]},"image/x-freehand":{"source":"apache","extensions":["fh","fhc","fh4","fh5","fh7"]},"image/x-icon":{"source":"apache","compressible":true,"extensions":["ico"]},"image/x-jng":{"source":"nginx","extensions":["jng"]},"image/x-mrsid-image":{"source":"apache","extensions":["sid"]},"image/x-ms-bmp":{"source":"nginx","compressible":true,"extensions":["bmp"]},"image/x-pcx":{"source":"apache","extensions":["pcx"]},"image/x-pict":{"source":"apache","extensions":["pic","pct"]},"image/x-portable-anymap":{"source":"apache","extensions":["pnm"]},"image/x-portable-bitmap":{"source":"apache","extensions":["pbm"]},"image/x-portable-graymap":{"source":"apache","extensions":["pgm"]},"image/x-portable-pixmap":{"source":"apache","extensions":["ppm"]},"image/x-rgb":{"source":"apache","extensions":["rgb"]},"image/x-tga":{"source":"apache","extensions":["tga"]},"image/x-xbitmap":{"source":"apache","extensions":["xbm"]},"image/x-xcf":{"compressible":false},"image/x-xpixmap":{"source":"apache","extensions":["xpm"]},"image/x-xwindowdump":{"source":"apache","extensions":["xwd"]},"message/cpim":{"source":"iana"},"message/delivery-status":{"source":"iana"},"message/disposition-notification":{"source":"iana","extensions":["disposition-notification"]},"message/external-body":{"source":"iana"},"message/feedback-report":{"source":"iana"},"message/global":{"source":"iana","extensions":["u8msg"]},"message/global-delivery-status":{"source":"iana","extensions":["u8dsn"]},"message/global-disposition-notification":{"source":"iana","extensions":["u8mdn"]},"message/global-headers":{"source":"iana","extensions":["u8hdr"]},"message/http":{"source":"iana","compressible":false},"message/imdn+xml":{"source":"iana","compressible":true},"message/news":{"source":"iana"},"message/partial":{"source":"iana","compressible":false},"message/rfc822":{"source":"iana","compressible":true,"extensions":["eml","mime"]},"message/s-http":{"source":"iana"},"message/sip":{"source":"iana"},"message/sipfrag":{"source":"iana"},"message/tracking-status":{"source":"iana"},"message/vnd.si.simp":{"source":"iana"},"message/vnd.wfa.wsc":{"source":"iana","extensions":["wsc"]},"model/3mf":{"source":"iana","extensions":["3mf"]},"model/e57":{"source":"iana"},"model/gltf+json":{"source":"iana","compressible":true,"extensions":["gltf"]},"model/gltf-binary":{"source":"iana","compressible":true,"extensions":["glb"]},"model/iges":{"source":"iana","compressible":false,"extensions":["igs","iges"]},"model/mesh":{"source":"iana","compressible":false,"extensions":["msh","mesh","silo"]},"model/mtl":{"source":"iana","extensions":["mtl"]},"model/obj":{"source":"iana","extensions":["obj"]},"model/step":{"source":"iana"},"model/step+xml":{"source":"iana","compressible":true,"extensions":["stpx"]},"model/step+zip":{"source":"iana","compressible":false,"extensions":["stpz"]},"model/step-xml+zip":{"source":"iana","compressible":false,"extensions":["stpxz"]},"model/stl":{"source":"iana","extensions":["stl"]},"model/vnd.collada+xml":{"source":"iana","compressible":true,"extensions":["dae"]},"model/vnd.dwf":{"source":"iana","extensions":["dwf"]},"model/vnd.flatland.3dml":{"source":"iana"},"model/vnd.gdl":{"source":"iana","extensions":["gdl"]},"model/vnd.gs-gdl":{"source":"apache"},"model/vnd.gs.gdl":{"source":"iana"},"model/vnd.gtw":{"source":"iana","extensions":["gtw"]},"model/vnd.moml+xml":{"source":"iana","compressible":true},"model/vnd.mts":{"source":"iana","extensions":["mts"]},"model/vnd.opengex":{"source":"iana","extensions":["ogex"]},"model/vnd.parasolid.transmit.binary":{"source":"iana","extensions":["x_b"]},"model/vnd.parasolid.transmit.text":{"source":"iana","extensions":["x_t"]},"model/vnd.pytha.pyox":{"source":"iana"},"model/vnd.rosette.annotated-data-model":{"source":"iana"},"model/vnd.sap.vds":{"source":"iana","extensions":["vds"]},"model/vnd.usdz+zip":{"source":"iana","compressible":false,"extensions":["usdz"]},"model/vnd.valve.source.compiled-map":{"source":"iana","extensions":["bsp"]},"model/vnd.vtu":{"source":"iana","extensions":["vtu"]},"model/vrml":{"source":"iana","compressible":false,"extensions":["wrl","vrml"]},"model/x3d+binary":{"source":"apache","compressible":false,"extensions":["x3db","x3dbz"]},"model/x3d+fastinfoset":{"source":"iana","extensions":["x3db"]},"model/x3d+vrml":{"source":"apache","compressible":false,"extensions":["x3dv","x3dvz"]},"model/x3d+xml":{"source":"iana","compressible":true,"extensions":["x3d","x3dz"]},"model/x3d-vrml":{"source":"iana","extensions":["x3dv"]},"multipart/alternative":{"source":"iana","compressible":false},"multipart/appledouble":{"source":"iana"},"multipart/byteranges":{"source":"iana"},"multipart/digest":{"source":"iana"},"multipart/encrypted":{"source":"iana","compressible":false},"multipart/form-data":{"source":"iana","compressible":false},"multipart/header-set":{"source":"iana"},"multipart/mixed":{"source":"iana"},"multipart/multilingual":{"source":"iana"},"multipart/parallel":{"source":"iana"},"multipart/related":{"source":"iana","compressible":false},"multipart/report":{"source":"iana"},"multipart/signed":{"source":"iana","compressible":false},"multipart/vnd.bint.med-plus":{"source":"iana"},"multipart/voice-message":{"source":"iana"},"multipart/x-mixed-replace":{"source":"iana"},"text/1d-interleaved-parityfec":{"source":"iana"},"text/cache-manifest":{"source":"iana","compressible":true,"extensions":["appcache","manifest"]},"text/calendar":{"source":"iana","extensions":["ics","ifb"]},"text/calender":{"compressible":true},"text/cmd":{"compressible":true},"text/coffeescript":{"extensions":["coffee","litcoffee"]},"text/cql":{"source":"iana"},"text/cql-expression":{"source":"iana"},"text/cql-identifier":{"source":"iana"},"text/css":{"source":"iana","charset":"UTF-8","compressible":true,"extensions":["css"]},"text/csv":{"source":"iana","compressible":true,"extensions":["csv"]},"text/csv-schema":{"source":"iana"},"text/directory":{"source":"iana"},"text/dns":{"source":"iana"},"text/ecmascript":{"source":"iana"},"text/encaprtp":{"source":"iana"},"text/enriched":{"source":"iana"},"text/fhirpath":{"source":"iana"},"text/flexfec":{"source":"iana"},"text/fwdred":{"source":"iana"},"text/gff3":{"source":"iana"},"text/grammar-ref-list":{"source":"iana"},"text/html":{"source":"iana","compressible":true,"extensions":["html","htm","shtml"]},"text/jade":{"extensions":["jade"]},"text/javascript":{"source":"iana","compressible":true},"text/jcr-cnd":{"source":"iana"},"text/jsx":{"compressible":true,"extensions":["jsx"]},"text/less":{"compressible":true,"extensions":["less"]},"text/markdown":{"source":"iana","compressible":true,"extensions":["markdown","md"]},"text/mathml":{"source":"nginx","extensions":["mml"]},"text/mdx":{"compressible":true,"extensions":["mdx"]},"text/mizar":{"source":"iana"},"text/n3":{"source":"iana","charset":"UTF-8","compressible":true,"extensions":["n3"]},"text/parameters":{"source":"iana","charset":"UTF-8"},"text/parityfec":{"source":"iana"},"text/plain":{"source":"iana","compressible":true,"extensions":["txt","text","conf","def","list","log","in","ini"]},"text/provenance-notation":{"source":"iana","charset":"UTF-8"},"text/prs.fallenstein.rst":{"source":"iana"},"text/prs.lines.tag":{"source":"iana","extensions":["dsc"]},"text/prs.prop.logic":{"source":"iana"},"text/raptorfec":{"source":"iana"},"text/red":{"source":"iana"},"text/rfc822-headers":{"source":"iana"},"text/richtext":{"source":"iana","compressible":true,"extensions":["rtx"]},"text/rtf":{"source":"iana","compressible":true,"extensions":["rtf"]},"text/rtp-enc-aescm128":{"source":"iana"},"text/rtploopback":{"source":"iana"},"text/rtx":{"source":"iana"},"text/sgml":{"source":"iana","extensions":["sgml","sgm"]},"text/shaclc":{"source":"iana"},"text/shex":{"source":"iana","extensions":["shex"]},"text/slim":{"extensions":["slim","slm"]},"text/spdx":{"source":"iana","extensions":["spdx"]},"text/strings":{"source":"iana"},"text/stylus":{"extensions":["stylus","styl"]},"text/t140":{"source":"iana"},"text/tab-separated-values":{"source":"iana","compressible":true,"extensions":["tsv"]},"text/troff":{"source":"iana","extensions":["t","tr","roff","man","me","ms"]},"text/turtle":{"source":"iana","charset":"UTF-8","extensions":["ttl"]},"text/ulpfec":{"source":"iana"},"text/uri-list":{"source":"iana","compressible":true,"extensions":["uri","uris","urls"]},"text/vcard":{"source":"iana","compressible":true,"extensions":["vcard"]},"text/vnd.a":{"source":"iana"},"text/vnd.abc":{"source":"iana"},"text/vnd.ascii-art":{"source":"iana"},"text/vnd.curl":{"source":"iana","extensions":["curl"]},"text/vnd.curl.dcurl":{"source":"apache","extensions":["dcurl"]},"text/vnd.curl.mcurl":{"source":"apache","extensions":["mcurl"]},"text/vnd.curl.scurl":{"source":"apache","extensions":["scurl"]},"text/vnd.debian.copyright":{"source":"iana","charset":"UTF-8"},"text/vnd.dmclientscript":{"source":"iana"},"text/vnd.dvb.subtitle":{"source":"iana","extensions":["sub"]},"text/vnd.esmertec.theme-descriptor":{"source":"iana","charset":"UTF-8"},"text/vnd.familysearch.gedcom":{"source":"iana","extensions":["ged"]},"text/vnd.ficlab.flt":{"source":"iana"},"text/vnd.fly":{"source":"iana","extensions":["fly"]},"text/vnd.fmi.flexstor":{"source":"iana","extensions":["flx"]},"text/vnd.gml":{"source":"iana"},"text/vnd.graphviz":{"source":"iana","extensions":["gv"]},"text/vnd.hans":{"source":"iana"},"text/vnd.hgl":{"source":"iana"},"text/vnd.in3d.3dml":{"source":"iana","extensions":["3dml"]},"text/vnd.in3d.spot":{"source":"iana","extensions":["spot"]},"text/vnd.iptc.newsml":{"source":"iana"},"text/vnd.iptc.nitf":{"source":"iana"},"text/vnd.latex-z":{"source":"iana"},"text/vnd.motorola.reflex":{"source":"iana"},"text/vnd.ms-mediapackage":{"source":"iana"},"text/vnd.net2phone.commcenter.command":{"source":"iana"},"text/vnd.radisys.msml-basic-layout":{"source":"iana"},"text/vnd.senx.warpscript":{"source":"iana"},"text/vnd.si.uricatalogue":{"source":"iana"},"text/vnd.sosi":{"source":"iana"},"text/vnd.sun.j2me.app-descriptor":{"source":"iana","charset":"UTF-8","extensions":["jad"]},"text/vnd.trolltech.linguist":{"source":"iana","charset":"UTF-8"},"text/vnd.wap.si":{"source":"iana"},"text/vnd.wap.sl":{"source":"iana"},"text/vnd.wap.wml":{"source":"iana","extensions":["wml"]},"text/vnd.wap.wmlscript":{"source":"iana","extensions":["wmls"]},"text/vtt":{"source":"iana","charset":"UTF-8","compressible":true,"extensions":["vtt"]},"text/x-asm":{"source":"apache","extensions":["s","asm"]},"text/x-c":{"source":"apache","extensions":["c","cc","cxx","cpp","h","hh","dic"]},"text/x-component":{"source":"nginx","extensions":["htc"]},"text/x-fortran":{"source":"apache","extensions":["f","for","f77","f90"]},"text/x-gwt-rpc":{"compressible":true},"text/x-handlebars-template":{"extensions":["hbs"]},"text/x-java-source":{"source":"apache","extensions":["java"]},"text/x-jquery-tmpl":{"compressible":true},"text/x-lua":{"extensions":["lua"]},"text/x-markdown":{"compressible":true,"extensions":["mkd"]},"text/x-nfo":{"source":"apache","extensions":["nfo"]},"text/x-opml":{"source":"apache","extensions":["opml"]},"text/x-org":{"compressible":true,"extensions":["org"]},"text/x-pascal":{"source":"apache","extensions":["p","pas"]},"text/x-processing":{"compressible":true,"extensions":["pde"]},"text/x-sass":{"extensions":["sass"]},"text/x-scss":{"extensions":["scss"]},"text/x-setext":{"source":"apache","extensions":["etx"]},"text/x-sfv":{"source":"apache","extensions":["sfv"]},"text/x-suse-ymp":{"compressible":true,"extensions":["ymp"]},"text/x-uuencode":{"source":"apache","extensions":["uu"]},"text/x-vcalendar":{"source":"apache","extensions":["vcs"]},"text/x-vcard":{"source":"apache","extensions":["vcf"]},"text/xml":{"source":"iana","compressible":true,"extensions":["xml"]},"text/xml-external-parsed-entity":{"source":"iana"},"text/yaml":{"compressible":true,"extensions":["yaml","yml"]},"video/1d-interleaved-parityfec":{"source":"iana"},"video/3gpp":{"source":"iana","extensions":["3gp","3gpp"]},"video/3gpp-tt":{"source":"iana"},"video/3gpp2":{"source":"iana","extensions":["3g2"]},"video/av1":{"source":"iana"},"video/bmpeg":{"source":"iana"},"video/bt656":{"source":"iana"},"video/celb":{"source":"iana"},"video/dv":{"source":"iana"},"video/encaprtp":{"source":"iana"},"video/ffv1":{"source":"iana"},"video/flexfec":{"source":"iana"},"video/h261":{"source":"iana","extensions":["h261"]},"video/h263":{"source":"iana","extensions":["h263"]},"video/h263-1998":{"source":"iana"},"video/h263-2000":{"source":"iana"},"video/h264":{"source":"iana","extensions":["h264"]},"video/h264-rcdo":{"source":"iana"},"video/h264-svc":{"source":"iana"},"video/h265":{"source":"iana"},"video/iso.segment":{"source":"iana","extensions":["m4s"]},"video/jpeg":{"source":"iana","extensions":["jpgv"]},"video/jpeg2000":{"source":"iana"},"video/jpm":{"source":"apache","extensions":["jpm","jpgm"]},"video/jxsv":{"source":"iana"},"video/mj2":{"source":"iana","extensions":["mj2","mjp2"]},"video/mp1s":{"source":"iana"},"video/mp2p":{"source":"iana"},"video/mp2t":{"source":"iana","extensions":["ts"]},"video/mp4":{"source":"iana","compressible":false,"extensions":["mp4","mp4v","mpg4"]},"video/mp4v-es":{"source":"iana"},"video/mpeg":{"source":"iana","compressible":false,"extensions":["mpeg","mpg","mpe","m1v","m2v"]},"video/mpeg4-generic":{"source":"iana"},"video/mpv":{"source":"iana"},"video/nv":{"source":"iana"},"video/ogg":{"source":"iana","compressible":false,"extensions":["ogv"]},"video/parityfec":{"source":"iana"},"video/pointer":{"source":"iana"},"video/quicktime":{"source":"iana","compressible":false,"extensions":["qt","mov"]},"video/raptorfec":{"source":"iana"},"video/raw":{"source":"iana"},"video/rtp-enc-aescm128":{"source":"iana"},"video/rtploopback":{"source":"iana"},"video/rtx":{"source":"iana"},"video/scip":{"source":"iana"},"video/smpte291":{"source":"iana"},"video/smpte292m":{"source":"iana"},"video/ulpfec":{"source":"iana"},"video/vc1":{"source":"iana"},"video/vc2":{"source":"iana"},"video/vnd.cctv":{"source":"iana"},"video/vnd.dece.hd":{"source":"iana","extensions":["uvh","uvvh"]},"video/vnd.dece.mobile":{"source":"iana","extensions":["uvm","uvvm"]},"video/vnd.dece.mp4":{"source":"iana"},"video/vnd.dece.pd":{"source":"iana","extensions":["uvp","uvvp"]},"video/vnd.dece.sd":{"source":"iana","extensions":["uvs","uvvs"]},"video/vnd.dece.video":{"source":"iana","extensions":["uvv","uvvv"]},"video/vnd.directv.mpeg":{"source":"iana"},"video/vnd.directv.mpeg-tts":{"source":"iana"},"video/vnd.dlna.mpeg-tts":{"source":"iana"},"video/vnd.dvb.file":{"source":"iana","extensions":["dvb"]},"video/vnd.fvt":{"source":"iana","extensions":["fvt"]},"video/vnd.hns.video":{"source":"iana"},"video/vnd.iptvforum.1dparityfec-1010":{"source":"iana"},"video/vnd.iptvforum.1dparityfec-2005":{"source":"iana"},"video/vnd.iptvforum.2dparityfec-1010":{"source":"iana"},"video/vnd.iptvforum.2dparityfec-2005":{"source":"iana"},"video/vnd.iptvforum.ttsavc":{"source":"iana"},"video/vnd.iptvforum.ttsmpeg2":{"source":"iana"},"video/vnd.motorola.video":{"source":"iana"},"video/vnd.motorola.videop":{"source":"iana"},"video/vnd.mpegurl":{"source":"iana","extensions":["mxu","m4u"]},"video/vnd.ms-playready.media.pyv":{"source":"iana","extensions":["pyv"]},"video/vnd.nokia.interleaved-multimedia":{"source":"iana"},"video/vnd.nokia.mp4vr":{"source":"iana"},"video/vnd.nokia.videovoip":{"source":"iana"},"video/vnd.objectvideo":{"source":"iana"},"video/vnd.radgamettools.bink":{"source":"iana"},"video/vnd.radgamettools.smacker":{"source":"iana"},"video/vnd.sealed.mpeg1":{"source":"iana"},"video/vnd.sealed.mpeg4":{"source":"iana"},"video/vnd.sealed.swf":{"source":"iana"},"video/vnd.sealedmedia.softseal.mov":{"source":"iana"},"video/vnd.uvvu.mp4":{"source":"iana","extensions":["uvu","uvvu"]},"video/vnd.vivo":{"source":"iana","extensions":["viv"]},"video/vnd.youtube.yt":{"source":"iana"},"video/vp8":{"source":"iana"},"video/vp9":{"source":"iana"},"video/webm":{"source":"apache","compressible":false,"extensions":["webm"]},"video/x-f4v":{"source":"apache","extensions":["f4v"]},"video/x-fli":{"source":"apache","extensions":["fli"]},"video/x-flv":{"source":"apache","compressible":false,"extensions":["flv"]},"video/x-m4v":{"source":"apache","extensions":["m4v"]},"video/x-matroska":{"source":"apache","compressible":false,"extensions":["mkv","mk3d","mks"]},"video/x-mng":{"source":"apache","extensions":["mng"]},"video/x-ms-asf":{"source":"apache","extensions":["asf","asx"]},"video/x-ms-vob":{"source":"apache","extensions":["vob"]},"video/x-ms-wm":{"source":"apache","extensions":["wm"]},"video/x-ms-wmv":{"source":"apache","compressible":false,"extensions":["wmv"]},"video/x-ms-wmx":{"source":"apache","extensions":["wmx"]},"video/x-ms-wvx":{"source":"apache","extensions":["wvx"]},"video/x-msvideo":{"source":"apache","extensions":["avi"]},"video/x-sgi-movie":{"source":"apache","extensions":["movie"]},"video/x-smv":{"source":"apache","extensions":["smv"]},"x-conference/x-cooltalk":{"source":"apache","extensions":["ice"]},"x-shader/x-fragment":{"compressible":true},"x-shader/x-vertex":{"compressible":true}}'))},47723,(a,b,c)=>{b.exports=a.r(78900)},38201,(a,b,c)=>{"use strict";var d,e,f,g=a.r(47723),h=a.r(14747).extname,i=/^\s*([^;\s]*)(?:;|\s|$)/,j=/^text\//i;function k(a){if(!a||"string"!=typeof a)return!1;var b=i.exec(a),c=b&&g[b[1].toLowerCase()];return c&&c.charset?c.charset:!!(b&&j.test(b[1]))&&"UTF-8"}c.charset=k,c.charsets={lookup:k},c.contentType=function(a){if(!a||"string"!=typeof a)return!1;var b=-1===a.indexOf("/")?c.lookup(a):a;if(!b)return!1;if(-1===b.indexOf("charset")){var d=c.charset(b);d&&(b+="; charset="+d.toLowerCase())}return b},c.extension=function(a){if(!a||"string"!=typeof a)return!1;var b=i.exec(a),d=b&&c.extensions[b[1].toLowerCase()];return!!d&&!!d.length&&d[0]},c.extensions=Object.create(null),c.lookup=function(a){if(!a||"string"!=typeof a)return!1;var b=h("x."+a).toLowerCase().substr(1);return!!b&&(c.types[b]||!1)},c.types=Object.create(null),d=c.extensions,e=c.types,f=["nginx","apache",void 0,"iana"],Object.keys(g).forEach(function(a){var b=g[a],c=b.extensions;if(c&&c.length){d[a]=c;for(var h=0;h<c.length;h++){var i=c[h];if(e[i]){var j=f.indexOf(g[e[i]].source),k=f.indexOf(b.source);if("application/octet-stream"!==e[i]&&(j>k||j===k&&"application/"===e[i].substr(0,12)))continue}e[i]=a}}})},21681,(a,b,c)=>{b.exports=function(a){var b="function"==typeof setImmediate?setImmediate:"object"==typeof process&&"function"==typeof process.nextTick?process.nextTick:null;b?b(a):setTimeout(a,0)}},43440,(a,b,c)=>{var d=a.r(21681);b.exports=function(a){var b=!1;return d(function(){b=!0}),function(c,e){b?a(c,e):d(function(){a(c,e)})}}},99206,(a,b,c)=>{b.exports=function(a){Object.keys(a.jobs).forEach(d.bind(a)),a.jobs={}};function d(a){"function"==typeof this.jobs[a]&&this.jobs[a]()}},99786,(a,b,c)=>{var d=a.r(43440),e=a.r(99206);b.exports=function(a,b,c,f){var g,h,i,j,k=c.keyedList?c.keyedList[c.index]:c.index;c.jobs[k]=(g=b,h=k,i=a[k],j=function(a,b){k in c.jobs&&(delete c.jobs[k],a?e(c):c.results[k]=b,f(a,c.results))},2==g.length?g(i,d(j)):g(i,h,d(j)))}},99747,(a,b,c)=>{b.exports=function(a,b){var c=!Array.isArray(a),d={index:0,keyedList:c||b?Object.keys(a):null,jobs:{},results:c?{}:[],size:c?Object.keys(a).length:a.length};return b&&d.keyedList.sort(c?b:function(c,d){return b(a[c],a[d])}),d}},40895,(a,b,c)=>{var d=a.r(99206),e=a.r(43440);b.exports=function(a){Object.keys(this.jobs).length&&(this.index=this.size,d(this),e(a)(null,this.results))}},96451,(a,b,c)=>{var d=a.r(99786),e=a.r(99747),f=a.r(40895);b.exports=function(a,b,c){for(var g=e(a);g.index<(g.keyedList||a).length;)d(a,b,g,function(a,b){a?c(a,b):0===Object.keys(g.jobs).length&&c(null,g.results)}),g.index++;return f.bind(g,c)}},9083,(a,b,c)=>{var d=a.r(99786),e=a.r(99747),f=a.r(40895);function g(a,b){return a<b?-1:+(a>b)}b.exports=function(a,b,c,g){var h=e(a,c);return d(a,b,h,function c(e,f){e?g(e,f):(h.index++,h.index<(h.keyedList||a).length)?d(a,b,h,c):g(null,h.results)}),f.bind(h,g)},b.exports.ascending=g,b.exports.descending=function(a,b){return -1*g(a,b)}},38743,(a,b,c)=>{var d=a.r(9083);b.exports=function(a,b,c){return d(a,b,null,c)}},77388,(a,b,c)=>{b.exports={parallel:a.r(96451),serial:a.r(38743),serialOrdered:a.r(9083)}},46303,(a,b,c)=>{"use strict";b.exports=Object},48974,(a,b,c)=>{"use strict";b.exports=Error},16830,(a,b,c)=>{"use strict";b.exports=EvalError},33877,(a,b,c)=>{"use strict";b.exports=RangeError},195,(a,b,c)=>{"use strict";b.exports=ReferenceError},42775,(a,b,c)=>{"use strict";b.exports=SyntaxError},28754,(a,b,c)=>{"use strict";b.exports=TypeError},56912,(a,b,c)=>{"use strict";b.exports=URIError},92778,(a,b,c)=>{"use strict";b.exports=Math.abs},18415,(a,b,c)=>{"use strict";b.exports=Math.floor},90363,(a,b,c)=>{"use strict";b.exports=Math.max},98768,(a,b,c)=>{"use strict";b.exports=Math.min},94841,(a,b,c)=>{"use strict";b.exports=Math.pow},77479,(a,b,c)=>{"use strict";b.exports=Math.round},85356,(a,b,c)=>{"use strict";b.exports=Number.isNaN||function(a){return a!=a}},11699,(a,b,c)=>{"use strict";var d=a.r(85356);b.exports=function(a){return d(a)||0===a?a:a<0?-1:1}},46884,(a,b,c)=>{"use strict";b.exports=Object.getOwnPropertyDescriptor},59885,(a,b,c)=>{"use strict";var d=a.r(46884);if(d)try{d([],"length")}catch(a){d=null}b.exports=d},93521,(a,b,c)=>{"use strict";var d=Object.defineProperty||!1;if(d)try{d({},"a",{value:1})}catch(a){d=!1}b.exports=d},32854,(a,b,c)=>{"use strict";b.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var a={},b=Symbol("test"),c=Object(b);if("string"==typeof b||"[object Symbol]"!==Object.prototype.toString.call(b)||"[object Symbol]"!==Object.prototype.toString.call(c))return!1;for(var d in a[b]=42,a)return!1;if("function"==typeof Object.keys&&0!==Object.keys(a).length||"function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(a).length)return!1;var e=Object.getOwnPropertySymbols(a);if(1!==e.length||e[0]!==b||!Object.prototype.propertyIsEnumerable.call(a,b))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var f=Object.getOwnPropertyDescriptor(a,b);if(42!==f.value||!0!==f.enumerable)return!1}return!0}},32250,(a,b,c)=>{"use strict";var d="undefined"!=typeof Symbol&&Symbol,e=a.r(32854);b.exports=function(){return"function"==typeof d&&"function"==typeof Symbol&&"symbol"==typeof d("foo")&&"symbol"==typeof Symbol("bar")&&e()}},86200,(a,b,c)=>{"use strict";b.exports="undefined"!=typeof Reflect&&Reflect.getPrototypeOf||null},29958,(a,b,c)=>{"use strict";b.exports=a.r(46303).getPrototypeOf||null},20344,(a,b,c)=>{"use strict";var d=Object.prototype.toString,e=Math.max,f=function(a,b){for(var c=[],d=0;d<a.length;d+=1)c[d]=a[d];for(var e=0;e<b.length;e+=1)c[e+a.length]=b[e];return c},g=function(a,b){for(var c=[],d=b||0,e=0;d<a.length;d+=1,e+=1)c[e]=a[d];return c},h=function(a,b){for(var c="",d=0;d<a.length;d+=1)c+=a[d],d+1<a.length&&(c+=b);return c};b.exports=function(a){var b,c=this;if("function"!=typeof c||"[object Function]"!==d.apply(c))throw TypeError("Function.prototype.bind called on incompatible "+c);for(var i=g(arguments,1),j=e(0,c.length-i.length),k=[],l=0;l<j;l++)k[l]="$"+l;if(b=Function("binder","return function ("+h(k,",")+"){ return binder.apply(this,arguments); }")(function(){if(this instanceof b){var d=c.apply(this,f(i,arguments));return Object(d)===d?d:this}return c.apply(a,f(i,arguments))}),c.prototype){var m=function(){};m.prototype=c.prototype,b.prototype=new m,m.prototype=null}return b}},21843,(a,b,c)=>{"use strict";var d=a.r(20344);b.exports=Function.prototype.bind||d},46626,(a,b,c)=>{"use strict";b.exports=Function.prototype.call},85675,(a,b,c)=>{"use strict";b.exports=Function.prototype.apply},95948,(a,b,c)=>{"use strict";b.exports="undefined"!=typeof Reflect&&Reflect&&Reflect.apply},98928,(a,b,c)=>{"use strict";var d=a.r(21843),e=a.r(85675),f=a.r(46626);b.exports=a.r(95948)||d.call(f,e)},85943,(a,b,c)=>{"use strict";var d=a.r(21843),e=a.r(28754),f=a.r(46626),g=a.r(98928);b.exports=function(a){if(a.length<1||"function"!=typeof a[0])throw new e("a function is required");return g(d,f,a)}},66783,(a,b,c)=>{"use strict";var d,e=a.r(85943),f=a.r(59885);try{d=[].__proto__===Array.prototype}catch(a){if(!a||"object"!=typeof a||!("code"in a)||"ERR_PROTO_ACCESS"!==a.code)throw a}var g=!!d&&f&&f(Object.prototype,"__proto__"),h=Object,i=h.getPrototypeOf;b.exports=g&&"function"==typeof g.get?e([g.get]):"function"==typeof i&&function(a){return i(null==a?a:h(a))}},97223,(a,b,c)=>{"use strict";var d=a.r(86200),e=a.r(29958),f=a.r(66783);b.exports=d?function(a){return d(a)}:e?function(a){if(!a||"object"!=typeof a&&"function"!=typeof a)throw TypeError("getProto: not an object");return e(a)}:f?function(a){return f(a)}:null},85739,(a,b,c)=>{"use strict";var d=Function.prototype.call,e=Object.prototype.hasOwnProperty;b.exports=a.r(21843).call(d,e)},81697,(a,b,c)=>{"use strict";var d=a.r(46303),e=a.r(48974),f=a.r(16830),g=a.r(33877),h=a.r(195),i=a.r(42775),j=a.r(28754),k=a.r(56912),l=a.r(92778),m=a.r(18415),n=a.r(90363),o=a.r(98768),p=a.r(94841),q=a.r(77479),r=a.r(11699),s=Function,t=function(a){try{return s('"use strict"; return ('+a+").constructor;")()}catch(a){}},u=a.r(59885),v=a.r(93521),w=function(){throw new j},x=u?function(){try{return arguments.callee,w}catch(a){try{return u(arguments,"callee").get}catch(a){return w}}}():w,y=a.r(32250)(),z=a.r(97223),A=a.r(29958),B=a.r(86200),C=a.r(85675),D=a.r(46626),E={},F="undefined"!=typeof Uint8Array&&z?z(Uint8Array):void 0,G={__proto__:null,"%AggregateError%":"undefined"==typeof AggregateError?void 0:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?void 0:ArrayBuffer,"%ArrayIteratorPrototype%":y&&z?z([][Symbol.iterator]()):void 0,"%AsyncFromSyncIteratorPrototype%":void 0,"%AsyncFunction%":E,"%AsyncGenerator%":E,"%AsyncGeneratorFunction%":E,"%AsyncIteratorPrototype%":E,"%Atomics%":"undefined"==typeof Atomics?void 0:Atomics,"%BigInt%":"undefined"==typeof BigInt?void 0:BigInt,"%BigInt64Array%":"undefined"==typeof BigInt64Array?void 0:BigInt64Array,"%BigUint64Array%":"undefined"==typeof BigUint64Array?void 0:BigUint64Array,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?void 0:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":e,"%eval%":eval,"%EvalError%":f,"%Float16Array%":"undefined"==typeof Float16Array?void 0:Float16Array,"%Float32Array%":"undefined"==typeof Float32Array?void 0:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?void 0:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?void 0:FinalizationRegistry,"%Function%":s,"%GeneratorFunction%":E,"%Int8Array%":"undefined"==typeof Int8Array?void 0:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?void 0:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?void 0:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":y&&z?z(z([][Symbol.iterator]())):void 0,"%JSON%":"object"==typeof JSON?JSON:void 0,"%Map%":"undefined"==typeof Map?void 0:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&y&&z?z(new Map()[Symbol.iterator]()):void 0,"%Math%":Math,"%Number%":Number,"%Object%":d,"%Object.getOwnPropertyDescriptor%":u,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?void 0:Promise,"%Proxy%":"undefined"==typeof Proxy?void 0:Proxy,"%RangeError%":g,"%ReferenceError%":h,"%Reflect%":"undefined"==typeof Reflect?void 0:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?void 0:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&y&&z?z(new Set()[Symbol.iterator]()):void 0,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?void 0:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":y&&z?z(""[Symbol.iterator]()):void 0,"%Symbol%":y?Symbol:void 0,"%SyntaxError%":i,"%ThrowTypeError%":x,"%TypedArray%":F,"%TypeError%":j,"%Uint8Array%":"undefined"==typeof Uint8Array?void 0:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?void 0:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?void 0:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?void 0:Uint32Array,"%URIError%":k,"%WeakMap%":"undefined"==typeof WeakMap?void 0:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?void 0:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?void 0:WeakSet,"%Function.prototype.call%":D,"%Function.prototype.apply%":C,"%Object.defineProperty%":v,"%Object.getPrototypeOf%":A,"%Math.abs%":l,"%Math.floor%":m,"%Math.max%":n,"%Math.min%":o,"%Math.pow%":p,"%Math.round%":q,"%Math.sign%":r,"%Reflect.getPrototypeOf%":B};if(z)try{null.error}catch(a){var H=z(z(a));G["%Error.prototype%"]=H}var I=function a(b){var c;if("%AsyncFunction%"===b)c=t("async function () {}");else if("%GeneratorFunction%"===b)c=t("function* () {}");else if("%AsyncGeneratorFunction%"===b)c=t("async function* () {}");else if("%AsyncGenerator%"===b){var d=a("%AsyncGeneratorFunction%");d&&(c=d.prototype)}else if("%AsyncIteratorPrototype%"===b){var e=a("%AsyncGenerator%");e&&z&&(c=z(e.prototype))}return G[b]=c,c},J={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},K=a.r(21843),L=a.r(85739),M=K.call(D,Array.prototype.concat),N=K.call(C,Array.prototype.splice),O=K.call(D,String.prototype.replace),P=K.call(D,String.prototype.slice),Q=K.call(D,RegExp.prototype.exec),R=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,S=/\\(\\)?/g,T=function(a){var b=P(a,0,1),c=P(a,-1);if("%"===b&&"%"!==c)throw new i("invalid intrinsic syntax, expected closing `%`");if("%"===c&&"%"!==b)throw new i("invalid intrinsic syntax, expected opening `%`");var d=[];return O(a,R,function(a,b,c,e){d[d.length]=c?O(e,S,"$1"):b||a}),d},U=function(a,b){var c,d=a;if(L(J,d)&&(d="%"+(c=J[d])[0]+"%"),L(G,d)){var e=G[d];if(e===E&&(e=I(d)),void 0===e&&!b)throw new j("intrinsic "+a+" exists, but is not available. Please file an issue!");return{alias:c,name:d,value:e}}throw new i("intrinsic "+a+" does not exist!")};b.exports=function(a,b){if("string"!=typeof a||0===a.length)throw new j("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof b)throw new j('"allowMissing" argument must be a boolean');if(null===Q(/^%?[^%]*%?$/,a))throw new i("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var c=T(a),d=c.length>0?c[0]:"",e=U("%"+d+"%",b),f=e.name,g=e.value,h=!1,k=e.alias;k&&(d=k[0],N(c,M([0,1],k)));for(var l=1,m=!0;l<c.length;l+=1){var n=c[l],o=P(n,0,1),p=P(n,-1);if(('"'===o||"'"===o||"`"===o||'"'===p||"'"===p||"`"===p)&&o!==p)throw new i("property names with quotes must have matching quotes");if("constructor"!==n&&m||(h=!0),d+="."+n,L(G,f="%"+d+"%"))g=G[f];else if(null!=g){if(!(n in g)){if(!b)throw new j("base intrinsic for "+a+" exists, but the property is not available.");return}if(u&&l+1>=c.length){var q=u(g,n);g=(m=!!q)&&"get"in q&&!("originalValue"in q.get)?q.get:g[n]}else m=L(g,n),g=g[n];m&&!h&&(G[f]=g)}}return g}},96744,(a,b,c)=>{"use strict";var d=a.r(32854);b.exports=function(){return d()&&!!Symbol.toStringTag}},83166,(a,b,c)=>{"use strict";var d=a.r(81697)("%Object.defineProperty%",!0),e=a.r(96744)(),f=a.r(85739),g=a.r(28754),h=e?Symbol.toStringTag:null;b.exports=function(a,b){var c=arguments.length>2&&!!arguments[2]&&arguments[2].force,e=arguments.length>2&&!!arguments[2]&&arguments[2].nonConfigurable;if(void 0!==c&&"boolean"!=typeof c||void 0!==e&&"boolean"!=typeof e)throw new g("if provided, the `overrideIfSet` and `nonConfigurable` options must be booleans");h&&(c||!f(a,h))&&(d?d(a,h,{configurable:!e,enumerable:!1,value:b,writable:!1}):a[h]=b)}},40625,(a,b,c)=>{"use strict";b.exports=function(a,b){return Object.keys(b).forEach(function(c){a[c]=a[c]||b[c]}),a}},81275,(a,b,c)=>{"use strict";var d=a.r(48803),e=a.r(24361),f=a.r(14747),g=a.r(21517),h=a.r(24836),i=a.r(92509).parse,j=a.r(22734),k=a.r(88947).Stream,l=a.r(54799),m=a.r(38201),n=a.r(77388),o=a.r(83166),p=a.r(85739),q=a.r(40625);function r(a){if(!(this instanceof r))return new r(a);for(var b in this._overheadLength=0,this._valueLength=0,this._valuesToMeasure=[],d.call(this),a=a||{})this[b]=a[b]}e.inherits(r,d),r.LINE_BREAK="\r\n",r.DEFAULT_CONTENT_TYPE="application/octet-stream",r.prototype.append=function(a,b,c){"string"==typeof(c=c||{})&&(c={filename:c});var e=d.prototype.append.bind(this);if(("number"==typeof b||null==b)&&(b=String(b)),Array.isArray(b))return void this._error(Error("Arrays are not supported."));var f=this._multiPartHeader(a,b,c),g=this._multiPartFooter();e(f),e(b),e(g),this._trackLength(f,b,c)},r.prototype._trackLength=function(a,b,c){var d=0;null!=c.knownLength?d+=Number(c.knownLength):Buffer.isBuffer(b)?d=b.length:"string"==typeof b&&(d=Buffer.byteLength(b)),this._valueLength+=d,this._overheadLength+=Buffer.byteLength(a)+r.LINE_BREAK.length,b&&(b.path||b.readable&&p(b,"httpVersion")||b instanceof k)&&(c.knownLength||this._valuesToMeasure.push(b))},r.prototype._lengthRetriever=function(a,b){p(a,"fd")?void 0!=a.end&&a.end!=1/0&&void 0!=a.start?b(null,a.end+1-(a.start?a.start:0)):j.stat(a.path,function(c,d){c?b(c):b(null,d.size-(a.start?a.start:0))}):p(a,"httpVersion")?b(null,Number(a.headers["content-length"])):p(a,"httpModule")?(a.on("response",function(c){a.pause(),b(null,Number(c.headers["content-length"]))}),a.resume()):b("Unknown stream")},r.prototype._multiPartHeader=function(a,b,c){if("string"==typeof c.header)return c.header;var d,e=this._getContentDisposition(b,c),f=this._getContentType(b,c),g="",h={"Content-Disposition":["form-data",'name="'+a+'"'].concat(e||[]),"Content-Type":[].concat(f||[])};for(var i in"object"==typeof c.header&&q(h,c.header),h)if(p(h,i)){if(null==(d=h[i]))continue;Array.isArray(d)||(d=[d]),d.length&&(g+=i+": "+d.join("; ")+r.LINE_BREAK)}return"--"+this.getBoundary()+r.LINE_BREAK+g+r.LINE_BREAK},r.prototype._getContentDisposition=function(a,b){var c;if("string"==typeof b.filepath?c=f.normalize(b.filepath).replace(/\\/g,"/"):b.filename||a&&(a.name||a.path)?c=f.basename(b.filename||a&&(a.name||a.path)):a&&a.readable&&p(a,"httpVersion")&&(c=f.basename(a.client._httpMessage.path||"")),c)return'filename="'+c+'"'},r.prototype._getContentType=function(a,b){var c=b.contentType;return!c&&a&&a.name&&(c=m.lookup(a.name)),!c&&a&&a.path&&(c=m.lookup(a.path)),!c&&a&&a.readable&&p(a,"httpVersion")&&(c=a.headers["content-type"]),!c&&(b.filepath||b.filename)&&(c=m.lookup(b.filepath||b.filename)),!c&&a&&"object"==typeof a&&(c=r.DEFAULT_CONTENT_TYPE),c},r.prototype._multiPartFooter=function(){return(function(a){var b=r.LINE_BREAK;0===this._streams.length&&(b+=this._lastBoundary()),a(b)}).bind(this)},r.prototype._lastBoundary=function(){return"--"+this.getBoundary()+"--"+r.LINE_BREAK},r.prototype.getHeaders=function(a){var b,c={"content-type":"multipart/form-data; boundary="+this.getBoundary()};for(b in a)p(a,b)&&(c[b.toLowerCase()]=a[b]);return c},r.prototype.setBoundary=function(a){if("string"!=typeof a)throw TypeError("FormData boundary must be a string");this._boundary=a},r.prototype.getBoundary=function(){return this._boundary||this._generateBoundary(),this._boundary},r.prototype.getBuffer=function(){for(var a=new Buffer.alloc(0),b=this.getBoundary(),c=0,d=this._streams.length;c<d;c++)"function"!=typeof this._streams[c]&&(a=Buffer.isBuffer(this._streams[c])?Buffer.concat([a,this._streams[c]]):Buffer.concat([a,Buffer.from(this._streams[c])]),("string"!=typeof this._streams[c]||this._streams[c].substring(2,b.length+2)!==b)&&(a=Buffer.concat([a,Buffer.from(r.LINE_BREAK)])));return Buffer.concat([a,Buffer.from(this._lastBoundary())])},r.prototype._generateBoundary=function(){this._boundary="--------------------------"+l.randomBytes(12).toString("hex")},r.prototype.getLengthSync=function(){var a=this._overheadLength+this._valueLength;return this._streams.length&&(a+=this._lastBoundary().length),this.hasKnownLength()||this._error(Error("Cannot calculate proper length in synchronous way.")),a},r.prototype.hasKnownLength=function(){var a=!0;return this._valuesToMeasure.length&&(a=!1),a},r.prototype.getLength=function(a){var b=this._overheadLength+this._valueLength;(this._streams.length&&(b+=this._lastBoundary().length),this._valuesToMeasure.length)?n.parallel(this._valuesToMeasure,this._lengthRetriever,function(c,d){c?a(c):(d.forEach(function(a){b+=a}),a(null,b))}):process.nextTick(a.bind(this,null,b))},r.prototype.submit=function(a,b){var c,d,e={method:"post"};return"string"==typeof a?d=q({port:(a=i(a)).port,path:a.pathname,host:a.hostname,protocol:a.protocol},e):(d=q(a,e)).port||(d.port="https:"===d.protocol?443:80),d.headers=this.getHeaders(a.headers),c="https:"===d.protocol?h.request(d):g.request(d),this.getLength((function(a,d){if(a&&"Unknown stream"!==a)return void this._error(a);if(d&&c.setHeader("Content-Length",d),this.pipe(c),b){var e,f=function(a,d){return c.removeListener("error",f),c.removeListener("response",e),b.call(this,a,d)};e=f.bind(this,null),c.on("error",f),c.on("response",e)}}).bind(this)),c},r.prototype._error=function(a){this.error||(this.error=a,this.pause(),this.emit("error",a))},r.prototype.toString=function(){return"[object FormData]"},o(r.prototype,"FormData"),b.exports=r},94435,(a,b,c)=>{"use strict";var d=a.r(92509).parse,e={ftp:21,gopher:70,http:80,https:443,ws:80,wss:443},f=String.prototype.endsWith||function(a){return a.length<=this.length&&-1!==this.indexOf(a,this.length-a.length)};function g(a){return process.env[a.toLowerCase()]||process.env[a.toUpperCase()]||""}c.getProxyForUrl=function(a){var b,c,h,i="string"==typeof a?d(a):a||{},j=i.protocol,k=i.host,l=i.port;if("string"!=typeof k||!k||"string"!=typeof j)return"";if(j=j.split(":",1)[0],b=k=k.replace(/:\d*$/,""),c=l=parseInt(l)||e[j]||0,!(!(h=(g("npm_config_no_proxy")||g("no_proxy")).toLowerCase())||"*"!==h&&h.split(/[,\s]/).every(function(a){if(!a)return!0;var d=a.match(/^(.+):(\d+)$/),e=d?d[1]:a,g=d?parseInt(d[2]):0;return!!g&&g!==c||(/^[.*]/.test(e)?("*"===e.charAt(0)&&(e=e.slice(1)),!f.call(b,e)):b!==e)})))return"";var m=g("npm_config_"+j+"_proxy")||g(j+"_proxy")||g("npm_config_proxy")||g("all_proxy");return m&&-1===m.indexOf("://")&&(m=j+"://"+m),m}},25328,(a,b,c)=>{b.exports=a.x("http2",()=>require("http2"))},49719,(a,b,c)=>{b.exports=a.x("assert",()=>require("assert"))},36263,(a,b,c)=>{var d;b.exports=function(){if(!d){try{d=(()=>{let a=Error("Cannot find module 'debug'");throw a.code="MODULE_NOT_FOUND",a})()("follow-redirects")}catch(a){}"function"!=typeof d&&(d=function(){})}d.apply(null,arguments)}},84803,(a,b,c)=>{var d,e,f=a.r(92509),g=f.URL,h=a.r(21517),i=a.r(24836),j=a.r(88947).Writable,k=a.r(49719),l=a.r(36263);d="undefined"!=typeof process,e=G(Error.captureStackTrace),d||e||console.warn("The follow-redirects package should be excluded from browser builds.");var m=!1;try{k(new g(""))}catch(a){m="ERR_INVALID_URL"===a.code}var n=["auth","host","hostname","href","path","pathname","port","protocol","query","search","hash"],o=["abort","aborted","connect","error","socket","timeout"],p=Object.create(null);o.forEach(function(a){p[a]=function(b,c,d){this._redirectable.emit(a,b,c,d)}});var q=D("ERR_INVALID_URL","Invalid URL",TypeError),r=D("ERR_FR_REDIRECTION_FAILURE","Redirected request failed"),s=D("ERR_FR_TOO_MANY_REDIRECTS","Maximum number of redirects exceeded",r),t=D("ERR_FR_MAX_BODY_LENGTH_EXCEEDED","Request body larger than maxBodyLength limit"),u=D("ERR_STREAM_WRITE_AFTER_END","write after end"),v=j.prototype.destroy||y;function w(a,b){j.call(this),this._sanitizeOptions(a),this._options=a,this._ended=!1,this._ending=!1,this._redirectCount=0,this._redirects=[],this._requestBodyLength=0,this._requestBodyBuffers=[],b&&this.on("response",b);var c=this;this._onNativeResponse=function(a){try{c._processResponse(a)}catch(a){c.emit("error",a instanceof r?a:new r({cause:a}))}},this._performRequest()}function x(a){var b={maxRedirects:21,maxBodyLength:0xa00000},c={};return Object.keys(a).forEach(function(d){var e=d+":",f=c[e]=a[d],h=b[d]=Object.create(f);Object.defineProperties(h,{request:{value:function(a,d,f){var h;return(h=a,g&&h instanceof g)?a=B(a):F(a)?a=B(z(a)):(f=d,d=A(a),a={protocol:e}),G(d)&&(f=d,d=null),(d=Object.assign({maxRedirects:b.maxRedirects,maxBodyLength:b.maxBodyLength},a,d)).nativeProtocols=c,F(d.host)||F(d.hostname)||(d.hostname="::1"),k.equal(d.protocol,e,"protocol mismatch"),l("options",d),new w(d,f)},configurable:!0,enumerable:!0,writable:!0},get:{value:function(a,b,c){var d=h.request(a,b,c);return d.end(),d},configurable:!0,enumerable:!0,writable:!0}})}),b}function y(){}function z(a){var b;if(m)b=new g(a);else if(!F((b=A(f.parse(a))).protocol))throw new q({input:a});return b}function A(a){if(/^\[/.test(a.hostname)&&!/^\[[:0-9a-f]+\]$/i.test(a.hostname)||/^\[/.test(a.host)&&!/^\[[:0-9a-f]+\](:\d+)?$/i.test(a.host))throw new q({input:a.href||a});return a}function B(a,b){var c=b||{};for(var d of n)c[d]=a[d];return c.hostname.startsWith("[")&&(c.hostname=c.hostname.slice(1,-1)),""!==c.port&&(c.port=Number(c.port)),c.path=c.search?c.pathname+c.search:c.pathname,c}function C(a,b){var c;for(var d in b)a.test(d)&&(c=b[d],delete b[d]);return null==c?void 0:String(c).trim()}function D(a,b,c){function d(c){G(Error.captureStackTrace)&&Error.captureStackTrace(this,this.constructor),Object.assign(this,c||{}),this.code=a,this.message=this.cause?b+": "+this.cause.message:b}return d.prototype=new(c||Error),Object.defineProperties(d.prototype,{constructor:{value:d,enumerable:!1},name:{value:"Error ["+a+"]",enumerable:!1}}),d}function E(a,b){for(var c of o)a.removeListener(c,p[c]);a.on("error",y),a.destroy(b)}function F(a){return"string"==typeof a||a instanceof String}function G(a){return"function"==typeof a}w.prototype=Object.create(j.prototype),w.prototype.abort=function(){E(this._currentRequest),this._currentRequest.abort(),this.emit("abort")},w.prototype.destroy=function(a){return E(this._currentRequest,a),v.call(this,a),this},w.prototype.write=function(a,b,c){var d;if(this._ending)throw new u;if(!F(a)&&!("object"==typeof(d=a)&&"length"in d))throw TypeError("data should be a string, Buffer or Uint8Array");if(G(b)&&(c=b,b=null),0===a.length){c&&c();return}this._requestBodyLength+a.length<=this._options.maxBodyLength?(this._requestBodyLength+=a.length,this._requestBodyBuffers.push({data:a,encoding:b}),this._currentRequest.write(a,b,c)):(this.emit("error",new t),this.abort())},w.prototype.end=function(a,b,c){if(G(a)?(c=a,a=b=null):G(b)&&(c=b,b=null),a){var d=this,e=this._currentRequest;this.write(a,b,function(){d._ended=!0,e.end(null,null,c)}),this._ending=!0}else this._ended=this._ending=!0,this._currentRequest.end(null,null,c)},w.prototype.setHeader=function(a,b){this._options.headers[a]=b,this._currentRequest.setHeader(a,b)},w.prototype.removeHeader=function(a){delete this._options.headers[a],this._currentRequest.removeHeader(a)},w.prototype.setTimeout=function(a,b){var c=this;function d(b){b.setTimeout(a),b.removeListener("timeout",b.destroy),b.addListener("timeout",b.destroy)}function e(b){c._timeout&&clearTimeout(c._timeout),c._timeout=setTimeout(function(){c.emit("timeout"),f()},a),d(b)}function f(){c._timeout&&(clearTimeout(c._timeout),c._timeout=null),c.removeListener("abort",f),c.removeListener("error",f),c.removeListener("response",f),c.removeListener("close",f),b&&c.removeListener("timeout",b),c.socket||c._currentRequest.removeListener("socket",e)}return b&&this.on("timeout",b),this.socket?e(this.socket):this._currentRequest.once("socket",e),this.on("socket",d),this.on("abort",f),this.on("error",f),this.on("response",f),this.on("close",f),this},["flushHeaders","getHeader","setNoDelay","setSocketKeepAlive"].forEach(function(a){w.prototype[a]=function(b,c){return this._currentRequest[a](b,c)}}),["aborted","connection","socket"].forEach(function(a){Object.defineProperty(w.prototype,a,{get:function(){return this._currentRequest[a]}})}),w.prototype._sanitizeOptions=function(a){if(a.headers||(a.headers={}),a.host&&(a.hostname||(a.hostname=a.host),delete a.host),!a.pathname&&a.path){var b=a.path.indexOf("?");b<0?a.pathname=a.path:(a.pathname=a.path.substring(0,b),a.search=a.path.substring(b))}},w.prototype._performRequest=function(){var a=this._options.protocol,b=this._options.nativeProtocols[a];if(!b)throw TypeError("Unsupported protocol "+a);if(this._options.agents){var c=a.slice(0,-1);this._options.agent=this._options.agents[c]}var d=this._currentRequest=b.request(this._options,this._onNativeResponse);for(var e of(d._redirectable=this,o))d.on(e,p[e]);if(this._currentUrl=/^\//.test(this._options.path)?f.format(this._options):this._options.path,this._isRedirect){var g=0,h=this,i=this._requestBodyBuffers;!function a(b){if(d===h._currentRequest)if(b)h.emit("error",b);else if(g<i.length){var c=i[g++];d.finished||d.write(c.data,c.encoding,a)}else h._ended&&d.end()}()}},w.prototype._processResponse=function(a){var b,c,d,e,h,i,j=a.statusCode;this._options.trackRedirects&&this._redirects.push({url:this._currentUrl,headers:a.headers,statusCode:j});var n=a.headers.location;if(!n||!1===this._options.followRedirects||j<300||j>=400){a.responseUrl=this._currentUrl,a.redirects=this._redirects,this.emit("response",a),this._requestBodyBuffers=[];return}if(E(this._currentRequest),a.destroy(),++this._redirectCount>this._options.maxRedirects)throw new s;var o=this._options.beforeRedirect;o&&(i=Object.assign({Host:a.req.getHeader("host")},this._options.headers));var p=this._options.method;(301!==j&&302!==j||"POST"!==this._options.method)&&(303!==j||/^(?:GET|HEAD)$/.test(this._options.method))||(this._options.method="GET",this._requestBodyBuffers=[],C(/^content-/i,this._options.headers));var q=C(/^host$/i,this._options.headers),r=z(this._currentUrl),t=q||r.host,u=/^\w+:/.test(n)?this._currentUrl:f.format(Object.assign(r,{host:t})),v=(b=n,c=u,m?new g(b,c):z(f.resolve(c,b)));if(l("redirecting to",v.href),this._isRedirect=!0,B(v,this._options),(v.protocol===r.protocol||"https:"===v.protocol)&&(v.host===t||(d=v.host,e=t,k(F(d)&&F(e)),(h=d.length-e.length-1)>0&&"."===d[h]&&d.endsWith(e)))||C(/^(?:(?:proxy-)?authorization|cookie)$/i,this._options.headers),G(o)){var w={headers:a.headers,statusCode:j},x={url:u,method:p,headers:i};o(this._options,w,x),this._sanitizeOptions(this._options)}this._performRequest()},b.exports=x({http:h,https:i}),b.exports.wrap=x},6461,(a,b,c)=>{b.exports=a.x("zlib",()=>require("zlib"))},27699,(a,b,c)=>{b.exports=a.x("events",()=>require("events"))},60350,a=>{"use strict";let b,c,d,e,f,g,h,i,j,k,l,m,n,o,p;var q,r,s=a.i(87924),t=a.i(72131);function u(a,b){if("function"==typeof a)return a(b);null!=a&&(a.current=b)}function v(...a){return b=>{let c=!1,d=a.map(a=>{let d=u(a,b);return c||"function"!=typeof d||(c=!0),d});if(c)return()=>{for(let b=0;b<d.length;b++){let c=d[b];"function"==typeof c?c():u(a[b],null)}}}}function w(...a){return t.useCallback(v(...a),a)}var x=t.forwardRef((a,b)=>{let{children:c,...d}=a,e=t.Children.toArray(c),f=e.find(A);if(f){let a=f.props.children,c=e.map(b=>b!==f?b:t.Children.count(a)>1?t.Children.only(null):t.isValidElement(a)?a.props.children:null);return(0,s.jsx)(y,{...d,ref:b,children:t.isValidElement(a)?t.cloneElement(a,void 0,c):null})}return(0,s.jsx)(y,{...d,ref:b,children:c})});x.displayName="Slot";var y=t.forwardRef((a,b)=>{let{children:c,...d}=a;if(t.isValidElement(c)){var e;let a,f,g=(e=c,(f=(a=Object.getOwnPropertyDescriptor(e.props,"ref")?.get)&&"isReactWarning"in a&&a.isReactWarning)?e.ref:(f=(a=Object.getOwnPropertyDescriptor(e,"ref")?.get)&&"isReactWarning"in a&&a.isReactWarning)?e.props.ref:e.props.ref||e.ref);return t.cloneElement(c,{...function(a,b){let c={...b};for(let d in b){let e=a[d],f=b[d];/^on[A-Z]/.test(d)?e&&f?c[d]=(...a)=>{f(...a),e(...a)}:e&&(c[d]=e):"style"===d?c[d]={...e,...f}:"className"===d&&(c[d]=[e,f].filter(Boolean).join(" "))}return{...a,...c}}(d,c.props),ref:b?v(b,g):g})}return t.Children.count(c)>1?t.Children.only(null):null});y.displayName="SlotClone";var z=({children:a})=>(0,s.jsx)(s.Fragment,{children:a});function A(a){return t.isValidElement(a)&&a.type===z}function B(){for(var a,b,c=0,d="",e=arguments.length;c<e;c++)(a=arguments[c])&&(b=function a(b){var c,d,e="";if("string"==typeof b||"number"==typeof b)e+=b;else if("object"==typeof b)if(Array.isArray(b)){var f=b.length;for(c=0;c<f;c++)b[c]&&(d=a(b[c]))&&(e&&(e+=" "),e+=d)}else for(d in b)b[d]&&(e&&(e+=" "),e+=d);return e}(a))&&(d&&(d+=" "),d+=b);return d}let C=a=>"boolean"==typeof a?`${a}`:0===a?"0":a,D=(a=new Map,b=null,c)=>({nextPart:a,validators:b,classGroupId:c}),E=[],F=(a,b,c)=>{if(0==a.length-b)return c.classGroupId;let d=a[b],e=c.nextPart.get(d);if(e){let c=F(a,b+1,e);if(c)return c}let f=c.validators;if(null===f)return;let g=0===b?a.join("-"):a.slice(b).join("-"),h=f.length;for(let a=0;a<h;a++){let b=f[a];if(b.validator(g))return b.classGroupId}},G=(a,b)=>{let c=D();for(let d in a)H(a[d],c,d,b);return c},H=(a,b,c,d)=>{let e=a.length;for(let f=0;f<e;f++)I(a[f],b,c,d)},I=(a,b,c,d)=>{"string"==typeof a?J(a,b,c):"function"==typeof a?K(a,b,c,d):L(a,b,c,d)},J=(a,b,c)=>{(""===a?b:M(b,a)).classGroupId=c},K=(a,b,c,d)=>{N(a)?H(a(d),b,c,d):(null===b.validators&&(b.validators=[]),b.validators.push({classGroupId:c,validator:a}))},L=(a,b,c,d)=>{let e=Object.entries(a),f=e.length;for(let a=0;a<f;a++){let[f,g]=e[a];H(g,M(b,f),c,d)}},M=(a,b)=>{let c=a,d=b.split("-"),e=d.length;for(let a=0;a<e;a++){let b=d[a],e=c.nextPart.get(b);e||(e=D(),c.nextPart.set(b,e)),c=e}return c},N=a=>"isThemeGetter"in a&&!0===a.isThemeGetter,O=[],P=(a,b,c,d,e)=>({modifiers:a,hasImportantModifier:b,baseClassName:c,maybePostfixModifierPosition:d,isExternal:e}),Q=/\s+/,R=a=>{let b;if("string"==typeof a)return a;let c="";for(let d=0;d<a.length;d++)a[d]&&(b=R(a[d]))&&(c&&(c+=" "),c+=b);return c},S=[],T=a=>{let b=b=>b[a]||S;return b.isThemeGetter=!0,b},U=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,V=/^\((?:(\w[\w-]*):)?(.+)\)$/i,W=/^\d+\/\d+$/,X=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Y=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,Z=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,$=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,_=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,aa=a=>W.test(a),ab=a=>!!a&&!Number.isNaN(Number(a)),ac=a=>!!a&&Number.isInteger(Number(a)),ad=a=>a.endsWith("%")&&ab(a.slice(0,-1)),ae=a=>X.test(a),af=()=>!0,ag=a=>Y.test(a)&&!Z.test(a),ah=()=>!1,ai=a=>$.test(a),aj=a=>_.test(a),ak=a=>!am(a)&&!as(a),al=a=>az(a,aD,ah),am=a=>U.test(a),an=a=>az(a,aE,ag),ao=a=>az(a,aF,ab),ap=a=>az(a,aB,ah),aq=a=>az(a,aC,aj),ar=a=>az(a,aH,ai),as=a=>V.test(a),at=a=>aA(a,aE),au=a=>aA(a,aG),av=a=>aA(a,aB),aw=a=>aA(a,aD),ax=a=>aA(a,aC),ay=a=>aA(a,aH,!0),az=(a,b,c)=>{let d=U.exec(a);return!!d&&(d[1]?b(d[1]):c(d[2]))},aA=(a,b,c=!1)=>{let d=V.exec(a);return!!d&&(d[1]?b(d[1]):c)},aB=a=>"position"===a||"percentage"===a,aC=a=>"image"===a||"url"===a,aD=a=>"length"===a||"size"===a||"bg-size"===a,aE=a=>"length"===a,aF=a=>"number"===a,aG=a=>"family-name"===a,aH=a=>"shadow"===a,aI=((a,...b)=>{let c,d,e,f,g=a=>{let b=d(a);if(b)return b;let f=((a,b)=>{let{parseClassName:c,getClassGroupId:d,getConflictingClassGroupIds:e,sortModifiers:f}=b,g=[],h=a.trim().split(Q),i="";for(let a=h.length-1;a>=0;a-=1){let b=h[a],{isExternal:j,modifiers:k,hasImportantModifier:l,baseClassName:m,maybePostfixModifierPosition:n}=c(b);if(j){i=b+(i.length>0?" "+i:i);continue}let o=!!n,p=d(o?m.substring(0,n):m);if(!p){if(!o||!(p=d(m))){i=b+(i.length>0?" "+i:i);continue}o=!1}let q=0===k.length?"":1===k.length?k[0]:f(k).join(":"),r=l?q+"!":q,s=r+p;if(g.indexOf(s)>-1)continue;g.push(s);let t=e(p,o);for(let a=0;a<t.length;++a){let b=t[a];g.push(r+b)}i=b+(i.length>0?" "+i:i)}return i})(a,c);return e(a,f),f};return f=h=>{var i;let j;return d=(c={cache:(a=>{if(a<1)return{get:()=>void 0,set:()=>{}};let b=0,c=Object.create(null),d=Object.create(null),e=(e,f)=>{c[e]=f,++b>a&&(b=0,d=c,c=Object.create(null))};return{get(a){let b=c[a];return void 0!==b?b:void 0!==(b=d[a])?(e(a,b),b):void 0},set(a,b){a in c?c[a]=b:e(a,b)}}})((i=b.reduce((a,b)=>b(a),a())).cacheSize),parseClassName:(a=>{let{prefix:b,experimentalParseClassName:c}=a,d=a=>{let b,c=[],d=0,e=0,f=0,g=a.length;for(let h=0;h<g;h++){let g=a[h];if(0===d&&0===e){if(":"===g){c.push(a.slice(f,h)),f=h+1;continue}if("/"===g){b=h;continue}}"["===g?d++:"]"===g?d--:"("===g?e++:")"===g&&e--}let h=0===c.length?a:a.slice(f),i=h,j=!1;return h.endsWith("!")?(i=h.slice(0,-1),j=!0):h.startsWith("!")&&(i=h.slice(1),j=!0),P(c,j,i,b&&b>f?b-f:void 0)};if(b){let a=b+":",c=d;d=b=>b.startsWith(a)?c(b.slice(a.length)):P(O,!1,b,void 0,!0)}if(c){let a=d;d=b=>c({className:b,parseClassName:a})}return d})(i),sortModifiers:(j=new Map,i.orderSensitiveModifiers.forEach((a,b)=>{j.set(a,1e6+b)}),a=>{let b=[],c=[];for(let d=0;d<a.length;d++){let e=a[d],f="["===e[0],g=j.has(e);f||g?(c.length>0&&(c.sort(),b.push(...c),c=[]),b.push(e)):c.push(e)}return c.length>0&&(c.sort(),b.push(...c)),b}),...(a=>{let b=(a=>{let{theme:b,classGroups:c}=a;return G(c,b)})(a),{conflictingClassGroups:c,conflictingClassGroupModifiers:d}=a;return{getClassGroupId:a=>{if(a.startsWith("[")&&a.endsWith("]")){var c;let b,d,e;return -1===(c=a).slice(1,-1).indexOf(":")?void 0:(d=(b=c.slice(1,-1)).indexOf(":"),(e=b.slice(0,d))?"arbitrary.."+e:void 0)}let d=a.split("-"),e=+(""===d[0]&&d.length>1);return F(d,e,b)},getConflictingClassGroupIds:(a,b)=>{if(b){let b=d[a],e=c[a];if(b){if(e){let a=Array(e.length+b.length);for(let b=0;b<e.length;b++)a[b]=e[b];for(let c=0;c<b.length;c++)a[e.length+c]=b[c];return a}return b}return e||E}return c[a]||E}}})(i)}).cache.get,e=c.cache.set,f=g,g(h)},(...a)=>f(((...a)=>{let b,c,d=0,e="";for(;d<a.length;)(b=a[d++])&&(c=R(b))&&(e&&(e+=" "),e+=c);return e})(...a))})(()=>{let a=T("color"),b=T("font"),c=T("text"),d=T("font-weight"),e=T("tracking"),f=T("leading"),g=T("breakpoint"),h=T("container"),i=T("spacing"),j=T("radius"),k=T("shadow"),l=T("inset-shadow"),m=T("text-shadow"),n=T("drop-shadow"),o=T("blur"),p=T("perspective"),q=T("aspect"),r=T("ease"),s=T("animate"),t=()=>["auto","avoid","all","avoid-page","page","left","right","column"],u=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],v=()=>[...u(),as,am],w=()=>["auto","hidden","clip","visible","scroll"],x=()=>["auto","contain","none"],y=()=>[as,am,i],z=()=>[aa,"full","auto",...y()],A=()=>[ac,"none","subgrid",as,am],B=()=>["auto",{span:["full",ac,as,am]},ac,as,am],C=()=>[ac,"auto",as,am],D=()=>["auto","min","max","fr",as,am],E=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],F=()=>["start","end","center","stretch","center-safe","end-safe"],G=()=>["auto",...y()],H=()=>[aa,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...y()],I=()=>[a,as,am],J=()=>[...u(),av,ap,{position:[as,am]}],K=()=>["no-repeat",{repeat:["","x","y","space","round"]}],L=()=>["auto","cover","contain",aw,al,{size:[as,am]}],M=()=>[ad,at,an],N=()=>["","none","full",j,as,am],O=()=>["",ab,at,an],P=()=>["solid","dashed","dotted","double"],Q=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],R=()=>[ab,ad,av,ap],S=()=>["","none",o,as,am],U=()=>["none",ab,as,am],V=()=>["none",ab,as,am],W=()=>[ab,as,am],X=()=>[aa,"full",...y()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[ae],breakpoint:[ae],color:[af],container:[ae],"drop-shadow":[ae],ease:["in","out","in-out"],font:[ak],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[ae],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[ae],shadow:[ae],spacing:["px",ab],text:[ae],"text-shadow":[ae],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",aa,am,as,q]}],container:["container"],columns:[{columns:[ab,am,as,h]}],"break-after":[{"break-after":t()}],"break-before":[{"break-before":t()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:v()}],overflow:[{overflow:w()}],"overflow-x":[{"overflow-x":w()}],"overflow-y":[{"overflow-y":w()}],overscroll:[{overscroll:x()}],"overscroll-x":[{"overscroll-x":x()}],"overscroll-y":[{"overscroll-y":x()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:z()}],"inset-x":[{"inset-x":z()}],"inset-y":[{"inset-y":z()}],start:[{start:z()}],end:[{end:z()}],top:[{top:z()}],right:[{right:z()}],bottom:[{bottom:z()}],left:[{left:z()}],visibility:["visible","invisible","collapse"],z:[{z:[ac,"auto",as,am]}],basis:[{basis:[aa,"full","auto",h,...y()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[ab,aa,"auto","initial","none",am]}],grow:[{grow:["",ab,as,am]}],shrink:[{shrink:["",ab,as,am]}],order:[{order:[ac,"first","last","none",as,am]}],"grid-cols":[{"grid-cols":A()}],"col-start-end":[{col:B()}],"col-start":[{"col-start":C()}],"col-end":[{"col-end":C()}],"grid-rows":[{"grid-rows":A()}],"row-start-end":[{row:B()}],"row-start":[{"row-start":C()}],"row-end":[{"row-end":C()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":D()}],"auto-rows":[{"auto-rows":D()}],gap:[{gap:y()}],"gap-x":[{"gap-x":y()}],"gap-y":[{"gap-y":y()}],"justify-content":[{justify:[...E(),"normal"]}],"justify-items":[{"justify-items":[...F(),"normal"]}],"justify-self":[{"justify-self":["auto",...F()]}],"align-content":[{content:["normal",...E()]}],"align-items":[{items:[...F(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...F(),{baseline:["","last"]}]}],"place-content":[{"place-content":E()}],"place-items":[{"place-items":[...F(),"baseline"]}],"place-self":[{"place-self":["auto",...F()]}],p:[{p:y()}],px:[{px:y()}],py:[{py:y()}],ps:[{ps:y()}],pe:[{pe:y()}],pt:[{pt:y()}],pr:[{pr:y()}],pb:[{pb:y()}],pl:[{pl:y()}],m:[{m:G()}],mx:[{mx:G()}],my:[{my:G()}],ms:[{ms:G()}],me:[{me:G()}],mt:[{mt:G()}],mr:[{mr:G()}],mb:[{mb:G()}],ml:[{ml:G()}],"space-x":[{"space-x":y()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":y()}],"space-y-reverse":["space-y-reverse"],size:[{size:H()}],w:[{w:[h,"screen",...H()]}],"min-w":[{"min-w":[h,"screen","none",...H()]}],"max-w":[{"max-w":[h,"screen","none","prose",{screen:[g]},...H()]}],h:[{h:["screen","lh",...H()]}],"min-h":[{"min-h":["screen","lh","none",...H()]}],"max-h":[{"max-h":["screen","lh",...H()]}],"font-size":[{text:["base",c,at,an]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[d,as,ao]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",ad,am]}],"font-family":[{font:[au,am,b]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[e,as,am]}],"line-clamp":[{"line-clamp":[ab,"none",as,ao]}],leading:[{leading:[f,...y()]}],"list-image":[{"list-image":["none",as,am]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",as,am]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:I()}],"text-color":[{text:I()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...P(),"wavy"]}],"text-decoration-thickness":[{decoration:[ab,"from-font","auto",as,an]}],"text-decoration-color":[{decoration:I()}],"underline-offset":[{"underline-offset":[ab,"auto",as,am]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:y()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",as,am]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",as,am]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:J()}],"bg-repeat":[{bg:K()}],"bg-size":[{bg:L()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},ac,as,am],radial:["",as,am],conic:[ac,as,am]},ax,aq]}],"bg-color":[{bg:I()}],"gradient-from-pos":[{from:M()}],"gradient-via-pos":[{via:M()}],"gradient-to-pos":[{to:M()}],"gradient-from":[{from:I()}],"gradient-via":[{via:I()}],"gradient-to":[{to:I()}],rounded:[{rounded:N()}],"rounded-s":[{"rounded-s":N()}],"rounded-e":[{"rounded-e":N()}],"rounded-t":[{"rounded-t":N()}],"rounded-r":[{"rounded-r":N()}],"rounded-b":[{"rounded-b":N()}],"rounded-l":[{"rounded-l":N()}],"rounded-ss":[{"rounded-ss":N()}],"rounded-se":[{"rounded-se":N()}],"rounded-ee":[{"rounded-ee":N()}],"rounded-es":[{"rounded-es":N()}],"rounded-tl":[{"rounded-tl":N()}],"rounded-tr":[{"rounded-tr":N()}],"rounded-br":[{"rounded-br":N()}],"rounded-bl":[{"rounded-bl":N()}],"border-w":[{border:O()}],"border-w-x":[{"border-x":O()}],"border-w-y":[{"border-y":O()}],"border-w-s":[{"border-s":O()}],"border-w-e":[{"border-e":O()}],"border-w-t":[{"border-t":O()}],"border-w-r":[{"border-r":O()}],"border-w-b":[{"border-b":O()}],"border-w-l":[{"border-l":O()}],"divide-x":[{"divide-x":O()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":O()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...P(),"hidden","none"]}],"divide-style":[{divide:[...P(),"hidden","none"]}],"border-color":[{border:I()}],"border-color-x":[{"border-x":I()}],"border-color-y":[{"border-y":I()}],"border-color-s":[{"border-s":I()}],"border-color-e":[{"border-e":I()}],"border-color-t":[{"border-t":I()}],"border-color-r":[{"border-r":I()}],"border-color-b":[{"border-b":I()}],"border-color-l":[{"border-l":I()}],"divide-color":[{divide:I()}],"outline-style":[{outline:[...P(),"none","hidden"]}],"outline-offset":[{"outline-offset":[ab,as,am]}],"outline-w":[{outline:["",ab,at,an]}],"outline-color":[{outline:I()}],shadow:[{shadow:["","none",k,ay,ar]}],"shadow-color":[{shadow:I()}],"inset-shadow":[{"inset-shadow":["none",l,ay,ar]}],"inset-shadow-color":[{"inset-shadow":I()}],"ring-w":[{ring:O()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:I()}],"ring-offset-w":[{"ring-offset":[ab,an]}],"ring-offset-color":[{"ring-offset":I()}],"inset-ring-w":[{"inset-ring":O()}],"inset-ring-color":[{"inset-ring":I()}],"text-shadow":[{"text-shadow":["none",m,ay,ar]}],"text-shadow-color":[{"text-shadow":I()}],opacity:[{opacity:[ab,as,am]}],"mix-blend":[{"mix-blend":[...Q(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":Q()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[ab]}],"mask-image-linear-from-pos":[{"mask-linear-from":R()}],"mask-image-linear-to-pos":[{"mask-linear-to":R()}],"mask-image-linear-from-color":[{"mask-linear-from":I()}],"mask-image-linear-to-color":[{"mask-linear-to":I()}],"mask-image-t-from-pos":[{"mask-t-from":R()}],"mask-image-t-to-pos":[{"mask-t-to":R()}],"mask-image-t-from-color":[{"mask-t-from":I()}],"mask-image-t-to-color":[{"mask-t-to":I()}],"mask-image-r-from-pos":[{"mask-r-from":R()}],"mask-image-r-to-pos":[{"mask-r-to":R()}],"mask-image-r-from-color":[{"mask-r-from":I()}],"mask-image-r-to-color":[{"mask-r-to":I()}],"mask-image-b-from-pos":[{"mask-b-from":R()}],"mask-image-b-to-pos":[{"mask-b-to":R()}],"mask-image-b-from-color":[{"mask-b-from":I()}],"mask-image-b-to-color":[{"mask-b-to":I()}],"mask-image-l-from-pos":[{"mask-l-from":R()}],"mask-image-l-to-pos":[{"mask-l-to":R()}],"mask-image-l-from-color":[{"mask-l-from":I()}],"mask-image-l-to-color":[{"mask-l-to":I()}],"mask-image-x-from-pos":[{"mask-x-from":R()}],"mask-image-x-to-pos":[{"mask-x-to":R()}],"mask-image-x-from-color":[{"mask-x-from":I()}],"mask-image-x-to-color":[{"mask-x-to":I()}],"mask-image-y-from-pos":[{"mask-y-from":R()}],"mask-image-y-to-pos":[{"mask-y-to":R()}],"mask-image-y-from-color":[{"mask-y-from":I()}],"mask-image-y-to-color":[{"mask-y-to":I()}],"mask-image-radial":[{"mask-radial":[as,am]}],"mask-image-radial-from-pos":[{"mask-radial-from":R()}],"mask-image-radial-to-pos":[{"mask-radial-to":R()}],"mask-image-radial-from-color":[{"mask-radial-from":I()}],"mask-image-radial-to-color":[{"mask-radial-to":I()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":u()}],"mask-image-conic-pos":[{"mask-conic":[ab]}],"mask-image-conic-from-pos":[{"mask-conic-from":R()}],"mask-image-conic-to-pos":[{"mask-conic-to":R()}],"mask-image-conic-from-color":[{"mask-conic-from":I()}],"mask-image-conic-to-color":[{"mask-conic-to":I()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:J()}],"mask-repeat":[{mask:K()}],"mask-size":[{mask:L()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",as,am]}],filter:[{filter:["","none",as,am]}],blur:[{blur:S()}],brightness:[{brightness:[ab,as,am]}],contrast:[{contrast:[ab,as,am]}],"drop-shadow":[{"drop-shadow":["","none",n,ay,ar]}],"drop-shadow-color":[{"drop-shadow":I()}],grayscale:[{grayscale:["",ab,as,am]}],"hue-rotate":[{"hue-rotate":[ab,as,am]}],invert:[{invert:["",ab,as,am]}],saturate:[{saturate:[ab,as,am]}],sepia:[{sepia:["",ab,as,am]}],"backdrop-filter":[{"backdrop-filter":["","none",as,am]}],"backdrop-blur":[{"backdrop-blur":S()}],"backdrop-brightness":[{"backdrop-brightness":[ab,as,am]}],"backdrop-contrast":[{"backdrop-contrast":[ab,as,am]}],"backdrop-grayscale":[{"backdrop-grayscale":["",ab,as,am]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[ab,as,am]}],"backdrop-invert":[{"backdrop-invert":["",ab,as,am]}],"backdrop-opacity":[{"backdrop-opacity":[ab,as,am]}],"backdrop-saturate":[{"backdrop-saturate":[ab,as,am]}],"backdrop-sepia":[{"backdrop-sepia":["",ab,as,am]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":y()}],"border-spacing-x":[{"border-spacing-x":y()}],"border-spacing-y":[{"border-spacing-y":y()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",as,am]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[ab,"initial",as,am]}],ease:[{ease:["linear","initial",r,as,am]}],delay:[{delay:[ab,as,am]}],animate:[{animate:["none",s,as,am]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[p,as,am]}],"perspective-origin":[{"perspective-origin":v()}],rotate:[{rotate:U()}],"rotate-x":[{"rotate-x":U()}],"rotate-y":[{"rotate-y":U()}],"rotate-z":[{"rotate-z":U()}],scale:[{scale:V()}],"scale-x":[{"scale-x":V()}],"scale-y":[{"scale-y":V()}],"scale-z":[{"scale-z":V()}],"scale-3d":["scale-3d"],skew:[{skew:W()}],"skew-x":[{"skew-x":W()}],"skew-y":[{"skew-y":W()}],transform:[{transform:[as,am,"","none","gpu","cpu"]}],"transform-origin":[{origin:v()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:X()}],"translate-x":[{"translate-x":X()}],"translate-y":[{"translate-y":X()}],"translate-z":[{"translate-z":X()}],"translate-none":["translate-none"],accent:[{accent:I()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:I()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",as,am]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":y()}],"scroll-mx":[{"scroll-mx":y()}],"scroll-my":[{"scroll-my":y()}],"scroll-ms":[{"scroll-ms":y()}],"scroll-me":[{"scroll-me":y()}],"scroll-mt":[{"scroll-mt":y()}],"scroll-mr":[{"scroll-mr":y()}],"scroll-mb":[{"scroll-mb":y()}],"scroll-ml":[{"scroll-ml":y()}],"scroll-p":[{"scroll-p":y()}],"scroll-px":[{"scroll-px":y()}],"scroll-py":[{"scroll-py":y()}],"scroll-ps":[{"scroll-ps":y()}],"scroll-pe":[{"scroll-pe":y()}],"scroll-pt":[{"scroll-pt":y()}],"scroll-pr":[{"scroll-pr":y()}],"scroll-pb":[{"scroll-pb":y()}],"scroll-pl":[{"scroll-pl":y()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",as,am]}],fill:[{fill:["none",...I()]}],"stroke-w":[{stroke:[ab,at,an,ao]}],stroke:[{stroke:["none",...I()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}});function aJ(...a){return aI(B(a))}let aK=(d="inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",e={variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9","icon-sm":"size-8","icon-lg":"size-10"}},defaultVariants:{variant:"default",size:"default"}},a=>{var b;if((null==e?void 0:e.variants)==null)return B(d,null==a?void 0:a.class,null==a?void 0:a.className);let{variants:c,defaultVariants:f}=e,g=Object.keys(c).map(b=>{let d=null==a?void 0:a[b],e=null==f?void 0:f[b];if(null===d)return null;let g=C(d)||C(e);return c[b][g]}),h=a&&Object.entries(a).reduce((a,b)=>{let[c,d]=b;return void 0===d||(a[c]=d),a},{});return B(d,g,null==e||null==(b=e.compoundVariants)?void 0:b.reduce((a,b)=>{let{class:c,className:d,...e}=b;return Object.entries(e).every(a=>{let[b,c]=a;return Array.isArray(c)?c.includes({...f,...h}[b]):({...f,...h})[b]===c})?[...a,c,d]:a},[]),null==a?void 0:a.class,null==a?void 0:a.className)});function aL({className:a,variant:b="default",size:c="default",asChild:d=!1,...e}){let f=d?x:"button";return(0,s.jsx)(f,{"data-slot":"button","data-variant":b,"data-size":c,className:aJ(aK({variant:b,size:c,className:a})),...e})}function aM({className:a,type:b,...c}){return(0,s.jsx)("input",{type:b,"data-slot":"input",className:aJ("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",a),...c})}a.i(35112);var aN=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"].reduce((a,b)=>{let c=t.forwardRef((a,c)=>{let{asChild:d,...e}=a,f=d?x:b;return(0,s.jsx)(f,{...e,ref:c})});return c.displayName=`Primitive.${b}`,{...a,[b]:c}},{}),aO=t.forwardRef((a,b)=>(0,s.jsx)(aN.label,{...a,ref:b,onMouseDown:b=>{b.target.closest("button, input, select, textarea")||(a.onMouseDown?.(b),!b.defaultPrevented&&b.detail>1&&b.preventDefault())}}));function aP({className:a,...b}){return(0,s.jsx)(aO,{"data-slot":"label",className:aJ("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",a),...b})}function aQ({className:a,...b}){return(0,s.jsx)("div",{"data-slot":"card",className:aJ("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",a),...b})}function aR({className:a,...b}){return(0,s.jsx)("div",{"data-slot":"card-header",className:aJ("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",a),...b})}function aS({className:a,...b}){return(0,s.jsx)("div",{"data-slot":"card-title",className:aJ("leading-none font-semibold",a),...b})}function aT({className:a,...b}){return(0,s.jsx)("div",{"data-slot":"card-description",className:aJ("text-muted-foreground text-sm",a),...b})}function aU({className:a,...b}){return(0,s.jsx)("div",{"data-slot":"card-content",className:aJ("px-6",a),...b})}aO.displayName="Label";let aV=(...a)=>a.filter((a,b,c)=>!!a&&""!==a.trim()&&c.indexOf(a)===b).join(" ").trim();var aW={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let aX=(0,t.forwardRef)(({color:a="currentColor",size:b=24,strokeWidth:c=2,absoluteStrokeWidth:d,className:e="",children:f,iconNode:g,...h},i)=>(0,t.createElement)("svg",{ref:i,...aW,width:b,height:b,stroke:a,strokeWidth:d?24*Number(c)/Number(b):c,className:aV("lucide",e),...h},[...g.map(([a,b])=>(0,t.createElement)(a,b)),...Array.isArray(f)?f:[f]])),aY=(a,b)=>{let c=(0,t.forwardRef)(({className:c,...d},e)=>(0,t.createElement)(aX,{ref:e,iconNode:b,className:aV(`lucide-${a.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,c),...d}));return c.displayName=`${a}`,c},aZ=aY("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]),a$=aY("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),a_=aY("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);function a0(a,b){return function(){return a.apply(b,arguments)}}let{toString:a1}=Object.prototype,{getPrototypeOf:a2}=Object,{iterator:a3,toStringTag:a4}=Symbol,a5=(f=Object.create(null),a=>{let b=a1.call(a);return f[b]||(f[b]=b.slice(8,-1).toLowerCase())}),a6=a=>(a=a.toLowerCase(),b=>a5(b)===a),a7=a=>b=>typeof b===a,{isArray:a8}=Array,a9=a7("undefined");function ba(a){return null!==a&&!a9(a)&&null!==a.constructor&&!a9(a.constructor)&&bd(a.constructor.isBuffer)&&a.constructor.isBuffer(a)}let bb=a6("ArrayBuffer"),bc=a7("string"),bd=a7("function"),be=a7("number"),bf=a=>null!==a&&"object"==typeof a,bg=a=>{if("object"!==a5(a))return!1;let b=a2(a);return(null===b||b===Object.prototype||null===Object.getPrototypeOf(b))&&!(a4 in a)&&!(a3 in a)},bh=a6("Date"),bi=a6("File"),bj=a6("Blob"),bk=a6("FileList"),bl=a6("URLSearchParams"),[bm,bn,bo,bp]=["ReadableStream","Request","Response","Headers"].map(a6);function bq(a,b,{allOwnKeys:c=!1}={}){let d,e;if(null!=a)if("object"!=typeof a&&(a=[a]),a8(a))for(d=0,e=a.length;d<e;d++)b.call(null,a[d],d,a);else{let e;if(ba(a))return;let f=c?Object.getOwnPropertyNames(a):Object.keys(a),g=f.length;for(d=0;d<g;d++)e=f[d],b.call(null,a[e],e,a)}}function br(a,b){let c;if(ba(a))return null;b=b.toLowerCase();let d=Object.keys(a),e=d.length;for(;e-- >0;)if(b===(c=d[e]).toLowerCase())return c;return null}let bs="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:a.g,bt=a=>!a9(a)&&a!==bs,bu=(g="undefined"!=typeof Uint8Array&&a2(Uint8Array),a=>g&&a instanceof g),bv=a6("HTMLFormElement"),bw=(({hasOwnProperty:a})=>(b,c)=>a.call(b,c))(Object.prototype),bx=a6("RegExp"),by=(a,b)=>{let c=Object.getOwnPropertyDescriptors(a),d={};bq(c,(c,e)=>{let f;!1!==(f=b(c,e,a))&&(d[e]=f||c)}),Object.defineProperties(a,d)},bz=a6("AsyncFunction"),bA=(kt="function"==typeof setImmediate,ku=bd(bs.postMessage),kt?setImmediate:ku?(kv=`axios@${Math.random()}`,kw=[],bs.addEventListener("message",({source:a,data:b})=>{a===bs&&b===kv&&kw.length&&kw.shift()()},!1),a=>{kw.push(a),bs.postMessage(kv,"*")}):a=>setTimeout(a)),bB="undefined"!=typeof queueMicrotask?queueMicrotask.bind(bs):"undefined"!=typeof process&&process.nextTick||bA,bC={isArray:a8,isArrayBuffer:bb,isBuffer:ba,isFormData:a=>{let b;return a&&("function"==typeof FormData&&a instanceof FormData||bd(a.append)&&("formdata"===(b=a5(a))||"object"===b&&bd(a.toString)&&"[object FormData]"===a.toString()))},isArrayBufferView:function(a){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(a):a&&a.buffer&&bb(a.buffer)},isString:bc,isNumber:be,isBoolean:a=>!0===a||!1===a,isObject:bf,isPlainObject:bg,isEmptyObject:a=>{if(!bf(a)||ba(a))return!1;try{return 0===Object.keys(a).length&&Object.getPrototypeOf(a)===Object.prototype}catch(a){return!1}},isReadableStream:bm,isRequest:bn,isResponse:bo,isHeaders:bp,isUndefined:a9,isDate:bh,isFile:bi,isBlob:bj,isRegExp:bx,isFunction:bd,isStream:a=>bf(a)&&bd(a.pipe),isURLSearchParams:bl,isTypedArray:bu,isFileList:bk,forEach:bq,merge:function a(){let{caseless:b,skipUndefined:c}=bt(this)&&this||{},d={},e=(e,f)=>{let g=b&&br(d,f)||f;bg(d[g])&&bg(e)?d[g]=a(d[g],e):bg(e)?d[g]=a({},e):a8(e)?d[g]=e.slice():c&&a9(e)||(d[g]=e)};for(let a=0,b=arguments.length;a<b;a++)arguments[a]&&bq(arguments[a],e);return d},extend:(a,b,c,{allOwnKeys:d}={})=>(bq(b,(b,d)=>{c&&bd(b)?a[d]=a0(b,c):a[d]=b},{allOwnKeys:d}),a),trim:a=>a.trim?a.trim():a.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:a=>(65279===a.charCodeAt(0)&&(a=a.slice(1)),a),inherits:(a,b,c,d)=>{a.prototype=Object.create(b.prototype,d),a.prototype.constructor=a,Object.defineProperty(a,"super",{value:b.prototype}),c&&Object.assign(a.prototype,c)},toFlatObject:(a,b,c,d)=>{let e,f,g,h={};if(b=b||{},null==a)return b;do{for(f=(e=Object.getOwnPropertyNames(a)).length;f-- >0;)g=e[f],(!d||d(g,a,b))&&!h[g]&&(b[g]=a[g],h[g]=!0);a=!1!==c&&a2(a)}while(a&&(!c||c(a,b))&&a!==Object.prototype)return b},kindOf:a5,kindOfTest:a6,endsWith:(a,b,c)=>{a=String(a),(void 0===c||c>a.length)&&(c=a.length),c-=b.length;let d=a.indexOf(b,c);return -1!==d&&d===c},toArray:a=>{if(!a)return null;if(a8(a))return a;let b=a.length;if(!be(b))return null;let c=Array(b);for(;b-- >0;)c[b]=a[b];return c},forEachEntry:(a,b)=>{let c,d=(a&&a[a3]).call(a);for(;(c=d.next())&&!c.done;){let d=c.value;b.call(a,d[0],d[1])}},matchAll:(a,b)=>{let c,d=[];for(;null!==(c=a.exec(b));)d.push(c);return d},isHTMLForm:bv,hasOwnProperty:bw,hasOwnProp:bw,reduceDescriptors:by,freezeMethods:a=>{by(a,(b,c)=>{if(bd(a)&&-1!==["arguments","caller","callee"].indexOf(c))return!1;if(bd(a[c])){if(b.enumerable=!1,"writable"in b){b.writable=!1;return}b.set||(b.set=()=>{throw Error("Can not rewrite read-only method '"+c+"'")})}})},toObjectSet:(a,b)=>{let c={};return(a8(a)?a:String(a).split(b)).forEach(a=>{c[a]=!0}),c},toCamelCase:a=>a.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(a,b,c){return b.toUpperCase()+c}),noop:()=>{},toFiniteNumber:(a,b)=>null!=a&&Number.isFinite(a*=1)?a:b,findKey:br,global:bs,isContextDefined:bt,isSpecCompliantForm:function(a){return!!(a&&bd(a.append)&&"FormData"===a[a4]&&a[a3])},toJSONObject:a=>{let b=Array(10),c=(a,d)=>{if(bf(a)){if(b.indexOf(a)>=0)return;if(ba(a))return a;if(!("toJSON"in a)){b[d]=a;let e=a8(a)?[]:{};return bq(a,(a,b)=>{let f=c(a,d+1);a9(f)||(e[b]=f)}),b[d]=void 0,e}}return a};return c(a,0)},isAsyncFn:bz,isThenable:a=>a&&(bf(a)||bd(a))&&bd(a.then)&&bd(a.catch),setImmediate:bA,asap:bB,isIterable:a=>null!=a&&bd(a[a3])};function bD(a,b,c,d,e){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=Error().stack,this.message=a,this.name="AxiosError",b&&(this.code=b),c&&(this.config=c),d&&(this.request=d),e&&(this.response=e,this.status=e.status?e.status:null)}bC.inherits(bD,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:bC.toJSONObject(this.config),code:this.code,status:this.status}}});let bE=bD.prototype,bF={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(a=>{bF[a]={value:a}}),Object.defineProperties(bD,bF),Object.defineProperty(bE,"isAxiosError",{value:!0}),bD.from=(a,b,c,d,e,f)=>{let g=Object.create(bE);bC.toFlatObject(a,g,function(a){return a!==Error.prototype},a=>"isAxiosError"!==a);let h=a&&a.message?a.message:"Error",i=null==b&&a?a.code:b;return bD.call(g,h,i,c,d,e),a&&null==g.cause&&Object.defineProperty(g,"cause",{value:a,configurable:!0}),g.name=a&&a.name||"Error",f&&Object.assign(g,f),g};let bG=a.i(81275).default;function bH(a){return bC.isPlainObject(a)||bC.isArray(a)}function bI(a){return bC.endsWith(a,"[]")?a.slice(0,-2):a}function bJ(a,b,c){return a?a.concat(b).map(function(a,b){return a=bI(a),!c&&b?"["+a+"]":a}).join(c?".":""):b}let bK=bC.toFlatObject(bC,{},null,function(a){return/^is[A-Z]/.test(a)}),bL=function(a,b,c){if(!bC.isObject(a))throw TypeError("target must be an object");b=b||new(bG||FormData);let d=(c=bC.toFlatObject(c,{metaTokens:!0,dots:!1,indexes:!1},!1,function(a,b){return!bC.isUndefined(b[a])})).metaTokens,e=c.visitor||j,f=c.dots,g=c.indexes,h=(c.Blob||"undefined"!=typeof Blob&&Blob)&&bC.isSpecCompliantForm(b);if(!bC.isFunction(e))throw TypeError("visitor must be a function");function i(a){if(null===a)return"";if(bC.isDate(a))return a.toISOString();if(bC.isBoolean(a))return a.toString();if(!h&&bC.isBlob(a))throw new bD("Blob is not supported. Use a Buffer instead.");return bC.isArrayBuffer(a)||bC.isTypedArray(a)?h&&"function"==typeof Blob?new Blob([a]):Buffer.from(a):a}function j(a,c,e){let h=a;if(a&&!e&&"object"==typeof a)if(bC.endsWith(c,"{}"))c=d?c:c.slice(0,-2),a=JSON.stringify(a);else{var j;if(bC.isArray(a)&&(j=a,bC.isArray(j)&&!j.some(bH))||(bC.isFileList(a)||bC.endsWith(c,"[]"))&&(h=bC.toArray(a)))return c=bI(c),h.forEach(function(a,d){bC.isUndefined(a)||null===a||b.append(!0===g?bJ([c],d,f):null===g?c:c+"[]",i(a))}),!1}return!!bH(a)||(b.append(bJ(e,c,f),i(a)),!1)}let k=[],l=Object.assign(bK,{defaultVisitor:j,convertValue:i,isVisitable:bH});if(!bC.isObject(a))throw TypeError("data must be an object");return!function a(c,d){if(!bC.isUndefined(c)){if(-1!==k.indexOf(c))throw Error("Circular reference detected in "+d.join("."));k.push(c),bC.forEach(c,function(c,f){!0===(!(bC.isUndefined(c)||null===c)&&e.call(b,c,bC.isString(f)?f.trim():f,d,l))&&a(c,d?d.concat(f):[f])}),k.pop()}}(a),b};function bM(a){let b={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(a).replace(/[!'()~]|%20|%00/g,function(a){return b[a]})}function bN(a,b){this._pairs=[],a&&bL(a,this,b)}let bO=bN.prototype;function bP(a){return encodeURIComponent(a).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function bQ(a,b,c){let d;if(!b)return a;let e=c&&c.encode||bP;bC.isFunction(c)&&(c={serialize:c});let f=c&&c.serialize;if(d=f?f(b,c):bC.isURLSearchParams(b)?b.toString():new bN(b,c).toString(e)){let b=a.indexOf("#");-1!==b&&(a=a.slice(0,b)),a+=(-1===a.indexOf("?")?"?":"&")+d}return a}bO.append=function(a,b){this._pairs.push([a,b])},bO.toString=function(a){let b=a?function(b){return a.call(this,b,bM)}:bM;return this._pairs.map(function(a){return b(a[0])+"="+b(a[1])},"").join("&")};let bR=class{constructor(){this.handlers=[]}use(a,b,c){return this.handlers.push({fulfilled:a,rejected:b,synchronous:!!c&&c.synchronous,runWhen:c?c.runWhen:null}),this.handlers.length-1}eject(a){this.handlers[a]&&(this.handlers[a]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(a){bC.forEach(this.handlers,function(b){null!==b&&a(b)})}},bS={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1};var bT=a.i(54799);let bU=a.i(92509).default.URLSearchParams,bV="abcdefghijklmnopqrstuvwxyz",bW="0123456789",bX={DIGIT:bW,ALPHA:bV,ALPHA_DIGIT:bV+bV.toUpperCase()+bW},bY={isNode:!0,classes:{URLSearchParams:bU,FormData:bG,Blob:"undefined"!=typeof Blob&&Blob||null},ALPHABET:bX,generateString:(a=16,b=bX.ALPHA_DIGIT)=>{let c="",{length:d}=b,e=new Uint32Array(a);bT.default.randomFillSync(e);for(let f=0;f<a;f++)c+=b[e[f]%d];return c},protocols:["http","https","file","data"]},bZ="object"==typeof navigator&&navigator||void 0,b$="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"==typeof self.importScripts;a.s(["hasBrowserEnv",()=>!1,"hasStandardBrowserEnv",()=>!1,"hasStandardBrowserWebWorkerEnv",()=>b$,"navigator",()=>bZ,"origin",()=>"http://localhost"],7683);let b_={...a.i(7683),...bY},b0=function(a){if(bC.isFormData(a)&&bC.isFunction(a.entries)){let b={};return bC.forEachEntry(a,(a,c)=>{!function a(b,c,d,e){let f=b[e++];if("__proto__"===f)return!0;let g=Number.isFinite(+f),h=e>=b.length;return(f=!f&&bC.isArray(d)?d.length:f,h)?bC.hasOwnProp(d,f)?d[f]=[d[f],c]:d[f]=c:(d[f]&&bC.isObject(d[f])||(d[f]=[]),a(b,c,d[f],e)&&bC.isArray(d[f])&&(d[f]=function(a){let b,c,d={},e=Object.keys(a),f=e.length;for(b=0;b<f;b++)d[c=e[b]]=a[c];return d}(d[f]))),!g}(bC.matchAll(/\w+|\[(\w*)]/g,a).map(a=>"[]"===a[0]?"":a[1]||a[0]),c,b,0)}),b}return null},b1={transitional:bS,adapter:["xhr","http","fetch"],transformRequest:[function(a,b){let c,d=b.getContentType()||"",e=d.indexOf("application/json")>-1,f=bC.isObject(a);if(f&&bC.isHTMLForm(a)&&(a=new FormData(a)),bC.isFormData(a))return e?JSON.stringify(b0(a)):a;if(bC.isArrayBuffer(a)||bC.isBuffer(a)||bC.isStream(a)||bC.isFile(a)||bC.isBlob(a)||bC.isReadableStream(a))return a;if(bC.isArrayBufferView(a))return a.buffer;if(bC.isURLSearchParams(a))return b.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),a.toString();if(f){if(d.indexOf("application/x-www-form-urlencoded")>-1){var g,h;return(g=a,h=this.formSerializer,bL(g,new b_.classes.URLSearchParams,{visitor:function(a,b,c,d){return b_.isNode&&bC.isBuffer(a)?(this.append(b,a.toString("base64")),!1):d.defaultVisitor.apply(this,arguments)},...h})).toString()}if((c=bC.isFileList(a))||d.indexOf("multipart/form-data")>-1){let b=this.env&&this.env.FormData;return bL(c?{"files[]":a}:a,b&&new b,this.formSerializer)}}if(f||e){b.setContentType("application/json",!1);var i=a;if(bC.isString(i))try{return(0,JSON.parse)(i),bC.trim(i)}catch(a){if("SyntaxError"!==a.name)throw a}return(0,JSON.stringify)(i)}return a}],transformResponse:[function(a){let b=this.transitional||b1.transitional,c=b&&b.forcedJSONParsing,d="json"===this.responseType;if(bC.isResponse(a)||bC.isReadableStream(a))return a;if(a&&bC.isString(a)&&(c&&!this.responseType||d)){let c=b&&b.silentJSONParsing;try{return JSON.parse(a,this.parseReviver)}catch(a){if(!c&&d){if("SyntaxError"===a.name)throw bD.from(a,bD.ERR_BAD_RESPONSE,this,null,this.response);throw a}}}return a}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:b_.classes.FormData,Blob:b_.classes.Blob},validateStatus:function(a){return a>=200&&a<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};bC.forEach(["delete","get","head","post","put","patch"],a=>{b1.headers[a]={}});let b2=bC.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),b3=Symbol("internals");function b4(a){return a&&String(a).trim().toLowerCase()}function b5(a){return!1===a||null==a?a:bC.isArray(a)?a.map(b5):String(a)}function b6(a,b,c,d,e){if(bC.isFunction(d))return d.call(this,b,c);if(e&&(b=c),bC.isString(b)){if(bC.isString(d))return -1!==b.indexOf(d);if(bC.isRegExp(d))return d.test(b)}}class b7{constructor(a){a&&this.set(a)}set(a,b,c){let d=this;function e(a,b,c){let e=b4(b);if(!e)throw Error("header name must be a non-empty string");let f=bC.findKey(d,e);f&&void 0!==d[f]&&!0!==c&&(void 0!==c||!1===d[f])||(d[f||b]=b5(a))}let f=(a,b)=>bC.forEach(a,(a,c)=>e(a,c,b));if(bC.isPlainObject(a)||a instanceof this.constructor)f(a,b);else{let d;if(bC.isString(a)&&(a=a.trim())&&(d=a,!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(d.trim()))){var g;let c,d,e,h;f((h={},(g=a)&&g.split("\n").forEach(function(a){e=a.indexOf(":"),c=a.substring(0,e).trim().toLowerCase(),d=a.substring(e+1).trim(),!c||h[c]&&b2[c]||("set-cookie"===c?h[c]?h[c].push(d):h[c]=[d]:h[c]=h[c]?h[c]+", "+d:d)}),h),b)}else if(bC.isObject(a)&&bC.isIterable(a)){let c={},d,e;for(let b of a){if(!bC.isArray(b))throw TypeError("Object iterator must return a key-value pair");c[e=b[0]]=(d=c[e])?bC.isArray(d)?[...d,b[1]]:[d,b[1]]:b[1]}f(c,b)}else null!=a&&e(b,a,c)}return this}get(a,b){if(a=b4(a)){let c=bC.findKey(this,a);if(c){let a=this[c];if(!b)return a;if(!0===b){let b,c=Object.create(null),d=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;for(;b=d.exec(a);)c[b[1]]=b[2];return c}if(bC.isFunction(b))return b.call(this,a,c);if(bC.isRegExp(b))return b.exec(a);throw TypeError("parser must be boolean|regexp|function")}}}has(a,b){if(a=b4(a)){let c=bC.findKey(this,a);return!!(c&&void 0!==this[c]&&(!b||b6(this,this[c],c,b)))}return!1}delete(a,b){let c=this,d=!1;function e(a){if(a=b4(a)){let e=bC.findKey(c,a);e&&(!b||b6(c,c[e],e,b))&&(delete c[e],d=!0)}}return bC.isArray(a)?a.forEach(e):e(a),d}clear(a){let b=Object.keys(this),c=b.length,d=!1;for(;c--;){let e=b[c];(!a||b6(this,this[e],e,a,!0))&&(delete this[e],d=!0)}return d}normalize(a){let b=this,c={};return bC.forEach(this,(d,e)=>{let f=bC.findKey(c,e);if(f){b[f]=b5(d),delete b[e];return}let g=a?e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(a,b,c)=>b.toUpperCase()+c):String(e).trim();g!==e&&delete b[e],b[g]=b5(d),c[g]=!0}),this}concat(...a){return this.constructor.concat(this,...a)}toJSON(a){let b=Object.create(null);return bC.forEach(this,(c,d)=>{null!=c&&!1!==c&&(b[d]=a&&bC.isArray(c)?c.join(", "):c)}),b}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([a,b])=>a+": "+b).join("\n")}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(a){return a instanceof this?a:new this(a)}static concat(a,...b){let c=new this(a);return b.forEach(a=>c.set(a)),c}static accessor(a){let b=(this[b3]=this[b3]={accessors:{}}).accessors,c=this.prototype;function d(a){let d=b4(a);if(!b[d]){let e;e=bC.toCamelCase(" "+a),["get","set","has"].forEach(b=>{Object.defineProperty(c,b+e,{value:function(c,d,e){return this[b].call(this,a,c,d,e)},configurable:!0})}),b[d]=!0}}return bC.isArray(a)?a.forEach(d):d(a),this}}function b8(a,b){let c=this||b1,d=b||c,e=b7.from(d.headers),f=d.data;return bC.forEach(a,function(a){f=a.call(c,f,e.normalize(),b?b.status:void 0)}),e.normalize(),f}function b9(a){return!!(a&&a.__CANCEL__)}function ca(a,b,c){bD.call(this,null==a?"canceled":a,bD.ERR_CANCELED,b,c),this.name="CanceledError"}function cb(a,b,c){let d=c.config.validateStatus;!c.status||!d||d(c.status)?a(c):b(new bD("Request failed with status code "+c.status,[bD.ERR_BAD_REQUEST,bD.ERR_BAD_RESPONSE][Math.floor(c.status/100)-4],c.config,c.request,c))}function cc(a,b,c){let d=!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(b);return a&&(d||!1==c)?b?a.replace(/\/?\/$/,"")+"/"+b.replace(/^\/+/,""):a:b}b7.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),bC.reduceDescriptors(b7.prototype,({value:a},b)=>{let c=b[0].toUpperCase()+b.slice(1);return{get:()=>a,set(a){this[c]=a}}}),bC.freezeMethods(b7),bC.inherits(ca,bD,{__CANCEL__:!0});var cd=a.i(94435),ce=a.i(21517),cf=a.i(24836),cg=a.i(25328),ch=a.i(24361),ci=a.i(84803),cj=a.i(6461);let ck="1.13.2";function cl(a){let b=/^([-+\w]{1,25})(:?\/\/|:)/.exec(a);return b&&b[1]||""}let cm=/^(?:([^;]+);)?(?:[^;]+;)?(base64|),([\s\S]*)$/;var cn=a.i(88947),co=cn;let cp=Symbol("internals");class cq extends co.default.Transform{constructor(a){super({readableHighWaterMark:(a=bC.toFlatObject(a,{maxRate:0,chunkSize:65536,minChunkSize:100,timeWindow:500,ticksRate:2,samplesCount:15},null,(a,b)=>!bC.isUndefined(b[a]))).chunkSize});const b=this[cp]={timeWindow:a.timeWindow,chunkSize:a.chunkSize,maxRate:a.maxRate,minChunkSize:a.minChunkSize,bytesSeen:0,isCaptured:!1,notifiedBytesLoaded:0,ts:Date.now(),bytes:0,onReadCallback:null};this.on("newListener",a=>{"progress"!==a||b.isCaptured||(b.isCaptured=!0)})}_read(a){let b=this[cp];return b.onReadCallback&&b.onReadCallback(),super._read(a)}_transform(a,b,c){let d=this[cp],e=d.maxRate,f=this.readableHighWaterMark,g=d.timeWindow,h=e/(1e3/g),i=!1!==d.minChunkSize?Math.max(d.minChunkSize,.01*h):0,j=(a,b)=>{let c=Buffer.byteLength(a);d.bytesSeen+=c,d.bytes+=c,d.isCaptured&&this.emit("progress",d.bytesSeen),this.push(a)?process.nextTick(b):d.onReadCallback=()=>{d.onReadCallback=null,process.nextTick(b)}},k=(a,b)=>{let c,k=Buffer.byteLength(a),l=null,m=f,n=0;if(e){let a=Date.now();(!d.ts||(n=a-d.ts)>=g)&&(d.ts=a,c=h-d.bytes,d.bytes=c<0?-c:0,n=0),c=h-d.bytes}if(e){if(c<=0)return setTimeout(()=>{b(null,a)},g-n);c<m&&(m=c)}m&&k>m&&k-m>i&&(l=a.subarray(m),a=a.subarray(0,m)),j(a,l?()=>{process.nextTick(b,null,l)}:b)};k(a,function a(b,d){if(b)return c(b);d?k(d,a):c(null)})}}var cr=a.i(27699);let{asyncIterator:cs}=Symbol,ct=async function*(a){a.stream?yield*a.stream():a.arrayBuffer?yield await a.arrayBuffer():a[cs]?yield*a[cs]():yield a},cu=b_.ALPHABET.ALPHA_DIGIT+"-_",cv="function"==typeof TextEncoder?new TextEncoder:new ch.default.TextEncoder,cw=cv.encode("\r\n");class cx{constructor(a,b){const{escapeName:c}=this.constructor,d=bC.isString(b);let e=`Content-Disposition: form-data; name="${c(a)}"${!d&&b.name?`; filename="${c(b.name)}"`:""}\r
`;d?b=cv.encode(String(b).replace(/\r?\n|\r\n?/g,"\r\n")):e+=`Content-Type: ${b.type||"application/octet-stream"}\r
`,this.headers=cv.encode(e+"\r\n"),this.contentLength=d?b.byteLength:b.size,this.size=this.headers.byteLength+this.contentLength+2,this.name=a,this.value=b}async *encode(){yield this.headers;let{value:a}=this;bC.isTypedArray(a)?yield a:yield*ct(a),yield cw}static escapeName(a){return String(a).replace(/[\r\n"]/g,a=>({"\r":"%0D","\n":"%0A",'"':"%22"})[a])}}var cy=cn;class cz extends cy.default.Transform{__transform(a,b,c){this.push(a),c()}_transform(a,b,c){if(0!==a.length&&(this._transform=this.__transform,120!==a[0])){let a=Buffer.alloc(2);a[0]=120,a[1]=156,this.push(a,b)}this.__transform(a,b,c)}}let cA=function(a,b){let c,d=Array(a=a||10),e=Array(a),f=0,g=0;return b=void 0!==b?b:1e3,function(h){let i=Date.now(),j=e[g];c||(c=i),d[f]=h,e[f]=i;let k=g,l=0;for(;k!==f;)l+=d[k++],k%=a;if((f=(f+1)%a)===g&&(g=(g+1)%a),i-c<b)return;let m=j&&i-j;return m?Math.round(1e3*l/m):void 0}},cB=function(a,b){let c,d,e=0,f=1e3/b,g=(b,f=Date.now())=>{e=f,c=null,d&&(clearTimeout(d),d=null),a(...b)};return[(...a)=>{let b=Date.now(),h=b-e;h>=f?g(a,b):(c=a,d||(d=setTimeout(()=>{d=null,g(c)},f-h)))},()=>c&&g(c)]},cC=(a,b,c=3)=>{let d=0,e=cA(50,250);return cB(c=>{let f=c.loaded,g=c.lengthComputable?c.total:void 0,h=f-d,i=e(h);d=f,a({loaded:f,total:g,progress:g?f/g:void 0,bytes:h,rate:i||void 0,estimated:i&&g&&f<=g?(g-f)/i:void 0,event:c,lengthComputable:null!=g,[b?"download":"upload"]:!0})},c)},cD=(a,b)=>{let c=null!=a;return[d=>b[0]({lengthComputable:c,total:a,loaded:d}),b[1]]},cE=a=>(...b)=>bC.asap(()=>a(...b)),cF={flush:cj.default.constants.Z_SYNC_FLUSH,finishFlush:cj.default.constants.Z_SYNC_FLUSH},cG={flush:cj.default.constants.BROTLI_OPERATION_FLUSH,finishFlush:cj.default.constants.BROTLI_OPERATION_FLUSH},cH=bC.isFunction(cj.default.createBrotliDecompress),{http:cI,https:cJ}=ci.default,cK=/https:?/,cL=b_.protocols.map(a=>a+":"),cM=(a,[b,c])=>(a.on("end",c).on("error",c),b),cN=new class{constructor(){this.sessions=Object.create(null)}getSession(a,b){let c;b=Object.assign({sessionTimeout:1e3},b);let d=this.sessions[a];if(d){let a=d.length;for(let c=0;c<a;c++){let[a,e]=d[c];if(!a.destroyed&&!a.closed&&ch.default.isDeepStrictEqual(e,b))return a}}let e=cg.default.connect(a,b),f=()=>{if(c)return;c=!0;let b=d,f=b.length,g=f;for(;g--;)if(b[g][0]===e)return void(1===f?delete this.sessions[a]:b.splice(g,1))},g=e.request,{sessionTimeout:h}=b;if(null!=h){let a,b=0;e.request=function(){let c=g.apply(this,arguments);return b++,a&&(clearTimeout(a),a=null),c.once("close",()=>{--b||(a=setTimeout(()=>{a=null,f()},h))}),c}}e.once("close",f);let i=[e,b];return d?d.push(i):d=this.sessions[a]=[i],e}};function cO(a,b){a.beforeRedirects.proxy&&a.beforeRedirects.proxy(a),a.beforeRedirects.config&&a.beforeRedirects.config(a,b)}let cP="undefined"!=typeof process&&"process"===bC.kindOf(process),cQ=(a,b)=>(({address:a,family:b})=>{if(!bC.isString(a))throw TypeError("address must be a string");return{address:a,family:b||(0>a.indexOf(".")?6:4)}})(bC.isObject(a)?a:{address:a,family:b}),cR={request(a,b){let c=a.protocol+"//"+a.hostname+":"+(a.port||80),{http2Options:d,headers:e}=a,f=cN.getSession(c,d),{HTTP2_HEADER_SCHEME:g,HTTP2_HEADER_METHOD:h,HTTP2_HEADER_PATH:i,HTTP2_HEADER_STATUS:j}=cg.default.constants,k={[g]:a.protocol.replace(":",""),[h]:a.method,[i]:a.path};bC.forEach(e,(a,b)=>{":"!==b.charAt(0)&&(k[b]=a)});let l=f.request(k);return l.once("response",a=>{let c=(a=Object.assign({},a))[j];delete a[j],l.headers=a,l.statusCode=+c,b(l)}),l}},cS=cP&&function(a){let b;return b=async function(b,c,d){let e,f,g,h,i,j,k,{data:l,lookup:m,family:n,httpVersion:o=1,http2Options:p}=a,{responseType:q,responseEncoding:r}=a,s=a.method.toUpperCase(),t=!1;if(Number.isNaN(o*=1))throw TypeError(`Invalid protocol version: '${a.httpVersion}' is not a number`);if(1!==o&&2!==o)throw TypeError(`Unsupported protocol version '${o}'`);let u=2===o;if(m){let a,b,c=(a=m,b=a=>bC.isArray(a)?a:[a],bC.isAsyncFn(a)?function(...c){let d=c.pop();a.apply(this,c).then(a=>{try{b?d(null,...b(a)):d(null,a)}catch(a){d(a)}},d)}:a);m=(a,b,d)=>{c(a,b,(a,c,e)=>{if(a)return d(a);let f=bC.isArray(c)?c.map(a=>cQ(a)):[cQ(c,e)];b.all?d(a,f):d(a,f[0].address,f[0].family)})}}let v=new cr.EventEmitter;function w(b){try{v.emit("abort",!b||b.type?new ca(null,a,i):b)}catch(a){console.warn("emit error",a)}}v.once("abort",c);let x=()=>{a.cancelToken&&a.cancelToken.unsubscribe(w),a.signal&&a.signal.removeEventListener("abort",w),v.removeAllListeners()};(a.cancelToken||a.signal)&&(a.cancelToken&&a.cancelToken.subscribe(w),a.signal&&(a.signal.aborted?w():a.signal.addEventListener("abort",w))),d((a,b)=>{if(h=!0,b){t=!0,x();return}let{data:c}=a;if(c instanceof cn.default.Readable||c instanceof cn.default.Duplex){let a=cn.default.finished(c,()=>{a(),x()})}else x()});let y=cc(a.baseURL,a.url,a.allowAbsoluteUrls),z=new URL(y,b_.hasBrowserEnv?b_.origin:void 0),A=z.protocol||cL[0];if("data:"===A){let d;if(a.maxContentLength>-1&&function(a){if(!a||"string"!=typeof a||!a.startsWith("data:"))return 0;let b=a.indexOf(",");if(b<0)return 0;let c=a.slice(5,b),d=a.slice(b+1);if(/;base64/i.test(c)){let a=d.length,b=d.length;for(let c=0;c<b;c++)if(37===d.charCodeAt(c)&&c+2<b){let b=d.charCodeAt(c+1),e=d.charCodeAt(c+2);(b>=48&&b<=57||b>=65&&b<=70||b>=97&&b<=102)&&(e>=48&&e<=57||e>=65&&e<=70||e>=97&&e<=102)&&(a-=2,c+=2)}let c=0,e=b-1,f=a=>a>=2&&37===d.charCodeAt(a-2)&&51===d.charCodeAt(a-1)&&(68===d.charCodeAt(a)||100===d.charCodeAt(a));e>=0&&(61===d.charCodeAt(e)?(c++,e--):f(e)&&(c++,e-=3)),1===c&&e>=0&&(61===d.charCodeAt(e)?c++:f(e)&&c++);let g=3*Math.floor(a/4)-(c||0);return g>0?g:0}return Buffer.byteLength(d,"utf8")}(String(a.url||y||""))>a.maxContentLength)return c(new bD("maxContentLength size of "+a.maxContentLength+" exceeded",bD.ERR_BAD_RESPONSE,a));if("GET"!==s)return cb(b,c,{status:405,statusText:"method not allowed",headers:{},config:a});try{d=function(a,b,c){let d=c&&c.Blob||b_.classes.Blob,e=cl(a);if(void 0===b&&d&&(b=!0),"data"===e){a=e.length?a.slice(e.length+1):a;let c=cm.exec(a);if(!c)throw new bD("Invalid URL",bD.ERR_INVALID_URL);let f=c[1],g=c[2],h=c[3],i=Buffer.from(decodeURIComponent(h),g?"base64":"utf8");if(b){if(!d)throw new bD("Blob is not supported",bD.ERR_NOT_SUPPORT);return new d([i],{type:f})}return i}throw new bD("Unsupported protocol "+e,bD.ERR_NOT_SUPPORT)}(a.url,"blob"===q,{Blob:a.env&&a.env.Blob})}catch(b){throw bD.from(b,bD.ERR_BAD_REQUEST,a)}return"text"===q?(d=d.toString(r),r&&"utf8"!==r||(d=bC.stripBOM(d))):"stream"===q&&(d=cn.default.Readable.from(d)),cb(b,c,{data:d,status:200,statusText:"OK",headers:new b7,config:a})}if(-1===cL.indexOf(A))return c(new bD("Unsupported protocol "+A,bD.ERR_BAD_REQUEST,a));let B=b7.from(a.headers).normalize();B.set("User-Agent","axios/"+ck,!1);let{onUploadProgress:C,onDownloadProgress:D}=a,E=a.maxRate;if(bC.isSpecCompliantForm(l)){let a=B.getContentType(/boundary=([-_\w\d]{10,70})/i);l=((a,b,c)=>{let{tag:d="form-data-boundary",size:e=25,boundary:f=d+"-"+b_.generateString(e,cu)}=c||{};if(!bC.isFormData(a))throw TypeError("FormData instance required");if(f.length<1||f.length>70)throw Error("boundary must be 10-70 characters long");let g=cv.encode("--"+f+"\r\n"),h=cv.encode("--"+f+"--\r\n"),i=h.byteLength,j=Array.from(a.entries()).map(([a,b])=>{let c=new cx(a,b);return i+=c.size,c});i+=g.byteLength*j.length;let k={"Content-Type":`multipart/form-data; boundary=${f}`};return Number.isFinite(i=bC.toFiniteNumber(i))&&(k["Content-Length"]=i),b&&b(k),cn.Readable.from(async function*(){for(let a of j)yield g,yield*a.encode();yield h}())})(l,a=>{B.set(a)},{tag:`axios-${ck}-boundary`,boundary:a&&a[1]||void 0})}else if(bC.isFormData(l)&&bC.isFunction(l.getHeaders)){if(B.set(l.getHeaders()),!B.hasContentLength())try{let a=await ch.default.promisify(l.getLength).call(l);Number.isFinite(a)&&a>=0&&B.setContentLength(a)}catch(a){}}else if(bC.isBlob(l)||bC.isFile(l))l.size&&B.setContentType(l.type||"application/octet-stream"),B.setContentLength(l.size||0),l=cn.default.Readable.from(ct(l));else if(l&&!bC.isStream(l)){if(Buffer.isBuffer(l));else if(bC.isArrayBuffer(l))l=Buffer.from(new Uint8Array(l));else{if(!bC.isString(l))return c(new bD("Data after transformation must be a string, an ArrayBuffer, a Buffer, or a Stream",bD.ERR_BAD_REQUEST,a));l=Buffer.from(l,"utf-8")}if(B.setContentLength(l.length,!1),a.maxBodyLength>-1&&l.length>a.maxBodyLength)return c(new bD("Request body larger than maxBodyLength limit",bD.ERR_BAD_REQUEST,a))}let F=bC.toFiniteNumber(B.getContentLength());bC.isArray(E)?(e=E[0],f=E[1]):e=f=E,l&&(C||e)&&(bC.isStream(l)||(l=cn.default.Readable.from(l,{objectMode:!1})),l=cn.default.pipeline([l,new cq({maxRate:bC.toFiniteNumber(e)})],bC.noop),C&&l.on("progress",cM(l,cD(F,cC(cE(C),!1,3))))),a.auth&&(g=(a.auth.username||"")+":"+(a.auth.password||"")),!g&&z.username&&(g=z.username+":"+z.password),g&&B.delete("authorization");try{j=bQ(z.pathname+z.search,a.params,a.paramsSerializer).replace(/^\?/,"")}catch(d){let b=Error(d.message);return b.config=a,b.url=a.url,b.exists=!0,c(b)}B.set("Accept-Encoding","gzip, compress, deflate"+(cH?", br":""),!1);let G={path:j,method:s,headers:B.toJSON(),agents:{http:a.httpAgent,https:a.httpsAgent},auth:g,protocol:A,family:n,beforeRedirect:cO,beforeRedirects:{},http2Options:p};bC.isUndefined(m)||(G.lookup=m),a.socketPath?G.socketPath=a.socketPath:(G.hostname=z.hostname.startsWith("[")?z.hostname.slice(1,-1):z.hostname,G.port=z.port,function a(b,c,d){let e=c;if(!e&&!1!==e){let a=cd.default.getProxyForUrl(d);a&&(e=new URL(a))}if(e){if(e.username&&(e.auth=(e.username||"")+":"+(e.password||"")),e.auth){(e.auth.username||e.auth.password)&&(e.auth=(e.auth.username||"")+":"+(e.auth.password||""));let a=Buffer.from(e.auth,"utf8").toString("base64");b.headers["Proxy-Authorization"]="Basic "+a}b.headers.host=b.hostname+(b.port?":"+b.port:"");let a=e.hostname||e.host;b.hostname=a,b.host=a,b.port=e.port,b.path=d,e.protocol&&(b.protocol=e.protocol.includes(":")?e.protocol:`${e.protocol}:`)}b.beforeRedirects.proxy=function(b){a(b,c,b.href)}}(G,a.proxy,A+"//"+z.hostname+(z.port?":"+z.port:"")+G.path));let H=cK.test(G.protocol);if(G.agent=H?a.httpsAgent:a.httpAgent,u?k=cR:a.transport?k=a.transport:0===a.maxRedirects?k=H?cf.default:ce.default:(a.maxRedirects&&(G.maxRedirects=a.maxRedirects),a.beforeRedirect&&(G.beforeRedirects.config=a.beforeRedirect),k=H?cJ:cI),a.maxBodyLength>-1?G.maxBodyLength=a.maxBodyLength:G.maxBodyLength=1/0,a.insecureHTTPParser&&(G.insecureHTTPParser=a.insecureHTTPParser),i=k.request(G,function(d){if(i.destroyed)return;let e=[d],g=bC.toFiniteNumber(d.headers["content-length"]);if(D||f){let a=new cq({maxRate:bC.toFiniteNumber(f)});D&&a.on("progress",cM(a,cD(g,cC(cE(D),!0,3)))),e.push(a)}let h=d,j=d.req||i;if(!1!==a.decompress&&d.headers["content-encoding"])switch(("HEAD"===s||204===d.statusCode)&&delete d.headers["content-encoding"],(d.headers["content-encoding"]||"").toLowerCase()){case"gzip":case"x-gzip":case"compress":case"x-compress":e.push(cj.default.createUnzip(cF)),delete d.headers["content-encoding"];break;case"deflate":e.push(new cz),e.push(cj.default.createUnzip(cF)),delete d.headers["content-encoding"];break;case"br":cH&&(e.push(cj.default.createBrotliDecompress(cG)),delete d.headers["content-encoding"])}h=e.length>1?cn.default.pipeline(e,bC.noop):e[0];let k={status:d.statusCode,statusText:d.statusMessage,headers:new b7(d.headers),config:a,request:j};if("stream"===q)k.data=h,cb(b,c,k);else{let d=[],e=0;h.on("data",function(b){d.push(b),e+=b.length,a.maxContentLength>-1&&e>a.maxContentLength&&(t=!0,h.destroy(),w(new bD("maxContentLength size of "+a.maxContentLength+" exceeded",bD.ERR_BAD_RESPONSE,a,j)))}),h.on("aborted",function(){if(t)return;let b=new bD("stream has been aborted",bD.ERR_BAD_RESPONSE,a,j);h.destroy(b),c(b)}),h.on("error",function(b){i.destroyed||c(bD.from(b,null,a,j))}),h.on("end",function(){try{let a=1===d.length?d[0]:Buffer.concat(d);"arraybuffer"!==q&&(a=a.toString(r),r&&"utf8"!==r||(a=bC.stripBOM(a))),k.data=a}catch(b){return c(bD.from(b,null,a,k.request,k))}cb(b,c,k)})}v.once("abort",a=>{h.destroyed||(h.emit("error",a),h.destroy())})}),v.once("abort",a=>{i.close?i.close():i.destroy(a)}),i.on("error",function(b){c(bD.from(b,null,a,i))}),i.on("socket",function(a){a.setKeepAlive(!0,6e4)}),a.timeout){let b=parseInt(a.timeout,10);if(Number.isNaN(b))return void w(new bD("error trying to parse `config.timeout` to int",bD.ERR_BAD_OPTION_VALUE,a,i));i.setTimeout(b,function(){if(h)return;let b=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded",c=a.transitional||bS;a.timeoutErrorMessage&&(b=a.timeoutErrorMessage),w(new bD(b,c.clarifyTimeoutError?bD.ETIMEDOUT:bD.ECONNABORTED,a,i))})}else i.setTimeout(0);if(bC.isStream(l)){let b=!1,c=!1;l.on("end",()=>{b=!0}),l.once("error",a=>{c=!0,i.destroy(a)}),l.on("close",()=>{b||c||w(new ca("Request stream has been aborted",a,i))}),l.pipe(i)}else l&&i.write(l),i.end()},new Promise((a,c)=>{let d,e,f=(a,b)=>{!e&&(e=!0,d&&d(a,b))},g=a=>{f(a,!0),c(a)};b(b=>{f(b),a(b)},g,a=>d=a).catch(g)})},cT=b_.hasStandardBrowserEnv?(h=new URL(b_.origin),i=b_.navigator&&/(msie|trident)/i.test(b_.navigator.userAgent),a=>(a=new URL(a,b_.origin),h.protocol===a.protocol&&h.host===a.host&&(i||h.port===a.port))):()=>!0,cU=b_.hasStandardBrowserEnv?{write(a,b,c,d,e,f,g){if("undefined"==typeof document)return;let h=[`${a}=${encodeURIComponent(b)}`];bC.isNumber(c)&&h.push(`expires=${new Date(c).toUTCString()}`),bC.isString(d)&&h.push(`path=${d}`),bC.isString(e)&&h.push(`domain=${e}`),!0===f&&h.push("secure"),bC.isString(g)&&h.push(`SameSite=${g}`),document.cookie=h.join("; ")},read(a){if("undefined"==typeof document)return null;let b=document.cookie.match(RegExp("(?:^|; )"+a+"=([^;]*)"));return b?decodeURIComponent(b[1]):null},remove(a){this.write(a,"",Date.now()-864e5,"/")}}:{write(){},read:()=>null,remove(){}},cV=a=>a instanceof b7?{...a}:a;function cW(a,b){b=b||{};let c={};function d(a,b,c,d){return bC.isPlainObject(a)&&bC.isPlainObject(b)?bC.merge.call({caseless:d},a,b):bC.isPlainObject(b)?bC.merge({},b):bC.isArray(b)?b.slice():b}function e(a,b,c,e){return bC.isUndefined(b)?bC.isUndefined(a)?void 0:d(void 0,a,c,e):d(a,b,c,e)}function f(a,b){if(!bC.isUndefined(b))return d(void 0,b)}function g(a,b){return bC.isUndefined(b)?bC.isUndefined(a)?void 0:d(void 0,a):d(void 0,b)}function h(c,e,f){return f in b?d(c,e):f in a?d(void 0,c):void 0}let i={url:f,method:f,data:f,baseURL:g,transformRequest:g,transformResponse:g,paramsSerializer:g,timeout:g,timeoutMessage:g,withCredentials:g,withXSRFToken:g,adapter:g,responseType:g,xsrfCookieName:g,xsrfHeaderName:g,onUploadProgress:g,onDownloadProgress:g,decompress:g,maxContentLength:g,maxBodyLength:g,beforeRedirect:g,transport:g,httpAgent:g,httpsAgent:g,cancelToken:g,socketPath:g,responseEncoding:g,validateStatus:h,headers:(a,b,c)=>e(cV(a),cV(b),c,!0)};return bC.forEach(Object.keys({...a,...b}),function(d){let f=i[d]||e,g=f(a[d],b[d],d);bC.isUndefined(g)&&f!==h||(c[d]=g)}),c}let cX=a=>{let b=cW({},a),{data:c,withXSRFToken:d,xsrfHeaderName:e,xsrfCookieName:f,headers:g,auth:h}=b;if(b.headers=g=b7.from(g),b.url=bQ(cc(b.baseURL,b.url,b.allowAbsoluteUrls),a.params,a.paramsSerializer),h&&g.set("Authorization","Basic "+btoa((h.username||"")+":"+(h.password?unescape(encodeURIComponent(h.password)):""))),bC.isFormData(c)){if(b_.hasStandardBrowserEnv||b_.hasStandardBrowserWebWorkerEnv)g.setContentType(void 0);else if(bC.isFunction(c.getHeaders)){let a=c.getHeaders(),b=["content-type","content-length"];Object.entries(a).forEach(([a,c])=>{b.includes(a.toLowerCase())&&g.set(a,c)})}}if(b_.hasStandardBrowserEnv&&(d&&bC.isFunction(d)&&(d=d(b)),d||!1!==d&&cT(b.url))){let a=e&&f&&cU.read(f);a&&g.set(e,a)}return b},cY="undefined"!=typeof XMLHttpRequest&&function(a){return new Promise(function(b,c){let d,e,f,g,h,i=cX(a),j=i.data,k=b7.from(i.headers).normalize(),{responseType:l,onUploadProgress:m,onDownloadProgress:n}=i;function o(){g&&g(),h&&h(),i.cancelToken&&i.cancelToken.unsubscribe(d),i.signal&&i.signal.removeEventListener("abort",d)}let p=new XMLHttpRequest;function q(){if(!p)return;let d=b7.from("getAllResponseHeaders"in p&&p.getAllResponseHeaders());cb(function(a){b(a),o()},function(a){c(a),o()},{data:l&&"text"!==l&&"json"!==l?p.response:p.responseText,status:p.status,statusText:p.statusText,headers:d,config:a,request:p}),p=null}p.open(i.method.toUpperCase(),i.url,!0),p.timeout=i.timeout,"onloadend"in p?p.onloadend=q:p.onreadystatechange=function(){!p||4!==p.readyState||(0!==p.status||p.responseURL&&0===p.responseURL.indexOf("file:"))&&setTimeout(q)},p.onabort=function(){p&&(c(new bD("Request aborted",bD.ECONNABORTED,a,p)),p=null)},p.onerror=function(b){let d=new bD(b&&b.message?b.message:"Network Error",bD.ERR_NETWORK,a,p);d.event=b||null,c(d),p=null},p.ontimeout=function(){let b=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded",d=i.transitional||bS;i.timeoutErrorMessage&&(b=i.timeoutErrorMessage),c(new bD(b,d.clarifyTimeoutError?bD.ETIMEDOUT:bD.ECONNABORTED,a,p)),p=null},void 0===j&&k.setContentType(null),"setRequestHeader"in p&&bC.forEach(k.toJSON(),function(a,b){p.setRequestHeader(b,a)}),bC.isUndefined(i.withCredentials)||(p.withCredentials=!!i.withCredentials),l&&"json"!==l&&(p.responseType=i.responseType),n&&([f,h]=cC(n,!0),p.addEventListener("progress",f)),m&&p.upload&&([e,g]=cC(m),p.upload.addEventListener("progress",e),p.upload.addEventListener("loadend",g)),(i.cancelToken||i.signal)&&(d=b=>{p&&(c(!b||b.type?new ca(null,a,p):b),p.abort(),p=null)},i.cancelToken&&i.cancelToken.subscribe(d),i.signal&&(i.signal.aborted?d():i.signal.addEventListener("abort",d)));let r=cl(i.url);r&&-1===b_.protocols.indexOf(r)?c(new bD("Unsupported protocol "+r+":",bD.ERR_BAD_REQUEST,a)):p.send(j||null)})},cZ=function*(a,b){let c,d=a.byteLength;if(!b||d<b)return void(yield a);let e=0;for(;e<d;)c=e+b,yield a.slice(e,c),e=c},c$=async function*(a,b){for await(let c of c_(a))yield*cZ(c,b)},c_=async function*(a){if(a[Symbol.asyncIterator])return void(yield*a);let b=a.getReader();try{for(;;){let{done:a,value:c}=await b.read();if(a)break;yield c}}finally{await b.cancel()}},c0=(a,b,c,d)=>{let e,f=c$(a,b),g=0,h=a=>{!e&&(e=!0,d&&d(a))};return new ReadableStream({async pull(a){try{let{done:b,value:d}=await f.next();if(b){h(),a.close();return}let e=d.byteLength;if(c){let a=g+=e;c(a)}a.enqueue(new Uint8Array(d))}catch(a){throw h(a),a}},cancel:a=>(h(a),f.return())},{highWaterMark:2})},{isFunction:c1}=bC,c2=(({Request:a,Response:b})=>({Request:a,Response:b}))(bC.global),{ReadableStream:c3,TextEncoder:c4}=bC.global,c5=(a,...b)=>{try{return!!a(...b)}catch(a){return!1}},c6=a=>{let b,{fetch:c,Request:d,Response:e}=a=bC.merge.call({skipUndefined:!0},c2,a),f=c?c1(c):"function"==typeof fetch,g=c1(d),h=c1(e);if(!f)return!1;let i=f&&c1(c3),j=f&&("function"==typeof c4?(b=new c4,a=>b.encode(a)):async a=>new Uint8Array(await new d(a).arrayBuffer())),k=g&&i&&c5(()=>{let a=!1,b=new d(b_.origin,{body:new c3,method:"POST",get duplex(){return a=!0,"half"}}).headers.has("Content-Type");return a&&!b}),l=h&&i&&c5(()=>bC.isReadableStream(new e("").body)),m={stream:l&&(a=>a.body)};f&&["text","arrayBuffer","blob","formData","stream"].forEach(a=>{m[a]||(m[a]=(b,c)=>{let d=b&&b[a];if(d)return d.call(b);throw new bD(`Response type '${a}' is not supported`,bD.ERR_NOT_SUPPORT,c)})});let n=async a=>{if(null==a)return 0;if(bC.isBlob(a))return a.size;if(bC.isSpecCompliantForm(a)){let b=new d(b_.origin,{method:"POST",body:a});return(await b.arrayBuffer()).byteLength}return bC.isArrayBufferView(a)||bC.isArrayBuffer(a)?a.byteLength:(bC.isURLSearchParams(a)&&(a+=""),bC.isString(a))?(await j(a)).byteLength:void 0},o=async(a,b)=>{let c=bC.toFiniteNumber(a.getContentLength());return null==c?n(b):c};return async a=>{let b,{url:f,method:h,data:i,signal:j,cancelToken:n,timeout:p,onDownloadProgress:q,onUploadProgress:r,responseType:s,headers:t,withCredentials:u="same-origin",fetchOptions:v}=cX(a),w=c||fetch;s=s?(s+"").toLowerCase():"text";let x=((a,b)=>{let{length:c}=a=a?a.filter(Boolean):[];if(b||c){let c,d=new AbortController,e=function(a){if(!c){c=!0,g();let b=a instanceof Error?a:this.reason;d.abort(b instanceof bD?b:new ca(b instanceof Error?b.message:b))}},f=b&&setTimeout(()=>{f=null,e(new bD(`timeout ${b} of ms exceeded`,bD.ETIMEDOUT))},b),g=()=>{a&&(f&&clearTimeout(f),f=null,a.forEach(a=>{a.unsubscribe?a.unsubscribe(e):a.removeEventListener("abort",e)}),a=null)};a.forEach(a=>a.addEventListener("abort",e));let{signal:h}=d;return h.unsubscribe=()=>bC.asap(g),h}})([j,n&&n.toAbortSignal()],p),y=null,z=x&&x.unsubscribe&&(()=>{x.unsubscribe()});try{if(r&&k&&"get"!==h&&"head"!==h&&0!==(b=await o(t,i))){let a,c=new d(f,{method:"POST",body:i,duplex:"half"});if(bC.isFormData(i)&&(a=c.headers.get("content-type"))&&t.setContentType(a),c.body){let[a,d]=cD(b,cC(cE(r)));i=c0(c.body,65536,a,d)}}bC.isString(u)||(u=u?"include":"omit");let c=g&&"credentials"in d.prototype,j={...v,signal:x,method:h.toUpperCase(),headers:t.normalize().toJSON(),body:i,duplex:"half",credentials:c?u:void 0};y=g&&new d(f,j);let n=await (g?w(y,v):w(f,j)),p=l&&("stream"===s||"response"===s);if(l&&(q||p&&z)){let a={};["status","statusText","headers"].forEach(b=>{a[b]=n[b]});let b=bC.toFiniteNumber(n.headers.get("content-length")),[c,d]=q&&cD(b,cC(cE(q),!0))||[];n=new e(c0(n.body,65536,c,()=>{d&&d(),z&&z()}),a)}s=s||"text";let A=await m[bC.findKey(m,s)||"text"](n,a);return!p&&z&&z(),await new Promise((b,c)=>{cb(b,c,{data:A,headers:b7.from(n.headers),status:n.status,statusText:n.statusText,config:a,request:y})})}catch(b){if(z&&z(),b&&"TypeError"===b.name&&/Load failed|fetch/i.test(b.message))throw Object.assign(new bD("Network Error",bD.ERR_NETWORK,a,y),{cause:b.cause||b});throw bD.from(b,b&&b.code,a,y)}}},c7=new Map,c8=a=>{let b=a&&a.env||{},{fetch:c,Request:d,Response:e}=b,f=[d,e,c],g=f.length,h,i,j=c7;for(;g--;)h=f[g],void 0===(i=j.get(h))&&j.set(h,i=g?new Map:c6(b)),j=i;return i};c8();let c9={http:cS,xhr:cY,fetch:{get:c8}};bC.forEach(c9,(a,b)=>{if(a){try{Object.defineProperty(a,"name",{value:b})}catch(a){}Object.defineProperty(a,"adapterName",{value:b})}});let da=a=>`- ${a}`,db=a=>bC.isFunction(a)||null===a||!1===a,dc=function(a,b){let c,d,{length:e}=a=bC.isArray(a)?a:[a],f={};for(let g=0;g<e;g++){let e;if(d=c=a[g],!db(c)&&void 0===(d=c9[(e=String(c)).toLowerCase()]))throw new bD(`Unknown adapter '${e}'`);if(d&&(bC.isFunction(d)||(d=d.get(b))))break;f[e||"#"+g]=d}if(!d){let a=Object.entries(f).map(([a,b])=>`adapter ${a} `+(!1===b?"is not supported by the environment":"is not available in the build"));throw new bD("There is no suitable adapter to dispatch the request "+(e?a.length>1?"since :\n"+a.map(da).join("\n"):" "+da(a[0]):"as no adapter specified"),"ERR_NOT_SUPPORT")}return d};function dd(a){if(a.cancelToken&&a.cancelToken.throwIfRequested(),a.signal&&a.signal.aborted)throw new ca(null,a)}function de(a){return dd(a),a.headers=b7.from(a.headers),a.data=b8.call(a,a.transformRequest),-1!==["post","put","patch"].indexOf(a.method)&&a.headers.setContentType("application/x-www-form-urlencoded",!1),dc(a.adapter||b1.adapter,a)(a).then(function(b){return dd(a),b.data=b8.call(a,a.transformResponse,b),b.headers=b7.from(b.headers),b},function(b){return!b9(b)&&(dd(a),b&&b.response&&(b.response.data=b8.call(a,a.transformResponse,b.response),b.response.headers=b7.from(b.response.headers))),Promise.reject(b)})}let df={};["object","boolean","number","function","string","symbol"].forEach((a,b)=>{df[a]=function(c){return typeof c===a||"a"+(b<1?"n ":" ")+a}});let dg={};df.transitional=function(a,b,c){function d(a,b){return"[Axios v"+ck+"] Transitional option '"+a+"'"+b+(c?". "+c:"")}return(c,e,f)=>{if(!1===a)throw new bD(d(e," has been removed"+(b?" in "+b:"")),bD.ERR_DEPRECATED);return b&&!dg[e]&&(dg[e]=!0,console.warn(d(e," has been deprecated since v"+b+" and will be removed in the near future"))),!a||a(c,e,f)}},df.spelling=function(a){return(b,c)=>(console.warn(`${c} is likely a misspelling of ${a}`),!0)};let dh=function(a,b,c){if("object"!=typeof a)throw new bD("options must be an object",bD.ERR_BAD_OPTION_VALUE);let d=Object.keys(a),e=d.length;for(;e-- >0;){let f=d[e],g=b[f];if(g){let b=a[f],c=void 0===b||g(b,f,a);if(!0!==c)throw new bD("option "+f+" must be "+c,bD.ERR_BAD_OPTION_VALUE);continue}if(!0!==c)throw new bD("Unknown option "+f,bD.ERR_BAD_OPTION)}};class di{constructor(a){this.defaults=a||{},this.interceptors={request:new bR,response:new bR}}async request(a,b){try{return await this._request(a,b)}catch(a){if(a instanceof Error){let b={};Error.captureStackTrace?Error.captureStackTrace(b):b=Error();let c=b.stack?b.stack.replace(/^.+\n/,""):"";try{a.stack?c&&!String(a.stack).endsWith(c.replace(/^.+\n.+\n/,""))&&(a.stack+="\n"+c):a.stack=c}catch(a){}}throw a}}_request(a,b){let c,d;"string"==typeof a?(b=b||{}).url=a:b=a||{};let{transitional:e,paramsSerializer:f,headers:g}=b=cW(this.defaults,b);void 0!==e&&dh(e,{silentJSONParsing:df.transitional(df.boolean),forcedJSONParsing:df.transitional(df.boolean),clarifyTimeoutError:df.transitional(df.boolean)},!1),null!=f&&(bC.isFunction(f)?b.paramsSerializer={serialize:f}:dh(f,{encode:df.function,serialize:df.function},!0)),void 0!==b.allowAbsoluteUrls||(void 0!==this.defaults.allowAbsoluteUrls?b.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:b.allowAbsoluteUrls=!0),dh(b,{baseUrl:df.spelling("baseURL"),withXsrfToken:df.spelling("withXSRFToken")},!0),b.method=(b.method||this.defaults.method||"get").toLowerCase();let h=g&&bC.merge(g.common,g[b.method]);g&&bC.forEach(["delete","get","head","post","put","patch","common"],a=>{delete g[a]}),b.headers=b7.concat(h,g);let i=[],j=!0;this.interceptors.request.forEach(function(a){("function"!=typeof a.runWhen||!1!==a.runWhen(b))&&(j=j&&a.synchronous,i.unshift(a.fulfilled,a.rejected))});let k=[];this.interceptors.response.forEach(function(a){k.push(a.fulfilled,a.rejected)});let l=0;if(!j){let a=[de.bind(this),void 0];for(a.unshift(...i),a.push(...k),d=a.length,c=Promise.resolve(b);l<d;)c=c.then(a[l++],a[l++]);return c}d=i.length;let m=b;for(;l<d;){let a=i[l++],b=i[l++];try{m=a(m)}catch(a){b.call(this,a);break}}try{c=de.call(this,m)}catch(a){return Promise.reject(a)}for(l=0,d=k.length;l<d;)c=c.then(k[l++],k[l++]);return c}getUri(a){return bQ(cc((a=cW(this.defaults,a)).baseURL,a.url,a.allowAbsoluteUrls),a.params,a.paramsSerializer)}}bC.forEach(["delete","get","head","options"],function(a){di.prototype[a]=function(b,c){return this.request(cW(c||{},{method:a,url:b,data:(c||{}).data}))}}),bC.forEach(["post","put","patch"],function(a){function b(b){return function(c,d,e){return this.request(cW(e||{},{method:a,headers:b?{"Content-Type":"multipart/form-data"}:{},url:c,data:d}))}}di.prototype[a]=b(),di.prototype[a+"Form"]=b(!0)});class dj{constructor(a){let b;if("function"!=typeof a)throw TypeError("executor must be a function.");this.promise=new Promise(function(a){b=a});const c=this;this.promise.then(a=>{if(!c._listeners)return;let b=c._listeners.length;for(;b-- >0;)c._listeners[b](a);c._listeners=null}),this.promise.then=a=>{let b,d=new Promise(a=>{c.subscribe(a),b=a}).then(a);return d.cancel=function(){c.unsubscribe(b)},d},a(function(a,d,e){c.reason||(c.reason=new ca(a,d,e),b(c.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(a){this.reason?a(this.reason):this._listeners?this._listeners.push(a):this._listeners=[a]}unsubscribe(a){if(!this._listeners)return;let b=this._listeners.indexOf(a);-1!==b&&this._listeners.splice(b,1)}toAbortSignal(){let a=new AbortController,b=b=>{a.abort(b)};return this.subscribe(b),a.signal.unsubscribe=()=>this.unsubscribe(b),a.signal}static source(){let a;return{token:new dj(function(b){a=b}),cancel:a}}}let dk={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(dk).forEach(([a,b])=>{dk[b]=a});let dl=function a(b){let c=new di(b),d=a0(di.prototype.request,c);return bC.extend(d,di.prototype,c,{allOwnKeys:!0}),bC.extend(d,c,null,{allOwnKeys:!0}),d.create=function(c){return a(cW(b,c))},d}(b1);dl.Axios=di,dl.CanceledError=ca,dl.CancelToken=dj,dl.isCancel=b9,dl.VERSION=ck,dl.toFormData=bL,dl.AxiosError=bD,dl.Cancel=dl.CanceledError,dl.all=function(a){return Promise.all(a)},dl.spread=function(a){return function(b){return a.apply(null,b)}},dl.isAxiosError=function(a){return bC.isObject(a)&&!0===a.isAxiosError},dl.mergeConfig=cW,dl.AxiosHeaders=b7,dl.formToJSON=a=>b0(bC.isHTMLForm(a)?new FormData(a):a),dl.getAdapter=dc,dl.HttpStatusCode=dk,dl.default=dl;var dm=a.i(47033);let dn=process.env.NEXT_PUBLIC_BACKEND_URL||"http://localhost:8000",dp=dl.create({baseURL:dn,headers:{"Content-Type":"application/json"}});async function dq(a){return(await dp.post("/api/tokens",a)).data}function dr({onJoin:a,user:b}){let[c,d]=(0,t.useState)(""),[e,f]=(0,t.useState)(!1),[g,h]=(0,t.useState)(null),i=b?.name||b?.preferred_username||"User",j=async b=>{if(b.preventDefault(),c.trim()){f(!0),h(null);try{let b=await dq({room_name:c.trim(),participant_name:i});a({serverUrl:b.url,token:b.token,roomName:c.trim(),participantName:i})}catch(a){console.error("Failed to generate token:",a),h(a?.message||"Failed to generate token. Please try again.")}finally{f(!1)}}};return(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center p-4",children:(0,s.jsxs)(aQ,{className:"w-full max-w-md bg-card border-border",children:[(0,s.jsxs)(aR,{className:"text-center",children:[(0,s.jsx)("div",{className:"mx-auto mb-4 flex h-16 w-16 items-center justify-center rounded-full bg-primary/10",children:(0,s.jsx)(aZ,{className:"h-8 w-8 text-primary"})}),(0,s.jsx)(aS,{className:"text-2xl font-bold text-foreground",children:"Join Video Chat"}),(0,s.jsx)(aT,{className:"text-muted-foreground",children:"Enter a room name to start video conferencing"})]}),(0,s.jsx)(aU,{children:(0,s.jsxs)("form",{onSubmit:j,className:"space-y-4",children:[b&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(aP,{className:"text-foreground",children:"Your Name"}),(0,s.jsx)("div",{className:"px-3 py-2 rounded-md border border-border bg-muted text-muted-foreground",children:i})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(aP,{htmlFor:"roomName",className:"text-foreground",children:"Room Name"}),(0,s.jsx)(aM,{id:"roomName",type:"text",placeholder:"my-meeting-room",value:c,onChange:a=>d(a.target.value),required:!0,className:"bg-input border-border text-foreground placeholder:text-muted-foreground",disabled:e})]}),g&&(0,s.jsx)("div",{className:"p-3 rounded-md bg-destructive/10 text-destructive text-sm",children:g}),(0,s.jsx)(aL,{type:"submit",className:"w-full bg-primary text-primary-foreground hover:bg-primary/90",disabled:!c.trim()||e,children:e?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(a_,{className:"mr-2 h-4 w-4 animate-spin"}),"Connecting..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(a$,{className:"mr-2 h-4 w-4"}),"Join Room"]})})]})})]})})}dp.interceptors.request.use(a=>{let b=(0,dm.getToken)();return b&&(a.headers.Authorization=`Bearer ${b}`),a}),dp.interceptors.response.use(a=>a,a=>{if(a.response){let b=a.response.data?.detail||a.response.data?.message||a.message;a.message=b}return Promise.reject(a)});var ds=Object.defineProperty,dt=(a,b,c)=>{let d;return(d="symbol"!=typeof b?b+"":b)in a?ds(a,d,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[d]=c};class du{constructor(){dt(this,"_locking"),dt(this,"_locks"),this._locking=Promise.resolve(),this._locks=0}isLocked(){return this._locks>0}lock(){let a;this._locks+=1;let b=new Promise(b=>a=()=>{this._locks-=1,b()}),c=this._locking.then(()=>a);return this._locking=this._locking.then(()=>b),c}}function dv(a,b){if(!a)throw Error(b)}function dw(a){if("number"!=typeof a)throw Error("invalid int 32: "+typeof a);if(!Number.isInteger(a)||a>0x7fffffff||a<-0x80000000)throw Error("invalid int 32: "+a)}function dx(a){if("number"!=typeof a)throw Error("invalid uint 32: "+typeof a);if(!Number.isInteger(a)||a>0xffffffff||a<0)throw Error("invalid uint 32: "+a)}function dy(a){if("number"!=typeof a)throw Error("invalid float 32: "+typeof a);if(Number.isFinite(a)&&(a>34028234663852886e22||a<-34028234663852886e22))throw Error("invalid float 32: "+a)}let dz=Symbol("@bufbuild/protobuf/enum-type");function dA(a,b,c,d){a[dz]=dB(b,c.map(b=>({no:b.no,name:b.name,localName:a[b.no]})))}function dB(a,b,c){let d=Object.create(null),e=Object.create(null),f=[];for(let a of b){let b=dC(a);f.push(b),d[a.name]=b,e[a.no]=b}return{typeName:a,values:f,findName:a=>d[a],findNumber:a=>e[a]}}function dC(a){return"localName"in a?a:Object.assign(Object.assign({},a),{localName:a.name})}class dD{equals(a){return this.getType().runtime.util.equals(this.getType(),this,a)}clone(){return this.getType().runtime.util.clone(this)}fromBinary(a,b){let c=this.getType().runtime.bin,d=c.makeReadOptions(b);return c.readMessage(this,d.readerFactory(a),a.byteLength,d),this}fromJson(a,b){let c=this.getType(),d=c.runtime.json,e=d.makeReadOptions(b);return d.readMessage(c,a,e,this),this}fromJsonString(a,b){let c;try{c=JSON.parse(a)}catch(a){throw Error("cannot decode ".concat(this.getType().typeName," from JSON: ").concat(a instanceof Error?a.message:String(a)))}return this.fromJson(c,b)}toBinary(a){let b=this.getType().runtime.bin,c=b.makeWriteOptions(a),d=c.writerFactory();return b.writeMessage(this,d,c),d.finish()}toJson(a){let b=this.getType().runtime.json,c=b.makeWriteOptions(a);return b.writeMessage(this,c)}toJsonString(a){var b;return JSON.stringify(this.toJson(a),null,null!=(b=null==a?void 0:a.prettySpaces)?b:0)}toJSON(){return this.toJson({emitDefaultValues:!0})}getType(){return Object.getPrototypeOf(this).constructor}}function dE(){let a=0,b=0;for(let c=0;c<28;c+=7){let d=this.buf[this.pos++];if(a|=(127&d)<<c,(128&d)==0)return this.assertBounds(),[a,b]}let c=this.buf[this.pos++];if(a|=(15&c)<<28,b=(112&c)>>4,(128&c)==0)return this.assertBounds(),[a,b];for(let c=3;c<=31;c+=7){let d=this.buf[this.pos++];if(b|=(127&d)<<c,(128&d)==0)return this.assertBounds(),[a,b]}throw Error("invalid varint")}function dF(a,b,c){for(let d=0;d<28;d+=7){let e=a>>>d,f=e>>>7!=0||0!=b,g=(f?128|e:e)&255;if(c.push(g),!f)return}let d=a>>>28&15|(7&b)<<4,e=b>>3!=0;if(c.push((e?128|d:d)&255),e){for(let a=3;a<31;a+=7){let d=b>>>a,e=d>>>7!=0,f=(e?128|d:d)&255;if(c.push(f),!e)return}c.push(b>>>31&1)}}function dG(a){let b="-"===a[0];b&&(a=a.slice(1));let c=0,d=0;function e(b,e){let f=Number(a.slice(b,e));d*=1e6,(c=1e6*c+f)>=0x100000000&&(d+=c/0x100000000|0,c%=0x100000000)}return e(-24,-18),e(-18,-12),e(-12,-6),e(-6),b?dJ(c,d):dI(c,d)}function dH(a,b){if({lo:a,hi:b}={lo:a>>>0,hi:b>>>0},b<=2097151)return String(0x100000000*b+a);let c=0xffffff&a,d=(a>>>24|b<<8)&0xffffff,e=b>>16&65535,f=c+6777216*d+6710656*e,g=d+8147497*e,h=2*e;return f>=1e7&&(g+=Math.floor(f/1e7),f%=1e7),g>=1e7&&(h+=Math.floor(g/1e7),g%=1e7),h.toString()+dK(g)+dK(f)}function dI(a,b){return{lo:0|a,hi:0|b}}function dJ(a,b){return b=~b,a?a=~a+1:b+=1,dI(a,b)}let dK=a=>{let b=String(a);return"0000000".slice(b.length)+b};function dL(a,b){if(a>=0){for(;a>127;)b.push(127&a|128),a>>>=7;b.push(a)}else{for(let c=0;c<9;c++)b.push(127&a|128),a>>=7;b.push(1)}}function dM(){let a=this.buf[this.pos++],b=127&a;if((128&a)==0||(b|=(127&(a=this.buf[this.pos++]))<<7,(128&a)==0)||(b|=(127&(a=this.buf[this.pos++]))<<14,(128&a)==0)||(b|=(127&(a=this.buf[this.pos++]))<<21,(128&a)==0))return this.assertBounds(),b;b|=(15&(a=this.buf[this.pos++]))<<28;for(let b=5;(128&a)!=0&&b<10;b++)a=this.buf[this.pos++];if((128&a)!=0)throw Error("invalid varint");return this.assertBounds(),b>>>0}let dN=function(){let a=new DataView(new ArrayBuffer(8));if("function"==typeof BigInt&&"function"==typeof a.getBigInt64&&"function"==typeof a.getBigUint64&&"function"==typeof a.setBigInt64&&"function"==typeof a.setBigUint64&&("object"!=typeof process||"object"!=typeof process.env||"1"!==process.env.BUF_BIGINT_DISABLE)){let b=BigInt("-9223372036854775808"),c=BigInt("9223372036854775807"),d=BigInt("0"),e=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(a){let d="bigint"==typeof a?a:BigInt(a);if(d>c||d<b)throw Error("int64 invalid: ".concat(a));return d},uParse(a){let b="bigint"==typeof a?a:BigInt(a);if(b>e||b<d)throw Error("uint64 invalid: ".concat(a));return b},enc(b){return a.setBigInt64(0,this.parse(b),!0),{lo:a.getInt32(0,!0),hi:a.getInt32(4,!0)}},uEnc(b){return a.setBigInt64(0,this.uParse(b),!0),{lo:a.getInt32(0,!0),hi:a.getInt32(4,!0)}},dec:(b,c)=>(a.setInt32(0,b,!0),a.setInt32(4,c,!0),a.getBigInt64(0,!0)),uDec:(b,c)=>(a.setInt32(0,b,!0),a.setInt32(4,c,!0),a.getBigUint64(0,!0))}}let b=a=>dv(/^-?[0-9]+$/.test(a),"int64 invalid: ".concat(a)),c=a=>dv(/^[0-9]+$/.test(a),"uint64 invalid: ".concat(a));return{zero:"0",supported:!1,parse:a=>("string"!=typeof a&&(a=a.toString()),b(a),a),uParse:a=>("string"!=typeof a&&(a=a.toString()),c(a),a),enc:a=>("string"!=typeof a&&(a=a.toString()),b(a),dG(a)),uEnc:a=>("string"!=typeof a&&(a=a.toString()),c(a),dG(a)),dec:(a,b)=>{let c,d,e;return(d=0x80000000&(c=dI(a,b)).hi)&&(c=dJ(c.lo,c.hi)),e=dH(c.lo,c.hi),d?"-"+e:e},uDec:(a,b)=>dH(a,b)}}();function dO(a,b,c){if(b===c)return!0;if(a==k5.BYTES){if(!(b instanceof Uint8Array)||!(c instanceof Uint8Array)||b.length!==c.length)return!1;for(let a=0;a<b.length;a++)if(b[a]!==c[a])return!1;return!0}switch(a){case k5.UINT64:case k5.FIXED64:case k5.INT64:case k5.SFIXED64:case k5.SINT64:return b==c}return!1}function dP(a,b){switch(a){case k5.BOOL:return!1;case k5.UINT64:case k5.FIXED64:case k5.INT64:case k5.SFIXED64:case k5.SINT64:return 0==b?dN.zero:"0";case k5.DOUBLE:case k5.FLOAT:return 0;case k5.BYTES:return new Uint8Array(0);case k5.STRING:return"";default:return 0}}function dQ(a,b){switch(a){case k5.BOOL:return!1===b;case k5.STRING:return""===b;case k5.BYTES:return b instanceof Uint8Array&&!b.byteLength;default:return 0==b}}(kx=k5||(k5={}))[kx.DOUBLE=1]="DOUBLE",kx[kx.FLOAT=2]="FLOAT",kx[kx.INT64=3]="INT64",kx[kx.UINT64=4]="UINT64",kx[kx.INT32=5]="INT32",kx[kx.FIXED64=6]="FIXED64",kx[kx.FIXED32=7]="FIXED32",kx[kx.BOOL=8]="BOOL",kx[kx.STRING=9]="STRING",kx[kx.BYTES=12]="BYTES",kx[kx.UINT32=13]="UINT32",kx[kx.SFIXED32=15]="SFIXED32",kx[kx.SFIXED64=16]="SFIXED64",kx[kx.SINT32=17]="SINT32",kx[kx.SINT64=18]="SINT64",(ky=k6||(k6={}))[ky.BIGINT=0]="BIGINT",ky[ky.STRING=1]="STRING",(kz=k7||(k7={}))[kz.Varint=0]="Varint",kz[kz.Bit64=1]="Bit64",kz[kz.LengthDelimited=2]="LengthDelimited",kz[kz.StartGroup=3]="StartGroup",kz[kz.EndGroup=4]="EndGroup",kz[kz.Bit32=5]="Bit32";class dR{constructor(a){this.stack=[],this.textEncoder=null!=a?a:new TextEncoder,this.chunks=[],this.buf=[]}finish(){this.chunks.push(new Uint8Array(this.buf));let a=0;for(let b=0;b<this.chunks.length;b++)a+=this.chunks[b].length;let b=new Uint8Array(a),c=0;for(let a=0;a<this.chunks.length;a++)b.set(this.chunks[a],c),c+=this.chunks[a].length;return this.chunks=[],b}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let a=this.finish(),b=this.stack.pop();if(!b)throw Error("invalid state, fork stack empty");return this.chunks=b.chunks,this.buf=b.buf,this.uint32(a.byteLength),this.raw(a)}tag(a,b){return this.uint32((a<<3|b)>>>0)}raw(a){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(a),this}uint32(a){for(dx(a);a>127;)this.buf.push(127&a|128),a>>>=7;return this.buf.push(a),this}int32(a){return dw(a),dL(a,this.buf),this}bool(a){return this.buf.push(+!!a),this}bytes(a){return this.uint32(a.byteLength),this.raw(a)}string(a){let b=this.textEncoder.encode(a);return this.uint32(b.byteLength),this.raw(b)}float(a){dy(a);let b=new Uint8Array(4);return new DataView(b.buffer).setFloat32(0,a,!0),this.raw(b)}double(a){let b=new Uint8Array(8);return new DataView(b.buffer).setFloat64(0,a,!0),this.raw(b)}fixed32(a){dx(a);let b=new Uint8Array(4);return new DataView(b.buffer).setUint32(0,a,!0),this.raw(b)}sfixed32(a){dw(a);let b=new Uint8Array(4);return new DataView(b.buffer).setInt32(0,a,!0),this.raw(b)}sint32(a){return dw(a),dL(a=(a<<1^a>>31)>>>0,this.buf),this}sfixed64(a){let b=new Uint8Array(8),c=new DataView(b.buffer),d=dN.enc(a);return c.setInt32(0,d.lo,!0),c.setInt32(4,d.hi,!0),this.raw(b)}fixed64(a){let b=new Uint8Array(8),c=new DataView(b.buffer),d=dN.uEnc(a);return c.setInt32(0,d.lo,!0),c.setInt32(4,d.hi,!0),this.raw(b)}int64(a){let b=dN.enc(a);return dF(b.lo,b.hi,this.buf),this}sint64(a){let b=dN.enc(a),c=b.hi>>31;return dF(b.lo<<1^c,(b.hi<<1|b.lo>>>31)^c,this.buf),this}uint64(a){let b=dN.uEnc(a);return dF(b.lo,b.hi,this.buf),this}}class dS{constructor(a,b){this.varint64=dE,this.uint32=dM,this.buf=a,this.len=a.length,this.pos=0,this.view=new DataView(a.buffer,a.byteOffset,a.byteLength),this.textDecoder=null!=b?b:new TextDecoder}tag(){let a=this.uint32(),b=a>>>3,c=7&a;if(b<=0||c<0||c>5)throw Error("illegal tag: field no "+b+" wire type "+c);return[b,c]}skip(a,b){let c=this.pos;switch(a){case k7.Varint:for(;128&this.buf[this.pos++];);break;case k7.Bit64:this.pos+=4;case k7.Bit32:this.pos+=4;break;case k7.LengthDelimited:let d=this.uint32();this.pos+=d;break;case k7.StartGroup:for(;;){let[a,c]=this.tag();if(c===k7.EndGroup){if(void 0!==b&&a!==b)throw Error("invalid end group tag");break}this.skip(c,a)}break;default:throw Error("cant skip wire type "+a)}return this.assertBounds(),this.buf.subarray(c,this.pos)}assertBounds(){if(this.pos>this.len)throw RangeError("premature EOF")}int32(){return 0|this.uint32()}sint32(){let a=this.uint32();return a>>>1^-(1&a)}int64(){return dN.dec(...this.varint64())}uint64(){return dN.uDec(...this.varint64())}sint64(){let[a,b]=this.varint64(),c=-(1&a);return a=(a>>>1|(1&b)<<31)^c,b=b>>>1^c,dN.dec(a,b)}bool(){let[a,b]=this.varint64();return 0!==a||0!==b}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return dN.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return dN.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let a=this.uint32(),b=this.pos;return this.pos+=a,this.assertBounds(),this.buf.subarray(b,b+a)}string(){return this.textDecoder.decode(this.bytes())}}function dT(a){let b=a.field.localName,c=Object.create(null);return c[b]=function(a){let b=a.field;if(b.repeated)return[];if(void 0!==b.default)return b.default;switch(b.kind){case"enum":return b.T.values[0].no;case"scalar":return dP(b.T,b.L);case"message":let c=b.T,d=new c;return c.fieldWrapper?c.fieldWrapper.unwrapField(d):d;case"map":throw"map fields are not allowed to be extensions"}}(a),[c,()=>c[b]]}let dU="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),dV=[];for(let a=0;a<dU.length;a++)dV[dU[a].charCodeAt(0)]=a;dV[45]=dU.indexOf("+"),dV[95]=dU.indexOf("/");let dW={dec(a){let b=3*a.length/4;"="==a[a.length-2]?b-=2:"="==a[a.length-1]&&(b-=1);let c=new Uint8Array(b),d=0,e=0,f,g=0;for(let b=0;b<a.length;b++){if(void 0===(f=dV[a.charCodeAt(b)]))switch(a[b]){case"=":e=0;case"\n":case"\r":case"	":case" ":continue;default:throw Error("invalid base64 string.")}switch(e){case 0:g=f,e=1;break;case 1:c[d++]=g<<2|(48&f)>>4,g=f,e=2;break;case 2:c[d++]=(15&g)<<4|(60&f)>>2,g=f,e=3;break;case 3:c[d++]=(3&g)<<6|f,e=0}}if(1==e)throw Error("invalid base64 string.");return c.subarray(0,d)},enc(a){let b="",c=0,d,e=0;for(let f=0;f<a.length;f++)switch(d=a[f],c){case 0:b+=dU[d>>2],e=(3&d)<<4,c=1;break;case 1:b+=dU[e|d>>4],e=(15&d)<<2,c=2;break;case 2:b+=dU[e|d>>6],b+=dU[63&d],c=0}return c&&(b+=dU[e],b+="=",1==c&&(b+="=")),b}};function dX(a,b){let c=a.getType();return b.extendee.typeName===c.typeName&&!!c.runtime.bin.listUnknownFields(a).find(a=>a.no==b.field.no)}function dY(a,b){dv(a.extendee.typeName==b.getType().typeName,"extension ".concat(a.typeName," can only be applied to message ").concat(a.extendee.typeName))}function dZ(a,b){let c=a.localName;if(a.repeated)return b[c].length>0;if(a.oneof)return b[a.oneof.localName].case===c;switch(a.kind){case"enum":case"scalar":if(a.opt||a.req)return void 0!==b[c];if("enum"==a.kind)return b[c]!==a.T.values[0].no;return!dQ(a.T,b[c]);case"message":return void 0!==b[c];case"map":return Object.keys(b[c]).length>0}}function d$(a,b){let c=a.localName,d=!a.opt&&!a.req;if(a.repeated)b[c]=[];else if(a.oneof)b[a.oneof.localName]={case:void 0};else switch(a.kind){case"map":b[c]={};break;case"enum":b[c]=d?a.T.values[0].no:void 0;break;case"scalar":b[c]=d?dP(a.T,a.L):void 0;break;case"message":b[c]=void 0}}function d_(a,b){if(null===a||"object"!=typeof a||!Object.getOwnPropertyNames(dD.prototype).every(b=>b in a&&"function"==typeof a[b]))return!1;let c=a.getType();return null!==c&&"function"==typeof c&&"typeName"in c&&"string"==typeof c.typeName&&(void 0===b||c.typeName==b.typeName)}function d0(a,b){return d_(b)||!a.fieldWrapper?b:a.fieldWrapper.wrapField(b)}k5.DOUBLE,k5.FLOAT,k5.INT64,k5.UINT64,k5.INT32,k5.UINT32,k5.BOOL,k5.STRING,k5.BYTES;let d1={ignoreUnknownFields:!1},d2={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0},d3=Symbol(),d4=Symbol();function d5(a){if(null===a)return"null";switch(typeof a){case"object":return Array.isArray(a)?"array":"object";case"string":return a.length>100?"string":'"'.concat(a.split('"').join('\\"'),'"');default:return String(a)}}function d6(a,b,c,d,e){let f=c.localName;if(c.repeated){if(dv("map"!=c.kind),null===b)return;if(!Array.isArray(b))throw Error("cannot decode field ".concat(e.typeName,".").concat(c.name," from JSON: ").concat(d5(b)));let g=a[f];for(let a of b){if(null===a)throw Error("cannot decode field ".concat(e.typeName,".").concat(c.name," from JSON: ").concat(d5(a)));switch(c.kind){case"message":g.push(c.T.fromJson(a,d));break;case"enum":let b=d8(c.T,a,d.ignoreUnknownFields,!0);b!==d4&&g.push(b);break;case"scalar":try{g.push(d7(c.T,a,c.L,!0))}catch(d){let b="cannot decode field ".concat(e.typeName,".").concat(c.name," from JSON: ").concat(d5(a));throw d instanceof Error&&d.message.length>0&&(b+=": ".concat(d.message)),Error(b)}}}}else if("map"==c.kind){if(null===b)return;if("object"!=typeof b||Array.isArray(b))throw Error("cannot decode field ".concat(e.typeName,".").concat(c.name," from JSON: ").concat(d5(b)));let g=a[f];for(let[a,f]of Object.entries(b)){let h;if(null===f)throw Error("cannot decode field ".concat(e.typeName,".").concat(c.name," from JSON: map value null"));try{h=function(a,b){if(a===k5.BOOL)switch(b){case"true":b=!0;break;case"false":b=!1}return d7(a,b,k6.BIGINT,!0).toString()}(c.K,a)}catch(d){let a="cannot decode map key for field ".concat(e.typeName,".").concat(c.name," from JSON: ").concat(d5(b));throw d instanceof Error&&d.message.length>0&&(a+=": ".concat(d.message)),Error(a)}switch(c.V.kind){case"message":g[h]=c.V.T.fromJson(f,d);break;case"enum":let i=d8(c.V.T,f,d.ignoreUnknownFields,!0);i!==d4&&(g[h]=i);break;case"scalar":try{g[h]=d7(c.V.T,f,k6.BIGINT,!0)}catch(d){let a="cannot decode map value for field ".concat(e.typeName,".").concat(c.name," from JSON: ").concat(d5(b));throw d instanceof Error&&d.message.length>0&&(a+=": ".concat(d.message)),Error(a)}}}}else switch(c.oneof&&(a=a[c.oneof.localName]={case:f},f="value"),c.kind){case"message":let g=c.T;if(null===b&&"google.protobuf.Value"!=g.typeName)return;let h=a[f];d_(h)?h.fromJson(b,d):(a[f]=h=g.fromJson(b,d),g.fieldWrapper&&!c.oneof&&(a[f]=g.fieldWrapper.unwrapField(h)));break;case"enum":let i=d8(c.T,b,d.ignoreUnknownFields,!1);switch(i){case d3:d$(c,a);break;case d4:break;default:a[f]=i}break;case"scalar":try{let d=d7(c.T,b,c.L,!1);d===d3?d$(c,a):a[f]=d}catch(d){let a="cannot decode field ".concat(e.typeName,".").concat(c.name," from JSON: ").concat(d5(b));throw d instanceof Error&&d.message.length>0&&(a+=": ".concat(d.message)),Error(a)}}}function d7(a,b,c,d){if(null===b)return d?dP(a,c):d3;switch(a){case k5.DOUBLE:case k5.FLOAT:if("NaN"===b)return NaN;if("Infinity"===b)return 1/0;if("-Infinity"===b)return-1/0;if(""===b||"string"==typeof b&&b.trim().length!==b.length||"string"!=typeof b&&"number"!=typeof b)break;let e=Number(b);if(Number.isNaN(e)||!Number.isFinite(e))break;return a==k5.FLOAT&&dy(e),e;case k5.INT32:case k5.FIXED32:case k5.SFIXED32:case k5.SINT32:case k5.UINT32:let f;if("number"==typeof b?f=b:"string"==typeof b&&b.length>0&&b.trim().length===b.length&&(f=Number(b)),void 0===f)break;return a==k5.UINT32||a==k5.FIXED32?dx(f):dw(f),f;case k5.INT64:case k5.SFIXED64:case k5.SINT64:if("number"!=typeof b&&"string"!=typeof b)break;let g=dN.parse(b);return c?g.toString():g;case k5.FIXED64:case k5.UINT64:if("number"!=typeof b&&"string"!=typeof b)break;let h=dN.uParse(b);return c?h.toString():h;case k5.BOOL:if("boolean"!=typeof b)break;return b;case k5.STRING:if("string"!=typeof b)break;try{encodeURIComponent(b)}catch(a){throw Error("invalid UTF8")}return b;case k5.BYTES:if(""===b)return new Uint8Array(0);if("string"!=typeof b)break;return dW.dec(b)}throw Error()}function d8(a,b,c,d){if(null===b)return"google.protobuf.NullValue"==a.typeName?0:d?a.values[0].no:d3;switch(typeof b){case"number":if(Number.isInteger(b))return b;break;case"string":let e=a.findName(b);if(void 0!==e)return e.no;if(c)return d4}throw Error("cannot decode enum ".concat(a.typeName," from JSON: ").concat(d5(b)))}function d9(a,b,c){if("map"==a.kind){dv("object"==typeof b&&null!=b);let d={},e=Object.entries(b);switch(a.V.kind){case"scalar":for(let[b,c]of e)d[b.toString()]=eb(a.V.T,c);break;case"message":for(let[a,b]of e)d[a.toString()]=b.toJson(c);break;case"enum":let f=a.V.T;for(let[a,b]of e)d[a.toString()]=ea(f,b,c.enumAsInteger)}return c.emitDefaultValues||e.length>0?d:void 0}if(a.repeated){dv(Array.isArray(b));let d=[];switch(a.kind){case"scalar":for(let c=0;c<b.length;c++)d.push(eb(a.T,b[c]));break;case"enum":for(let e=0;e<b.length;e++)d.push(ea(a.T,b[e],c.enumAsInteger));break;case"message":for(let a=0;a<b.length;a++)d.push(b[a].toJson(c))}return c.emitDefaultValues||d.length>0?d:void 0}switch(a.kind){case"scalar":return eb(a.T,b);case"enum":return ea(a.T,b,c.enumAsInteger);case"message":return d0(a.T,b).toJson(c)}}function ea(a,b,c){var d;if(dv("number"==typeof b),"google.protobuf.NullValue"==a.typeName)return null;if(c)return b;let e=a.findNumber(b);return null!=(d=null==e?void 0:e.name)?d:b}function eb(a,b){switch(a){case k5.INT32:case k5.SFIXED32:case k5.SINT32:case k5.FIXED32:case k5.UINT32:return dv("number"==typeof b),b;case k5.FLOAT:case k5.DOUBLE:if(dv("number"==typeof b),Number.isNaN(b))return"NaN";if(b===1/0)return"Infinity";if(b===-1/0)return"-Infinity";return b;case k5.STRING:return dv("string"==typeof b),b;case k5.BOOL:return dv("boolean"==typeof b),b;case k5.UINT64:case k5.FIXED64:case k5.INT64:case k5.SFIXED64:case k5.SINT64:return dv("bigint"==typeof b||"string"==typeof b||"number"==typeof b),b.toString();case k5.BYTES:return dv(b instanceof Uint8Array),dW.enc(b)}}let ec=Symbol("@bufbuild/protobuf/unknown-fields"),ed={readUnknownFields:!0,readerFactory:a=>new dS(a)},ee={writeUnknownFields:!0,writerFactory:()=>new dR};function ef(a,b,c,d,e){let{repeated:f,localName:g}=c;switch(c.oneof&&((a=a[c.oneof.localName]).case!=g&&delete a.value,a.case=g,g="value"),c.kind){case"scalar":case"enum":let h="enum"==c.kind?k5.INT32:c.T,i=ei;if("scalar"==c.kind&&c.L>0&&(i=eh),f){let c=a[g];if(d==k7.LengthDelimited&&h!=k5.STRING&&h!=k5.BYTES){let a=b.uint32()+b.pos;for(;b.pos<a;)c.push(i(b,h))}else c.push(i(b,h))}else a[g]=i(b,h);break;case"message":let j=c.T;f?a[g].push(eg(b,new j,e,c)):d_(a[g])?eg(b,a[g],e,c):(a[g]=eg(b,new j,e,c),!j.fieldWrapper||c.oneof||c.repeated||(a[g]=j.fieldWrapper.unwrapField(a[g])));break;case"map":let[k,l]=function(a,b,c){let d,e,f=b.uint32(),g=b.pos+f;for(;b.pos<g;){let[f]=b.tag();switch(f){case 1:d=ei(b,a.K);break;case 2:switch(a.V.kind){case"scalar":e=ei(b,a.V.T);break;case"enum":e=b.int32();break;case"message":e=eg(b,new a.V.T,c,void 0)}}}if(void 0===d&&(d=dP(a.K,k6.BIGINT)),"string"!=typeof d&&"number"!=typeof d&&(d=d.toString()),void 0===e)switch(a.V.kind){case"scalar":e=dP(a.V.T,k6.BIGINT);break;case"enum":e=a.V.T.values[0].no;break;case"message":e=new a.V.T}return[d,e]}(c,b,e);a[g][k]=l}}function eg(a,b,c,d){let e=b.getType().runtime.bin,f=null==d?void 0:d.delimited;return e.readMessage(b,a,f?d.no:a.uint32(),c,f),b}function eh(a,b){let c=ei(a,b);return"bigint"==typeof c?c.toString():c}function ei(a,b){switch(b){case k5.STRING:return a.string();case k5.BOOL:return a.bool();case k5.DOUBLE:return a.double();case k5.FLOAT:return a.float();case k5.INT32:return a.int32();case k5.INT64:return a.int64();case k5.UINT64:return a.uint64();case k5.FIXED64:return a.fixed64();case k5.BYTES:return a.bytes();case k5.FIXED32:return a.fixed32();case k5.SFIXED32:return a.sfixed32();case k5.SFIXED64:return a.sfixed64();case k5.SINT64:return a.sint64();case k5.UINT32:return a.uint32();case k5.SINT32:return a.sint32()}}function ej(a,b,c,d){dv(void 0!==b);let e=a.repeated;switch(a.kind){case"scalar":case"enum":let f="enum"==a.kind?k5.INT32:a.T;if(e)if(dv(Array.isArray(b)),a.packed)!function(a,b,c,d){if(!d.length)return;a.tag(c,k7.LengthDelimited).fork();let[,e]=em(b);for(let b=0;b<d.length;b++)a[e](d[b]);a.join()}(c,f,a.no,b);else for(let d of b)el(c,f,a.no,d);else el(c,f,a.no,b);break;case"message":if(e)for(let e of(dv(Array.isArray(b)),b))ek(c,d,a,e);else ek(c,d,a,b);break;case"map":for(let[e,f]of(dv("object"==typeof b&&null!=b),Object.entries(b)))!function(a,b,c,d,e){a.tag(c.no,k7.LengthDelimited),a.fork();let f=d;switch(c.K){case k5.INT32:case k5.FIXED32:case k5.UINT32:case k5.SFIXED32:case k5.SINT32:f=Number.parseInt(d);break;case k5.BOOL:dv("true"==d||"false"==d),f="true"==d}switch(el(a,c.K,1,f),c.V.kind){case"scalar":el(a,c.V.T,2,e);break;case"enum":el(a,k5.INT32,2,e);break;case"message":dv(void 0!==e),a.tag(2,k7.LengthDelimited).bytes(e.toBinary(b))}a.join()}(c,d,a,e,f)}}function ek(a,b,c,d){let e=d0(c.T,d);c.delimited?a.tag(c.no,k7.StartGroup).raw(e.toBinary(b)).tag(c.no,k7.EndGroup):a.tag(c.no,k7.LengthDelimited).bytes(e.toBinary(b))}function el(a,b,c,d){dv(void 0!==d);let[e,f]=em(b);a.tag(c,e)[f](d)}function em(a){let b=k7.Varint;switch(a){case k5.BYTES:case k5.STRING:b=k7.LengthDelimited;break;case k5.DOUBLE:case k5.FIXED64:case k5.SFIXED64:b=k7.Bit64;break;case k5.FIXED32:case k5.SFIXED32:case k5.FLOAT:b=k7.Bit32}return[b,k5[a].toLowerCase()]}function en(a){if(void 0===a)return a;if(d_(a))return a.clone();if(a instanceof Uint8Array){let b=new Uint8Array(a.byteLength);return b.set(a),b}return a}function eo(a){return a instanceof Uint8Array?a:new Uint8Array(a)}class ep{constructor(a,b){this._fields=a,this._normalizer=b}findJsonName(a){if(!this.jsonNames){let a={};for(let b of this.list())a[b.jsonName]=a[b.name]=b;this.jsonNames=a}return this.jsonNames[a]}find(a){if(!this.numbers){let a={};for(let b of this.list())a[b.no]=b;this.numbers=a}return this.numbers[a]}list(){return this.all||(this.all=this._normalizer(this._fields)),this.all}byNumber(){return this.numbersAsc||(this.numbersAsc=this.list().concat().sort((a,b)=>a.no-b.no)),this.numbersAsc}byMember(){if(!this.members){let a;this.members=[];let b=this.members;for(let c of this.list())c.oneof?c.oneof!==a&&(a=c.oneof,b.push(a)):b.push(c)}return this.members}}function eq(a,b){let c=es(a);return b?c:ew(ev(c))}let er=es;function es(a){let b=!1,c=[];for(let d=0;d<a.length;d++){let e=a.charAt(d);switch(e){case"_":b=!0;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":c.push(e),b=!1;break;default:b&&(b=!1,e=e.toUpperCase()),c.push(e)}}return c.join("")}let et=new Set(["constructor","toString","toJSON","valueOf"]),eu=new Set(["getType","clone","equals","fromBinary","fromJson","fromJsonString","toBinary","toJson","toJsonString","toObject"]),ev=a=>{if(eu.has(a))return"".concat(a,"$");return a},ew=a=>{if(et.has(a))return"".concat(a,"$");return a};class ex{constructor(a){this.kind="oneof",this.repeated=!1,this.packed=!1,this.opt=!1,this.req=!1,this.default=void 0,this.fields=[],this.name=a,this.localName=eq(a,!1)}addField(a){dv(a.oneof===this,"field ".concat(a.name," not one of ").concat(this.name)),this.fields.push(a)}findField(a){if(!this._lookup){this._lookup=Object.create(null);for(let a=0;a<this.fields.length;a++)this._lookup[this.fields[a].localName]=this.fields[a]}return this._lookup[a]}}let ey=(kA=a=>new ep(a,a=>(function(a,b){var c,d,e,f,g,h;let i,j=[];for(let b of"function"==typeof a?a():a){if(b.localName=eq(b.name,void 0!==b.oneof),b.jsonName=null!=(c=b.jsonName)?c:er(b.name),b.repeated=null!=(d=b.repeated)&&d,"scalar"==b.kind&&(b.L=null!=(e=b.L)?e:k6.BIGINT),b.delimited=null!=(f=b.delimited)&&f,b.req=null!=(g=b.req)&&g,b.opt=null!=(h=b.opt)&&h,void 0===b.packed&&(b.packed="enum"==b.kind||"scalar"==b.kind&&b.T!=k5.BYTES&&b.T!=k5.STRING),void 0!==b.oneof){let a="string"==typeof b.oneof?b.oneof:b.oneof.name;i&&i.name==a||(i=new ex(a)),b.oneof=i,i.addField(b)}j.push(b)}return j})(a)),kB=a=>{for(let b of a.getType().fields.byMember()){if(b.opt)continue;let c=b.localName;if(b.repeated){a[c]=[];continue}switch(b.kind){case"oneof":a[c]={case:void 0};break;case"enum":a[c]=0;break;case"map":a[c]={};break;case"scalar":a[c]=dP(b.T,b.L)}}},{syntax:"proto3",json:{makeReadOptions:function(a){return a?Object.assign(Object.assign({},d1),a):d1},makeWriteOptions:function(a){return a?Object.assign(Object.assign({},d2),a):d2},readMessage(a,b,c,d){if(null==b||Array.isArray(b)||"object"!=typeof b)throw Error("cannot decode message ".concat(a.typeName," from JSON: ").concat(d5(b)));d=null!=d?d:new a;let e=new Map,f=c.typeRegistry;for(let[g,h]of Object.entries(b)){let b=a.fields.findJsonName(g);if(b){if(b.oneof){if(null===h&&"scalar"==b.kind)continue;let c=e.get(b.oneof);if(void 0!==c)throw Error("cannot decode message ".concat(a.typeName,' from JSON: multiple keys for oneof "').concat(b.oneof.name,'" present: "').concat(c,'", "').concat(g,'"'));e.set(b.oneof,g)}d6(d,h,b,c,a)}else{let b=!1;if((null==f?void 0:f.findExtension)&&g.startsWith("[")&&g.endsWith("]")){let e=f.findExtension(g.substring(1,g.length-1));if(e&&e.extendee.typeName==a.typeName){b=!0;let[a,f]=dT(e);d6(a,h,e.field,c,e),function(a,b,c,d){dY(b,a);let e=b.runtime.bin.makeReadOptions(d),f=b.runtime.bin.makeWriteOptions(d);if(dX(a,b)){let c=a.getType().runtime.bin.listUnknownFields(a).filter(a=>a.no!=b.field.no);for(let b of(a.getType().runtime.bin.discardUnknownFields(a),c))a.getType().runtime.bin.onUnknownField(a,b.no,b.wireType,b.data)}let g=f.writerFactory(),h=b.field;h.opt||h.repeated||"enum"!=h.kind&&"scalar"!=h.kind||(h=Object.assign(Object.assign({},b.field),{opt:!0})),b.runtime.bin.writeField(h,c,g,f);let i=e.readerFactory(g.finish());for(;i.pos<i.len;){let[b,c]=i.tag(),d=i.skip(c,b);a.getType().runtime.bin.onUnknownField(a,b,c,d)}}(d,e,f(),c)}}if(!b&&!c.ignoreUnknownFields)throw Error("cannot decode message ".concat(a.typeName,' from JSON: key "').concat(g,'" is unknown'))}}return d},writeMessage(a,b){let c,d=a.getType(),e={};try{for(c of d.fields.byNumber()){if(!dZ(c,a)){var f;if(c.req)throw"required field not set";if(!b.emitDefaultValues||!((f=c).repeated||"map"==f.kind||!f.oneof&&"message"!=f.kind&&!f.opt&&!f.req))continue}let d=c.oneof?a[c.oneof.localName].value:a[c.localName],g=d9(c,d,b);void 0!==g&&(e[b.useProtoFieldName?c.name:c.jsonName]=g)}let g=b.typeRegistry;if(null==g?void 0:g.findExtensionFor)for(let c of d.runtime.bin.listUnknownFields(a)){let f=g.findExtensionFor(d.typeName,c.no);if(f&&dX(a,f)){let c=function(a,b,c){dY(b,a);let d=b.runtime.bin.makeReadOptions(c),e=function(a,b){if(!b.repeated&&("enum"==b.kind||"scalar"==b.kind)){for(let c=a.length-1;c>=0;--c)if(a[c].no==b.no)return[a[c]];return[]}return a.filter(a=>a.no===b.no)}(a.getType().runtime.bin.listUnknownFields(a),b.field),[f,g]=dT(b);for(let a of e)b.runtime.bin.readField(f,d.readerFactory(a.data),b.field,a.wireType,d);return g()}(a,f,b),d=d9(f.field,c,b);void 0!==d&&(e[f.field.jsonName]=d)}}}catch(e){let a=c?"cannot encode field ".concat(d.typeName,".").concat(c.name," to JSON"):"cannot encode message ".concat(d.typeName," to JSON"),b=e instanceof Error?e.message:String(e);throw Error(a+(b.length>0?": ".concat(b):""))}return e},readScalar:(a,b,c)=>d7(a,b,null!=c?c:k6.BIGINT,!0),writeScalar(a,b,c){if(void 0!==b&&(c||dQ(a,b)))return eb(a,b)},debug:d5},bin:{makeReadOptions:function(a){return a?Object.assign(Object.assign({},ed),a):ed},makeWriteOptions:function(a){return a?Object.assign(Object.assign({},ee),a):ee},listUnknownFields(a){var b;return null!=(b=a[ec])?b:[]},discardUnknownFields(a){delete a[ec]},writeUnknownFields(a,b){let c=a[ec];if(c)for(let a of c)b.tag(a.no,a.wireType).raw(a.data)},onUnknownField(a,b,c,d){Array.isArray(a[ec])||(a[ec]=[]),a[ec].push({no:b,wireType:c,data:d})},readMessage(a,b,c,d,e){let f,g,h=a.getType(),i=e?b.len:b.pos+c;for(;b.pos<i&&([f,g]=b.tag(),!0!==e||g!=k7.EndGroup);){let c=h.fields.find(f);if(!c){let c=b.skip(g,f);d.readUnknownFields&&this.onUnknownField(a,f,g,c);continue}ef(a,b,c,g,d)}if(e&&(g!=k7.EndGroup||f!==c))throw Error("invalid end group tag")},readField:ef,writeMessage(a,b,c){let d=a.getType();for(let e of d.fields.byNumber()){if(!dZ(e,a)){if(e.req)throw Error("cannot encode field ".concat(d.typeName,".").concat(e.name," to binary: required field not set"));continue}let f=e.oneof?a[e.oneof.localName].value:a[e.localName];ej(e,f,b,c)}return c.writeUnknownFields&&this.writeUnknownFields(a,b),b},writeField(a,b,c,d){void 0!==b&&ej(a,b,c,d)}},util:Object.assign(Object.assign({},{setEnumType:dA,initPartial(a,b){if(void 0!==a)for(let c of b.getType().fields.byMember()){let d=c.localName;if(null!=a[d])switch(c.kind){case"oneof":let e=a[d].case;if(void 0===e)continue;let f=c.findField(e),g=a[d].value;f&&"message"==f.kind&&!d_(g,f.T)?g=new f.T(g):f&&"scalar"===f.kind&&f.T===k5.BYTES&&(g=eo(g)),b[d]={case:e,value:g};break;case"scalar":case"enum":let h=a[d];c.T===k5.BYTES&&(h=c.repeated?h.map(eo):eo(h)),b[d]=h;break;case"map":switch(c.V.kind){case"scalar":case"enum":if(c.V.T===k5.BYTES)for(let[c,e]of Object.entries(a[d]))b[d][c]=eo(e);else Object.assign(b[d],a[d]);break;case"message":let i=c.V.T;for(let c of Object.keys(a[d])){let e=a[d][c];i.fieldWrapper||(e=new i(e)),b[d][c]=e}}break;case"message":let j=c.T;if(c.repeated)b[d]=a[d].map(a=>d_(a,j)?a:new j(a));else{let c=a[d];j.fieldWrapper?"google.protobuf.BytesValue"===j.typeName?b[d]=eo(c):b[d]=c:b[d]=d_(c,j)?c:new j(c)}}}},equals:(a,b,c)=>b===c||!!b&&!!c&&a.fields.byMember().every(a=>{let d=b[a.localName],e=c[a.localName];if(a.repeated){if(d.length!==e.length)return!1;switch(a.kind){case"message":return d.every((b,c)=>a.T.equals(b,e[c]));case"scalar":return d.every((b,c)=>dO(a.T,b,e[c]));case"enum":return d.every((a,b)=>dO(k5.INT32,a,e[b]))}throw Error("repeated cannot contain ".concat(a.kind))}switch(a.kind){case"message":let f=d,g=e;return a.T.fieldWrapper&&(void 0===f||d_(f)||(f=a.T.fieldWrapper.wrapField(f)),void 0===g||d_(g)||(g=a.T.fieldWrapper.wrapField(g))),a.T.equals(f,g);case"enum":return dO(k5.INT32,d,e);case"scalar":return dO(a.T,d,e);case"oneof":if(d.case!==e.case)return!1;let h=a.findField(d.case);if(void 0===h)return!0;switch(h.kind){case"message":return h.T.equals(d.value,e.value);case"enum":return dO(k5.INT32,d.value,e.value);case"scalar":return dO(h.T,d.value,e.value)}throw Error("oneof cannot contain ".concat(h.kind));case"map":let i=Object.keys(d).concat(Object.keys(e));switch(a.V.kind){case"message":let j=a.V.T;return i.every(a=>j.equals(d[a],e[a]));case"enum":return i.every(a=>dO(k5.INT32,d[a],e[a]));case"scalar":let k=a.V.T;return i.every(a=>dO(k,d[a],e[a]))}}}),clone(a){let b=a.getType(),c=new b;for(let d of b.fields.byMember()){let b,e=a[d.localName];if(d.repeated)b=e.map(en);else if("map"==d.kind)for(let[a,f]of(b=c[d.localName],Object.entries(e)))b[a]=en(f);else b="oneof"==d.kind?d.findField(e.case)?{case:e.case,value:en(e.value)}:{case:void 0}:en(e);c[d.localName]=b}for(let d of b.runtime.bin.listUnknownFields(a))b.runtime.bin.onUnknownField(c,d.no,d.wireType,d.data);return c}}),{newFieldList:kA,initFields:kB}),makeMessageType(a,b,c){var d,e;let f,g;return d=this,Object.setPrototypeOf((g=({[f=null!=(e=null==c?void 0:c.localName)?e:a.substring(a.lastIndexOf(".")+1)]:function(a){d.util.initFields(this),d.util.initPartial(a,this)}})[f]).prototype,new dD),Object.assign(g,{runtime:d,typeName:a,fields:d.util.newFieldList(b),fromBinary:(a,b)=>new g().fromBinary(a,b),fromJson:(a,b)=>new g().fromJson(a,b),fromJsonString:(a,b)=>new g().fromJsonString(a,b),equals:(a,b)=>d.util.equals(g,a,b)}),g},makeEnum:function(a,b,c){let d={};for(let a of b){let b=dC(a);d[b.localName]=b.no,d[b.no]=b.localName}return dA(d,a,b),d},makeEnumType:dB,getEnumType:function(a){let b=a[dz];return dv(b,"missing enum type on enum object"),b},makeExtension(a,b,c){var d;let e;return d=this,{typeName:a,extendee:b,get field(){if(!e){let b="function"==typeof c?c():c;b.name=a.split(".").pop(),b.jsonName="[".concat(a,"]"),e=d.util.newFieldList([b]).list()[0]}return e},runtime:d}}});class ez extends dD{constructor(a){super(),this.seconds=dN.zero,this.nanos=0,ey.util.initPartial(a,this)}fromJson(a,b){if("string"!=typeof a)throw Error("cannot decode google.protobuf.Timestamp from JSON: ".concat(ey.json.debug(a)));let c=a.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})(?:Z|\.([0-9]{3,9})Z|([+-][0-9][0-9]:[0-9][0-9]))$/);if(!c)throw Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");let d=Date.parse(c[1]+"-"+c[2]+"-"+c[3]+"T"+c[4]+":"+c[5]+":"+c[6]+(c[8]?c[8]:"Z"));if(Number.isNaN(d))throw Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");if(d<Date.parse("0001-01-01T00:00:00Z")||d>Date.parse("9999-12-31T23:59:59Z"))throw Error("cannot decode message google.protobuf.Timestamp from JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");return this.seconds=dN.parse(d/1e3),this.nanos=0,c[7]&&(this.nanos=parseInt("1"+c[7]+"0".repeat(9-c[7].length))-1e9),this}toJson(a){let b=1e3*Number(this.seconds);if(b<Date.parse("0001-01-01T00:00:00Z")||b>Date.parse("9999-12-31T23:59:59Z"))throw Error("cannot encode google.protobuf.Timestamp to JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");if(this.nanos<0)throw Error("cannot encode google.protobuf.Timestamp to JSON: nanos must not be negative");let c="Z";if(this.nanos>0){let a=(this.nanos+1e9).toString().substring(1);c="000000"===a.substring(3)?"."+a.substring(0,3)+"Z":"000"===a.substring(6)?"."+a.substring(0,6)+"Z":"."+a+"Z"}return new Date(b).toISOString().replace(".000Z",c)}toDate(){return new Date(1e3*Number(this.seconds)+Math.ceil(this.nanos/1e6))}static now(){return ez.fromDate(new Date)}static fromDate(a){let b=a.getTime();return new ez({seconds:dN.parse(Math.floor(b/1e3)),nanos:b%1e3*1e6})}static fromBinary(a,b){return new ez().fromBinary(a,b)}static fromJson(a,b){return new ez().fromJson(a,b)}static fromJsonString(a,b){return new ez().fromJsonString(a,b)}static equals(a,b){return ey.util.equals(ez,a,b)}}ez.runtime=ey,ez.typeName="google.protobuf.Timestamp",ez.fields=ey.util.newFieldList(()=>[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}]);let eA=ey.makeMessageType("livekit.MetricsBatch",()=>[{no:1,name:"timestamp_ms",kind:"scalar",T:3},{no:2,name:"normalized_timestamp",kind:"message",T:ez},{no:3,name:"str_data",kind:"scalar",T:9,repeated:!0},{no:4,name:"time_series",kind:"message",T:eB,repeated:!0},{no:5,name:"events",kind:"message",T:eD,repeated:!0}]),eB=ey.makeMessageType("livekit.TimeSeriesMetric",()=>[{no:1,name:"label",kind:"scalar",T:13},{no:2,name:"participant_identity",kind:"scalar",T:13},{no:3,name:"track_sid",kind:"scalar",T:13},{no:4,name:"samples",kind:"message",T:eC,repeated:!0},{no:5,name:"rid",kind:"scalar",T:13}]),eC=ey.makeMessageType("livekit.MetricSample",()=>[{no:1,name:"timestamp_ms",kind:"scalar",T:3},{no:2,name:"normalized_timestamp",kind:"message",T:ez},{no:3,name:"value",kind:"scalar",T:2}]),eD=ey.makeMessageType("livekit.EventMetric",()=>[{no:1,name:"label",kind:"scalar",T:13},{no:2,name:"participant_identity",kind:"scalar",T:13},{no:3,name:"track_sid",kind:"scalar",T:13},{no:4,name:"start_timestamp_ms",kind:"scalar",T:3},{no:5,name:"end_timestamp_ms",kind:"scalar",T:3,opt:!0},{no:6,name:"normalized_start_timestamp",kind:"message",T:ez},{no:7,name:"normalized_end_timestamp",kind:"message",T:ez,opt:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"rid",kind:"scalar",T:13}]),eE=ey.makeEnum("livekit.AudioCodec",[{no:0,name:"DEFAULT_AC"},{no:1,name:"OPUS"},{no:2,name:"AAC"},{no:3,name:"AC_MP3"}]),eF=ey.makeEnum("livekit.VideoCodec",[{no:0,name:"DEFAULT_VC"},{no:1,name:"H264_BASELINE"},{no:2,name:"H264_MAIN"},{no:3,name:"H264_HIGH"},{no:4,name:"VP8"}]),eG=ey.makeEnum("livekit.ImageCodec",[{no:0,name:"IC_DEFAULT"},{no:1,name:"IC_JPEG"}]),eH=ey.makeEnum("livekit.BackupCodecPolicy",[{no:0,name:"PREFER_REGRESSION"},{no:1,name:"SIMULCAST"},{no:2,name:"REGRESSION"}]),eI=ey.makeEnum("livekit.TrackType",[{no:0,name:"AUDIO"},{no:1,name:"VIDEO"},{no:2,name:"DATA"}]),eJ=ey.makeEnum("livekit.TrackSource",[{no:0,name:"UNKNOWN"},{no:1,name:"CAMERA"},{no:2,name:"MICROPHONE"},{no:3,name:"SCREEN_SHARE"},{no:4,name:"SCREEN_SHARE_AUDIO"}]),eK=ey.makeEnum("livekit.VideoQuality",[{no:0,name:"LOW"},{no:1,name:"MEDIUM"},{no:2,name:"HIGH"},{no:3,name:"OFF"}]),eL=ey.makeEnum("livekit.ConnectionQuality",[{no:0,name:"POOR"},{no:1,name:"GOOD"},{no:2,name:"EXCELLENT"},{no:3,name:"LOST"}]),eM=ey.makeEnum("livekit.ClientConfigSetting",[{no:0,name:"UNSET"},{no:1,name:"DISABLED"},{no:2,name:"ENABLED"}]),eN=ey.makeEnum("livekit.DisconnectReason",[{no:0,name:"UNKNOWN_REASON"},{no:1,name:"CLIENT_INITIATED"},{no:2,name:"DUPLICATE_IDENTITY"},{no:3,name:"SERVER_SHUTDOWN"},{no:4,name:"PARTICIPANT_REMOVED"},{no:5,name:"ROOM_DELETED"},{no:6,name:"STATE_MISMATCH"},{no:7,name:"JOIN_FAILURE"},{no:8,name:"MIGRATION"},{no:9,name:"SIGNAL_CLOSE"},{no:10,name:"ROOM_CLOSED"},{no:11,name:"USER_UNAVAILABLE"},{no:12,name:"USER_REJECTED"},{no:13,name:"SIP_TRUNK_FAILURE"},{no:14,name:"CONNECTION_TIMEOUT"},{no:15,name:"MEDIA_FAILURE"}]),eO=ey.makeEnum("livekit.ReconnectReason",[{no:0,name:"RR_UNKNOWN"},{no:1,name:"RR_SIGNAL_DISCONNECTED"},{no:2,name:"RR_PUBLISHER_FAILED"},{no:3,name:"RR_SUBSCRIBER_FAILED"},{no:4,name:"RR_SWITCH_CANDIDATE"}]),eP=ey.makeEnum("livekit.SubscriptionError",[{no:0,name:"SE_UNKNOWN"},{no:1,name:"SE_CODEC_UNSUPPORTED"},{no:2,name:"SE_TRACK_NOTFOUND"}]),eQ=ey.makeEnum("livekit.AudioTrackFeature",[{no:0,name:"TF_STEREO"},{no:1,name:"TF_NO_DTX"},{no:2,name:"TF_AUTO_GAIN_CONTROL"},{no:3,name:"TF_ECHO_CANCELLATION"},{no:4,name:"TF_NOISE_SUPPRESSION"},{no:5,name:"TF_ENHANCED_NOISE_CANCELLATION"},{no:6,name:"TF_PRECONNECT_BUFFER"}]),eR=ey.makeMessageType("livekit.Room",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"empty_timeout",kind:"scalar",T:13},{no:14,name:"departure_timeout",kind:"scalar",T:13},{no:4,name:"max_participants",kind:"scalar",T:13},{no:5,name:"creation_time",kind:"scalar",T:3},{no:15,name:"creation_time_ms",kind:"scalar",T:3},{no:6,name:"turn_password",kind:"scalar",T:9},{no:7,name:"enabled_codecs",kind:"message",T:eS,repeated:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"num_participants",kind:"scalar",T:13},{no:11,name:"num_publishers",kind:"scalar",T:13},{no:10,name:"active_recording",kind:"scalar",T:8},{no:13,name:"version",kind:"message",T:fo}]),eS=ey.makeMessageType("livekit.Codec",()=>[{no:1,name:"mime",kind:"scalar",T:9},{no:2,name:"fmtp_line",kind:"scalar",T:9}]),eT=ey.makeMessageType("livekit.ParticipantPermission",()=>[{no:1,name:"can_subscribe",kind:"scalar",T:8},{no:2,name:"can_publish",kind:"scalar",T:8},{no:3,name:"can_publish_data",kind:"scalar",T:8},{no:9,name:"can_publish_sources",kind:"enum",T:ey.getEnumType(eJ),repeated:!0},{no:7,name:"hidden",kind:"scalar",T:8},{no:8,name:"recorder",kind:"scalar",T:8},{no:10,name:"can_update_metadata",kind:"scalar",T:8},{no:11,name:"agent",kind:"scalar",T:8},{no:12,name:"can_subscribe_metrics",kind:"scalar",T:8}]),eU=ey.makeMessageType("livekit.ParticipantInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"identity",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:ey.getEnumType(eV)},{no:4,name:"tracks",kind:"message",T:e$,repeated:!0},{no:5,name:"metadata",kind:"scalar",T:9},{no:6,name:"joined_at",kind:"scalar",T:3},{no:17,name:"joined_at_ms",kind:"scalar",T:3},{no:9,name:"name",kind:"scalar",T:9},{no:10,name:"version",kind:"scalar",T:13},{no:11,name:"permission",kind:"message",T:eT},{no:12,name:"region",kind:"scalar",T:9},{no:13,name:"is_publisher",kind:"scalar",T:8},{no:14,name:"kind",kind:"enum",T:ey.getEnumType(eW)},{no:15,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:16,name:"disconnect_reason",kind:"enum",T:ey.getEnumType(eN)},{no:18,name:"kind_details",kind:"enum",T:ey.getEnumType(eX),repeated:!0}]),eV=ey.makeEnum("livekit.ParticipantInfo.State",[{no:0,name:"JOINING"},{no:1,name:"JOINED"},{no:2,name:"ACTIVE"},{no:3,name:"DISCONNECTED"}]),eW=ey.makeEnum("livekit.ParticipantInfo.Kind",[{no:0,name:"STANDARD"},{no:1,name:"INGRESS"},{no:2,name:"EGRESS"},{no:3,name:"SIP"},{no:4,name:"AGENT"},{no:7,name:"CONNECTOR"}]),eX=ey.makeEnum("livekit.ParticipantInfo.KindDetail",[{no:0,name:"CLOUD_AGENT"},{no:1,name:"FORWARDED"}]),eY=ey.makeEnum("livekit.Encryption.Type",[{no:0,name:"NONE"},{no:1,name:"GCM"},{no:2,name:"CUSTOM"}]),eZ=ey.makeMessageType("livekit.SimulcastCodecInfo",()=>[{no:1,name:"mime_type",kind:"scalar",T:9},{no:2,name:"mid",kind:"scalar",T:9},{no:3,name:"cid",kind:"scalar",T:9},{no:4,name:"layers",kind:"message",T:e_,repeated:!0},{no:5,name:"video_layer_mode",kind:"enum",T:ey.getEnumType(e0)},{no:6,name:"sdp_cid",kind:"scalar",T:9}]),e$=ey.makeMessageType("livekit.TrackInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"type",kind:"enum",T:ey.getEnumType(eI)},{no:3,name:"name",kind:"scalar",T:9},{no:4,name:"muted",kind:"scalar",T:8},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"simulcast",kind:"scalar",T:8},{no:8,name:"disable_dtx",kind:"scalar",T:8},{no:9,name:"source",kind:"enum",T:ey.getEnumType(eJ)},{no:10,name:"layers",kind:"message",T:e_,repeated:!0},{no:11,name:"mime_type",kind:"scalar",T:9},{no:12,name:"mid",kind:"scalar",T:9},{no:13,name:"codecs",kind:"message",T:eZ,repeated:!0},{no:14,name:"stereo",kind:"scalar",T:8},{no:15,name:"disable_red",kind:"scalar",T:8},{no:16,name:"encryption",kind:"enum",T:ey.getEnumType(eY)},{no:17,name:"stream",kind:"scalar",T:9},{no:18,name:"version",kind:"message",T:fo},{no:19,name:"audio_features",kind:"enum",T:ey.getEnumType(eQ),repeated:!0},{no:20,name:"backup_codec_policy",kind:"enum",T:ey.getEnumType(eH)}]),e_=ey.makeMessageType("livekit.VideoLayer",()=>[{no:1,name:"quality",kind:"enum",T:ey.getEnumType(eK)},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13},{no:4,name:"bitrate",kind:"scalar",T:13},{no:5,name:"ssrc",kind:"scalar",T:13},{no:6,name:"spatial_layer",kind:"scalar",T:5},{no:7,name:"rid",kind:"scalar",T:9}]),e0=ey.makeEnum("livekit.VideoLayer.Mode",[{no:0,name:"MODE_UNUSED"},{no:1,name:"ONE_SPATIAL_LAYER_PER_STREAM"},{no:2,name:"MULTIPLE_SPATIAL_LAYERS_PER_STREAM"},{no:3,name:"ONE_SPATIAL_LAYER_PER_STREAM_INCOMPLETE_RTCP_SR"}]),e1=ey.makeMessageType("livekit.DataPacket",()=>[{no:1,name:"kind",kind:"enum",T:ey.getEnumType(e2)},{no:4,name:"participant_identity",kind:"scalar",T:9},{no:5,name:"destination_identities",kind:"scalar",T:9,repeated:!0},{no:2,name:"user",kind:"message",T:e7,oneof:"value"},{no:3,name:"speaker",kind:"message",T:e5,oneof:"value"},{no:6,name:"sip_dtmf",kind:"message",T:e8,oneof:"value"},{no:7,name:"transcription",kind:"message",T:e9,oneof:"value"},{no:8,name:"metrics",kind:"message",T:eA,oneof:"value"},{no:9,name:"chat_message",kind:"message",T:fb,oneof:"value"},{no:10,name:"rpc_request",kind:"message",T:fc,oneof:"value"},{no:11,name:"rpc_ack",kind:"message",T:fd,oneof:"value"},{no:12,name:"rpc_response",kind:"message",T:fe,oneof:"value"},{no:13,name:"stream_header",kind:"message",T:fs,oneof:"value"},{no:14,name:"stream_chunk",kind:"message",T:ft,oneof:"value"},{no:15,name:"stream_trailer",kind:"message",T:fu,oneof:"value"},{no:18,name:"encrypted_packet",kind:"message",T:e3,oneof:"value"},{no:16,name:"sequence",kind:"scalar",T:13},{no:17,name:"participant_sid",kind:"scalar",T:9}]),e2=ey.makeEnum("livekit.DataPacket.Kind",[{no:0,name:"RELIABLE"},{no:1,name:"LOSSY"}]),e3=ey.makeMessageType("livekit.EncryptedPacket",()=>[{no:1,name:"encryption_type",kind:"enum",T:ey.getEnumType(eY)},{no:2,name:"iv",kind:"scalar",T:12},{no:3,name:"key_index",kind:"scalar",T:13},{no:4,name:"encrypted_value",kind:"scalar",T:12}]),e4=ey.makeMessageType("livekit.EncryptedPacketPayload",()=>[{no:1,name:"user",kind:"message",T:e7,oneof:"value"},{no:3,name:"chat_message",kind:"message",T:fb,oneof:"value"},{no:4,name:"rpc_request",kind:"message",T:fc,oneof:"value"},{no:5,name:"rpc_ack",kind:"message",T:fd,oneof:"value"},{no:6,name:"rpc_response",kind:"message",T:fe,oneof:"value"},{no:7,name:"stream_header",kind:"message",T:fs,oneof:"value"},{no:8,name:"stream_chunk",kind:"message",T:ft,oneof:"value"},{no:9,name:"stream_trailer",kind:"message",T:fu,oneof:"value"}]),e5=ey.makeMessageType("livekit.ActiveSpeakerUpdate",()=>[{no:1,name:"speakers",kind:"message",T:e6,repeated:!0}]),e6=ey.makeMessageType("livekit.SpeakerInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"level",kind:"scalar",T:2},{no:3,name:"active",kind:"scalar",T:8}]),e7=ey.makeMessageType("livekit.UserPacket",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:5,name:"participant_identity",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:12},{no:3,name:"destination_sids",kind:"scalar",T:9,repeated:!0},{no:6,name:"destination_identities",kind:"scalar",T:9,repeated:!0},{no:4,name:"topic",kind:"scalar",T:9,opt:!0},{no:8,name:"id",kind:"scalar",T:9,opt:!0},{no:9,name:"start_time",kind:"scalar",T:4,opt:!0},{no:10,name:"end_time",kind:"scalar",T:4,opt:!0},{no:11,name:"nonce",kind:"scalar",T:12}]),e8=ey.makeMessageType("livekit.SipDTMF",()=>[{no:3,name:"code",kind:"scalar",T:13},{no:4,name:"digit",kind:"scalar",T:9}]),e9=ey.makeMessageType("livekit.Transcription",()=>[{no:2,name:"transcribed_participant_identity",kind:"scalar",T:9},{no:3,name:"track_id",kind:"scalar",T:9},{no:4,name:"segments",kind:"message",T:fa,repeated:!0}]),fa=ey.makeMessageType("livekit.TranscriptionSegment",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"text",kind:"scalar",T:9},{no:3,name:"start_time",kind:"scalar",T:4},{no:4,name:"end_time",kind:"scalar",T:4},{no:5,name:"final",kind:"scalar",T:8},{no:6,name:"language",kind:"scalar",T:9}]),fb=ey.makeMessageType("livekit.ChatMessage",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"timestamp",kind:"scalar",T:3},{no:3,name:"edit_timestamp",kind:"scalar",T:3,opt:!0},{no:4,name:"message",kind:"scalar",T:9},{no:5,name:"deleted",kind:"scalar",T:8},{no:6,name:"generated",kind:"scalar",T:8}]),fc=ey.makeMessageType("livekit.RpcRequest",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"method",kind:"scalar",T:9},{no:3,name:"payload",kind:"scalar",T:9},{no:4,name:"response_timeout_ms",kind:"scalar",T:13},{no:5,name:"version",kind:"scalar",T:13}]),fd=ey.makeMessageType("livekit.RpcAck",()=>[{no:1,name:"request_id",kind:"scalar",T:9}]),fe=ey.makeMessageType("livekit.RpcResponse",()=>[{no:1,name:"request_id",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:9,oneof:"value"},{no:3,name:"error",kind:"message",T:ff,oneof:"value"}]),ff=ey.makeMessageType("livekit.RpcError",()=>[{no:1,name:"code",kind:"scalar",T:13},{no:2,name:"message",kind:"scalar",T:9},{no:3,name:"data",kind:"scalar",T:9}]),fg=ey.makeMessageType("livekit.ParticipantTracks",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sids",kind:"scalar",T:9,repeated:!0}]),fh=ey.makeMessageType("livekit.ServerInfo",()=>[{no:1,name:"edition",kind:"enum",T:ey.getEnumType(fi)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"region",kind:"scalar",T:9},{no:5,name:"node_id",kind:"scalar",T:9},{no:6,name:"debug_info",kind:"scalar",T:9},{no:7,name:"agent_protocol",kind:"scalar",T:5}]),fi=ey.makeEnum("livekit.ServerInfo.Edition",[{no:0,name:"Standard"},{no:1,name:"Cloud"}]),fj=ey.makeMessageType("livekit.ClientInfo",()=>[{no:1,name:"sdk",kind:"enum",T:ey.getEnumType(fk)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"os",kind:"scalar",T:9},{no:5,name:"os_version",kind:"scalar",T:9},{no:6,name:"device_model",kind:"scalar",T:9},{no:7,name:"browser",kind:"scalar",T:9},{no:8,name:"browser_version",kind:"scalar",T:9},{no:9,name:"address",kind:"scalar",T:9},{no:10,name:"network",kind:"scalar",T:9},{no:11,name:"other_sdks",kind:"scalar",T:9}]),fk=ey.makeEnum("livekit.ClientInfo.SDK",[{no:0,name:"UNKNOWN"},{no:1,name:"JS"},{no:2,name:"SWIFT"},{no:3,name:"ANDROID"},{no:4,name:"FLUTTER"},{no:5,name:"GO"},{no:6,name:"UNITY"},{no:7,name:"REACT_NATIVE"},{no:8,name:"RUST"},{no:9,name:"PYTHON"},{no:10,name:"CPP"},{no:11,name:"UNITY_WEB"},{no:12,name:"NODE"},{no:13,name:"UNREAL"},{no:14,name:"ESP32"}]),fl=ey.makeMessageType("livekit.ClientConfiguration",()=>[{no:1,name:"video",kind:"message",T:fm},{no:2,name:"screen",kind:"message",T:fm},{no:3,name:"resume_connection",kind:"enum",T:ey.getEnumType(eM)},{no:4,name:"disabled_codecs",kind:"message",T:fn},{no:5,name:"force_relay",kind:"enum",T:ey.getEnumType(eM)}]),fm=ey.makeMessageType("livekit.VideoConfiguration",()=>[{no:1,name:"hardware_encoder",kind:"enum",T:ey.getEnumType(eM)}]),fn=ey.makeMessageType("livekit.DisabledCodecs",()=>[{no:1,name:"codecs",kind:"message",T:eS,repeated:!0},{no:2,name:"publish",kind:"message",T:eS,repeated:!0}]),fo=ey.makeMessageType("livekit.TimedVersion",()=>[{no:1,name:"unix_micro",kind:"scalar",T:3},{no:2,name:"ticks",kind:"scalar",T:5}]),fp=ey.makeEnum("livekit.DataStream.OperationType",[{no:0,name:"CREATE"},{no:1,name:"UPDATE"},{no:2,name:"DELETE"},{no:3,name:"REACTION"}]),fq=ey.makeMessageType("livekit.DataStream.TextHeader",()=>[{no:1,name:"operation_type",kind:"enum",T:ey.getEnumType(fp)},{no:2,name:"version",kind:"scalar",T:5},{no:3,name:"reply_to_stream_id",kind:"scalar",T:9},{no:4,name:"attached_stream_ids",kind:"scalar",T:9,repeated:!0},{no:5,name:"generated",kind:"scalar",T:8}],{localName:"DataStream_TextHeader"}),fr=ey.makeMessageType("livekit.DataStream.ByteHeader",()=>[{no:1,name:"name",kind:"scalar",T:9}],{localName:"DataStream_ByteHeader"}),fs=ey.makeMessageType("livekit.DataStream.Header",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"timestamp",kind:"scalar",T:3},{no:3,name:"topic",kind:"scalar",T:9},{no:4,name:"mime_type",kind:"scalar",T:9},{no:5,name:"total_length",kind:"scalar",T:4,opt:!0},{no:7,name:"encryption_type",kind:"enum",T:ey.getEnumType(eY)},{no:8,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:9,name:"text_header",kind:"message",T:fq,oneof:"content_header"},{no:10,name:"byte_header",kind:"message",T:fr,oneof:"content_header"}],{localName:"DataStream_Header"}),ft=ey.makeMessageType("livekit.DataStream.Chunk",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"chunk_index",kind:"scalar",T:4},{no:3,name:"content",kind:"scalar",T:12},{no:4,name:"version",kind:"scalar",T:5},{no:5,name:"iv",kind:"scalar",T:12,opt:!0}],{localName:"DataStream_Chunk"}),fu=ey.makeMessageType("livekit.DataStream.Trailer",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"reason",kind:"scalar",T:9},{no:3,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}}],{localName:"DataStream_Trailer"}),fv=ey.makeMessageType("livekit.FilterParams",()=>[{no:1,name:"include_events",kind:"scalar",T:9,repeated:!0},{no:2,name:"exclude_events",kind:"scalar",T:9,repeated:!0}]),fw=ey.makeMessageType("livekit.WebhookConfig",()=>[{no:1,name:"url",kind:"scalar",T:9},{no:2,name:"signing_key",kind:"scalar",T:9},{no:3,name:"filter_params",kind:"message",T:fv}]),fx=ey.makeMessageType("livekit.SubscribedAudioCodec",()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"enabled",kind:"scalar",T:8}]),fy=ey.makeMessageType("livekit.RoomAgentDispatch",()=>[{no:1,name:"agent_name",kind:"scalar",T:9},{no:2,name:"metadata",kind:"scalar",T:9}]),fz=ey.makeEnum("livekit.EncodedFileType",[{no:0,name:"DEFAULT_FILETYPE"},{no:1,name:"MP4"},{no:2,name:"OGG"},{no:3,name:"MP3"}]),fA=ey.makeEnum("livekit.SegmentedFileProtocol",[{no:0,name:"DEFAULT_SEGMENTED_FILE_PROTOCOL"},{no:1,name:"HLS_PROTOCOL"}]),fB=ey.makeEnum("livekit.SegmentedFileSuffix",[{no:0,name:"INDEX"},{no:1,name:"TIMESTAMP"}]),fC=ey.makeEnum("livekit.ImageFileSuffix",[{no:0,name:"IMAGE_SUFFIX_INDEX"},{no:1,name:"IMAGE_SUFFIX_TIMESTAMP"},{no:2,name:"IMAGE_SUFFIX_NONE_OVERWRITE"}]),fD=ey.makeEnum("livekit.StreamProtocol",[{no:0,name:"DEFAULT_PROTOCOL"},{no:1,name:"RTMP"},{no:2,name:"SRT"}]),fE=ey.makeEnum("livekit.AudioMixing",[{no:0,name:"DEFAULT_MIXING"},{no:1,name:"DUAL_CHANNEL_AGENT"},{no:2,name:"DUAL_CHANNEL_ALTERNATE"}]),fF=ey.makeEnum("livekit.EncodingOptionsPreset",[{no:0,name:"H264_720P_30"},{no:1,name:"H264_720P_60"},{no:2,name:"H264_1080P_30"},{no:3,name:"H264_1080P_60"},{no:4,name:"PORTRAIT_H264_720P_30"},{no:5,name:"PORTRAIT_H264_720P_60"},{no:6,name:"PORTRAIT_H264_1080P_30"},{no:7,name:"PORTRAIT_H264_1080P_60"}]),fG=ey.makeMessageType("livekit.RoomCompositeEgressRequest",()=>[{no:1,name:"room_name",kind:"scalar",T:9},{no:2,name:"layout",kind:"scalar",T:9},{no:3,name:"audio_only",kind:"scalar",T:8},{no:15,name:"audio_mixing",kind:"enum",T:ey.getEnumType(fE)},{no:4,name:"video_only",kind:"scalar",T:8},{no:5,name:"custom_base_url",kind:"scalar",T:9},{no:6,name:"file",kind:"message",T:fH,oneof:"output"},{no:7,name:"stream",kind:"message",T:fP,oneof:"output"},{no:10,name:"segments",kind:"message",T:fI,oneof:"output"},{no:8,name:"preset",kind:"enum",T:ey.getEnumType(fF),oneof:"options"},{no:9,name:"advanced",kind:"message",T:fQ,oneof:"options"},{no:11,name:"file_outputs",kind:"message",T:fH,repeated:!0},{no:12,name:"stream_outputs",kind:"message",T:fP,repeated:!0},{no:13,name:"segment_outputs",kind:"message",T:fI,repeated:!0},{no:14,name:"image_outputs",kind:"message",T:fJ,repeated:!0},{no:16,name:"webhooks",kind:"message",T:fw,repeated:!0}]),fH=ey.makeMessageType("livekit.EncodedFileOutput",()=>[{no:1,name:"file_type",kind:"enum",T:ey.getEnumType(fz)},{no:2,name:"filepath",kind:"scalar",T:9},{no:6,name:"disable_manifest",kind:"scalar",T:8},{no:3,name:"s3",kind:"message",T:fK,oneof:"output"},{no:4,name:"gcp",kind:"message",T:fL,oneof:"output"},{no:5,name:"azure",kind:"message",T:fM,oneof:"output"},{no:7,name:"aliOSS",kind:"message",T:fN,oneof:"output"}]),fI=ey.makeMessageType("livekit.SegmentedFileOutput",()=>[{no:1,name:"protocol",kind:"enum",T:ey.getEnumType(fA)},{no:2,name:"filename_prefix",kind:"scalar",T:9},{no:3,name:"playlist_name",kind:"scalar",T:9},{no:11,name:"live_playlist_name",kind:"scalar",T:9},{no:4,name:"segment_duration",kind:"scalar",T:13},{no:10,name:"filename_suffix",kind:"enum",T:ey.getEnumType(fB)},{no:8,name:"disable_manifest",kind:"scalar",T:8},{no:5,name:"s3",kind:"message",T:fK,oneof:"output"},{no:6,name:"gcp",kind:"message",T:fL,oneof:"output"},{no:7,name:"azure",kind:"message",T:fM,oneof:"output"},{no:9,name:"aliOSS",kind:"message",T:fN,oneof:"output"}]),fJ=ey.makeMessageType("livekit.ImageOutput",()=>[{no:1,name:"capture_interval",kind:"scalar",T:13},{no:2,name:"width",kind:"scalar",T:5},{no:3,name:"height",kind:"scalar",T:5},{no:4,name:"filename_prefix",kind:"scalar",T:9},{no:5,name:"filename_suffix",kind:"enum",T:ey.getEnumType(fC)},{no:6,name:"image_codec",kind:"enum",T:ey.getEnumType(eG)},{no:7,name:"disable_manifest",kind:"scalar",T:8},{no:8,name:"s3",kind:"message",T:fK,oneof:"output"},{no:9,name:"gcp",kind:"message",T:fL,oneof:"output"},{no:10,name:"azure",kind:"message",T:fM,oneof:"output"},{no:11,name:"aliOSS",kind:"message",T:fN,oneof:"output"}]),fK=ey.makeMessageType("livekit.S3Upload",()=>[{no:1,name:"access_key",kind:"scalar",T:9},{no:2,name:"secret",kind:"scalar",T:9},{no:11,name:"session_token",kind:"scalar",T:9},{no:12,name:"assume_role_arn",kind:"scalar",T:9},{no:13,name:"assume_role_external_id",kind:"scalar",T:9},{no:3,name:"region",kind:"scalar",T:9},{no:4,name:"endpoint",kind:"scalar",T:9},{no:5,name:"bucket",kind:"scalar",T:9},{no:6,name:"force_path_style",kind:"scalar",T:8},{no:7,name:"metadata",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:8,name:"tagging",kind:"scalar",T:9},{no:9,name:"content_disposition",kind:"scalar",T:9},{no:10,name:"proxy",kind:"message",T:fO}]),fL=ey.makeMessageType("livekit.GCPUpload",()=>[{no:1,name:"credentials",kind:"scalar",T:9},{no:2,name:"bucket",kind:"scalar",T:9},{no:3,name:"proxy",kind:"message",T:fO}]),fM=ey.makeMessageType("livekit.AzureBlobUpload",()=>[{no:1,name:"account_name",kind:"scalar",T:9},{no:2,name:"account_key",kind:"scalar",T:9},{no:3,name:"container_name",kind:"scalar",T:9}]),fN=ey.makeMessageType("livekit.AliOSSUpload",()=>[{no:1,name:"access_key",kind:"scalar",T:9},{no:2,name:"secret",kind:"scalar",T:9},{no:3,name:"region",kind:"scalar",T:9},{no:4,name:"endpoint",kind:"scalar",T:9},{no:5,name:"bucket",kind:"scalar",T:9}]),fO=ey.makeMessageType("livekit.ProxyConfig",()=>[{no:1,name:"url",kind:"scalar",T:9},{no:2,name:"username",kind:"scalar",T:9},{no:3,name:"password",kind:"scalar",T:9}]),fP=ey.makeMessageType("livekit.StreamOutput",()=>[{no:1,name:"protocol",kind:"enum",T:ey.getEnumType(fD)},{no:2,name:"urls",kind:"scalar",T:9,repeated:!0}]),fQ=ey.makeMessageType("livekit.EncodingOptions",()=>[{no:1,name:"width",kind:"scalar",T:5},{no:2,name:"height",kind:"scalar",T:5},{no:3,name:"depth",kind:"scalar",T:5},{no:4,name:"framerate",kind:"scalar",T:5},{no:5,name:"audio_codec",kind:"enum",T:ey.getEnumType(eE)},{no:6,name:"audio_bitrate",kind:"scalar",T:5},{no:11,name:"audio_quality",kind:"scalar",T:5},{no:7,name:"audio_frequency",kind:"scalar",T:5},{no:8,name:"video_codec",kind:"enum",T:ey.getEnumType(eF)},{no:9,name:"video_bitrate",kind:"scalar",T:5},{no:12,name:"video_quality",kind:"scalar",T:5},{no:10,name:"key_frame_interval",kind:"scalar",T:1}]),fR=ey.makeMessageType("livekit.AutoParticipantEgress",()=>[{no:1,name:"preset",kind:"enum",T:ey.getEnumType(fF),oneof:"options"},{no:2,name:"advanced",kind:"message",T:fQ,oneof:"options"},{no:3,name:"file_outputs",kind:"message",T:fH,repeated:!0},{no:4,name:"segment_outputs",kind:"message",T:fI,repeated:!0}]),fS=ey.makeMessageType("livekit.AutoTrackEgress",()=>[{no:1,name:"filepath",kind:"scalar",T:9},{no:5,name:"disable_manifest",kind:"scalar",T:8},{no:2,name:"s3",kind:"message",T:fK,oneof:"output"},{no:3,name:"gcp",kind:"message",T:fL,oneof:"output"},{no:4,name:"azure",kind:"message",T:fM,oneof:"output"},{no:6,name:"aliOSS",kind:"message",T:fN,oneof:"output"}]),fT=ey.makeMessageType("livekit.RoomEgress",()=>[{no:1,name:"room",kind:"message",T:fG},{no:3,name:"participant",kind:"message",T:fR},{no:2,name:"tracks",kind:"message",T:fS}]),fU=(()=>[{no:1,name:"name",kind:"scalar",T:9},{no:2,name:"empty_timeout",kind:"scalar",T:13},{no:3,name:"departure_timeout",kind:"scalar",T:13},{no:4,name:"max_participants",kind:"scalar",T:13},{no:11,name:"metadata",kind:"scalar",T:9},{no:5,name:"egress",kind:"message",T:fT},{no:7,name:"min_playout_delay",kind:"scalar",T:13},{no:8,name:"max_playout_delay",kind:"scalar",T:13},{no:9,name:"sync_streams",kind:"scalar",T:8},{no:10,name:"agents",kind:"message",T:fy,repeated:!0}],ey.makeEnum("livekit.SignalTarget",[{no:0,name:"PUBLISHER"},{no:1,name:"SUBSCRIBER"}])),fV=ey.makeEnum("livekit.StreamState",[{no:0,name:"ACTIVE"},{no:1,name:"PAUSED"}]),fW=ey.makeEnum("livekit.CandidateProtocol",[{no:0,name:"UDP"},{no:1,name:"TCP"},{no:2,name:"TLS"}]),fX=ey.makeMessageType("livekit.SignalRequest",()=>[{no:1,name:"offer",kind:"message",T:f5,oneof:"message"},{no:2,name:"answer",kind:"message",T:f5,oneof:"message"},{no:3,name:"trickle",kind:"message",T:f_,oneof:"message"},{no:4,name:"add_track",kind:"message",T:f$,oneof:"message"},{no:5,name:"mute",kind:"message",T:f0,oneof:"message"},{no:6,name:"subscription",kind:"message",T:f7,oneof:"message"},{no:7,name:"track_setting",kind:"message",T:f8,oneof:"message"},{no:8,name:"leave",kind:"message",T:gb,oneof:"message"},{no:10,name:"update_layers",kind:"message",T:gd,oneof:"message"},{no:11,name:"subscription_permission",kind:"message",T:gr,oneof:"message"},{no:12,name:"sync_state",kind:"message",T:gu,oneof:"message"},{no:13,name:"simulate",kind:"message",T:gx,oneof:"message"},{no:14,name:"ping",kind:"scalar",T:3,oneof:"message"},{no:15,name:"update_metadata",kind:"message",T:ge,oneof:"message"},{no:16,name:"ping_req",kind:"message",T:gy,oneof:"message"},{no:17,name:"update_audio_track",kind:"message",T:f9,oneof:"message"},{no:18,name:"update_video_track",kind:"message",T:ga,oneof:"message"}]),fY=ey.makeMessageType("livekit.SignalResponse",()=>[{no:1,name:"join",kind:"message",T:f1,oneof:"message"},{no:2,name:"answer",kind:"message",T:f5,oneof:"message"},{no:3,name:"offer",kind:"message",T:f5,oneof:"message"},{no:4,name:"trickle",kind:"message",T:f_,oneof:"message"},{no:5,name:"update",kind:"message",T:f6,oneof:"message"},{no:6,name:"track_published",kind:"message",T:f3,oneof:"message"},{no:8,name:"leave",kind:"message",T:gb,oneof:"message"},{no:9,name:"mute",kind:"message",T:f0,oneof:"message"},{no:10,name:"speakers_changed",kind:"message",T:gg,oneof:"message"},{no:11,name:"room_update",kind:"message",T:gh,oneof:"message"},{no:12,name:"connection_quality",kind:"message",T:gj,oneof:"message"},{no:13,name:"stream_state_update",kind:"message",T:gl,oneof:"message"},{no:14,name:"subscribed_quality_update",kind:"message",T:go,oneof:"message"},{no:15,name:"subscription_permission_update",kind:"message",T:gs,oneof:"message"},{no:16,name:"refresh_token",kind:"scalar",T:9,oneof:"message"},{no:17,name:"track_unpublished",kind:"message",T:f4,oneof:"message"},{no:18,name:"pong",kind:"scalar",T:3,oneof:"message"},{no:19,name:"reconnect",kind:"message",T:f2,oneof:"message"},{no:20,name:"pong_resp",kind:"message",T:gz,oneof:"message"},{no:21,name:"subscription_response",kind:"message",T:gC,oneof:"message"},{no:22,name:"request_response",kind:"message",T:gD,oneof:"message"},{no:23,name:"track_subscribed",kind:"message",T:gF,oneof:"message"},{no:24,name:"room_moved",kind:"message",T:gt,oneof:"message"},{no:25,name:"media_sections_requirement",kind:"message",T:gK,oneof:"message"},{no:26,name:"subscribed_audio_codec_update",kind:"message",T:gp,oneof:"message"}]),fZ=ey.makeMessageType("livekit.SimulcastCodec",()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"cid",kind:"scalar",T:9},{no:4,name:"layers",kind:"message",T:e_,repeated:!0},{no:5,name:"video_layer_mode",kind:"enum",T:ey.getEnumType(e0)}]),f$=ey.makeMessageType("livekit.AddTrackRequest",()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"type",kind:"enum",T:ey.getEnumType(eI)},{no:4,name:"width",kind:"scalar",T:13},{no:5,name:"height",kind:"scalar",T:13},{no:6,name:"muted",kind:"scalar",T:8},{no:7,name:"disable_dtx",kind:"scalar",T:8},{no:8,name:"source",kind:"enum",T:ey.getEnumType(eJ)},{no:9,name:"layers",kind:"message",T:e_,repeated:!0},{no:10,name:"simulcast_codecs",kind:"message",T:fZ,repeated:!0},{no:11,name:"sid",kind:"scalar",T:9},{no:12,name:"stereo",kind:"scalar",T:8},{no:13,name:"disable_red",kind:"scalar",T:8},{no:14,name:"encryption",kind:"enum",T:ey.getEnumType(eY)},{no:15,name:"stream",kind:"scalar",T:9},{no:16,name:"backup_codec_policy",kind:"enum",T:ey.getEnumType(eH)},{no:17,name:"audio_features",kind:"enum",T:ey.getEnumType(eQ),repeated:!0}]),f_=ey.makeMessageType("livekit.TrickleRequest",()=>[{no:1,name:"candidateInit",kind:"scalar",T:9},{no:2,name:"target",kind:"enum",T:ey.getEnumType(fU)},{no:3,name:"final",kind:"scalar",T:8}]),f0=ey.makeMessageType("livekit.MuteTrackRequest",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"muted",kind:"scalar",T:8}]),f1=ey.makeMessageType("livekit.JoinResponse",()=>[{no:1,name:"room",kind:"message",T:eR},{no:2,name:"participant",kind:"message",T:eU},{no:3,name:"other_participants",kind:"message",T:eU,repeated:!0},{no:4,name:"server_version",kind:"scalar",T:9},{no:5,name:"ice_servers",kind:"message",T:gf,repeated:!0},{no:6,name:"subscriber_primary",kind:"scalar",T:8},{no:7,name:"alternative_url",kind:"scalar",T:9},{no:8,name:"client_configuration",kind:"message",T:fl},{no:9,name:"server_region",kind:"scalar",T:9},{no:10,name:"ping_timeout",kind:"scalar",T:5},{no:11,name:"ping_interval",kind:"scalar",T:5},{no:12,name:"server_info",kind:"message",T:fh},{no:13,name:"sif_trailer",kind:"scalar",T:12},{no:14,name:"enabled_publish_codecs",kind:"message",T:eS,repeated:!0},{no:15,name:"fast_publish",kind:"scalar",T:8}]),f2=ey.makeMessageType("livekit.ReconnectResponse",()=>[{no:1,name:"ice_servers",kind:"message",T:gf,repeated:!0},{no:2,name:"client_configuration",kind:"message",T:fl},{no:3,name:"server_info",kind:"message",T:fh},{no:4,name:"last_message_seq",kind:"scalar",T:13}]),f3=ey.makeMessageType("livekit.TrackPublishedResponse",()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"track",kind:"message",T:e$}]),f4=ey.makeMessageType("livekit.TrackUnpublishedResponse",()=>[{no:1,name:"track_sid",kind:"scalar",T:9}]),f5=ey.makeMessageType("livekit.SessionDescription",()=>[{no:1,name:"type",kind:"scalar",T:9},{no:2,name:"sdp",kind:"scalar",T:9},{no:3,name:"id",kind:"scalar",T:13},{no:4,name:"mid_to_track_id",kind:"map",K:9,V:{kind:"scalar",T:9}}]),f6=ey.makeMessageType("livekit.ParticipantUpdate",()=>[{no:1,name:"participants",kind:"message",T:eU,repeated:!0}]),f7=ey.makeMessageType("livekit.UpdateSubscription",()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:2,name:"subscribe",kind:"scalar",T:8},{no:3,name:"participant_tracks",kind:"message",T:fg,repeated:!0}]),f8=ey.makeMessageType("livekit.UpdateTrackSettings",()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:3,name:"disabled",kind:"scalar",T:8},{no:4,name:"quality",kind:"enum",T:ey.getEnumType(eK)},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"fps",kind:"scalar",T:13},{no:8,name:"priority",kind:"scalar",T:13}]),f9=ey.makeMessageType("livekit.UpdateLocalAudioTrack",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"features",kind:"enum",T:ey.getEnumType(eQ),repeated:!0}]),ga=ey.makeMessageType("livekit.UpdateLocalVideoTrack",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13}]),gb=ey.makeMessageType("livekit.LeaveRequest",()=>[{no:1,name:"can_reconnect",kind:"scalar",T:8},{no:2,name:"reason",kind:"enum",T:ey.getEnumType(eN)},{no:3,name:"action",kind:"enum",T:ey.getEnumType(gc)},{no:4,name:"regions",kind:"message",T:gA}]),gc=ey.makeEnum("livekit.LeaveRequest.Action",[{no:0,name:"DISCONNECT"},{no:1,name:"RESUME"},{no:2,name:"RECONNECT"}]),gd=ey.makeMessageType("livekit.UpdateVideoLayers",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"layers",kind:"message",T:e_,repeated:!0}]),ge=ey.makeMessageType("livekit.UpdateParticipantMetadata",()=>[{no:1,name:"metadata",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:4,name:"request_id",kind:"scalar",T:13}]),gf=ey.makeMessageType("livekit.ICEServer",()=>[{no:1,name:"urls",kind:"scalar",T:9,repeated:!0},{no:2,name:"username",kind:"scalar",T:9},{no:3,name:"credential",kind:"scalar",T:9}]),gg=ey.makeMessageType("livekit.SpeakersChanged",()=>[{no:1,name:"speakers",kind:"message",T:e6,repeated:!0}]),gh=ey.makeMessageType("livekit.RoomUpdate",()=>[{no:1,name:"room",kind:"message",T:eR}]),gi=ey.makeMessageType("livekit.ConnectionQualityInfo",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"quality",kind:"enum",T:ey.getEnumType(eL)},{no:3,name:"score",kind:"scalar",T:2}]),gj=ey.makeMessageType("livekit.ConnectionQualityUpdate",()=>[{no:1,name:"updates",kind:"message",T:gi,repeated:!0}]),gk=ey.makeMessageType("livekit.StreamStateInfo",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:ey.getEnumType(fV)}]),gl=ey.makeMessageType("livekit.StreamStateUpdate",()=>[{no:1,name:"stream_states",kind:"message",T:gk,repeated:!0}]),gm=ey.makeMessageType("livekit.SubscribedQuality",()=>[{no:1,name:"quality",kind:"enum",T:ey.getEnumType(eK)},{no:2,name:"enabled",kind:"scalar",T:8}]),gn=ey.makeMessageType("livekit.SubscribedCodec",()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"qualities",kind:"message",T:gm,repeated:!0}]),go=ey.makeMessageType("livekit.SubscribedQualityUpdate",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"subscribed_qualities",kind:"message",T:gm,repeated:!0},{no:3,name:"subscribed_codecs",kind:"message",T:gn,repeated:!0}]),gp=ey.makeMessageType("livekit.SubscribedAudioCodecUpdate",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"subscribed_audio_codecs",kind:"message",T:fx,repeated:!0}]),gq=ey.makeMessageType("livekit.TrackPermission",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"all_tracks",kind:"scalar",T:8},{no:3,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:4,name:"participant_identity",kind:"scalar",T:9}]),gr=ey.makeMessageType("livekit.SubscriptionPermission",()=>[{no:1,name:"all_participants",kind:"scalar",T:8},{no:2,name:"track_permissions",kind:"message",T:gq,repeated:!0}]),gs=ey.makeMessageType("livekit.SubscriptionPermissionUpdate",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"allowed",kind:"scalar",T:8}]),gt=ey.makeMessageType("livekit.RoomMovedResponse",()=>[{no:1,name:"room",kind:"message",T:eR},{no:2,name:"token",kind:"scalar",T:9},{no:3,name:"participant",kind:"message",T:eU},{no:4,name:"other_participants",kind:"message",T:eU,repeated:!0}]),gu=ey.makeMessageType("livekit.SyncState",()=>[{no:1,name:"answer",kind:"message",T:f5},{no:2,name:"subscription",kind:"message",T:f7},{no:3,name:"publish_tracks",kind:"message",T:f3,repeated:!0},{no:4,name:"data_channels",kind:"message",T:gw,repeated:!0},{no:5,name:"offer",kind:"message",T:f5},{no:6,name:"track_sids_disabled",kind:"scalar",T:9,repeated:!0},{no:7,name:"datachannel_receive_states",kind:"message",T:gv,repeated:!0}]),gv=ey.makeMessageType("livekit.DataChannelReceiveState",()=>[{no:1,name:"publisher_sid",kind:"scalar",T:9},{no:2,name:"last_seq",kind:"scalar",T:13}]),gw=ey.makeMessageType("livekit.DataChannelInfo",()=>[{no:1,name:"label",kind:"scalar",T:9},{no:2,name:"id",kind:"scalar",T:13},{no:3,name:"target",kind:"enum",T:ey.getEnumType(fU)}]),gx=ey.makeMessageType("livekit.SimulateScenario",()=>[{no:1,name:"speaker_update",kind:"scalar",T:5,oneof:"scenario"},{no:2,name:"node_failure",kind:"scalar",T:8,oneof:"scenario"},{no:3,name:"migration",kind:"scalar",T:8,oneof:"scenario"},{no:4,name:"server_leave",kind:"scalar",T:8,oneof:"scenario"},{no:5,name:"switch_candidate_protocol",kind:"enum",T:ey.getEnumType(fW),oneof:"scenario"},{no:6,name:"subscriber_bandwidth",kind:"scalar",T:3,oneof:"scenario"},{no:7,name:"disconnect_signal_on_resume",kind:"scalar",T:8,oneof:"scenario"},{no:8,name:"disconnect_signal_on_resume_no_messages",kind:"scalar",T:8,oneof:"scenario"},{no:9,name:"leave_request_full_reconnect",kind:"scalar",T:8,oneof:"scenario"}]),gy=ey.makeMessageType("livekit.Ping",()=>[{no:1,name:"timestamp",kind:"scalar",T:3},{no:2,name:"rtt",kind:"scalar",T:3}]),gz=ey.makeMessageType("livekit.Pong",()=>[{no:1,name:"last_ping_timestamp",kind:"scalar",T:3},{no:2,name:"timestamp",kind:"scalar",T:3}]),gA=ey.makeMessageType("livekit.RegionSettings",()=>[{no:1,name:"regions",kind:"message",T:gB,repeated:!0}]),gB=ey.makeMessageType("livekit.RegionInfo",()=>[{no:1,name:"region",kind:"scalar",T:9},{no:2,name:"url",kind:"scalar",T:9},{no:3,name:"distance",kind:"scalar",T:3}]),gC=ey.makeMessageType("livekit.SubscriptionResponse",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"err",kind:"enum",T:ey.getEnumType(eP)}]),gD=ey.makeMessageType("livekit.RequestResponse",()=>[{no:1,name:"request_id",kind:"scalar",T:13},{no:2,name:"reason",kind:"enum",T:ey.getEnumType(gE)},{no:3,name:"message",kind:"scalar",T:9},{no:4,name:"trickle",kind:"message",T:f_,oneof:"request"},{no:5,name:"add_track",kind:"message",T:f$,oneof:"request"},{no:6,name:"mute",kind:"message",T:f0,oneof:"request"},{no:7,name:"update_metadata",kind:"message",T:ge,oneof:"request"},{no:8,name:"update_audio_track",kind:"message",T:f9,oneof:"request"},{no:9,name:"update_video_track",kind:"message",T:ga,oneof:"request"}]),gE=ey.makeEnum("livekit.RequestResponse.Reason",[{no:0,name:"OK"},{no:1,name:"NOT_FOUND"},{no:2,name:"NOT_ALLOWED"},{no:3,name:"LIMIT_EXCEEDED"},{no:4,name:"QUEUED"},{no:5,name:"UNSUPPORTED_TYPE"},{no:6,name:"UNCLASSIFIED_ERROR"}]),gF=ey.makeMessageType("livekit.TrackSubscribed",()=>[{no:1,name:"track_sid",kind:"scalar",T:9}]),gG=ey.makeMessageType("livekit.ConnectionSettings",()=>[{no:1,name:"auto_subscribe",kind:"scalar",T:8},{no:2,name:"adaptive_stream",kind:"scalar",T:8},{no:3,name:"subscriber_allow_pause",kind:"scalar",T:8,opt:!0},{no:4,name:"disable_ice_lite",kind:"scalar",T:8}]),gH=ey.makeMessageType("livekit.JoinRequest",()=>[{no:1,name:"client_info",kind:"message",T:fj},{no:2,name:"connection_settings",kind:"message",T:gG},{no:3,name:"metadata",kind:"scalar",T:9},{no:4,name:"participant_attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:5,name:"add_track_requests",kind:"message",T:f$,repeated:!0},{no:6,name:"publisher_offer",kind:"message",T:f5},{no:7,name:"reconnect",kind:"scalar",T:8},{no:8,name:"reconnect_reason",kind:"enum",T:ey.getEnumType(eO)},{no:9,name:"participant_sid",kind:"scalar",T:9},{no:10,name:"sync_state",kind:"message",T:gu}]),gI=ey.makeMessageType("livekit.WrappedJoinRequest",()=>[{no:1,name:"compression",kind:"enum",T:ey.getEnumType(gJ)},{no:2,name:"join_request",kind:"scalar",T:12}]),gJ=ey.makeEnum("livekit.WrappedJoinRequest.Compression",[{no:0,name:"NONE"},{no:1,name:"GZIP"}]),gK=ey.makeMessageType("livekit.MediaSectionsRequirement",()=>[{no:1,name:"num_audios",kind:"scalar",T:13},{no:2,name:"num_videos",kind:"scalar",T:13}]);var gL={exports:{}},gM=gL.exports,gN=function(){var a;return k8?gL.exports:(k8=1,a=function(){var a=function(){},b="undefined",c=["trace","debug","info","warn","error"],d={},e=null;function f(a,b){var c=a[b];if("function"==typeof c.bind)return c.bind(a);try{return Function.prototype.bind.call(c,a)}catch(b){return function(){return Function.prototype.apply.apply(c,[a,arguments])}}}function g(){for(var d=this.getLevel(),e=0;e<c.length;e++){var f=c[e];this[f]=e<d?a:this.methodFactory(f,d,this.name)}if(this.log=this.debug,typeof console===b&&d<this.levels.SILENT)return"No console available for logging"}function h(a){return function(){typeof console!==b&&(g.call(this),this[a].apply(this,arguments))}}function i(c,d,e){var g;return"debug"===(g=c)&&(g="log"),typeof console!==b&&(void 0!==console[g]?f(console,g):void 0!==console.log?f(console,"log"):a)||h.apply(this,arguments)}function j(a,b){var f,h,j,k=this;function l(){}function m(a){var b=a;if("string"==typeof b&&void 0!==k.levels[b.toUpperCase()]&&(b=k.levels[b.toUpperCase()]),"number"==typeof b&&b>=0&&b<=k.levels.SILENT)return b;throw TypeError("log.setLevel() called with invalid level: "+a)}k.name=a,k.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},k.methodFactory=b||i,k.getLevel=function(){return null!=j?j:null!=h?h:f},k.setLevel=function(a,b){return j=m(a),!1!==b&&(c[j]||"silent").toUpperCase(),g.call(k)},k.setDefaultLevel=function(a){h=m(a),l()||k.setLevel(a,!1)},k.resetLevel=function(){j=null,g.call(k)},k.enableAll=function(a){k.setLevel(k.levels.TRACE,a)},k.disableAll=function(a){k.setLevel(k.levels.SILENT,a)},k.rebuild=function(){if(e!==k&&(f=m(e.getLevel())),g.call(k),e===k)for(var a in d)d[a].rebuild()},f=m(e?e.getLevel():"WARN");var n=l();null!=n&&(j=m(n)),g.call(k)}return(e=new j).getLogger=function(a){if("symbol"!=typeof a&&"string"!=typeof a||""===a)throw TypeError("You must supply a name when creating a logger.");var b=d[a];return b||(b=d[a]=new j(a,e.methodFactory)),b},e.noConflict=function(){return e},e.getLoggers=function(){return d},e.default=e,e},gL.exports?gL.exports=a():gM.log=a(),gL.exports)}();(kC=k9||(k9={}))[kC.trace=0]="trace",kC[kC.debug=1]="debug",kC[kC.info=2]="info",kC[kC.warn=3]="warn",kC[kC.error=4]="error",kC[kC.silent=5]="silent",(kD=la||(la={})).Default="livekit",kD.Room="livekit-room",kD.TokenSource="livekit-token-source",kD.Participant="livekit-participant",kD.Track="livekit-track",kD.Publication="livekit-track-publication",kD.Engine="livekit-engine",kD.Signal="livekit-signal",kD.PCManager="livekit-pc-manager",kD.PCTransport="livekit-pc-transport",kD.E2EE="lk-e2ee";let gO=gN.getLogger("livekit");function gP(a){let b=gN.getLogger(a);return b.setDefaultLevel(gO.getLevel()),b}Object.values(la).map(a=>gN.getLogger(a)),gO.setDefaultLevel(k9.info);let gQ=gN.getLogger("lk-e2ee"),gR=[0,300,1200,2700,4800,7e3,7e3,7e3,7e3,7e3];function gS(a,b,c,d){return new(c||(c=Promise))(function(e,f){function g(a){try{i(d.next(a))}catch(a){f(a)}}function h(a){try{i(d.throw(a))}catch(a){f(a)}}function i(a){var b;a.done?e(a.value):((b=a.value)instanceof c?b:new c(function(a){a(b)})).then(g,h)}i((d=d.apply(a,b||[])).next())})}function gT(a){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var b,c=a[Symbol.asyncIterator];return c?c.call(a):(a=function(a){var b="function"==typeof Symbol&&Symbol.iterator,c=b&&a[b],d=0;if(c)return c.call(a);if(a&&"number"==typeof a.length)return{next:function(){return a&&d>=a.length&&(a=void 0),{value:a&&a[d++],done:!a}}};throw TypeError(b?"Object is not iterable.":"Symbol.iterator is not defined.")}(a),b={},d("next"),d("throw"),d("return"),b[Symbol.asyncIterator]=function(){return this},b);function d(c){b[c]=a[c]&&function(b){return new Promise(function(d,e){var f,g,h;f=d,g=e,h=(b=a[c](b)).done,Promise.resolve(b.value).then(function(a){f({value:a,done:h})},g)})}}}"function"==typeof SuppressedError&&SuppressedError;var gU={exports:{}},gV=function(){if(lb)return gU.exports;lb=1;var a,b="object"==typeof Reflect?Reflect:null,c=b&&"function"==typeof b.apply?b.apply:function(a,b,c){return Function.prototype.apply.call(a,b,c)};a=b&&"function"==typeof b.ownKeys?b.ownKeys:Object.getOwnPropertySymbols?function(a){return Object.getOwnPropertyNames(a).concat(Object.getOwnPropertySymbols(a))}:function(a){return Object.getOwnPropertyNames(a)};var d=Number.isNaN||function(a){return a!=a};function e(){e.init.call(this)}gU.exports=e,gU.exports.once=function(a,b){return new Promise(function(c,d){var e,f,g;function h(c){a.removeListener(b,i),d(c)}function i(){"function"==typeof a.removeListener&&a.removeListener("error",h),c([].slice.call(arguments))}o(a,b,i,{once:!0}),"error"!==b&&(e=a,f=h,g={once:!0},"function"==typeof e.on&&o(e,"error",f,g))})},e.EventEmitter=e,e.prototype._events=void 0,e.prototype._eventsCount=0,e.prototype._maxListeners=void 0;var f=10;function g(a){if("function"!=typeof a)throw TypeError('The "listener" argument must be of type Function. Received type '+typeof a)}function h(a){return void 0===a._maxListeners?e.defaultMaxListeners:a._maxListeners}function i(a,b,c,d){if(g(c),void 0===(f=a._events)?(f=a._events=Object.create(null),a._eventsCount=0):(void 0!==f.newListener&&(a.emit("newListener",b,c.listener?c.listener:c),f=a._events),i=f[b]),void 0===i)i=f[b]=c,++a._eventsCount;else if("function"==typeof i?i=f[b]=d?[c,i]:[i,c]:d?i.unshift(c):i.push(c),(e=h(a))>0&&i.length>e&&!i.warned){i.warned=!0;var e,f,i,j=Error("Possible EventEmitter memory leak detected. "+i.length+" "+String(b)+" listeners added. Use emitter.setMaxListeners() to increase limit");j.name="MaxListenersExceededWarning",j.emitter=a,j.type=b,j.count=i.length,console&&console.warn&&console.warn(j)}return a}function j(){if(!this.fired)return(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0==arguments.length)?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function k(a,b,c){var d={fired:!1,wrapFn:void 0,target:a,type:b,listener:c},e=j.bind(d);return e.listener=c,d.wrapFn=e,e}function l(a,b,c){var d=a._events;if(void 0===d)return[];var e=d[b];return void 0===e?[]:"function"==typeof e?c?[e.listener||e]:[e]:c?function(a){for(var b=Array(a.length),c=0;c<b.length;++c)b[c]=a[c].listener||a[c];return b}(e):n(e,e.length)}function m(a){var b=this._events;if(void 0!==b){var c=b[a];if("function"==typeof c)return 1;if(void 0!==c)return c.length}return 0}function n(a,b){for(var c=Array(b),d=0;d<b;++d)c[d]=a[d];return c}function o(a,b,c,d){if("function"==typeof a.on)d.once?a.once(b,c):a.on(b,c);else if("function"==typeof a.addEventListener)a.addEventListener(b,function e(f){d.once&&a.removeEventListener(b,e),c(f)});else throw TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof a)}return Object.defineProperty(e,"defaultMaxListeners",{enumerable:!0,get:function(){return f},set:function(a){if("number"!=typeof a||a<0||d(a))throw RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+a+".");f=a}}),e.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},e.prototype.setMaxListeners=function(a){if("number"!=typeof a||a<0||d(a))throw RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+a+".");return this._maxListeners=a,this},e.prototype.getMaxListeners=function(){return h(this)},e.prototype.emit=function(a){for(var b=[],d=1;d<arguments.length;d++)b.push(arguments[d]);var e="error"===a,f=this._events;if(void 0!==f)e=e&&void 0===f.error;else if(!e)return!1;if(e){if(b.length>0&&(g=b[0]),g instanceof Error)throw g;var g,h=Error("Unhandled error."+(g?" ("+g.message+")":""));throw h.context=g,h}var i=f[a];if(void 0===i)return!1;if("function"==typeof i)c(i,this,b);else for(var j=i.length,k=n(i,j),d=0;d<j;++d)c(k[d],this,b);return!0},e.prototype.addListener=function(a,b){return i(this,a,b,!1)},e.prototype.on=e.prototype.addListener,e.prototype.prependListener=function(a,b){return i(this,a,b,!0)},e.prototype.once=function(a,b){return g(b),this.on(a,k(this,a,b)),this},e.prototype.prependOnceListener=function(a,b){return g(b),this.prependListener(a,k(this,a,b)),this},e.prototype.removeListener=function(a,b){var c,d,e,f,h;if(g(b),void 0===(d=this._events)||void 0===(c=d[a]))return this;if(c===b||c.listener===b)0==--this._eventsCount?this._events=Object.create(null):(delete d[a],d.removeListener&&this.emit("removeListener",a,c.listener||b));else if("function"!=typeof c){for(e=-1,f=c.length-1;f>=0;f--)if(c[f]===b||c[f].listener===b){h=c[f].listener,e=f;break}if(e<0)return this;0===e?c.shift():function(a,b){for(;b+1<a.length;b++)a[b]=a[b+1];a.pop()}(c,e),1===c.length&&(d[a]=c[0]),void 0!==d.removeListener&&this.emit("removeListener",a,h||b)}return this},e.prototype.off=e.prototype.removeListener,e.prototype.removeAllListeners=function(a){var b,c,d;if(void 0===(c=this._events))return this;if(void 0===c.removeListener)return 0==arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==c[a]&&(0==--this._eventsCount?this._events=Object.create(null):delete c[a]),this;if(0==arguments.length){var e,f=Object.keys(c);for(d=0;d<f.length;++d)"removeListener"!==(e=f[d])&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(b=c[a]))this.removeListener(a,b);else if(void 0!==b)for(d=b.length-1;d>=0;d--)this.removeListener(a,b[d]);return this},e.prototype.listeners=function(a){return l(this,a,!0)},e.prototype.rawListeners=function(a){return l(this,a,!1)},e.listenerCount=function(a,b){return"function"==typeof a.listenerCount?a.listenerCount(b):m.call(a,b)},e.prototype.listenerCount=m,e.prototype.eventNames=function(){return this._eventsCount>0?a(this._events):[]},gU.exports}();let gW=!0;function gX(a,b,c){let d=a.match(b);return d&&d.length>=c&&parseFloat(d[c],10)}function gY(a,b,c){if(!a.RTCPeerConnection)return;let d=a.RTCPeerConnection.prototype,e=d.addEventListener;d.addEventListener=function(a,d){if(a!==b)return e.apply(this,arguments);let f=a=>{let b=c(a);b&&(d.handleEvent?d.handleEvent(b):d(b))};return this._eventMap=this._eventMap||{},this._eventMap[b]||(this._eventMap[b]=new Map),this._eventMap[b].set(d,f),e.apply(this,[a,f])};let f=d.removeEventListener;d.removeEventListener=function(a,c){if(a!==b||!this._eventMap||!this._eventMap[b]||!this._eventMap[b].has(c))return f.apply(this,arguments);let d=this._eventMap[b].get(c);return this._eventMap[b].delete(c),0===this._eventMap[b].size&&delete this._eventMap[b],0===Object.keys(this._eventMap).length&&delete this._eventMap,f.apply(this,[a,d])},Object.defineProperty(d,"on"+b,{get(){return this["_on"+b]},set(a){this["_on"+b]&&(this.removeEventListener(b,this["_on"+b]),delete this["_on"+b]),a&&this.addEventListener(b,this["_on"+b]=a)},enumerable:!0,configurable:!0})}function gZ(a){return"boolean"!=typeof a?Error("Argument type: "+typeof a+". Please use a boolean."):a?"adapter.js logging disabled":"adapter.js logging enabled"}function g$(a){return"boolean"!=typeof a?Error("Argument type: "+typeof a+". Please use a boolean."):(gW=!a,"adapter.js deprecation warnings "+(a?"disabled":"enabled"))}function g_(){}function g0(a,b){gW&&console.warn(a+" is deprecated, please use "+b+" instead.")}function g1(a){return"[object Object]"===Object.prototype.toString.call(a)}function g2(a,b,c){let d=c?"outbound-rtp":"inbound-rtp",e=new Map;if(null===b)return e;let f=[];return a.forEach(a=>{"track"===a.type&&a.trackIdentifier===b.id&&f.push(a)}),f.forEach(b=>{a.forEach(c=>{c.type===d&&c.trackId===b.id&&function a(b,c,d){!c||d.has(c.id)||(d.set(c.id,c),Object.keys(c).forEach(e=>{e.endsWith("Id")?a(b,b.get(c[e]),d):e.endsWith("Ids")&&c[e].forEach(c=>{a(b,b.get(c),d)})}))}(a,c,e)})}),e}function g3(a,b){let c=a&&a.navigator;if(!c.mediaDevices)return;let d=function(a){if("object"!=typeof a||a.mandatory||a.optional)return a;let b={};return Object.keys(a).forEach(c=>{if("require"===c||"advanced"===c||"mediaSource"===c)return;let d="object"==typeof a[c]?a[c]:{ideal:a[c]};void 0!==d.exact&&"number"==typeof d.exact&&(d.min=d.max=d.exact);let e=function(a,b){return a?a+b.charAt(0).toUpperCase()+b.slice(1):"deviceId"===b?"sourceId":b};if(void 0!==d.ideal){b.optional=b.optional||[];let a={};"number"==typeof d.ideal?(a[e("min",c)]=d.ideal,b.optional.push(a),(a={})[e("max",c)]=d.ideal):a[e("",c)]=d.ideal,b.optional.push(a)}void 0!==d.exact&&"number"!=typeof d.exact?(b.mandatory=b.mandatory||{},b.mandatory[e("",c)]=d.exact):["min","max"].forEach(a=>{void 0!==d[a]&&(b.mandatory=b.mandatory||{},b.mandatory[e(a,c)]=d[a])})}),a.advanced&&(b.optional=(b.optional||[]).concat(a.advanced)),b},e=function(a,e){if(b.version>=61)return e(a);if((a=JSON.parse(JSON.stringify(a)))&&"object"==typeof a.audio){let b=function(a,b,c){b in a&&!(c in a)&&(a[c]=a[b],delete a[b])};b((a=JSON.parse(JSON.stringify(a))).audio,"autoGainControl","googAutoGainControl"),b(a.audio,"noiseSuppression","googNoiseSuppression"),a.audio=d(a.audio)}if(a&&"object"==typeof a.video){let f=a.video.facingMode;f=f&&("object"==typeof f?f:{ideal:f});let g=b.version<66;if(f&&("user"===f.exact||"environment"===f.exact||"user"===f.ideal||"environment"===f.ideal)&&!(c.mediaDevices.getSupportedConstraints&&c.mediaDevices.getSupportedConstraints().facingMode&&!g)){let b;if(delete a.video.facingMode,"environment"===f.exact||"environment"===f.ideal?b=["back","rear"]:("user"===f.exact||"user"===f.ideal)&&(b=["front"]),b)return c.mediaDevices.enumerateDevices().then(c=>{let g=(c=c.filter(a=>"videoinput"===a.kind)).find(a=>b.some(b=>a.label.toLowerCase().includes(b)));return!g&&c.length&&b.includes("back")&&(g=c[c.length-1]),g&&(a.video.deviceId=f.exact?{exact:g.deviceId}:{ideal:g.deviceId}),a.video=d(a.video),g_("chrome: "+JSON.stringify(a)),e(a)})}a.video=d(a.video)}return g_("chrome: "+JSON.stringify(a)),e(a)},f=function(a){return b.version>=64?a:{name:({PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"})[a.name]||a.name,message:a.message,constraint:a.constraint||a.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(c.getUserMedia=(function(a,b,d){e(a,a=>{c.webkitGetUserMedia(a,b,a=>{d&&d(f(a))})})}).bind(c),c.mediaDevices.getUserMedia){let a=c.mediaDevices.getUserMedia.bind(c.mediaDevices);c.mediaDevices.getUserMedia=function(b){return e(b,b=>a(b).then(a=>{if(b.audio&&!a.getAudioTracks().length||b.video&&!a.getVideoTracks().length)throw a.getTracks().forEach(a=>{a.stop()}),new DOMException("","NotFoundError");return a},a=>Promise.reject(f(a))))}}}function g4(a){a.MediaStream=a.MediaStream||a.webkitMediaStream}function g5(a){if("object"!=typeof a||!a.RTCPeerConnection||"ontrack"in a.RTCPeerConnection.prototype)gY(a,"track",a=>(a.transceiver||Object.defineProperty(a,"transceiver",{value:{receiver:a.receiver}}),a));else{Object.defineProperty(a.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(a){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=a)},enumerable:!0,configurable:!0});let b=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=b=>{b.stream.addEventListener("addtrack",c=>{let d;d=a.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(a=>a.track&&a.track.id===c.track.id):{track:c.track};let e=new Event("track");e.track=c.track,e.receiver=d,e.transceiver={receiver:d},e.streams=[b.stream],this.dispatchEvent(e)}),b.stream.getTracks().forEach(c=>{let d;d=a.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(a=>a.track&&a.track.id===c.id):{track:c};let e=new Event("track");e.track=c,e.receiver=d,e.transceiver={receiver:d},e.streams=[b.stream],this.dispatchEvent(e)})},this.addEventListener("addstream",this._ontrackpoly)),b.apply(this,arguments)}}}function g6(a){if("object"==typeof a&&a.RTCPeerConnection&&!("getSenders"in a.RTCPeerConnection.prototype)&&"createDTMFSender"in a.RTCPeerConnection.prototype){let b=function(a,b){return{track:b,get dtmf(){return void 0===this._dtmf&&("audio"===b.kind?this._dtmf=a.createDTMFSender(b):this._dtmf=null),this._dtmf},_pc:a}};if(!a.RTCPeerConnection.prototype.getSenders){a.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};let c=a.RTCPeerConnection.prototype.addTrack;a.RTCPeerConnection.prototype.addTrack=function(a,d){let e=c.apply(this,arguments);return e||(e=b(this,a),this._senders.push(e)),e};let d=a.RTCPeerConnection.prototype.removeTrack;a.RTCPeerConnection.prototype.removeTrack=function(a){d.apply(this,arguments);let b=this._senders.indexOf(a);-1!==b&&this._senders.splice(b,1)}}let c=a.RTCPeerConnection.prototype.addStream;a.RTCPeerConnection.prototype.addStream=function(a){this._senders=this._senders||[],c.apply(this,[a]),a.getTracks().forEach(a=>{this._senders.push(b(this,a))})};let d=a.RTCPeerConnection.prototype.removeStream;a.RTCPeerConnection.prototype.removeStream=function(a){this._senders=this._senders||[],d.apply(this,[a]),a.getTracks().forEach(a=>{let b=this._senders.find(b=>b.track===a);b&&this._senders.splice(this._senders.indexOf(b),1)})}}else if("object"==typeof a&&a.RTCPeerConnection&&"getSenders"in a.RTCPeerConnection.prototype&&"createDTMFSender"in a.RTCPeerConnection.prototype&&a.RTCRtpSender&&!("dtmf"in a.RTCRtpSender.prototype)){let b=a.RTCPeerConnection.prototype.getSenders;a.RTCPeerConnection.prototype.getSenders=function(){let a=b.apply(this,[]);return a.forEach(a=>a._pc=this),a},Object.defineProperty(a.RTCRtpSender.prototype,"dtmf",{get(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function g7(a){if(!("object"==typeof a&&a.RTCPeerConnection&&a.RTCRtpSender&&a.RTCRtpReceiver))return;if(!("getStats"in a.RTCRtpSender.prototype)){let b=a.RTCPeerConnection.prototype.getSenders;b&&(a.RTCPeerConnection.prototype.getSenders=function(){let a=b.apply(this,[]);return a.forEach(a=>a._pc=this),a});let c=a.RTCPeerConnection.prototype.addTrack;c&&(a.RTCPeerConnection.prototype.addTrack=function(){let a=c.apply(this,arguments);return a._pc=this,a}),a.RTCRtpSender.prototype.getStats=function(){let a=this;return this._pc.getStats().then(b=>g2(b,a.track,!0))}}if(!("getStats"in a.RTCRtpReceiver.prototype)){let b=a.RTCPeerConnection.prototype.getReceivers;b&&(a.RTCPeerConnection.prototype.getReceivers=function(){let a=b.apply(this,[]);return a.forEach(a=>a._pc=this),a}),gY(a,"track",a=>(a.receiver._pc=a.srcElement,a)),a.RTCRtpReceiver.prototype.getStats=function(){let a=this;return this._pc.getStats().then(b=>g2(b,a.track,!1))}}if(!("getStats"in a.RTCRtpSender.prototype&&"getStats"in a.RTCRtpReceiver.prototype))return;let b=a.RTCPeerConnection.prototype.getStats;a.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof a.MediaStreamTrack){let a,b,c,d=arguments[0];return(this.getSenders().forEach(b=>{b.track===d&&(a?c=!0:a=b)}),this.getReceivers().forEach(a=>(a.track===d&&(b?c=!0:b=a),a.track===d)),c||a&&b)?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):a?a.getStats():b?b.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return b.apply(this,arguments)}}function g8(a){a.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(a=>this._shimmedLocalStreams[a][0])};let b=a.RTCPeerConnection.prototype.addTrack;a.RTCPeerConnection.prototype.addTrack=function(a,c){if(!c)return b.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};let d=b.apply(this,arguments);return this._shimmedLocalStreams[c.id]?-1===this._shimmedLocalStreams[c.id].indexOf(d)&&this._shimmedLocalStreams[c.id].push(d):this._shimmedLocalStreams[c.id]=[c,d],d};let c=a.RTCPeerConnection.prototype.addStream;a.RTCPeerConnection.prototype.addStream=function(a){this._shimmedLocalStreams=this._shimmedLocalStreams||{},a.getTracks().forEach(a=>{if(this.getSenders().find(b=>b.track===a))throw new DOMException("Track already exists.","InvalidAccessError")});let b=this.getSenders();c.apply(this,arguments);let d=this.getSenders().filter(a=>-1===b.indexOf(a));this._shimmedLocalStreams[a.id]=[a].concat(d)};let d=a.RTCPeerConnection.prototype.removeStream;a.RTCPeerConnection.prototype.removeStream=function(a){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[a.id],d.apply(this,arguments)};let e=a.RTCPeerConnection.prototype.removeTrack;a.RTCPeerConnection.prototype.removeTrack=function(a){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},a&&Object.keys(this._shimmedLocalStreams).forEach(b=>{let c=this._shimmedLocalStreams[b].indexOf(a);-1!==c&&this._shimmedLocalStreams[b].splice(c,1),1===this._shimmedLocalStreams[b].length&&delete this._shimmedLocalStreams[b]}),e.apply(this,arguments)}}function g9(a,b){if(!a.RTCPeerConnection)return;if(a.RTCPeerConnection.prototype.addTrack&&b.version>=65)return g8(a);let c=a.RTCPeerConnection.prototype.getLocalStreams;a.RTCPeerConnection.prototype.getLocalStreams=function(){let a=c.apply(this);return this._reverseStreams=this._reverseStreams||{},a.map(a=>this._reverseStreams[a.id])};let d=a.RTCPeerConnection.prototype.addStream;a.RTCPeerConnection.prototype.addStream=function(b){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},b.getTracks().forEach(a=>{if(this.getSenders().find(b=>b.track===a))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[b.id]){let c=new a.MediaStream(b.getTracks());this._streams[b.id]=c,this._reverseStreams[c.id]=b,b=c}d.apply(this,[b])};let e=a.RTCPeerConnection.prototype.removeStream;function f(a,b){let c=b.sdp;return Object.keys(a._reverseStreams||[]).forEach(b=>{let d=a._reverseStreams[b],e=a._streams[d.id];c=c.replace(RegExp(e.id,"g"),d.id)}),new RTCSessionDescription({type:b.type,sdp:c})}a.RTCPeerConnection.prototype.removeStream=function(a){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},e.apply(this,[this._streams[a.id]||a]),delete this._reverseStreams[this._streams[a.id]?this._streams[a.id].id:a.id],delete this._streams[a.id]},a.RTCPeerConnection.prototype.addTrack=function(b,c){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");let d=[].slice.call(arguments,1);if(1!==d.length||!d[0].getTracks().find(a=>a===b))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(a=>a.track===b))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};let e=this._streams[c.id];if(e)e.addTrack(b),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{let d=new a.MediaStream([b]);this._streams[c.id]=d,this._reverseStreams[d.id]=c,this.addStream(d)}return this.getSenders().find(a=>a.track===b)},["createOffer","createAnswer"].forEach(function(b){let c=a.RTCPeerConnection.prototype[b];a.RTCPeerConnection.prototype[b]=({[b](){let a=arguments,b=arguments.length&&"function"==typeof arguments[0];return b?c.apply(this,[b=>{let c=f(this,b);a[0].apply(null,[c])},b=>{a[1]&&a[1].apply(null,b)},arguments[2]]):c.apply(this,arguments).then(a=>f(this,a))}})[b]});let g=a.RTCPeerConnection.prototype.setLocalDescription;a.RTCPeerConnection.prototype.setLocalDescription=function(){var a,b;let c;return arguments.length&&arguments[0].type?(arguments[0]=(a=this,b=arguments[0],c=b.sdp,Object.keys(a._reverseStreams||[]).forEach(b=>{let d=a._reverseStreams[b],e=a._streams[d.id];c=c.replace(RegExp(d.id,"g"),e.id)}),new RTCSessionDescription({type:b.type,sdp:c})),g.apply(this,arguments)):g.apply(this,arguments)};let h=Object.getOwnPropertyDescriptor(a.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(a.RTCPeerConnection.prototype,"localDescription",{get(){let a=h.get.apply(this);return""===a.type?a:f(this,a)}}),a.RTCPeerConnection.prototype.removeTrack=function(a){let b;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!a._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(a._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{},Object.keys(this._streams).forEach(c=>{this._streams[c].getTracks().find(b=>a.track===b)&&(b=this._streams[c])}),b&&(1===b.getTracks().length?this.removeStream(this._reverseStreams[b.id]):b.removeTrack(a.track),this.dispatchEvent(new Event("negotiationneeded")))}}function ha(a,b){!a.RTCPeerConnection&&a.webkitRTCPeerConnection&&(a.RTCPeerConnection=a.webkitRTCPeerConnection),a.RTCPeerConnection&&b.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(b){let c=a.RTCPeerConnection.prototype[b];a.RTCPeerConnection.prototype[b]=({[b](){return arguments[0]=new("addIceCandidate"===b?a.RTCIceCandidate:a.RTCSessionDescription)(arguments[0]),c.apply(this,arguments)}})[b]})}function hb(a,b){gY(a,"negotiationneeded",a=>{let c=a.target;if(!(b.version<72)&&(!c.getConfiguration||"plan-b"!==c.getConfiguration().sdpSemantics)||"stable"===c.signalingState)return a})}var hc=Object.freeze({__proto__:null,fixNegotiationNeeded:hb,shimAddTrackRemoveTrack:g9,shimAddTrackRemoveTrackWithNative:g8,shimGetSendersWithDtmf:g6,shimGetUserMedia:g3,shimMediaStream:g4,shimOnTrack:g5,shimPeerConnection:ha,shimSenderReceiverGetStats:g7});function hd(a,b){let c=a&&a.navigator,d=a&&a.MediaStreamTrack;if(c.getUserMedia=function(a,b,d){g0("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),c.mediaDevices.getUserMedia(a).then(b,d)},!(b.version>55&&"autoGainControl"in c.mediaDevices.getSupportedConstraints())){let a=function(a,b,c){b in a&&!(c in a)&&(a[c]=a[b],delete a[b])},b=c.mediaDevices.getUserMedia.bind(c.mediaDevices);if(c.mediaDevices.getUserMedia=function(c){return"object"==typeof c&&"object"==typeof c.audio&&(a((c=JSON.parse(JSON.stringify(c))).audio,"autoGainControl","mozAutoGainControl"),a(c.audio,"noiseSuppression","mozNoiseSuppression")),b(c)},d&&d.prototype.getSettings){let b=d.prototype.getSettings;d.prototype.getSettings=function(){let c=b.apply(this,arguments);return a(c,"mozAutoGainControl","autoGainControl"),a(c,"mozNoiseSuppression","noiseSuppression"),c}}if(d&&d.prototype.applyConstraints){let b=d.prototype.applyConstraints;d.prototype.applyConstraints=function(c){return"audio"===this.kind&&"object"==typeof c&&(a(c=JSON.parse(JSON.stringify(c)),"autoGainControl","mozAutoGainControl"),a(c,"noiseSuppression","mozNoiseSuppression")),b.apply(this,[c])}}}}function he(a){"object"==typeof a&&a.RTCTrackEvent&&"receiver"in a.RTCTrackEvent.prototype&&!("transceiver"in a.RTCTrackEvent.prototype)&&Object.defineProperty(a.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function hf(a,b){if("object"!=typeof a||!(a.RTCPeerConnection||a.mozRTCPeerConnection))return;!a.RTCPeerConnection&&a.mozRTCPeerConnection&&(a.RTCPeerConnection=a.mozRTCPeerConnection),b.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(b){let c=a.RTCPeerConnection.prototype[b];a.RTCPeerConnection.prototype[b]=({[b](){return arguments[0]=new("addIceCandidate"===b?a.RTCIceCandidate:a.RTCSessionDescription)(arguments[0]),c.apply(this,arguments)}})[b]});let c={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},d=a.RTCPeerConnection.prototype.getStats;a.RTCPeerConnection.prototype.getStats=function(){let[a,e,f]=arguments;return d.apply(this,[a||null]).then(a=>{if(b.version<53&&!e)try{a.forEach(a=>{a.type=c[a.type]||a.type})}catch(b){if("TypeError"!==b.name)throw b;a.forEach((b,d)=>{a.set(d,Object.assign({},b,{type:c[b.type]||b.type}))})}return a}).then(e,f)}}function hg(a){if(!("object"==typeof a&&a.RTCPeerConnection&&a.RTCRtpSender)||a.RTCRtpSender&&"getStats"in a.RTCRtpSender.prototype)return;let b=a.RTCPeerConnection.prototype.getSenders;b&&(a.RTCPeerConnection.prototype.getSenders=function(){let a=b.apply(this,[]);return a.forEach(a=>a._pc=this),a});let c=a.RTCPeerConnection.prototype.addTrack;c&&(a.RTCPeerConnection.prototype.addTrack=function(){let a=c.apply(this,arguments);return a._pc=this,a}),a.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function hh(a){if(!("object"==typeof a&&a.RTCPeerConnection&&a.RTCRtpSender)||a.RTCRtpSender&&"getStats"in a.RTCRtpReceiver.prototype)return;let b=a.RTCPeerConnection.prototype.getReceivers;b&&(a.RTCPeerConnection.prototype.getReceivers=function(){let a=b.apply(this,[]);return a.forEach(a=>a._pc=this),a}),gY(a,"track",a=>(a.receiver._pc=a.srcElement,a)),a.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function hi(a){!a.RTCPeerConnection||"removeStream"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.removeStream=function(a){g0("removeStream","removeTrack"),this.getSenders().forEach(b=>{b.track&&a.getTracks().includes(b.track)&&this.removeTrack(b)})})}function hj(a){a.DataChannel&&!a.RTCDataChannel&&(a.RTCDataChannel=a.DataChannel)}function hk(a){if(!("object"==typeof a&&a.RTCPeerConnection))return;let b=a.RTCPeerConnection.prototype.addTransceiver;b&&(a.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let a=arguments[1]&&arguments[1].sendEncodings;void 0===a&&(a=[]);let c=(a=[...a]).length>0;c&&a.forEach(a=>{if("rid"in a&&!/^[a-z0-9]{0,16}$/i.test(a.rid))throw TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in a&&!(parseFloat(a.scaleResolutionDownBy)>=1))throw RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in a&&!(parseFloat(a.maxFramerate)>=0))throw RangeError("max_framerate must be >= 0.0")});let d=b.apply(this,arguments);if(c){let{sender:b}=d,c=b.getParameters();"encodings"in c&&(1!==c.encodings.length||0!==Object.keys(c.encodings[0]).length)||(c.encodings=a,b.sendEncodings=a,this.setParametersPromises.push(b.setParameters(c).then(()=>{delete b.sendEncodings}).catch(()=>{delete b.sendEncodings})))}return d})}function hl(a){if(!("object"==typeof a&&a.RTCRtpSender))return;let b=a.RTCRtpSender.prototype.getParameters;b&&(a.RTCRtpSender.prototype.getParameters=function(){let a=b.apply(this,arguments);return"encodings"in a||(a.encodings=[].concat(this.sendEncodings||[{}])),a})}function hm(a){if(!("object"==typeof a&&a.RTCPeerConnection))return;let b=a.RTCPeerConnection.prototype.createOffer;a.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>b.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):b.apply(this,arguments)}}function hn(a){if(!("object"==typeof a&&a.RTCPeerConnection))return;let b=a.RTCPeerConnection.prototype.createAnswer;a.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>b.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):b.apply(this,arguments)}}var ho=Object.freeze({__proto__:null,shimAddTransceiver:hk,shimCreateAnswer:hn,shimCreateOffer:hm,shimGetDisplayMedia:function(a,b){a.navigator.mediaDevices&&"getDisplayMedia"in a.navigator.mediaDevices||a.navigator.mediaDevices&&(a.navigator.mediaDevices.getDisplayMedia=function(c){if(!(c&&c.video)){let a=new DOMException("getDisplayMedia without video constraints is undefined");return a.name="NotFoundError",a.code=8,Promise.reject(a)}return!0===c.video?c.video={mediaSource:b}:c.video.mediaSource=b,a.navigator.mediaDevices.getUserMedia(c)})},shimGetParameters:hl,shimGetUserMedia:hd,shimOnTrack:he,shimPeerConnection:hf,shimRTCDataChannel:hj,shimReceiverGetStats:hh,shimRemoveStream:hi,shimSenderGetStats:hg});function hp(a){if("object"==typeof a&&a.RTCPeerConnection){if("getLocalStreams"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in a.RTCPeerConnection.prototype)){let b=a.RTCPeerConnection.prototype.addTrack;a.RTCPeerConnection.prototype.addStream=function(a){this._localStreams||(this._localStreams=[]),this._localStreams.includes(a)||this._localStreams.push(a),a.getAudioTracks().forEach(c=>b.call(this,c,a)),a.getVideoTracks().forEach(c=>b.call(this,c,a))},a.RTCPeerConnection.prototype.addTrack=function(a){for(var c=arguments.length,d=Array(c>1?c-1:0),e=1;e<c;e++)d[e-1]=arguments[e];return d&&d.forEach(a=>{this._localStreams?this._localStreams.includes(a)||this._localStreams.push(a):this._localStreams=[a]}),b.apply(this,arguments)}}"removeStream"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.removeStream=function(a){this._localStreams||(this._localStreams=[]);let b=this._localStreams.indexOf(a);if(-1===b)return;this._localStreams.splice(b,1);let c=a.getTracks();this.getSenders().forEach(a=>{c.includes(a.track)&&this.removeTrack(a)})})}}function hq(a){if("object"==typeof a&&a.RTCPeerConnection&&("getRemoteStreams"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in a.RTCPeerConnection.prototype))){Object.defineProperty(a.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(a){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=a),this.addEventListener("track",this._onaddstreampoly=a=>{a.streams.forEach(a=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(a))return;this._remoteStreams.push(a);let b=new Event("addstream");b.stream=a,this.dispatchEvent(b)})})}});let b=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(){let a=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(b){b.streams.forEach(b=>{if(a._remoteStreams||(a._remoteStreams=[]),a._remoteStreams.indexOf(b)>=0)return;a._remoteStreams.push(b);let c=new Event("addstream");c.stream=b,a.dispatchEvent(c)})}),b.apply(a,arguments)}}}function hr(a){if("object"!=typeof a||!a.RTCPeerConnection)return;let b=a.RTCPeerConnection.prototype,c=b.createOffer,d=b.createAnswer,e=b.setLocalDescription,f=b.setRemoteDescription,g=b.addIceCandidate;b.createOffer=function(a,b){let d=arguments.length>=2?arguments[2]:arguments[0],e=c.apply(this,[d]);return b?(e.then(a,b),Promise.resolve()):e},b.createAnswer=function(a,b){let c=arguments.length>=2?arguments[2]:arguments[0],e=d.apply(this,[c]);return b?(e.then(a,b),Promise.resolve()):e};let h=function(a,b,c){let d=e.apply(this,[a]);return c?(d.then(b,c),Promise.resolve()):d};b.setLocalDescription=h,b.setRemoteDescription=h=function(a,b,c){let d=f.apply(this,[a]);return c?(d.then(b,c),Promise.resolve()):d},b.addIceCandidate=function(a,b,c){let d=g.apply(this,[a]);return c?(d.then(b,c),Promise.resolve()):d}}function hs(a){let b=a&&a.navigator;if(b.mediaDevices&&b.mediaDevices.getUserMedia){let a=b.mediaDevices,c=a.getUserMedia.bind(a);b.mediaDevices.getUserMedia=a=>c(ht(a))}!b.getUserMedia&&b.mediaDevices&&b.mediaDevices.getUserMedia&&(b.getUserMedia=(function(a,c,d){b.mediaDevices.getUserMedia(a).then(c,d)}).bind(b))}function ht(a){return a&&void 0!==a.video?Object.assign({},a,{video:function a(b){return g1(b)?Object.keys(b).reduce(function(c,d){let e=g1(b[d]),f=e?a(b[d]):b[d],g=e&&!Object.keys(f).length;return void 0===f||g?c:Object.assign(c,{[d]:f})},{}):b}(a.video)}):a}function hu(a){if(!a.RTCPeerConnection)return;let b=a.RTCPeerConnection;a.RTCPeerConnection=function(a,c){if(a&&a.iceServers){let b=[];for(let c=0;c<a.iceServers.length;c++){let d=a.iceServers[c];void 0===d.urls&&d.url?(g0("RTCIceServer.url","RTCIceServer.urls"),(d=JSON.parse(JSON.stringify(d))).urls=d.url,delete d.url,b.push(d)):b.push(a.iceServers[c])}a.iceServers=b}return new b(a,c)},a.RTCPeerConnection.prototype=b.prototype,"generateCertificate"in b&&Object.defineProperty(a.RTCPeerConnection,"generateCertificate",{get:()=>b.generateCertificate})}function hv(a){"object"==typeof a&&a.RTCTrackEvent&&"receiver"in a.RTCTrackEvent.prototype&&!("transceiver"in a.RTCTrackEvent.prototype)&&Object.defineProperty(a.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function hw(a){let b=a.RTCPeerConnection.prototype.createOffer;a.RTCPeerConnection.prototype.createOffer=function(a){if(a){void 0!==a.offerToReceiveAudio&&(a.offerToReceiveAudio=!!a.offerToReceiveAudio);let b=this.getTransceivers().find(a=>"audio"===a.receiver.track.kind);!1===a.offerToReceiveAudio&&b?"sendrecv"===b.direction?b.setDirection?b.setDirection("sendonly"):b.direction="sendonly":"recvonly"===b.direction&&(b.setDirection?b.setDirection("inactive"):b.direction="inactive"):!0!==a.offerToReceiveAudio||b||this.addTransceiver("audio",{direction:"recvonly"}),void 0!==a.offerToReceiveVideo&&(a.offerToReceiveVideo=!!a.offerToReceiveVideo);let c=this.getTransceivers().find(a=>"video"===a.receiver.track.kind);!1===a.offerToReceiveVideo&&c?"sendrecv"===c.direction?c.setDirection?c.setDirection("sendonly"):c.direction="sendonly":"recvonly"===c.direction&&(c.setDirection?c.setDirection("inactive"):c.direction="inactive"):!0!==a.offerToReceiveVideo||c||this.addTransceiver("video",{direction:"recvonly"})}return b.apply(this,arguments)}}function hx(a){"object"!=typeof a||a.AudioContext||(a.AudioContext=a.webkitAudioContext)}var hy=Object.freeze({__proto__:null,shimAudioContext:hx,shimCallbacksAPI:hr,shimConstraints:ht,shimCreateOfferLegacy:hw,shimGetUserMedia:hs,shimLocalStreamsAPI:hp,shimRTCIceServerUrls:hu,shimRemoteStreamsAPI:hq,shimTrackEventTransceiver:hv}),hz={exports:{}},hA=function(){let a;return lc?hz.exports:(lc=1,(a={}).generateIdentifier=function(){return Math.random().toString(36).substring(2,12)},a.localCName=a.generateIdentifier(),a.splitLines=function(a){return a.trim().split("\n").map(a=>a.trim())},a.splitSections=function(a){return a.split("\nm=").map((a,b)=>(b>0?"m="+a:a).trim()+"\r\n")},a.getDescription=function(b){let c=a.splitSections(b);return c&&c[0]},a.getMediaSections=function(b){let c=a.splitSections(b);return c.shift(),c},a.matchPrefix=function(b,c){return a.splitLines(b).filter(a=>0===a.indexOf(c))},a.parseCandidate=function(a){let b,c={foundation:(b=0===a.indexOf("a=candidate:")?a.substring(12).split(" "):a.substring(10).split(" "))[0],component:{1:"rtp",2:"rtcp"}[b[1]]||b[1],protocol:b[2].toLowerCase(),priority:parseInt(b[3],10),ip:b[4],address:b[4],port:parseInt(b[5],10),type:b[7]};for(let a=8;a<b.length;a+=2)switch(b[a]){case"raddr":c.relatedAddress=b[a+1];break;case"rport":c.relatedPort=parseInt(b[a+1],10);break;case"tcptype":c.tcpType=b[a+1];break;case"ufrag":c.ufrag=b[a+1],c.usernameFragment=b[a+1];break;default:void 0===c[b[a]]&&(c[b[a]]=b[a+1])}return c},a.writeCandidate=function(a){let b=[];b.push(a.foundation);let c=a.component;"rtp"===c?b.push(1):"rtcp"===c?b.push(2):b.push(c),b.push(a.protocol.toUpperCase()),b.push(a.priority),b.push(a.address||a.ip),b.push(a.port);let d=a.type;return b.push("typ"),b.push(d),"host"!==d&&a.relatedAddress&&a.relatedPort&&(b.push("raddr"),b.push(a.relatedAddress),b.push("rport"),b.push(a.relatedPort)),a.tcpType&&"tcp"===a.protocol.toLowerCase()&&(b.push("tcptype"),b.push(a.tcpType)),(a.usernameFragment||a.ufrag)&&(b.push("ufrag"),b.push(a.usernameFragment||a.ufrag)),"candidate:"+b.join(" ")},a.parseIceOptions=function(a){return a.substring(14).split(" ")},a.parseRtpMap=function(a){let b=a.substring(9).split(" "),c={payloadType:parseInt(b.shift(),10)};return c.name=(b=b[0].split("/"))[0],c.clockRate=parseInt(b[1],10),c.channels=3===b.length?parseInt(b[2],10):1,c.numChannels=c.channels,c},a.writeRtpMap=function(a){let b=a.payloadType;void 0!==a.preferredPayloadType&&(b=a.preferredPayloadType);let c=a.channels||a.numChannels||1;return"a=rtpmap:"+b+" "+a.name+"/"+a.clockRate+(1!==c?"/"+c:"")+"\r\n"},a.parseExtmap=function(a){let b=a.substring(9).split(" ");return{id:parseInt(b[0],10),direction:b[0].indexOf("/")>0?b[0].split("/")[1]:"sendrecv",uri:b[1],attributes:b.slice(2).join(" ")}},a.writeExtmap=function(a){return"a=extmap:"+(a.id||a.preferredId)+(a.direction&&"sendrecv"!==a.direction?"/"+a.direction:"")+" "+a.uri+(a.attributes?" "+a.attributes:"")+"\r\n"},a.parseFmtp=function(a){let b,c={},d=a.substring(a.indexOf(" ")+1).split(";");for(let a=0;a<d.length;a++)c[(b=d[a].trim().split("="))[0].trim()]=b[1];return c},a.writeFmtp=function(a){let b="",c=a.payloadType;if(void 0!==a.preferredPayloadType&&(c=a.preferredPayloadType),a.parameters&&Object.keys(a.parameters).length){let d=[];Object.keys(a.parameters).forEach(b=>{void 0!==a.parameters[b]?d.push(b+"="+a.parameters[b]):d.push(b)}),b+="a=fmtp:"+c+" "+d.join(";")+"\r\n"}return b},a.parseRtcpFb=function(a){let b=a.substring(a.indexOf(" ")+1).split(" ");return{type:b.shift(),parameter:b.join(" ")}},a.writeRtcpFb=function(a){let b="",c=a.payloadType;return void 0!==a.preferredPayloadType&&(c=a.preferredPayloadType),a.rtcpFeedback&&a.rtcpFeedback.length&&a.rtcpFeedback.forEach(a=>{b+="a=rtcp-fb:"+c+" "+a.type+(a.parameter&&a.parameter.length?" "+a.parameter:"")+"\r\n"}),b},a.parseSsrcMedia=function(a){let b=a.indexOf(" "),c={ssrc:parseInt(a.substring(7,b),10)},d=a.indexOf(":",b);return d>-1?(c.attribute=a.substring(b+1,d),c.value=a.substring(d+1)):c.attribute=a.substring(b+1),c},a.parseSsrcGroup=function(a){let b=a.substring(13).split(" ");return{semantics:b.shift(),ssrcs:b.map(a=>parseInt(a,10))}},a.getMid=function(b){let c=a.matchPrefix(b,"a=mid:")[0];if(c)return c.substring(6)},a.parseFingerprint=function(a){let b=a.substring(14).split(" ");return{algorithm:b[0].toLowerCase(),value:b[1].toUpperCase()}},a.getDtlsParameters=function(b,c){return{role:"auto",fingerprints:a.matchPrefix(b+c,"a=fingerprint:").map(a.parseFingerprint)}},a.writeDtlsParameters=function(a,b){let c="a=setup:"+b+"\r\n";return a.fingerprints.forEach(a=>{c+="a=fingerprint:"+a.algorithm+" "+a.value+"\r\n"}),c},a.parseCryptoLine=function(a){let b=a.substring(9).split(" ");return{tag:parseInt(b[0],10),cryptoSuite:b[1],keyParams:b[2],sessionParams:b.slice(3)}},a.writeCryptoLine=function(b){return"a=crypto:"+b.tag+" "+b.cryptoSuite+" "+("object"==typeof b.keyParams?a.writeCryptoKeyParams(b.keyParams):b.keyParams)+(b.sessionParams?" "+b.sessionParams.join(" "):"")+"\r\n"},a.parseCryptoKeyParams=function(a){if(0!==a.indexOf("inline:"))return null;let b=a.substring(7).split("|");return{keyMethod:"inline",keySalt:b[0],lifeTime:b[1],mkiValue:b[2]?b[2].split(":")[0]:void 0,mkiLength:b[2]?b[2].split(":")[1]:void 0}},a.writeCryptoKeyParams=function(a){return a.keyMethod+":"+a.keySalt+(a.lifeTime?"|"+a.lifeTime:"")+(a.mkiValue&&a.mkiLength?"|"+a.mkiValue+":"+a.mkiLength:"")},a.getCryptoParameters=function(b,c){return a.matchPrefix(b+c,"a=crypto:").map(a.parseCryptoLine)},a.getIceParameters=function(b,c){let d=a.matchPrefix(b+c,"a=ice-ufrag:")[0],e=a.matchPrefix(b+c,"a=ice-pwd:")[0];return d&&e?{usernameFragment:d.substring(12),password:e.substring(10)}:null},a.writeIceParameters=function(a){let b="a=ice-ufrag:"+a.usernameFragment+"\r\na=ice-pwd:"+a.password+"\r\n";return a.iceLite&&(b+="a=ice-lite\r\n"),b},a.parseRtpParameters=function(b){let c={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},d=a.splitLines(b)[0].split(" ");c.profile=d[2];for(let e=3;e<d.length;e++){let f=d[e],g=a.matchPrefix(b,"a=rtpmap:"+f+" ")[0];if(g){let d=a.parseRtpMap(g),e=a.matchPrefix(b,"a=fmtp:"+f+" ");switch(d.parameters=e.length?a.parseFmtp(e[0]):{},d.rtcpFeedback=a.matchPrefix(b,"a=rtcp-fb:"+f+" ").map(a.parseRtcpFb),c.codecs.push(d),d.name.toUpperCase()){case"RED":case"ULPFEC":c.fecMechanisms.push(d.name.toUpperCase())}}}a.matchPrefix(b,"a=extmap:").forEach(b=>{c.headerExtensions.push(a.parseExtmap(b))});let e=a.matchPrefix(b,"a=rtcp-fb:* ").map(a.parseRtcpFb);return c.codecs.forEach(a=>{e.forEach(b=>{a.rtcpFeedback.find(a=>a.type===b.type&&a.parameter===b.parameter)||a.rtcpFeedback.push(b)})}),c},a.writeRtpDescription=function(b,c){let d="";d+="m="+b+" ",d+=c.codecs.length>0?"9":"0",d+=" "+(c.profile||"UDP/TLS/RTP/SAVPF")+" ",d+=c.codecs.map(a=>void 0!==a.preferredPayloadType?a.preferredPayloadType:a.payloadType).join(" ")+"\r\n",d+="c=IN IP4 0.0.0.0\r\n",d+="a=rtcp:9 IN IP4 0.0.0.0\r\n",c.codecs.forEach(b=>{d+=a.writeRtpMap(b),d+=a.writeFmtp(b),d+=a.writeRtcpFb(b)});let e=0;return c.codecs.forEach(a=>{a.maxptime>e&&(e=a.maxptime)}),e>0&&(d+="a=maxptime:"+e+"\r\n"),c.headerExtensions&&c.headerExtensions.forEach(b=>{d+=a.writeExtmap(b)}),d},a.parseRtpEncodingParameters=function(b){let c,d=[],e=a.parseRtpParameters(b),f=-1!==e.fecMechanisms.indexOf("RED"),g=-1!==e.fecMechanisms.indexOf("ULPFEC"),h=a.matchPrefix(b,"a=ssrc:").map(b=>a.parseSsrcMedia(b)).filter(a=>"cname"===a.attribute),i=h.length>0&&h[0].ssrc,j=a.matchPrefix(b,"a=ssrc-group:FID").map(a=>a.substring(17).split(" ").map(a=>parseInt(a,10)));j.length>0&&j[0].length>1&&j[0][0]===i&&(c=j[0][1]),e.codecs.forEach(a=>{if("RTX"===a.name.toUpperCase()&&a.parameters.apt){let b={ssrc:i,codecPayloadType:parseInt(a.parameters.apt,10)};i&&c&&(b.rtx={ssrc:c}),d.push(b),f&&((b=JSON.parse(JSON.stringify(b))).fec={ssrc:i,mechanism:g?"red+ulpfec":"red"},d.push(b))}}),0===d.length&&i&&d.push({ssrc:i});let k=a.matchPrefix(b,"b=");return k.length&&(k=0===k[0].indexOf("b=TIAS:")?parseInt(k[0].substring(7),10):0===k[0].indexOf("b=AS:")?1e3*parseInt(k[0].substring(5),10)*.95-16e3:void 0,d.forEach(a=>{a.maxBitrate=k})),d},a.parseRtcpParameters=function(b){let c={},d=a.matchPrefix(b,"a=ssrc:").map(b=>a.parseSsrcMedia(b)).filter(a=>"cname"===a.attribute)[0];d&&(c.cname=d.value,c.ssrc=d.ssrc);let e=a.matchPrefix(b,"a=rtcp-rsize");return c.reducedSize=e.length>0,c.compound=0===e.length,c.mux=a.matchPrefix(b,"a=rtcp-mux").length>0,c},a.writeRtcpParameters=function(a){let b="";return a.reducedSize&&(b+="a=rtcp-rsize\r\n"),a.mux&&(b+="a=rtcp-mux\r\n"),void 0!==a.ssrc&&a.cname&&(b+="a=ssrc:"+a.ssrc+" cname:"+a.cname+"\r\n"),b},a.parseMsid=function(b){let c,d=a.matchPrefix(b,"a=msid:");if(1===d.length)return{stream:(c=d[0].substring(7).split(" "))[0],track:c[1]};let e=a.matchPrefix(b,"a=ssrc:").map(b=>a.parseSsrcMedia(b)).filter(a=>"msid"===a.attribute);if(e.length>0)return{stream:(c=e[0].value.split(" "))[0],track:c[1]}},a.parseSctpDescription=function(b){let c,d=a.parseMLine(b),e=a.matchPrefix(b,"a=max-message-size:");e.length>0&&(c=parseInt(e[0].substring(19),10)),isNaN(c)&&(c=65536);let f=a.matchPrefix(b,"a=sctp-port:");if(f.length>0)return{port:parseInt(f[0].substring(12),10),protocol:d.fmt,maxMessageSize:c};let g=a.matchPrefix(b,"a=sctpmap:");if(g.length>0){let a=g[0].substring(10).split(" ");return{port:parseInt(a[0],10),protocol:a[1],maxMessageSize:c}}},a.writeSctpDescription=function(a,b){let c=[];return c="DTLS/SCTP"!==a.protocol?["m="+a.kind+" 9 "+a.protocol+" "+b.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+b.port+"\r\n"]:["m="+a.kind+" 9 "+a.protocol+" "+b.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+b.port+" "+b.protocol+" 65535\r\n"],void 0!==b.maxMessageSize&&c.push("a=max-message-size:"+b.maxMessageSize+"\r\n"),c.join("")},a.generateSessionId=function(){return Math.random().toString().substr(2,22)},a.writeSessionBoilerplate=function(b,c,d){return"v=0\r\no="+(d||"thisisadapterortc")+" "+(b||a.generateSessionId())+" "+(void 0!==c?c:2)+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},a.getDirection=function(b,c){let d=a.splitLines(b);for(let a=0;a<d.length;a++)switch(d[a]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return d[a].substring(2)}return c?a.getDirection(c):"sendrecv"},a.getKind=function(b){return a.splitLines(b)[0].split(" ")[0].substring(2)},a.isRejected=function(a){return"0"===a.split(" ",2)[1]},a.parseMLine=function(b){let c=a.splitLines(b)[0].substring(2).split(" ");return{kind:c[0],port:parseInt(c[1],10),protocol:c[2],fmt:c.slice(3).join(" ")}},a.parseOLine=function(b){let c=a.matchPrefix(b,"o=")[0].substring(2).split(" ");return{username:c[0],sessionId:c[1],sessionVersion:parseInt(c[2],10),netType:c[3],addressType:c[4],address:c[5]}},a.isValidSDP=function(b){if("string"!=typeof b||0===b.length)return!1;let c=a.splitLines(b);for(let a=0;a<c.length;a++)if(c[a].length<2||"="!==c[a].charAt(1))return!1;return!0},hz.exports=a,hz.exports)}(),hB=hA&&hA.__esModule&&Object.prototype.hasOwnProperty.call(hA,"default")?hA.default:hA,hC=(kE={__proto__:null,default:hB},[hA].forEach(function(a){a&&"string"!=typeof a&&!Array.isArray(a)&&Object.keys(a).forEach(function(b){if("default"!==b&&!(b in kE)){var c=Object.getOwnPropertyDescriptor(a,b);Object.defineProperty(kE,b,c.get?c:{enumerable:!0,get:function(){return a[b]}})}})}),Object.freeze(kE));function hD(a){if(!a.RTCIceCandidate||a.RTCIceCandidate&&"foundation"in a.RTCIceCandidate.prototype)return;let b=a.RTCIceCandidate;a.RTCIceCandidate=function(a){if("object"==typeof a&&a.candidate&&0===a.candidate.indexOf("a=")&&((a=JSON.parse(JSON.stringify(a))).candidate=a.candidate.substring(2)),a.candidate&&a.candidate.length){let c=new b(a),d=hB.parseCandidate(a.candidate);for(let a in d)a in c||Object.defineProperty(c,a,{value:d[a]});return c.toJSON=function(){return{candidate:c.candidate,sdpMid:c.sdpMid,sdpMLineIndex:c.sdpMLineIndex,usernameFragment:c.usernameFragment}},c}return new b(a)},a.RTCIceCandidate.prototype=b.prototype,gY(a,"icecandidate",b=>(b.candidate&&Object.defineProperty(b,"candidate",{value:new a.RTCIceCandidate(b.candidate),writable:"false"}),b))}function hE(a){!a.RTCIceCandidate||a.RTCIceCandidate&&"relayProtocol"in a.RTCIceCandidate.prototype||gY(a,"icecandidate",a=>{if(a.candidate){let b=hB.parseCandidate(a.candidate.candidate);"relay"===b.type&&(a.candidate.relayProtocol=({0:"tls",1:"tcp",2:"udp"})[b.priority>>24])}return a})}function hF(a,b){if(!a.RTCPeerConnection)return;"sctp"in a.RTCPeerConnection.prototype||Object.defineProperty(a.RTCPeerConnection.prototype,"sctp",{get(){return void 0===this._sctp?null:this._sctp}});let c=function(a){if(!a||!a.sdp)return!1;let b=hB.splitSections(a.sdp);return b.shift(),b.some(a=>{let b=hB.parseMLine(a);return b&&"application"===b.kind&&-1!==b.protocol.indexOf("SCTP")})},d=function(a){let b=a.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===b||b.length<2)return -1;let c=parseInt(b[1],10);return c!=c?-1:c},e=function(a){let c=65536;return"firefox"===b.browser&&(c=b.version<57?-1===a?16384:0x7ffffff5:b.version<60?57===b.version?65535:65536:0x7ffffff5),c},f=function(a,c){let d=65536;"firefox"===b.browser&&57===b.version&&(d=65535);let e=hB.matchPrefix(a.sdp,"a=max-message-size:");return e.length>0?d=parseInt(e[0].substring(19),10):"firefox"===b.browser&&-1!==c&&(d=0x7ffffff5),d},g=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===b.browser&&b.version>=76){let{sdpSemantics:a}=this.getConfiguration();"plan-b"===a&&Object.defineProperty(this,"sctp",{get(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0})}if(c(arguments[0])){let a,b=d(arguments[0]),c=e(b),g=f(arguments[0],b);a=0===c&&0===g?1/0:0===c||0===g?Math.max(c,g):Math.min(c,g);let h={};Object.defineProperty(h,"maxMessageSize",{get:()=>a}),this._sctp=h}return g.apply(this,arguments)}}function hG(a){if(!(a.RTCPeerConnection&&"createDataChannel"in a.RTCPeerConnection.prototype))return;function b(a,b){let c=a.send;a.send=function(){let d=arguments[0],e=d.length||d.size||d.byteLength;if("open"===a.readyState&&b.sctp&&e>b.sctp.maxMessageSize)throw TypeError("Message too large (can send a maximum of "+b.sctp.maxMessageSize+" bytes)");return c.apply(a,arguments)}}let c=a.RTCPeerConnection.prototype.createDataChannel;a.RTCPeerConnection.prototype.createDataChannel=function(){let a=c.apply(this,arguments);return b(a,this),a},gY(a,"datachannel",a=>(b(a.channel,a.target),a))}function hH(a){if(!a.RTCPeerConnection||"connectionState"in a.RTCPeerConnection.prototype)return;let b=a.RTCPeerConnection.prototype;Object.defineProperty(b,"connectionState",{get(){return({completed:"connected",checking:"connecting"})[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(b,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(a){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),a&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=a)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(a=>{let c=b[a];b[a]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=a=>{let b=a.target;if(b._lastConnectionState!==b.connectionState){b._lastConnectionState=b.connectionState;let c=new Event("connectionstatechange",a);b.dispatchEvent(c)}return a},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),c.apply(this,arguments)}})}function hI(a,b){if(!a.RTCPeerConnection||"chrome"===b.browser&&b.version>=71||"safari"===b.browser&&b._safariVersion>=13.1)return;let c=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(b){if(b&&b.sdp&&-1!==b.sdp.indexOf("\na=extmap-allow-mixed")){let c=b.sdp.split("\n").filter(a=>"a=extmap-allow-mixed"!==a.trim()).join("\n");a.RTCSessionDescription&&b instanceof a.RTCSessionDescription?arguments[0]=new a.RTCSessionDescription({type:b.type,sdp:c}):b.sdp=c}return c.apply(this,arguments)}}function hJ(a,b){if(!(a.RTCPeerConnection&&a.RTCPeerConnection.prototype))return;let c=a.RTCPeerConnection.prototype.addIceCandidate;c&&0!==c.length&&(a.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?("chrome"===b.browser&&b.version<78||"firefox"===b.browser&&b.version<68||"safari"===b.browser)&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():c.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function hK(a,b){if(!(a.RTCPeerConnection&&a.RTCPeerConnection.prototype))return;let c=a.RTCPeerConnection.prototype.setLocalDescription;c&&0!==c.length&&(a.RTCPeerConnection.prototype.setLocalDescription=function(){let a=arguments[0]||{};if("object"!=typeof a||a.type&&a.sdp)return c.apply(this,arguments);if(!(a={type:a.type,sdp:a.sdp}).type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":a.type="offer";break;default:a.type="answer"}return a.sdp||"offer"!==a.type&&"answer"!==a.type?c.apply(this,[a]):("offer"===a.type?this.createOffer:this.createAnswer).apply(this).then(a=>c.apply(this,[a]))})}var hL=Object.freeze({__proto__:null,removeExtmapAllowMixed:hI,shimAddIceCandidateNullOrEmpty:hJ,shimConnectionState:hH,shimMaxMessageSize:hF,shimParameterlessSetLocalDescription:hK,shimRTCIceCandidate:hD,shimRTCIceCandidateRelayProtocol:hE,shimSendThrowTypeError:hG});!function(){let{window:a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0},c=function(a){let b={browser:null,version:null};if(void 0===a||!a.navigator||!a.navigator.userAgent)return b.browser="Not a browser.",b;let{navigator:c}=a;if(c.userAgentData&&c.userAgentData.brands){let a=c.userAgentData.brands.find(a=>"Chromium"===a.brand);if(a)return{browser:"chrome",version:parseInt(a.version,10)}}return c.mozGetUserMedia?(b.browser="firefox",b.version=parseInt(gX(c.userAgent,/Firefox\/(\d+)\./,1))):c.webkitGetUserMedia||!1===a.isSecureContext&&a.webkitRTCPeerConnection?(b.browser="chrome",b.version=parseInt(gX(c.userAgent,/Chrom(e|ium)\/(\d+)\./,2))):a.RTCPeerConnection&&c.userAgent.match(/AppleWebKit\/(\d+)\./)?(b.browser="safari",b.version=parseInt(gX(c.userAgent,/AppleWebKit\/(\d+)\./,1)),b.supportsUnifiedPlan=a.RTCRtpTransceiver&&"currentDirection"in a.RTCRtpTransceiver.prototype,b._safariVersion=gX(c.userAgent,/Version\/(\d+(\.?\d+))/,1)):b.browser="Not a supported browser.",b}(a),d={browserDetails:c,commonShim:hL,extractVersion:gX,disableLog:gZ,disableWarnings:g$,sdp:hC};switch(c.browser){case"chrome":if(!hc||!ha||!b.shimChrome){g_("Chrome shim is not included in this adapter release.");break}if(null===c.version){g_("Chrome shim can not determine version, not shimming.");break}g_("adapter.js shimming chrome."),d.browserShim=hc,hJ(a,c),hK(a),g3(a,c),g4(a),ha(a,c),g5(a),g9(a,c),g6(a),g7(a),hb(a,c),hD(a),hE(a),hH(a),hF(a,c),hG(a),hI(a,c);break;case"firefox":if(!ho||!hf||!b.shimFirefox){g_("Firefox shim is not included in this adapter release.");break}g_("adapter.js shimming firefox."),d.browserShim=ho,hJ(a,c),hK(a),hd(a,c),hf(a,c),he(a),hi(a),hg(a),hh(a),hj(a),hk(a),hl(a),hm(a),hn(a),hD(a),hH(a),hF(a,c),hG(a);break;case"safari":if(!hy||!b.shimSafari){g_("Safari shim is not included in this adapter release.");break}g_("adapter.js shimming safari."),d.browserShim=hy,hJ(a,c),hK(a),hu(a),hw(a),hr(a),hp(a),hq(a),hv(a),hs(a),hx(a),hD(a),hE(a),hF(a,c),hG(a),hI(a,c);break;default:g_("Unsupported browser!")}}({window:void 0});let hM=/version\/(\d+(\.?_?\d+)+)/i;function hN(a){let c=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if(void 0===a&&"undefined"==typeof navigator)return;let d=(null!=a?a:navigator.userAgent).toLowerCase();if(void 0===b||c){let a=hO.find(a=>{let{test:b}=a;return b.test(d)});b=null==a?void 0:a.describe(d)}return b}let hO=[{test:/firefox|iceweasel|fxios/i,describe:a=>({name:"Firefox",version:hP(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,a),os:a.toLowerCase().includes("fxios")?"iOS":void 0,osVersion:hQ(a)})},{test:/chrom|crios|crmo/i,describe:a=>({name:"Chrome",version:hP(/(?:chrome|chromium|crios|crmo)\/(\d+(\.?_?\d+)+)/i,a),os:a.toLowerCase().includes("crios")?"iOS":void 0,osVersion:hQ(a)})},{test:/safari|applewebkit/i,describe:a=>({name:"Safari",version:hP(hM,a),os:a.includes("mobile/")?"iOS":"macOS",osVersion:hQ(a)})}];function hP(a,b){let c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,d=b.match(a);return d&&d.length>=c&&d[c]||""}function hQ(a){return a.includes("mac os")?hP(/\(.+?(\d+_\d+(:?_\d+)?)/,a,1).replace(/_/g,"."):void 0}class hR extends Error{constructor(a,b){super(b||"an error has occured"),this.name="LiveKitError",this.code=a}}(kF=ld||(ld={}))[kF.NotAllowed=0]="NotAllowed",kF[kF.ServerUnreachable=1]="ServerUnreachable",kF[kF.InternalError=2]="InternalError",kF[kF.Cancelled=3]="Cancelled",kF[kF.LeaveRequest=4]="LeaveRequest",kF[kF.Timeout=5]="Timeout",kF[kF.WebSocket=6]="WebSocket";class hS extends hR{constructor(a,b,c,d){super(1,a),this.name="ConnectionError",this.status=c,this.reason=b,this.context=d,this.reasonName=ld[b]}static notAllowed(a,b,c){return new hS(a,ld.NotAllowed,b,c)}static timeout(a){return new hS(a,ld.Timeout)}static leaveRequest(a,b){return new hS(a,ld.LeaveRequest,void 0,b)}static internal(a,b){return new hS(a,ld.InternalError,void 0,b)}static cancelled(a){return new hS(a,ld.Cancelled)}static serverUnreachable(a,b){return new hS(a,ld.ServerUnreachable,b)}static websocket(a,b,c){return new hS(a,ld.WebSocket,b,c)}}class hT extends hR{constructor(a){super(21,null!=a?a:"device is unsupported"),this.name="DeviceUnsupportedError"}}class hU extends hR{constructor(a){super(20,null!=a?a:"track is invalid"),this.name="TrackInvalidError"}}class hV extends hR{constructor(a){super(10,null!=a?a:"unsupported server"),this.name="UnsupportedServer"}}class hW extends hR{constructor(a){super(12,null!=a?a:"unexpected connection state"),this.name="UnexpectedConnectionState"}}class hX extends hR{constructor(a){super(13,null!=a?a:"unable to negotiate"),this.name="NegotiationError"}}class hY extends hR{constructor(a,b){super(15,a),this.name="PublishTrackError",this.status=b}}class hZ extends hR{constructor(a,b){super(15,a),this.name="SignalRequestError",this.reason=b,this.reasonName="string"==typeof b?b:gE[b]}}(kG=le||(le={}))[kG.AlreadyOpened=0]="AlreadyOpened",kG[kG.AbnormalEnd=1]="AbnormalEnd",kG[kG.DecodeFailed=2]="DecodeFailed",kG[kG.LengthExceeded=3]="LengthExceeded",kG[kG.Incomplete=4]="Incomplete",kG[kG.HandlerAlreadyRegistered=7]="HandlerAlreadyRegistered",kG[kG.EncryptionTypeMismatch=8]="EncryptionTypeMismatch";class h$ extends hR{constructor(a,b){super(16,a),this.name="DataStreamError",this.reason=b,this.reasonName=le[b]}}class h_ extends hR{constructor(a){super(18,a),this.name="SignalReconnectError"}}(kH=lf||(lf={})).PermissionDenied="PermissionDenied",kH.NotFound="NotFound",kH.DeviceInUse="DeviceInUse",kH.Other="Other",(kI=lf||(lf={})).getFailure=function(a){if(a&&"name"in a)return"NotFoundError"===a.name||"DevicesNotFoundError"===a.name?kI.NotFound:"NotAllowedError"===a.name||"PermissionDeniedError"===a.name?kI.PermissionDenied:"NotReadableError"===a.name||"TrackStartError"===a.name?kI.DeviceInUse:kI.Other};class h0{}h0.setTimeout=function(){return setTimeout(...arguments)},h0.setInterval=function(){return setInterval(...arguments)},h0.clearTimeout=function(){return clearTimeout(...arguments)},h0.clearInterval=function(){return clearInterval(...arguments)},(kJ=lg||(lg={})).Connected="connected",kJ.Reconnecting="reconnecting",kJ.SignalReconnecting="signalReconnecting",kJ.Reconnected="reconnected",kJ.Disconnected="disconnected",kJ.ConnectionStateChanged="connectionStateChanged",kJ.Moved="moved",kJ.MediaDevicesChanged="mediaDevicesChanged",kJ.ParticipantConnected="participantConnected",kJ.ParticipantDisconnected="participantDisconnected",kJ.TrackPublished="trackPublished",kJ.TrackSubscribed="trackSubscribed",kJ.TrackSubscriptionFailed="trackSubscriptionFailed",kJ.TrackUnpublished="trackUnpublished",kJ.TrackUnsubscribed="trackUnsubscribed",kJ.TrackMuted="trackMuted",kJ.TrackUnmuted="trackUnmuted",kJ.LocalTrackPublished="localTrackPublished",kJ.LocalTrackUnpublished="localTrackUnpublished",kJ.LocalAudioSilenceDetected="localAudioSilenceDetected",kJ.ActiveSpeakersChanged="activeSpeakersChanged",kJ.ParticipantMetadataChanged="participantMetadataChanged",kJ.ParticipantNameChanged="participantNameChanged",kJ.ParticipantAttributesChanged="participantAttributesChanged",kJ.ParticipantActive="participantActive",kJ.RoomMetadataChanged="roomMetadataChanged",kJ.DataReceived="dataReceived",kJ.SipDTMFReceived="sipDTMFReceived",kJ.TranscriptionReceived="transcriptionReceived",kJ.ConnectionQualityChanged="connectionQualityChanged",kJ.TrackStreamStateChanged="trackStreamStateChanged",kJ.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",kJ.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",kJ.AudioPlaybackStatusChanged="audioPlaybackChanged",kJ.VideoPlaybackStatusChanged="videoPlaybackChanged",kJ.MediaDevicesError="mediaDevicesError",kJ.ParticipantPermissionsChanged="participantPermissionsChanged",kJ.SignalConnected="signalConnected",kJ.RecordingStatusChanged="recordingStatusChanged",kJ.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",kJ.EncryptionError="encryptionError",kJ.DCBufferStatusChanged="dcBufferStatusChanged",kJ.ActiveDeviceChanged="activeDeviceChanged",kJ.ChatMessage="chatMessage",kJ.LocalTrackSubscribed="localTrackSubscribed",kJ.MetricsReceived="metricsReceived",(kK=lh||(lh={})).TrackPublished="trackPublished",kK.TrackSubscribed="trackSubscribed",kK.TrackSubscriptionFailed="trackSubscriptionFailed",kK.TrackUnpublished="trackUnpublished",kK.TrackUnsubscribed="trackUnsubscribed",kK.TrackMuted="trackMuted",kK.TrackUnmuted="trackUnmuted",kK.LocalTrackPublished="localTrackPublished",kK.LocalTrackUnpublished="localTrackUnpublished",kK.LocalTrackCpuConstrained="localTrackCpuConstrained",kK.LocalSenderCreated="localSenderCreated",kK.ParticipantMetadataChanged="participantMetadataChanged",kK.ParticipantNameChanged="participantNameChanged",kK.DataReceived="dataReceived",kK.SipDTMFReceived="sipDTMFReceived",kK.TranscriptionReceived="transcriptionReceived",kK.IsSpeakingChanged="isSpeakingChanged",kK.ConnectionQualityChanged="connectionQualityChanged",kK.TrackStreamStateChanged="trackStreamStateChanged",kK.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",kK.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",kK.TrackCpuConstrained="trackCpuConstrained",kK.MediaDevicesError="mediaDevicesError",kK.AudioStreamAcquired="audioStreamAcquired",kK.ParticipantPermissionsChanged="participantPermissionsChanged",kK.PCTrackAdded="pcTrackAdded",kK.AttributesChanged="attributesChanged",kK.LocalTrackSubscribed="localTrackSubscribed",kK.ChatMessage="chatMessage",kK.Active="active",(kL=li||(li={})).TransportsCreated="transportsCreated",kL.Connected="connected",kL.Disconnected="disconnected",kL.Resuming="resuming",kL.Resumed="resumed",kL.Restarting="restarting",kL.Restarted="restarted",kL.SignalResumed="signalResumed",kL.SignalRestarted="signalRestarted",kL.Closing="closing",kL.MediaTrackAdded="mediaTrackAdded",kL.ActiveSpeakersUpdate="activeSpeakersUpdate",kL.DataPacketReceived="dataPacketReceived",kL.RTPVideoMapUpdate="rtpVideoMapUpdate",kL.DCBufferStatusChanged="dcBufferStatusChanged",kL.ParticipantUpdate="participantUpdate",kL.RoomUpdate="roomUpdate",kL.SpeakersChanged="speakersChanged",kL.StreamStateChanged="streamStateChanged",kL.ConnectionQualityUpdate="connectionQualityUpdate",kL.SubscriptionError="subscriptionError",kL.SubscriptionPermissionUpdate="subscriptionPermissionUpdate",kL.RemoteMute="remoteMute",kL.SubscribedQualityUpdate="subscribedQualityUpdate",kL.LocalTrackUnpublished="localTrackUnpublished",kL.LocalTrackSubscribed="localTrackSubscribed",kL.Offline="offline",kL.SignalRequestResponse="signalRequestResponse",kL.SignalConnected="signalConnected",kL.RoomMoved="roomMoved",(kM=lj||(lj={})).Message="message",kM.Muted="muted",kM.Unmuted="unmuted",kM.Restarted="restarted",kM.Ended="ended",kM.Subscribed="subscribed",kM.Unsubscribed="unsubscribed",kM.CpuConstrained="cpuConstrained",kM.UpdateSettings="updateSettings",kM.UpdateSubscription="updateSubscription",kM.AudioPlaybackStarted="audioPlaybackStarted",kM.AudioPlaybackFailed="audioPlaybackFailed",kM.AudioSilenceDetected="audioSilenceDetected",kM.VisibilityChanged="visibilityChanged",kM.VideoDimensionsChanged="videoDimensionsChanged",kM.VideoPlaybackStarted="videoPlaybackStarted",kM.VideoPlaybackFailed="videoPlaybackFailed",kM.ElementAttached="elementAttached",kM.ElementDetached="elementDetached",kM.UpstreamPaused="upstreamPaused",kM.UpstreamResumed="upstreamResumed",kM.SubscriptionPermissionChanged="subscriptionPermissionChanged",kM.SubscriptionStatusChanged="subscriptionStatusChanged",kM.SubscriptionFailed="subscriptionFailed",kM.TrackProcessorUpdate="trackProcessorUpdate",kM.AudioTrackFeatureUpdate="audioTrackFeatureUpdate",kM.TranscriptionReceived="transcriptionReceived",kM.TimeSyncUpdate="timeSyncUpdate",kM.PreConnectBufferFlushed="preConnectBufferFlushed";class h1{constructor(a,b,c,d,e){if("object"==typeof a)this.width=a.width,this.height=a.height,this.aspectRatio=a.aspectRatio,this.encoding={maxBitrate:a.maxBitrate,maxFramerate:a.maxFramerate,priority:a.priority};else if(void 0!==b&&void 0!==c)this.width=a,this.height=b,this.aspectRatio=a/b,this.encoding={maxBitrate:c,maxFramerate:d,priority:e};else throw TypeError("Unsupported options: provide at least width, height and maxBitrate")}get resolution(){return{width:this.width,height:this.height,frameRate:this.encoding.maxFramerate,aspectRatio:this.aspectRatio}}}let h2=["vp8","h264"],h3=["vp8","h264","vp9","av1","h265"],h4=function(a){return!!h2.find(b=>b===a)};(kN=lk||(lk={}))[kN.PREFER_REGRESSION=0]="PREFER_REGRESSION",kN[kN.SIMULCAST=1]="SIMULCAST",kN[kN.REGRESSION=2]="REGRESSION",(kO=ll||(ll={})).telephone={maxBitrate:12e3},kO.speech={maxBitrate:24e3},kO.music={maxBitrate:48e3},kO.musicStereo={maxBitrate:64e3},kO.musicHighQuality={maxBitrate:96e3},kO.musicHighQualityStereo={maxBitrate:128e3};let h5={h90:new h1(160,90,9e4,20),h180:new h1(320,180,16e4,20),h216:new h1(384,216,18e4,20),h360:new h1(640,360,45e4,20),h540:new h1(960,540,8e5,25),h720:new h1(1280,720,17e5,30),h1080:new h1(1920,1080,3e6,30),h1440:new h1(2560,1440,5e6,30),h2160:new h1(3840,2160,8e6,30)},h6={h120:new h1(160,120,7e4,20),h180:new h1(240,180,125e3,20),h240:new h1(320,240,14e4,20),h360:new h1(480,360,33e4,20),h480:new h1(640,480,5e5,20),h540:new h1(720,540,6e5,25),h720:new h1(960,720,13e5,30),h1080:new h1(1440,1080,23e5,30),h1440:new h1(1920,1440,38e5,30)},h7={h360fps3:new h1(640,360,2e5,3,"medium"),h360fps15:new h1(640,360,4e5,15,"medium"),h720fps5:new h1(1280,720,8e5,5,"medium"),h720fps15:new h1(1280,720,15e5,15,"medium"),h720fps30:new h1(1280,720,2e6,30,"medium"),h1080fps15:new h1(1920,1080,25e5,15,"medium"),h1080fps30:new h1(1920,1080,5e6,30,"medium"),original:new h1(0,0,7e6,30,"medium")};function h8(a,b,c){var d,e;let{optionsWithoutProcessor:f,audioProcessor:g,videoProcessor:h}=ih(null!=a?a:{}),i=null==b?void 0:b.processor,j=null==c?void 0:c.processor,k=null!=f?f:{};return!0===k.audio&&(k.audio={}),!0===k.video&&(k.video={}),k.audio&&(h9(k.audio,b),null!=(d=k.audio).deviceId||(d.deviceId={ideal:"default"}),(g||i)&&(k.audio.processor=null!=g?g:i)),k.video&&(h9(k.video,c),null!=(e=k.video).deviceId||(e.deviceId={ideal:"default"}),(h||j)&&(k.video.processor=null!=h?h:j)),k}function h9(a,b){return Object.keys(b).forEach(c=>{void 0===a[c]&&(a[c]=b[c])}),a}function ia(a){var b,c;let d={};if(a.video)if("object"==typeof a.video){let c={},e=a.video;Object.keys(e).forEach(a=>{"resolution"===a?h9(c,e.resolution):c[a]=e[a]}),d.video=c,null!=(b=d.video).deviceId||(b.deviceId={ideal:"default"})}else d.video=!!a.video&&{deviceId:{ideal:"default"}};else d.video=!1;return a.audio?"object"==typeof a.audio?(d.audio=a.audio,null!=(c=d.audio).deviceId||(c.deviceId={ideal:"default"})):d.audio={deviceId:{ideal:"default"}}:d.audio=!1,d}function ib(a){return gS(this,arguments,void 0,function(a){let b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200;return function*(){let c=ic();if(c){let d=c.createAnalyser();d.fftSize=2048;let e=new Uint8Array(d.frequencyBinCount);c.createMediaStreamSource(new MediaStream([a.mediaStreamTrack])).connect(d),yield ip(b),d.getByteTimeDomainData(e);let f=e.some(a=>128!==a&&0!==a);return c.close(),!f}return!1}()})}function ic(){}function id(a){return a===ik.Source.Microphone?"audioinput":a===ik.Source.Camera?"videoinput":void 0}function ie(a){return a.split("/")[1].toLowerCase()}function ig(a){return"mediaStreamTrack"in a?{trackID:a.sid,source:a.source,muted:a.isMuted,enabled:a.mediaStreamTrack.enabled,kind:a.kind,streamID:a.mediaStreamID,streamTrackID:a.mediaStreamTrack.id}:{trackID:a.trackSid,enabled:a.isEnabled,muted:a.isMuted,trackInfo:Object.assign({mimeType:a.mimeType,name:a.trackName,encrypted:a.isEncrypted,kind:a.kind,source:a.source},a.track?ig(a.track):{})}}function ih(a){let b,c,d=Object.assign({},a);return"object"==typeof d.audio&&d.audio.processor&&(b=d.audio.processor,d.audio=Object.assign(Object.assign({},d.audio),{processor:void 0})),"object"==typeof d.video&&d.video.processor&&(c=d.video.processor,d.video=Object.assign(Object.assign({},d.video),{processor:void 0})),{audioProcessor:b,videoProcessor:c,optionsWithoutProcessor:void 0===d?d:"function"!=typeof structuredClone?JSON.parse(JSON.stringify(d)):"object"==typeof d&&null!==d?structuredClone(Object.assign({},d)):structuredClone(d)}}function ii(a,b){return a.width*a.height<b.width*b.height}let ij=[];(kP=lm||(lm={}))[kP.LOW=0]="LOW",kP[kP.MEDIUM=1]="MEDIUM",kP[kP.HIGH=2]="HIGH";class ik extends gV.EventEmitter{get streamState(){return this._streamState}setStreamState(a){this._streamState=a}constructor(a,b){var c;let d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};super(),this.attachedElements=[],this.isMuted=!1,this._streamState=ik.StreamState.Active,this.isInBackground=!1,this._currentBitrate=0,this.log=gO,this.appVisibilityChangedListener=()=>{this.backgroundTimeout&&clearTimeout(this.backgroundTimeout),"hidden"===document.visibilityState?this.backgroundTimeout=setTimeout(()=>this.handleAppVisibilityChanged(),5e3):this.handleAppVisibilityChanged()},this.log=gP(null!=(c=d.loggerName)?c:la.Track),this.loggerContextCb=d.loggerContextCb,this.setMaxListeners(100),this.kind=b,this._mediaStreamTrack=a,this._mediaStreamID=a.id,this.source=ik.Source.Unknown}get logContext(){var a;return Object.assign(Object.assign({},null==(a=this.loggerContextCb)?void 0:a.call(this)),ig(this))}get currentBitrate(){return this._currentBitrate}get mediaStreamTrack(){return this._mediaStreamTrack}get mediaStreamID(){return this._mediaStreamID}attach(a){let b="audio";this.kind===ik.Kind.Video&&(b="video"),0===this.attachedElements.length&&this.kind===ik.Kind.Video&&this.addAppVisibilityListener(),!a&&("audio"===b&&(ij.forEach(b=>{null!==b.parentElement||a||(a=b)}),a&&ij.splice(ij.indexOf(a),1)),a||(a=document.createElement(b))),this.attachedElements.includes(a)||this.attachedElements.push(a),il(this.mediaStreamTrack,a);let c=a.srcObject.getTracks(),d=c.some(a=>"audio"===a.kind);return a.play().then(()=>{this.emit(d?lj.AudioPlaybackStarted:lj.VideoPlaybackStarted)}).catch(b=>{"NotAllowedError"===b.name?this.emit(d?lj.AudioPlaybackFailed:lj.VideoPlaybackFailed,b):"AbortError"===b.name?gO.debug("".concat(d?"audio":"video"," playback aborted, likely due to new play request")):gO.warn("could not playback ".concat(d?"audio":"video"),b),d&&a&&c.some(a=>"video"===a.kind)&&"NotAllowedError"===b.name&&(a.muted=!0,a.play().catch(()=>{}))}),this.emit(lj.ElementAttached,a),a}detach(a){try{if(a){im(this.mediaStreamTrack,a);let b=this.attachedElements.indexOf(a);return b>=0&&(this.attachedElements.splice(b,1),this.recycleElement(a),this.emit(lj.ElementDetached,a)),a}let b=[];return this.attachedElements.forEach(a=>{im(this.mediaStreamTrack,a),b.push(a),this.recycleElement(a),this.emit(lj.ElementDetached,a)}),this.attachedElements=[],b}finally{0===this.attachedElements.length&&this.removeAppVisibilityListener()}}stop(){this.stopMonitor(),this._mediaStreamTrack.stop()}enable(){this._mediaStreamTrack.enabled=!0}disable(){this._mediaStreamTrack.enabled=!1}stopMonitor(){this.monitorInterval&&clearInterval(this.monitorInterval),this.timeSyncHandle&&cancelAnimationFrame(this.timeSyncHandle)}updateLoggerOptions(a){a.loggerName&&(this.log=gP(a.loggerName)),a.loggerContextCb&&(this.loggerContextCb=a.loggerContextCb)}recycleElement(a){if(a instanceof HTMLAudioElement){let b=!0;a.pause(),ij.forEach(a=>{a.parentElement||(b=!1)}),b&&ij.push(a)}}handleAppVisibilityChanged(){return gS(this,void 0,void 0,function*(){this.isInBackground="hidden"===document.visibilityState,this.isInBackground||this.kind!==ik.Kind.Video||setTimeout(()=>this.attachedElements.forEach(a=>a.play().catch(()=>{})),0)})}addAppVisibilityListener(){iz()?(this.isInBackground="hidden"===document.visibilityState,document.addEventListener("visibilitychange",this.appVisibilityChangedListener)):this.isInBackground=!1}removeAppVisibilityListener(){iz()&&document.removeEventListener("visibilitychange",this.appVisibilityChangedListener)}}function il(a,b){let c,d;c=b.srcObject instanceof MediaStream?b.srcObject:new MediaStream,(d="audio"===a.kind?c.getAudioTracks():c.getVideoTracks()).includes(a)||(d.forEach(a=>{c.removeTrack(a)}),c.addTrack(a)),iw()&&b instanceof HTMLVideoElement||(b.autoplay=!0),b.muted=0===c.getAudioTracks().length,b instanceof HTMLVideoElement&&(b.playsInline=!0),b.srcObject!==c&&(b.srcObject=c,(iw()||iu())&&b instanceof HTMLVideoElement&&setTimeout(()=>{b.srcObject=c,b.play().catch(()=>{})},0))}function im(a,b){if(b.srcObject instanceof MediaStream){let c=b.srcObject;c.removeTrack(a),c.getTracks().length>0?b.srcObject=c:b.srcObject=null}}(kR=j=(kQ=ik||(ik={})).Kind||(kQ.Kind={})).Audio="audio",kR.Video="video",kR.Unknown="unknown",(kS=k=kQ.Source||(kQ.Source={})).Camera="camera",kS.Microphone="microphone",kS.ScreenShare="screen_share",kS.ScreenShareAudio="screen_share_audio",kS.Unknown="unknown",(kT=l=kQ.StreamState||(kQ.StreamState={})).Active="active",kT.Paused="paused",kT.Unknown="unknown",kQ.kindToProto=function(a){switch(a){case j.Audio:return eI.AUDIO;case j.Video:return eI.VIDEO;default:return eI.DATA}},kQ.kindFromProto=function(a){switch(a){case eI.AUDIO:return j.Audio;case eI.VIDEO:return j.Video;default:return j.Unknown}},kQ.sourceToProto=function(a){switch(a){case k.Camera:return eJ.CAMERA;case k.Microphone:return eJ.MICROPHONE;case k.ScreenShare:return eJ.SCREEN_SHARE;case k.ScreenShareAudio:return eJ.SCREEN_SHARE_AUDIO;default:return eJ.UNKNOWN}},kQ.sourceFromProto=function(a){switch(a){case eJ.CAMERA:return k.Camera;case eJ.MICROPHONE:return k.Microphone;case eJ.SCREEN_SHARE:return k.ScreenShare;case eJ.SCREEN_SHARE_AUDIO:return k.ScreenShareAudio;default:return k.Unknown}},kQ.streamStateFromProto=function(a){switch(a){case fV.ACTIVE:return l.Active;case fV.PAUSED:return l.Paused;default:return l.Unknown}};let io="https://aomediacodec.github.io/av1-rtp-spec/#dependency-descriptor-rtp-header-extension";function ip(a){return gS(this,void 0,void 0,function*(){return new Promise(b=>h0.setTimeout(b,a))})}function iq(){return"addTransceiver"in RTCPeerConnection.prototype}function ir(){return"addTrack"in RTCPeerConnection.prototype}function is(a){return"av1"===a||"vp9"===a}function it(a){return!(!document||ix())&&(a||(a=document.createElement("audio")),"setSinkId"in a)}function iu(){var a;return(null==(a=hN())?void 0:a.name)==="Firefox"}function iv(){let a=hN();return!!a&&"Chrome"===a.name&&"iOS"!==a.os}function iw(){var a;return(null==(a=hN())?void 0:a.name)==="Safari"}function ix(){let a=hN();return(null==a?void 0:a.name)==="Safari"||(null==a?void 0:a.os)==="iOS"}function iy(){var a,b;return!!iz()&&(null!=(b=null==(a=navigator.userAgentData)?void 0:a.mobile)?b:/Tablet|iPad|Mobile|Android|BlackBerry/.test(navigator.userAgent))}function iz(){return"undefined"!=typeof document}function iA(){return"ReactNative"==navigator.product}function iB(a){return a.hostname.endsWith(".livekit.cloud")||a.hostname.endsWith(".livekit.run")}function iC(a){return iB(a)?a.hostname.split(".")[0]:null}function iD(){if(a.g&&a.g.LiveKitReactNativeGlobal)return a.g.LiveKitReactNativeGlobal}function iE(){if(!iA())return;let a=iD();if(a)return a.platform}function iF(){if(iz())return window.devicePixelRatio;if(iA()){let a=iD();if(a)return a.devicePixelRatio}return 1}function iG(a,b){let c=a.split("."),d=b.split("."),e=Math.min(c.length,d.length);for(let a=0;a<e;++a){let b=parseInt(c[a],10),f=parseInt(d[a],10);if(b>f)return 1;if(b<f)return -1;if(a===e-1&&b===f)return 0}return""===a&&""!==b?-1:""===b?1:c.length==d.length?0:c.length<d.length?-1:1}function iH(a){for(let b of a)b.target.handleResize(b)}function iI(a){for(let b of a)b.target.handleVisibilityChanged(b)}let iJ=null,iK=()=>(iJ||(iJ=new ResizeObserver(iH)),iJ),iL=null,iM=()=>(iL||(iL=new IntersectionObserver(iI,{root:null,rootMargin:"0px"})),iL);function iN(){let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:16,b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16,c=arguments.length>2&&void 0!==arguments[2]&&arguments[2],d=arguments.length>3&&void 0!==arguments[3]&&arguments[3],e=document.createElement("canvas");e.width=a,e.height=b;let f=e.getContext("2d");null==f||f.fillRect(0,0,e.width,e.height),d&&f&&(f.beginPath(),f.arc(a/2,b/2,50,0,2*Math.PI,!0),f.closePath(),f.fillStyle="grey",f.fill());let[g]=e.captureStream().getTracks();if(!g)throw Error("Could not get empty media stream video track");return g.enabled=c,g}function iO(){if(!c){let a=new AudioContext,b=a.createOscillator(),d=a.createGain();d.gain.setValueAtTime(0,0);let e=a.createMediaStreamDestination();if(b.connect(d),d.connect(e),b.start(),[c]=e.stream.getAudioTracks(),!c)throw Error("Could not get empty media stream audio track");c.enabled=!1}return c.clone()}class iP{get isResolved(){return this._isResolved}constructor(a,b){this._isResolved=!1,this.onFinally=b,this.promise=new Promise((b,c)=>gS(this,void 0,void 0,function*(){this.resolve=b,this.reject=c,a&&(yield a(b,c))})).finally(()=>{var a;this._isResolved=!0,null==(a=this.onFinally)||a.call(this)})}}function iQ(a){if("string"==typeof a||"number"==typeof a)return a;if(Array.isArray(a))return a[0];if(void 0!==a.exact)return Array.isArray(a.exact)?a.exact[0]:a.exact;if(void 0!==a.ideal)return Array.isArray(a.ideal)?a.ideal[0]:a.ideal;throw Error("could not unwrap constraint")}function iR(a){return a.startsWith("ws")?a.replace(/^(ws)/,"http"):a}function iS(a){switch(a.reason){case ld.LeaveRequest:return a.context;case ld.Cancelled:return eN.CLIENT_INITIATED;case ld.NotAllowed:return eN.USER_REJECTED;case ld.ServerUnreachable:return eN.JOIN_FAILURE;default:return eN.UNKNOWN_REASON}}function iT(a){return void 0!==a?Number(a):void 0}function iU(a){return void 0!==a?BigInt(a):void 0}function iV(a){return!!a&&!(a instanceof MediaStreamTrack)&&a.isLocal}function iW(a){return!!a&&a.kind==ik.Kind.Audio}function iX(a){return!!a&&a.kind==ik.Kind.Video}function iY(a){return iV(a)&&iX(a)}function iZ(a){return iV(a)&&iW(a)}function i$(a){return!!a&&!a.isLocal}function i_(a){return i$(a)&&iX(a)}function i0(a){return a.endsWith("/")?a:"".concat(a,"/")}function i1(a,b){return a.pathname="".concat(i0(a.pathname)).concat(b),a.toString()}function i2(a){if("string"==typeof a)return fY.fromJson(JSON.parse(a),{ignoreUnknownFields:!0});if(a instanceof ArrayBuffer)return fY.fromBinary(new Uint8Array(a));throw Error("could not decode websocket message: ".concat(typeof a))}let i3="lk_e2ee";function i4(){return void 0!==window.RTCRtpScriptTransform}(kU=ln||(ln={})).SetKey="setKey",kU.RatchetRequest="ratchetRequest",kU.KeyRatcheted="keyRatcheted",(lo||(lo={})).KeyRatcheted="keyRatcheted",(kV=lp||(lp={})).ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",kV.EncryptionError="encryptionError",(lq||(lq={})).Error="cryptorError",gV.EventEmitter,(kW=lr||(lr={}))[kW.InvalidKey=0]="InvalidKey",kW[kW.MissingKey=1]="MissingKey",kW[kW.InternalError=2]="InternalError";class i5 extends gV.EventEmitter{constructor(a,b){super(),this.decryptDataRequests=new Map,this.encryptDataRequests=new Map,this.onWorkerMessage=a=>{var b,c;let{kind:d,data:e}=a.data;switch(d){case"error":if(gO.error(e.error.message),e.uuid){let a=this.decryptDataRequests.get(e.uuid);if(null==a?void 0:a.reject){a.reject(e.error);break}let b=this.encryptDataRequests.get(e.uuid);if(null==b?void 0:b.reject){b.reject(e.error);break}}this.emit(lp.EncryptionError,e.error,e.participantIdentity);break;case"initAck":e.enabled&&this.keyProvider.getKeys().forEach(a=>{this.postKey(a)});break;case"enable":if(e.enabled&&this.keyProvider.getKeys().forEach(a=>{this.postKey(a)}),this.encryptionEnabled!==e.enabled&&e.participantIdentity===(null==(b=this.room)?void 0:b.localParticipant.identity))this.emit(lp.ParticipantEncryptionStatusChanged,e.enabled,this.room.localParticipant),this.encryptionEnabled=e.enabled;else if(e.participantIdentity){let a=null==(c=this.room)?void 0:c.getParticipantByIdentity(e.participantIdentity);if(!a)throw TypeError("couldn't set encryption status, participant not found".concat(e.participantIdentity));this.emit(lp.ParticipantEncryptionStatusChanged,e.enabled,a)}break;case"ratchetKey":this.keyProvider.emit(ln.KeyRatcheted,e.ratchetResult,e.participantIdentity,e.keyIndex);break;case"decryptDataResponse":let f=this.decryptDataRequests.get(e.uuid);(null==f?void 0:f.resolve)&&f.resolve(e);break;case"encryptDataResponse":let g=this.encryptDataRequests.get(e.uuid);(null==g?void 0:g.resolve)&&g.resolve(e)}},this.onWorkerError=a=>{gO.error("e2ee worker encountered an error:",{error:a.error}),this.emit(lp.EncryptionError,a.error,void 0)},this.keyProvider=a.keyProvider,this.worker=a.worker,this.encryptionEnabled=!1,this.dataChannelEncryptionEnabled=b}get isEnabled(){return this.encryptionEnabled}get isDataChannelEncryptionEnabled(){return this.isEnabled&&this.dataChannelEncryptionEnabled}setup(a){if(!(void 0!==window.RTCRtpSender&&void 0!==window.RTCRtpSender.prototype.createEncodedStreams||i4()))throw new hT("tried to setup end-to-end encryption on an unsupported browser");if(gO.info("setting up e2ee"),a!==this.room){this.room=a,this.setupEventListeners(a,this.keyProvider);let b={kind:"init",data:{keyProviderOptions:this.keyProvider.getOptions(),loglevel:gQ.getLevel()}};this.worker&&(gO.info("initializing worker",{worker:this.worker}),this.worker.onmessage=this.onWorkerMessage,this.worker.onerror=this.onWorkerError,this.worker.postMessage(b))}}setParticipantCryptorEnabled(a,b){gO.debug("set e2ee to ".concat(a," for participant ").concat(b)),this.postEnable(a,b)}setSifTrailer(a){a&&0!==a.length?this.postSifTrailer(a):gO.warn("ignoring server sent trailer as it's empty")}setupEngine(a){a.on(li.RTPVideoMapUpdate,a=>{this.postRTPMap(a)})}setupEventListeners(a,b){a.on(lg.TrackPublished,(a,b)=>this.setParticipantCryptorEnabled(a.trackInfo.encryption!==eY.NONE,b.identity)),a.on(lg.ConnectionStateChanged,b=>{b===lC.Connected&&a.remoteParticipants.forEach(a=>{a.trackPublications.forEach(b=>{this.setParticipantCryptorEnabled(b.trackInfo.encryption!==eY.NONE,a.identity)})})}).on(lg.TrackUnsubscribed,(a,b,c)=>{var d;let e={kind:"removeTransform",data:{participantIdentity:c.identity,trackId:a.mediaStreamID}};null==(d=this.worker)||d.postMessage(e)}).on(lg.TrackSubscribed,(a,b,c)=>{this.setupE2EEReceiver(a,c.identity,b.trackInfo)}).on(lg.SignalConnected,()=>{if(!this.room)throw TypeError("expected room to be present on signal connect");b.getKeys().forEach(a=>{this.postKey(a)}),this.setParticipantCryptorEnabled(this.room.localParticipant.isE2EEEnabled,this.room.localParticipant.identity)}),a.localParticipant.on(lh.LocalSenderCreated,(a,b)=>gS(this,void 0,void 0,function*(){this.setupE2EESender(b,a)})),a.localParticipant.on(lh.LocalTrackPublished,a=>{if(!iX(a.track)||!ix())return;let b={kind:"updateCodec",data:{trackId:a.track.mediaStreamID,codec:ie(a.trackInfo.codecs[0].mimeType),participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(b)}),b.on(ln.SetKey,a=>this.postKey(a)).on(ln.RatchetRequest,(a,b)=>this.postRatchetRequest(a,b))}encryptData(a){return gS(this,void 0,void 0,function*(){if(!this.worker)throw Error("could not encrypt data, worker is missing");let b=crypto.randomUUID(),c={kind:"encryptDataRequest",data:{uuid:b,payload:a,participantIdentity:this.room.localParticipant.identity}},d=new iP;return d.onFinally=()=>{this.encryptDataRequests.delete(b)},this.encryptDataRequests.set(b,d),this.worker.postMessage(c),d.promise})}handleEncryptedData(a,b,c,d){if(!this.worker)throw Error("could not handle encrypted data, worker is missing");let e=crypto.randomUUID(),f=new iP;return f.onFinally=()=>{this.decryptDataRequests.delete(e)},this.decryptDataRequests.set(e,f),this.worker.postMessage({kind:"decryptDataRequest",data:{uuid:e,payload:a,iv:b,participantIdentity:c,keyIndex:d}}),f.promise}postRatchetRequest(a,b){if(!this.worker)throw Error("could not ratchet key, worker is missing");this.worker.postMessage({kind:"ratchetRequest",data:{participantIdentity:a,keyIndex:b}})}postKey(a){var b;let{key:c,participantIdentity:d,keyIndex:e}=a;if(!this.worker)throw Error("could not set key, worker is missing");let f={kind:"setKey",data:{participantIdentity:d,isPublisher:d===(null==(b=this.room)?void 0:b.localParticipant.identity),key:c,keyIndex:e}};this.worker.postMessage(f)}postEnable(a,b){if(this.worker)this.worker.postMessage({kind:"enable",data:{enabled:a,participantIdentity:b}});else throw ReferenceError("failed to enable e2ee, worker is not ready")}postRTPMap(a){var b;if(!this.worker)throw TypeError("could not post rtp map, worker is missing");if(!(null==(b=this.room)?void 0:b.localParticipant.identity))throw TypeError("could not post rtp map, local participant identity is missing");let c={kind:"setRTPMap",data:{map:a,participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(c)}postSifTrailer(a){if(!this.worker)throw Error("could not post SIF trailer, worker is missing");this.worker.postMessage({kind:"setSifTrailer",data:{trailer:a}})}setupE2EEReceiver(a,b,c){if(a.receiver){if(!(null==c?void 0:c.mimeType)||""===c.mimeType)throw TypeError("MimeType missing from trackInfo, cannot set up E2EE cryptor");this.handleReceiver(a.receiver,a.mediaStreamID,b,"video"===a.kind?ie(c.mimeType):void 0)}}setupE2EESender(a,b){if(!iV(a)||!b){b||gO.warn("early return because sender is not ready");return}this.handleSender(b,a.mediaStreamID,void 0)}handleReceiver(a,b,c,d){return gS(this,void 0,void 0,function*(){if(this.worker){if(i4()&&!iv())a.transform=new RTCRtpScriptTransform(this.worker,{kind:"decode",participantIdentity:c,trackId:b,codec:d});else{if(i3 in a&&d)return void this.worker.postMessage({kind:"updateCodec",data:{trackId:b,codec:d,participantIdentity:c}});let e=a.writableStream,f=a.readableStream;if(!e||!f){let b=a.createEncodedStreams();a.writableStream=b.writable,e=b.writable,a.readableStream=b.readable,f=b.readable}let g={kind:"decode",data:{readableStream:f,writableStream:e,trackId:b,codec:d,participantIdentity:c,isReuse:i3 in a}};this.worker.postMessage(g,[f,e])}a[i3]=!0}})}handleSender(a,b,c){var d;if(!(i3 in a)&&this.worker){if(!(null==(d=this.room)?void 0:d.localParticipant.identity)||""===this.room.localParticipant.identity)throw TypeError("local identity needs to be known in order to set up encrypted sender");if(i4()&&!iv()){gO.info("initialize script transform");let d={kind:"encode",participantIdentity:this.room.localParticipant.identity,trackId:b,codec:c};a.transform=new RTCRtpScriptTransform(this.worker,d)}else{gO.info("initialize encoded streams");let d=a.createEncodedStreams(),e={kind:"encode",data:{readableStream:d.readable,writableStream:d.writable,codec:c,trackId:b,participantIdentity:this.room.localParticipant.identity,isReuse:!1}};this.worker.postMessage(e,[d.readable,d.writable])}a[i3]=!0}}}class i6{constructor(){this.failedConnectionAttempts=new Map,this.backOffPromises=new Map}static getInstance(){return this._instance||(this._instance=new i6),this._instance}addFailedConnectionAttempt(a){var b;let c=iC(new URL(a));if(!c)return;let d=null!=(b=this.failedConnectionAttempts.get(c))?b:0;this.failedConnectionAttempts.set(c,d+1),this.backOffPromises.set(c,ip(Math.min(500*Math.pow(2,d),15e3)))}getBackOffPromise(a){let b=new URL(a),c=b&&iC(b);return c&&this.backOffPromises.get(c)||Promise.resolve()}resetFailedConnectionAttempts(a){let b=new URL(a),c=b&&iC(b);c&&(this.failedConnectionAttempts.set(c,0),this.backOffPromises.set(c,Promise.resolve()))}resetAll(){this.backOffPromises.clear(),this.failedConnectionAttempts.clear()}}i6._instance=null;let i7="default";class i8{constructor(){this._previousDevices=[]}static getInstance(){return void 0===this.instance&&(this.instance=new i8),this.instance}get previousDevices(){return this._previousDevices}getDevices(a){return gS(this,arguments,void 0,function(a){var b=this;let c=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return function*(){var d;if((null==(d=i8.userMediaPromiseMap)?void 0:d.size)>0){gO.debug("awaiting getUserMedia promise");try{a?yield i8.userMediaPromiseMap.get(a):yield Promise.all(i8.userMediaPromiseMap.values())}catch(a){gO.warn("error waiting for media permissons")}}let e=yield navigator.mediaDevices.enumerateDevices();if(c&&!(iw()&&b.hasDeviceInUse(a))&&(0===e.filter(b=>b.kind===a).length||e.some(b=>{let c=""===b.label,d=!a||b.kind===a;return c&&d}))){let b=yield navigator.mediaDevices.getUserMedia({video:"audioinput"!==a&&"audiooutput"!==a,audio:"videoinput"!==a&&{deviceId:{ideal:"default"}}});e=yield navigator.mediaDevices.enumerateDevices(),b.getTracks().forEach(a=>{a.stop()})}return b._previousDevices=e,a&&(e=e.filter(b=>b.kind===a)),e}()})}normalizeDeviceId(a,b,c){return gS(this,void 0,void 0,function*(){if(b!==i7)return b;let d=yield this.getDevices(a),e=d.find(a=>a.deviceId===i7);if(!e)return void gO.warn("could not reliably determine default device");let f=d.find(a=>a.deviceId!==i7&&a.groupId===(null!=c?c:e.groupId));return f?null==f?void 0:f.deviceId:void gO.warn("could not reliably determine default device")})}hasDeviceInUse(a){return a?i8.userMediaPromiseMap.has(a):i8.userMediaPromiseMap.size>0}}i8.mediaDeviceKinds=["audioinput","audiooutput","videoinput"],i8.userMediaPromiseMap=new Map,(kX=ls||(ls={}))[kX.WAITING=0]="WAITING",kX[kX.RUNNING=1]="RUNNING",kX[kX.COMPLETED=2]="COMPLETED";class i9{constructor(){this.pendingTasks=new Map,this.taskMutex=new du,this.nextTaskIndex=0}run(a){return gS(this,void 0,void 0,function*(){let b={id:this.nextTaskIndex++,enqueuedAt:Date.now(),status:ls.WAITING};this.pendingTasks.set(b.id,b);let c=yield this.taskMutex.lock();try{return b.executedAt=Date.now(),b.status=ls.RUNNING,yield a()}finally{b.status=ls.COMPLETED,this.pendingTasks.delete(b.id),c()}})}flush(){return gS(this,void 0,void 0,function*(){return this.run(()=>gS(this,void 0,void 0,function*(){}))})}snapshot(){return Array.from(this.pendingTasks.values())}}class ja{get readyState(){return this.ws.readyState}constructor(a){var b,c;let d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(null==(b=d.signal)?void 0:b.aborted)throw new DOMException("This operation was aborted","AbortError");this.url=a;const e=new WebSocket(a,null!=(c=d.protocols)?c:[]);e.binaryType="arraybuffer",this.ws=e;const f=function(){let{closeCode:a,reason:b}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.close(a,b)};this.opened=new Promise((a,b)=>{e.onopen=()=>{a({readable:new ReadableStream({start(a){e.onmessage=b=>{let{data:c}=b;return a.enqueue(c)},e.onerror=b=>a.error(b)},cancel:f}),writable:new WritableStream({write(a){e.send(a)},abort(){e.close()},close:f}),protocol:e.protocol,extensions:e.extensions}),e.removeEventListener("error",b)},e.addEventListener("error",b)}),this.closed=new Promise((a,b)=>{let c=()=>gS(this,void 0,void 0,function*(){let c=new Promise(a=>{e.readyState===WebSocket.CLOSED||e.addEventListener("close",b=>{a(b)},{once:!0})}),d=yield Promise.race([ip(250),c]);d?a(d):b(Error("Encountered unspecified websocket error without a timely close event"))});e.onclose=b=>{let{code:d,reason:f}=b;a({closeCode:d,reason:f}),e.removeEventListener("error",c)},e.addEventListener("error",c)}),d.signal&&(d.signal.onabort=()=>e.close()),this.close=f}}let jb=["syncState","trickle","offer","answer","simulate","leave"];(kY=lt||(lt={}))[kY.CONNECTING=0]="CONNECTING",kY[kY.CONNECTED=1]="CONNECTED",kY[kY.RECONNECTING=2]="RECONNECTING",kY[kY.DISCONNECTING=3]="DISCONNECTING",kY[kY.DISCONNECTED=4]="DISCONNECTED";class jc{get currentState(){return this.state}get isDisconnected(){return this.state===lt.DISCONNECTING||this.state===lt.DISCONNECTED}get isEstablishingConnection(){return this.state===lt.CONNECTING||this.state===lt.RECONNECTING}getNextRequestId(){return this._requestId+=1,this._requestId}constructor(){var a;let b=arguments.length>0&&void 0!==arguments[0]&&arguments[0],c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.rtt=0,this.state=lt.DISCONNECTED,this.log=gO,this._requestId=0,this.resetCallbacks=()=>{this.onAnswer=void 0,this.onLeave=void 0,this.onLocalTrackPublished=void 0,this.onLocalTrackUnpublished=void 0,this.onNegotiateRequested=void 0,this.onOffer=void 0,this.onRemoteMuteChanged=void 0,this.onSubscribedQualityUpdate=void 0,this.onTokenRefresh=void 0,this.onTrickle=void 0,this.onClose=void 0,this.onMediaSectionsRequirement=void 0},this.log=gP(null!=(a=c.loggerName)?a:la.Signal),this.loggerContextCb=c.loggerContextCb,this.useJSON=b,this.requestQueue=new i9,this.queuedRequests=[],this.closingLock=new du,this.connectionLock=new du,this.state=lt.DISCONNECTED}get logContext(){var a,b;return null!=(b=null==(a=this.loggerContextCb)?void 0:a.call(this))?b:{}}join(a,b,c,d){return gS(this,void 0,void 0,function*(){return this.state=lt.CONNECTING,this.options=c,yield this.connect(a,b,c,d)})}reconnect(a,b,c,d){return gS(this,void 0,void 0,function*(){return this.options?(this.state=lt.RECONNECTING,this.clearPingInterval(),yield this.connect(a,b,Object.assign(Object.assign({},this.options),{reconnect:!0,sid:c,reconnectReason:d}))):void this.log.warn("attempted to reconnect without signal options being set, ignoring",this.logContext)})}connect(a,b,c,d){return gS(this,void 0,void 0,function*(){var e,f,g,h,i,j,k,l;let m,n,o,p,q,r,s=yield this.connectionLock.lock();this.connectOptions=c;let t=(q=new fj({sdk:fk.JS,protocol:16,version:"2.16.1"}),iA()&&(q.os=null!=(e=iE())?e:""),q),u=c.singlePeerConnection?(f=b,g=t,h=c,(m=new URLSearchParams).set("access_token",f),n=new gH({clientInfo:g,connectionSettings:new gG({autoSubscribe:!!h.autoSubscribe,adaptiveStream:!!h.adaptiveStream}),reconnect:!!h.reconnect,participantSid:h.sid?h.sid:void 0}),h.reconnectReason&&(n.reconnectReason=h.reconnectReason),o=new gI({joinRequest:n.toBinary()}),m.set("join_request",btoa(new TextDecoder("utf-8").decode(o.toBinary()))),m):(i=b,j=t,k=c,(p=new URLSearchParams).set("access_token",i),k.reconnect&&(p.set("reconnect","1"),k.sid&&p.set("sid",k.sid)),p.set("auto_subscribe",k.autoSubscribe?"1":"0"),p.set("sdk",iA()?"reactnative":"js"),p.set("version",j.version),p.set("protocol",j.protocol.toString()),j.deviceModel&&p.set("device_model",j.deviceModel),j.os&&p.set("os",j.os),j.osVersion&&p.set("os_version",j.osVersion),j.browser&&p.set("browser",j.browser),j.browserVersion&&p.set("browser_version",j.browserVersion),k.adaptiveStream&&p.set("adaptive_stream","1"),k.reconnectReason&&p.set("reconnect_reason",k.reconnectReason.toString()),(null==(l=navigator.connection)?void 0:l.type)&&p.set("network",navigator.connection.type),p),v=(r=new URL(a.startsWith("http")?a.replace(/^(http)/,"ws"):a),u.forEach((a,b)=>{r.searchParams.set(b,a)}),i1(r,"rtc")),w=i1(new URL(iR(v)),"validate");return new Promise((a,b)=>gS(this,void 0,void 0,function*(){var e,f;try{let g=!1,h=a=>gS(this,void 0,void 0,function*(){if(g)return;g=!0;let c=a instanceof Event?a.currentTarget:a,d=function(a){let b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Unknown reason";if(!(a instanceof AbortSignal))return b;let c=a.reason;switch(typeof c){case"string":return c;case"object":return c instanceof Error?c.message:b;default:return"toString"in c?c.toString():b}}(c,"Abort handler called");this.streamWriter&&!this.isDisconnected?this.sendLeave().then(()=>this.close(d)).catch(a=>{this.log.error(a),this.close()}):this.close(),i(),b(hS.cancelled(d))});null==d||d.addEventListener("abort",h);let i=()=>{clearTimeout(j),null==d||d.removeEventListener("abort",h)},j=setTimeout(()=>{h(hS.timeout("room connection has timed out (signal)"))},c.websocketTimeout),k=(a,b)=>{this.handleSignalConnected(a,j,b)},l=new URL(v);l.searchParams.has("access_token")&&l.searchParams.set("access_token","<redacted>"),this.log.debug("connecting to ".concat(l),Object.assign({reconnect:c.reconnect,reconnectReason:c.reconnectReason},this.logContext)),this.ws&&(yield this.close(!1)),this.ws=new ja(v);try{this.ws.closed.then(a=>{var c;this.isEstablishingConnection&&b(hS.internal("Websocket got closed during a (re)connection attempt: ".concat(a.reason))),1e3!==a.closeCode&&(this.log.warn("websocket closed",Object.assign(Object.assign({},this.logContext),{reason:a.reason,code:a.closeCode,wasClean:1e3===a.closeCode,state:this.state})),this.state===lt.CONNECTED&&this.handleOnClose(null!=(c=a.reason)?c:"Unexpected WS error"))}).catch(a=>{this.isEstablishingConnection&&b(hS.internal("Websocket error during a (re)connection attempt: ".concat(a)))});let d=yield this.ws.opened.catch(a=>gS(this,void 0,void 0,function*(){if(this.state!==lt.CONNECTED){this.state=lt.DISCONNECTED,clearTimeout(j);let c=yield this.handleConnectionError(a,w);b(c);return}this.handleWSError(a),b(a)}));if(clearTimeout(j),!d)return;let g=d.readable.getReader();this.streamWriter=d.writable.getWriter();let h=yield g.read();if(g.releaseLock(),!h.value)throw hS.internal("no message received as first message");let i=i2(h.value),l=this.validateFirstMessage(i,null!=(e=c.reconnect)&&e);if(!l.isValid)return void b(l.error);(null==(f=i.message)?void 0:f.case)==="join"&&(this.pingTimeoutDuration=i.message.value.pingTimeout,this.pingIntervalDuration=i.message.value.pingInterval,this.pingTimeoutDuration&&this.pingTimeoutDuration>0&&this.log.debug("ping config",Object.assign(Object.assign({},this.logContext),{timeout:this.pingTimeoutDuration,interval:this.pingIntervalDuration})));let m=l.shouldProcessFirstMessage?i:void 0;k(d,m),a(l.response)}catch(a){b(a)}finally{i()}}finally{s()}}))})}startReadingLoop(a,b){return gS(this,void 0,void 0,function*(){for(b&&this.handleSignalResponse(b);;){this.signalLatency&&(yield ip(this.signalLatency));let{done:b,value:c}=yield a.read();if(b)break;let d=i2(c);this.handleSignalResponse(d)}})}close(){return gS(this,arguments,void 0,function(){var a=this;let b=!(arguments.length>0)||void 0===arguments[0]||arguments[0],c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Close method called on signal client";return function*(){if([lt.DISCONNECTING||lt.DISCONNECTED].includes(a.state))return void a.log.debug("ignoring signal close as it's already in disconnecting state");let d=yield a.closingLock.lock();try{if(a.clearPingInterval(),b&&(a.state=lt.DISCONNECTING),a.ws){a.ws.close({closeCode:1e3,reason:c});let b=a.ws.closed;a.ws=void 0,a.streamWriter=void 0,yield Promise.race([b,ip(250)])}}catch(b){a.log.debug("websocket error while closing",Object.assign(Object.assign({},a.logContext),{error:b}))}finally{b&&(a.state=lt.DISCONNECTED),d()}}()})}sendOffer(a,b){this.log.debug("sending offer",Object.assign(Object.assign({},this.logContext),{offerSdp:a.sdp})),this.sendRequest({case:"offer",value:je(a,b)})}sendAnswer(a,b){return this.log.debug("sending answer",Object.assign(Object.assign({},this.logContext),{answerSdp:a.sdp})),this.sendRequest({case:"answer",value:je(a,b)})}sendIceCandidate(a,b){return this.log.debug("sending ice candidate",Object.assign(Object.assign({},this.logContext),{candidate:a})),this.sendRequest({case:"trickle",value:new f_({candidateInit:JSON.stringify(a),target:b})})}sendMuteTrack(a,b){return this.sendRequest({case:"mute",value:new f0({sid:a,muted:b})})}sendAddTrack(a){return this.sendRequest({case:"addTrack",value:a})}sendUpdateLocalMetadata(a,b){return gS(this,arguments,void 0,function(a,b){var c=this;let d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return function*(){let e=c.getNextRequestId();return yield c.sendRequest({case:"updateMetadata",value:new ge({requestId:e,metadata:a,name:b,attributes:d})}),e}()})}sendUpdateTrackSettings(a){this.sendRequest({case:"trackSetting",value:a})}sendUpdateSubscription(a){return this.sendRequest({case:"subscription",value:a})}sendSyncState(a){return this.sendRequest({case:"syncState",value:a})}sendUpdateVideoLayers(a,b){return this.sendRequest({case:"updateLayers",value:new gd({trackSid:a,layers:b})})}sendUpdateSubscriptionPermissions(a,b){return this.sendRequest({case:"subscriptionPermission",value:new gr({allParticipants:a,trackPermissions:b})})}sendSimulateScenario(a){return this.sendRequest({case:"simulate",value:a})}sendPing(){return Promise.all([this.sendRequest({case:"ping",value:dN.parse(Date.now())}),this.sendRequest({case:"pingReq",value:new gy({timestamp:dN.parse(Date.now()),rtt:dN.parse(this.rtt)})})])}sendUpdateLocalAudioTrack(a,b){return this.sendRequest({case:"updateAudioTrack",value:new f9({trackSid:a,features:b})})}sendLeave(){return this.sendRequest({case:"leave",value:new gb({reason:eN.CLIENT_INITIATED,action:gc.DISCONNECT})})}sendRequest(a){return gS(this,arguments,void 0,function(a){var b=this;let c=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function*(){let d;if(!c&&(d=jb.indexOf(a.case)>=0,gO.trace("request allowed to bypass queue:",{canPass:d,req:a}),!d)&&b.state===lt.RECONNECTING)return void b.queuedRequests.push(()=>gS(b,void 0,void 0,function*(){yield this.sendRequest(a,!0)}));if(c||(yield b.requestQueue.flush()),b.signalLatency&&(yield ip(b.signalLatency)),b.isDisconnected)return void b.log.debug("skipping signal request (type: ".concat(a.case,") - SignalClient disconnected"));if(!b.streamWriter)return void b.log.error("cannot send signal request before connected, type: ".concat(null==a?void 0:a.case),b.logContext);let e=new fX({message:a});try{b.useJSON?yield b.streamWriter.write(e.toJsonString()):yield b.streamWriter.write(e.toBinary())}catch(a){b.log.error("error sending signal message",Object.assign(Object.assign({},b.logContext),{error:a}))}}()})}handleSignalResponse(a){var b,c;let d=a.message;if(void 0==d)return void this.log.debug("received unsupported message",this.logContext);let e=!1;if("answer"===d.case){let a=jd(d.value);this.onAnswer&&this.onAnswer(a,d.value.id,d.value.midToTrackId)}else if("offer"===d.case){let a=jd(d.value);this.onOffer&&this.onOffer(a,d.value.id,d.value.midToTrackId)}else if("trickle"===d.case){let a=JSON.parse(d.value.candidateInit);this.onTrickle&&this.onTrickle(a,d.value.target)}else"update"===d.case?this.onParticipantUpdate&&this.onParticipantUpdate(null!=(b=d.value.participants)?b:[]):"trackPublished"===d.case?this.onLocalTrackPublished&&this.onLocalTrackPublished(d.value):"speakersChanged"===d.case?this.onSpeakersChanged&&this.onSpeakersChanged(null!=(c=d.value.speakers)?c:[]):"leave"===d.case?this.onLeave&&this.onLeave(d.value):"mute"===d.case?this.onRemoteMuteChanged&&this.onRemoteMuteChanged(d.value.sid,d.value.muted):"roomUpdate"===d.case?this.onRoomUpdate&&d.value.room&&this.onRoomUpdate(d.value.room):"connectionQuality"===d.case?this.onConnectionQuality&&this.onConnectionQuality(d.value):"streamStateUpdate"===d.case?this.onStreamStateUpdate&&this.onStreamStateUpdate(d.value):"subscribedQualityUpdate"===d.case?this.onSubscribedQualityUpdate&&this.onSubscribedQualityUpdate(d.value):"subscriptionPermissionUpdate"===d.case?this.onSubscriptionPermissionUpdate&&this.onSubscriptionPermissionUpdate(d.value):"refreshToken"===d.case?this.onTokenRefresh&&this.onTokenRefresh(d.value):"trackUnpublished"===d.case?this.onLocalTrackUnpublished&&this.onLocalTrackUnpublished(d.value):"subscriptionResponse"===d.case?this.onSubscriptionError&&this.onSubscriptionError(d.value):"pong"===d.case||("pongResp"===d.case?(this.rtt=Date.now()-Number.parseInt(d.value.lastPingTimestamp.toString()),this.resetPingTimeout(),e=!0):"requestResponse"===d.case?this.onRequestResponse&&this.onRequestResponse(d.value):"trackSubscribed"===d.case?this.onLocalTrackSubscribed&&this.onLocalTrackSubscribed(d.value.trackSid):"roomMoved"===d.case?(this.onTokenRefresh&&this.onTokenRefresh(d.value.token),this.onRoomMoved&&this.onRoomMoved(d.value)):"mediaSectionsRequirement"===d.case?this.onMediaSectionsRequirement&&this.onMediaSectionsRequirement(d.value):this.log.debug("unsupported message",Object.assign(Object.assign({},this.logContext),{msgCase:d.case})));e||this.resetPingTimeout()}setReconnected(){for(;this.queuedRequests.length>0;){let a=this.queuedRequests.shift();a&&this.requestQueue.run(a)}}handleOnClose(a){return gS(this,void 0,void 0,function*(){if(this.state===lt.DISCONNECTED)return;let b=this.onClose;yield this.close(void 0,a),this.log.debug("websocket connection closed: ".concat(a),Object.assign(Object.assign({},this.logContext),{reason:a})),b&&b(a)})}handleWSError(a){this.log.error("websocket error",Object.assign(Object.assign({},this.logContext),{error:a}))}resetPingTimeout(){(this.clearPingTimeout(),this.pingTimeoutDuration)?this.pingTimeout=h0.setTimeout(()=>{this.log.warn("ping timeout triggered. last pong received at: ".concat(new Date(Date.now()-1e3*this.pingTimeoutDuration).toUTCString()),this.logContext),this.handleOnClose("ping timeout")},1e3*this.pingTimeoutDuration):this.log.warn("ping timeout duration not set",this.logContext)}clearPingTimeout(){this.pingTimeout&&h0.clearTimeout(this.pingTimeout)}startPingInterval(){(this.clearPingInterval(),this.resetPingTimeout(),this.pingIntervalDuration)?(this.log.debug("start ping interval",this.logContext),this.pingInterval=h0.setInterval(()=>{this.sendPing()},1e3*this.pingIntervalDuration)):this.log.warn("ping interval duration not set",this.logContext)}clearPingInterval(){this.log.debug("clearing ping interval",this.logContext),this.clearPingTimeout(),this.pingInterval&&h0.clearInterval(this.pingInterval)}handleSignalConnected(a,b,c){this.state=lt.CONNECTED,clearTimeout(b),this.startPingInterval(),this.startReadingLoop(a.readable.getReader(),c)}validateFirstMessage(a,b){var c,d,e,f,g;if((null==(c=a.message)?void 0:c.case)==="join")return{isValid:!0,response:a.message.value};if(this.state===lt.RECONNECTING&&(null==(d=a.message)?void 0:d.case)!=="leave")if((null==(e=a.message)?void 0:e.case)==="reconnect")return{isValid:!0,response:a.message.value};else return this.log.debug("declaring signal reconnected without reconnect response received",this.logContext),{isValid:!0,response:void 0,shouldProcessFirstMessage:!0};return this.isEstablishingConnection&&(null==(f=a.message)?void 0:f.case)==="leave"?{isValid:!1,error:hS.leaveRequest("Received leave request while trying to (re)connect",a.message.value.reason)}:b?{isValid:!1,error:hS.internal("Unexpected first message")}:{isValid:!1,error:hS.internal("did not receive join response, got ".concat(null==(g=a.message)?void 0:g.case," instead"))}}handleConnectionError(a,b){return gS(this,void 0,void 0,function*(){try{let c=yield fetch(b);if(c.status.toFixed(0).startsWith("4")){let a=yield c.text();return hS.notAllowed(a,c.status)}if(a instanceof hS)return a;return hS.internal("Encountered unknown websocket error during connection: ".concat(a),{status:c.status,statusText:c.statusText})}catch(a){return a instanceof hS?a:hS.serverUnreachable(a instanceof Error?a.message:"server was not reachable")}})}}function jd(a){let b={type:"offer",sdp:a.sdp};switch(a.type){case"answer":case"offer":case"pranswer":case"rollback":b.type=a.type}return b}function je(a,b){return new f5({sdp:a.sdp,type:a.type,id:b})}class jf{constructor(){this.buffer=[],this._totalSize=0}push(a){this.buffer.push(a),this._totalSize+=a.data.byteLength}pop(){let a=this.buffer.shift();return a&&(this._totalSize-=a.data.byteLength),a}getAll(){return this.buffer.slice()}popToSequence(a){for(;this.buffer.length>0;)if(this.buffer[0].sequence<=a)this.pop();else break}alignBufferedAmount(a){for(;this.buffer.length>0;){let b=this.buffer[0];if(this._totalSize-b.data.byteLength<=a)break;this.pop()}}get length(){return this.buffer.length}}class jg{constructor(a){this._map=new Map,this._lastCleanup=0,this.ttl=a}set(a,b){let c=Date.now();c-this._lastCleanup>this.ttl/2&&this.cleanup();let d=c+this.ttl;return this._map.set(a,{value:b,expiresAt:d}),this}get(a){let b=this._map.get(a);if(b)return b.expiresAt<Date.now()?void this._map.delete(a):b.value}has(a){let b=this._map.get(a);return!!b&&(!(b.expiresAt<Date.now())||(this._map.delete(a),!1))}delete(a){return this._map.delete(a)}clear(){this._map.clear()}cleanup(){let a=Date.now();for(let[b,c]of this._map.entries())c.expiresAt<a&&this._map.delete(b);this._lastCleanup=a}get size(){return this.cleanup(),this._map.size}forEach(a){for(let[b,c]of(this.cleanup(),this._map.entries()))c.expiresAt>=Date.now()&&a(c.value,b,this.asValueMap())}map(a){this.cleanup();let b=[],c=this.asValueMap();for(let[d,e]of c.entries())b.push(a(e,d,c));return b}asValueMap(){let a=new Map;for(let[b,c]of this._map.entries())c.expiresAt>=Date.now()&&a.set(b,c.value);return a}}var jh={},ji={},jj={exports:{}};function jk(){if(lu)return jj.exports;lu=1;var a=jj.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(a){return a.encoding?"rtpmap:%d %s/%s/%s":a.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(a){return null!=a.address?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(a){return null!=a.subtype?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(a){return"extmap:%d"+(a.direction?"/%s":"%v")+(a["encrypt-uri"]?" %s":"%v")+" %s"+(a.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(a){return null!=a.sessionConfig?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(a){var b="candidate:%s %d %s %d %s %d typ %s";return b+=(null!=a.raddr?" raddr %s rport %d":"%v%v")+(null!=a.tcptype?" tcptype %s":"%v"),null!=a.generation&&(b+=" generation %d"),b+=(null!=a["network-id"]?" network-id %d":"%v")+(null!=a["network-cost"]?" network-cost %d":"%v")}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(a){var b="ssrc:%d";return null!=a.attribute&&(b+=" %s",null!=a.value&&(b+=":%s")),b}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(a){return null!=a.maxMessageSize?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(a){return a.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(a){return"imageattr:%s %s %s"+(a.dir2?" %s %s":"")}},{name:"simulcast",reg:RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(a){return"simulcast:%s %s"+(a.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(a){return"ts-refclk:%s"+(null!=a.clksrcExt?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(a){var b="mediaclk:";return b+((null!=a.id?"id=%s %s":"%v%s")+(null!=a.mediaClockValue?"=%s":"")+(null!=a.rateNumerator?" rate=%s":"")+(null!=a.rateDenominator?"/%s":""))}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};return Object.keys(a).forEach(function(b){a[b].forEach(function(a){a.reg||(a.reg=/(.*)/),a.format||(a.format="%s")})}),jj.exports}var jl=function(){if(ly)return jh;ly=1;var a=function(){var a,b,c,d,e,f;return lv?ji:(lv=1,a=function(a){return String(Number(a))===a?Number(a):a},b=function(b,c,d,e){if(e&&!d)c[e]=a(b[1]);else for(var f=0;f<d.length;f+=1)null!=b[f+1]&&(c[d[f]]=a(b[f+1]))},c=function(a,c,d){var e=a.name&&a.names;a.push&&!c[a.push]?c[a.push]=[]:e&&!c[a.name]&&(c[a.name]={});var f=a.push?{}:e?c[a.name]:c;b(d.match(a.reg),f,a.names,a.name),a.push&&c[a.push].push(f)},d=jk(),e=RegExp.prototype.test.bind(/^([a-z])=(.*)/),ji.parse=function(a){var b={},f=[],g=b;return a.split(/(\r\n|\r|\n)/).filter(e).forEach(function(a){var b=a[0],e=a.slice(2);"m"===b&&(f.push({rtp:[],fmtp:[]}),g=f[f.length-1]);for(var h=0;h<(d[b]||[]).length;h+=1){var i=d[b][h];if(i.reg.test(e))return c(i,g,e)}}),b.media=f,b},f=function(b,c){var d=c.split(/=(.+)/,2);return 2===d.length?b[d[0]]=a(d[1]):1===d.length&&c.length>1&&(b[d[0]]=void 0),b},ji.parseParams=function(a){return a.split(/;\s?/).reduce(f,{})},ji.parseFmtpConfig=ji.parseParams,ji.parsePayloads=function(a){return a.toString().split(" ").map(Number)},ji.parseRemoteCandidates=function(b){for(var c=[],d=b.split(" ").map(a),e=0;e<d.length;e+=3)c.push({component:d[e],ip:d[e+1],port:d[e+2]});return c},ji.parseImageAttributes=function(a){return a.split(" ").map(function(a){return a.substring(1,a.length-1).split(",").reduce(f,{})})},ji.parseSimulcastStreamList=function(b){return b.split(";").map(function(b){return b.split(",").map(function(b){var c,d=!1;return"~"!==b[0]?c=a(b):(c=a(b.substring(1,b.length)),d=!0),{scid:c,paused:d}})})},ji)}(),b=function(){if(lx)return lw;lx=1;var a=jk(),b=/%[sdv%]/g,c=function(a){var c=1,d=arguments,e=d.length;return a.replace(b,function(a){if(c>=e)return a;var b=d[c];switch(c+=1,a){case"%%":return"%";case"%s":return String(b);case"%d":return Number(b);case"%v":return""}})},d=function(a,b,d){var e=[a+"="+(b.format instanceof Function?b.format(b.push?d:d[b.name]):b.format)];if(b.names)for(var f=0;f<b.names.length;f+=1){var g=b.names[f];b.name?e.push(d[b.name][g]):e.push(d[b.names[f]])}else e.push(d[b.name]);return c.apply(null,e)},e=["v","o","s","i","u","e","p","c","b","t","r","z","a"],f=["i","c","b","a"];return lw=function(b,c){c=c||{},null==b.version&&(b.version=0),null==b.name&&(b.name=" "),b.media.forEach(function(a){null==a.payloads&&(a.payloads="")});var g=c.outerOrder||e,h=c.innerOrder||f,i=[];return g.forEach(function(c){a[c].forEach(function(a){a.name in b&&null!=b[a.name]?i.push(d(c,a,b)):a.push in b&&null!=b[a.push]&&b[a.push].forEach(function(b){i.push(d(c,a,b))})})}),b.media.forEach(function(b){i.push(d("m",a.m[0],b)),h.forEach(function(c){a[c].forEach(function(a){a.name in b&&null!=b[a.name]?i.push(d(c,a,b)):a.push in b&&null!=b[a.push]&&b[a.push].forEach(function(b){i.push(d(c,a,b))})})})}),i.join("\r\n")+"\r\n"}}();return jh.grammar=jk(),jh.write=b,jh.parse=a.parse,jh.parseParams=a.parseParams,jh.parseFmtpConfig=a.parseFmtpConfig,jh.parsePayloads=a.parsePayloads,jh.parseRemoteCandidates=a.parseRemoteCandidates,jh.parseImageAttributes=a.parseImageAttributes,jh.parseSimulcastStreamList=a.parseSimulcastStreamList,jh}();function jm(a,b,c){void 0===b&&(b=50),void 0===c&&(c={});var d,e,f,g=null!=(d=c.isImmediate)&&d,h=null!=(e=c.callback)&&e,i=c.maxWait,j=Date.now(),k=[],l=function(){var c=[].slice.call(arguments),d=this;return new Promise(function(e,l){var m=g&&void 0===f;if(void 0!==f&&clearTimeout(f),f=setTimeout(function(){if(f=void 0,j=Date.now(),!g){var b=a.apply(d,c);h&&h(b),k.forEach(function(a){return(0,a.resolve)(b)}),k=[]}},function(){if(void 0!==i){var a=Date.now()-j;if(a+b>=i)return i-a}return b}()),m){var n=a.apply(d,c);return h&&h(n),e(n)}k.push({resolve:e,reject:l})})};return l.cancel=function(a){void 0!==f&&clearTimeout(f),k.forEach(function(b){return(0,b.reject)(a)}),k=[]},l}let jn="negotiationStarted",jo="negotiationComplete",jp="rtpVideoPayloadTypes";class jq extends gV.EventEmitter{get pc(){return this._pc||(this._pc=this.createPC()),this._pc}constructor(a){var b;let c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),this.log=gO,this.ddExtID=0,this.latestOfferId=0,this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate=!1,this.trackBitrates=[],this.remoteStereoMids=[],this.remoteNackMids=[],this.negotiate=jm(a=>gS(this,void 0,void 0,function*(){this.emit(jn);try{yield this.createAndSendOffer()}catch(b){if(a)a(b);else throw b}}),20),this.close=()=>{this._pc&&(this._pc.close(),this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.ondatachannel=null,this._pc.onnegotiationneeded=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ondatachannel=null,this._pc.ontrack=null,this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc=null)},this.log=gP(null!=(b=c.loggerName)?b:la.PCTransport),this.loggerOptions=c,this.config=a,this._pc=this.createPC(),this.offerLock=new du}createPC(){let a=new RTCPeerConnection(this.config);return a.onicecandidate=a=>{var b;a.candidate&&(null==(b=this.onIceCandidate)||b.call(this,a.candidate))},a.onicecandidateerror=a=>{var b;null==(b=this.onIceCandidateError)||b.call(this,a)},a.oniceconnectionstatechange=()=>{var b;null==(b=this.onIceConnectionStateChange)||b.call(this,a.iceConnectionState)},a.onsignalingstatechange=()=>{var b;null==(b=this.onSignalingStatechange)||b.call(this,a.signalingState)},a.onconnectionstatechange=()=>{var b;null==(b=this.onConnectionStateChange)||b.call(this,a.connectionState)},a.ondatachannel=a=>{var b;null==(b=this.onDataChannel)||b.call(this,a)},a.ontrack=a=>{var b;null==(b=this.onTrack)||b.call(this,a)},a}get logContext(){var a,b;return Object.assign({},null==(b=(a=this.loggerOptions).loggerContextCb)?void 0:b.call(a))}get isICEConnected(){return null!==this._pc&&("connected"===this.pc.iceConnectionState||"completed"===this.pc.iceConnectionState)}addIceCandidate(a){return gS(this,void 0,void 0,function*(){if(this.pc.remoteDescription&&!this.restartingIce)return this.pc.addIceCandidate(a);this.pendingCandidates.push(a)})}setRemoteDescription(a,b){return gS(this,void 0,void 0,function*(){var c,d,e;let f;if("answer"===a.type&&this.latestOfferId>0&&b>0&&b!==this.latestOfferId)return this.log.warn("ignoring answer for old offer",Object.assign(Object.assign({},this.logContext),{offerId:b,latestOfferId:this.latestOfferId})),!1;if("offer"===a.type){let b,c,f,g,{stereoMids:h,nackMids:i}=(d=a,b=[],c=[],f=jl.parse(null!=(e=d.sdp)?e:""),g=0,f.media.forEach(a=>{var d;let e=jt(a.mid);"audio"===a.type&&(a.rtp.some(a=>"opus"===a.codec&&(g=a.payload,!0)),(null==(d=a.rtcpFb)?void 0:d.some(a=>a.payload===g&&"nack"===a.type))&&c.push(e),a.fmtp.some(a=>a.payload===g&&(a.config.includes("sprop-stereo=1")&&b.push(e),!0)))}),{stereoMids:b,nackMids:c});this.remoteStereoMids=h,this.remoteNackMids=i}else if("answer"===a.type){let b=jl.parse(null!=(c=a.sdp)?c:"");b.media.forEach(a=>{let b=jt(a.mid);"audio"===a.type&&this.trackBitrates.some(c=>{if(!c.transceiver||b!=c.transceiver.mid)return!1;let d=0;if(a.rtp.some(a=>a.codec.toUpperCase()===c.codec.toUpperCase()&&(d=a.payload,!0)),0===d)return!0;let e=!1;for(let b of a.fmtp)if(b.payload===d){b.config=b.config.split(";").filter(a=>!a.includes("maxaveragebitrate")).join(";"),c.maxbr>0&&(b.config+=";maxaveragebitrate=".concat(1e3*c.maxbr)),e=!0;break}return!e&&c.maxbr>0&&a.fmtp.push({payload:d,config:"maxaveragebitrate=".concat(1e3*c.maxbr)}),!0})}),f=jl.write(b)}return yield this.setMungedSDP(a,f,!0),this.pendingCandidates.forEach(a=>{this.pc.addIceCandidate(a)}),this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate?(this.renegotiate=!1,yield this.createAndSendOffer()):"answer"===a.type&&(this.emit(jo),a.sdp&&jl.parse(a.sdp).media.forEach(a=>{"video"===a.type&&this.emit(jp,a.rtp)})),!0})}createAndSendOffer(a){return gS(this,void 0,void 0,function*(){var b;let c=yield this.offerLock.lock();try{if(void 0===this.onOffer)return;if((null==a?void 0:a.iceRestart)&&(this.log.debug("restarting ICE",this.logContext),this.restartingIce=!0),this._pc&&"have-local-offer"===this._pc.signalingState){let b=this._pc.remoteDescription;if((null==a?void 0:a.iceRestart)&&b)yield this._pc.setRemoteDescription(b);else{this.renegotiate=!0;return}}else if(!this._pc||"closed"===this._pc.signalingState)return void this.log.warn("could not createOffer with closed peer connection",this.logContext);this.log.debug("starting to negotiate",this.logContext);let c=this.latestOfferId+1;this.latestOfferId=c;let d=yield this.pc.createOffer(a);this.log.debug("original offer",Object.assign({sdp:d.sdp},this.logContext));let e=jl.parse(null!=(b=d.sdp)?b:"");if(e.media.forEach(a=>{js(a),"audio"===a.type?jr(a,["all"],[]):"video"===a.type&&this.trackBitrates.some(b=>{if(!a.msid||!b.cid||!a.msid.includes(b.cid))return!1;let c=0;if(a.rtp.some(a=>a.codec.toUpperCase()===b.codec.toUpperCase()&&(c=a.payload,!0)),0===c||(is(b.codec)&&!iw()&&this.ensureVideoDDExtensionForSVC(a,e),!is(b.codec)))return!0;let d=Math.round(.7*b.maxbr);for(let b of a.fmtp)if(b.payload===c){b.config.includes("x-google-start-bitrate")||(b.config+=";x-google-start-bitrate=".concat(d));break}return!0})}),this.latestOfferId>c)return void this.log.warn("latestOfferId mismatch",Object.assign(Object.assign({},this.logContext),{latestOfferId:this.latestOfferId,offerId:c}));yield this.setMungedSDP(d,jl.write(e)),this.onOffer(d,this.latestOfferId)}finally{c()}})}createAndSetAnswer(){return gS(this,void 0,void 0,function*(){var a;let b=yield this.pc.createAnswer(),c=jl.parse(null!=(a=b.sdp)?a:"");return c.media.forEach(a=>{js(a),"audio"===a.type&&jr(a,this.remoteStereoMids,this.remoteNackMids)}),yield this.setMungedSDP(b,jl.write(c)),b})}createDataChannel(a,b){return this.pc.createDataChannel(a,b)}addTransceiver(a,b){return this.pc.addTransceiver(a,b)}addTransceiverOfKind(a,b){return this.pc.addTransceiver(a,b)}addTrack(a){if(!this._pc)throw new hW("PC closed, cannot add track");return this._pc.addTrack(a)}setTrackCodecBitrate(a){this.trackBitrates.push(a)}setConfiguration(a){var b;if(!this._pc)throw new hW("PC closed, cannot configure");return null==(b=this._pc)?void 0:b.setConfiguration(a)}canRemoveTrack(){var a;return!!(null==(a=this._pc)?void 0:a.removeTrack)}removeTrack(a){var b;return null==(b=this._pc)?void 0:b.removeTrack(a)}getConnectionState(){var a,b;return null!=(b=null==(a=this._pc)?void 0:a.connectionState)?b:"closed"}getICEConnectionState(){var a,b;return null!=(b=null==(a=this._pc)?void 0:a.iceConnectionState)?b:"closed"}getSignallingState(){var a,b;return null!=(b=null==(a=this._pc)?void 0:a.signalingState)?b:"closed"}getTransceivers(){var a,b;return null!=(b=null==(a=this._pc)?void 0:a.getTransceivers())?b:[]}getSenders(){var a,b;return null!=(b=null==(a=this._pc)?void 0:a.getSenders())?b:[]}getLocalDescription(){var a;return null==(a=this._pc)?void 0:a.localDescription}getRemoteDescription(){var a;return null==(a=this.pc)?void 0:a.remoteDescription}getStats(){return this.pc.getStats()}getConnectedAddress(){return gS(this,void 0,void 0,function*(){var a;if(!this._pc)return;let b="",c=new Map,d=new Map;if((yield this._pc.getStats()).forEach(a=>{switch(a.type){case"transport":b=a.selectedCandidatePairId;break;case"candidate-pair":""===b&&a.selected&&(b=a.id),c.set(a.id,a);break;case"remote-candidate":d.set(a.id,"".concat(a.address,":").concat(a.port))}}),""===b)return;let e=null==(a=c.get(b))?void 0:a.remoteCandidateId;if(void 0!==e)return d.get(e)})}setMungedSDP(a,b,c){return gS(this,void 0,void 0,function*(){if(b){let d=a.sdp;a.sdp=b;try{this.log.debug("setting munged ".concat(c?"remote":"local"," description"),this.logContext),c?yield this.pc.setRemoteDescription(a):yield this.pc.setLocalDescription(a);return}catch(c){this.log.warn("not able to set ".concat(a.type,", falling back to unmodified sdp"),Object.assign(Object.assign({},this.logContext),{error:c,sdp:b})),a.sdp=d}}try{c?yield this.pc.setRemoteDescription(a):yield this.pc.setLocalDescription(a)}catch(e){let b="unknown error";e instanceof Error?b=e.message:"string"==typeof e&&(b=e);let d={error:b,sdp:a.sdp};throw!c&&this.pc.remoteDescription&&(d.remoteSdp=this.pc.remoteDescription),this.log.error("unable to set ".concat(a.type),Object.assign(Object.assign({},this.logContext),{fields:d})),new hX(b)}})}ensureVideoDDExtensionForSVC(a,b){var c,d;if(!(null==(c=a.ext)?void 0:c.some(a=>a.uri===io))){if(0===this.ddExtID){let a=0;b.media.forEach(b=>{var c;"video"===b.type&&(null==(c=b.ext)||c.forEach(b=>{b.value>a&&(a=b.value)}))}),this.ddExtID=a+1}null==(d=a.ext)||d.push({value:this.ddExtID,uri:io})}}}function jr(a,b,c){let d=jt(a.mid),e=0;a.rtp.some(a=>"opus"===a.codec&&(e=a.payload,!0)),e>0&&(a.rtcpFb||(a.rtcpFb=[]),c.includes(d)&&!a.rtcpFb.some(a=>a.payload===e&&"nack"===a.type)&&a.rtcpFb.push({payload:e,type:"nack"}),(b.includes(d)||1===b.length&&"all"===b[0])&&a.fmtp.some(a=>a.payload===e&&(a.config.includes("stereo=1")||(a.config+=";stereo=1"),!0)))}function js(a){if(a.connection){let b=a.connection.ip.indexOf(":")>=0;(4===a.connection.version&&b||6===a.connection.version&&!b)&&(a.connection.ip="0.0.0.0",a.connection.version=4)}}function jt(a){return"number"==typeof a?a.toFixed(0):a}let ju={audioPreset:ll.music,dtx:!0,red:!0,forceStereo:!1,simulcast:!0,screenShareEncoding:h7.h1080fps15.encoding,stopMicTrackOnMute:!1,videoCodec:"vp8",backupCodec:!0,preConnectBuffer:!1},jv={deviceId:{ideal:"default"},autoGainControl:!0,echoCancellation:!0,noiseSuppression:!0,voiceIsolation:!0},jw={deviceId:{ideal:"default"},resolution:h5.h720.resolution},jx={adaptiveStream:!1,dynacast:!1,stopLocalTrackOnUnpublish:!0,reconnectPolicy:new class{constructor(a){this._retryDelays=void 0!==a?[...a]:gR}nextRetryDelayInMs(a){if(a.retryCount>=this._retryDelays.length)return null;let b=this._retryDelays[a.retryCount];return a.retryCount<=1?b:b+1e3*Math.random()}},disconnectOnPageLeave:!0,webAudioMix:!1,singlePeerConnection:!1},jy={autoSubscribe:!0,maxRetries:1,peerConnectionTimeout:15e3,websocketTimeout:15e3};(kZ=lz||(lz={}))[kZ.NEW=0]="NEW",kZ[kZ.CONNECTING=1]="CONNECTING",kZ[kZ.CONNECTED=2]="CONNECTED",kZ[kZ.FAILED=3]="FAILED",kZ[kZ.CLOSING=4]="CLOSING",kZ[kZ.CLOSED=5]="CLOSED";class jz{get needsPublisher(){return this.isPublisherConnectionRequired}get needsSubscriber(){return this.isSubscriberConnectionRequired}get currentState(){return this.state}constructor(a,b,c){var d;this.peerConnectionTimeout=jy.peerConnectionTimeout,this.log=gO,this.updateState=()=>{var a,b;let c=this.state,d=this.requiredTransports.map(a=>a.getConnectionState());d.every(a=>"connected"===a)?this.state=lz.CONNECTED:d.some(a=>"failed"===a)?this.state=lz.FAILED:d.some(a=>"connecting"===a)?this.state=lz.CONNECTING:d.every(a=>"closed"===a)?this.state=lz.CLOSED:d.some(a=>"closed"===a)?this.state=lz.CLOSING:d.every(a=>"new"===a)&&(this.state=lz.NEW),c!==this.state&&(this.log.debug("pc state change: from ".concat(lz[c]," to ").concat(lz[this.state]),this.logContext),null==(a=this.onStateChange)||a.call(this,this.state,this.publisher.getConnectionState(),null==(b=this.subscriber)?void 0:b.getConnectionState()))},this.log=gP(null!=(d=c.loggerName)?d:la.PCManager),this.loggerOptions=c,this.isPublisherConnectionRequired="subscriber-primary"!==b,this.isSubscriberConnectionRequired="subscriber-primary"===b,this.publisher=new jq(a,c),"publisher-only"!==b&&(this.subscriber=new jq(a,c),this.subscriber.onConnectionStateChange=this.updateState,this.subscriber.onIceConnectionStateChange=this.updateState,this.subscriber.onSignalingStatechange=this.updateState,this.subscriber.onIceCandidate=a=>{var b;null==(b=this.onIceCandidate)||b.call(this,a,fU.SUBSCRIBER)},this.subscriber.onDataChannel=a=>{var b;null==(b=this.onDataChannel)||b.call(this,a)},this.subscriber.onTrack=a=>{var b;null==(b=this.onTrack)||b.call(this,a)}),this.publisher.onConnectionStateChange=this.updateState,this.publisher.onIceConnectionStateChange=this.updateState,this.publisher.onSignalingStatechange=this.updateState,this.publisher.onIceCandidate=a=>{var b;null==(b=this.onIceCandidate)||b.call(this,a,fU.PUBLISHER)},this.publisher.onTrack=a=>{var b;null==(b=this.onTrack)||b.call(this,a)},this.publisher.onOffer=(a,b)=>{var c;null==(c=this.onPublisherOffer)||c.call(this,a,b)},this.state=lz.NEW,this.connectionLock=new du,this.remoteOfferLock=new du}get logContext(){var a,b;return Object.assign({},null==(b=(a=this.loggerOptions).loggerContextCb)?void 0:b.call(a))}requirePublisher(){let a=!(arguments.length>0)||void 0===arguments[0]||arguments[0];this.isPublisherConnectionRequired=a,this.updateState()}createAndSendPublisherOffer(a){return this.publisher.createAndSendOffer(a)}setPublisherAnswer(a,b){return this.publisher.setRemoteDescription(a,b)}removeTrack(a){return this.publisher.removeTrack(a)}close(){return gS(this,void 0,void 0,function*(){var a;if(this.publisher&&"closed"!==this.publisher.getSignallingState()){let a=this.publisher;for(let b of a.getSenders())try{a.canRemoveTrack()&&a.removeTrack(b)}catch(a){this.log.warn("could not removeTrack",Object.assign(Object.assign({},this.logContext),{error:a}))}}yield Promise.all([this.publisher.close(),null==(a=this.subscriber)?void 0:a.close()]),this.updateState()})}triggerIceRestart(){return gS(this,void 0,void 0,function*(){this.subscriber&&(this.subscriber.restartingIce=!0),this.needsPublisher&&(yield this.createAndSendPublisherOffer({iceRestart:!0}))})}addIceCandidate(a,b){return gS(this,void 0,void 0,function*(){var c;b===fU.PUBLISHER?yield this.publisher.addIceCandidate(a):yield null==(c=this.subscriber)?void 0:c.addIceCandidate(a)})}createSubscriberAnswerFromOffer(a,b){return gS(this,void 0,void 0,function*(){var c,d,e;this.log.debug("received server offer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:a.type,sdp:a.sdp,signalingState:null==(c=this.subscriber)?void 0:c.getSignallingState().toString()}));let f=yield this.remoteOfferLock.lock();try{if(!(yield null==(d=this.subscriber)?void 0:d.setRemoteDescription(a,b)))return;return yield null==(e=this.subscriber)?void 0:e.createAndSetAnswer()}finally{f()}})}updateConfiguration(a,b){var c;this.publisher.setConfiguration(a),null==(c=this.subscriber)||c.setConfiguration(a),b&&this.triggerIceRestart()}ensurePCTransportConnection(a,b){return gS(this,void 0,void 0,function*(){var c;let d=yield this.connectionLock.lock();try{this.isPublisherConnectionRequired&&"connected"!==this.publisher.getConnectionState()&&"connecting"!==this.publisher.getConnectionState()&&(this.log.debug("negotiation required, start negotiating",this.logContext),this.publisher.negotiate()),yield Promise.all(null==(c=this.requiredTransports)?void 0:c.map(c=>this.ensureTransportConnected(c,a,b)))}finally{d()}})}negotiate(a){return gS(this,void 0,void 0,function*(){return new Promise((b,c)=>gS(this,void 0,void 0,function*(){let d=setTimeout(()=>{c("negotiation timed out")},this.peerConnectionTimeout);a.signal.addEventListener("abort",()=>{clearTimeout(d),c("negotiation aborted")}),this.publisher.once(jn,()=>{a.signal.aborted||this.publisher.once(jo,()=>{clearTimeout(d),b()})}),yield this.publisher.negotiate(a=>{clearTimeout(d),c(a)})}))})}addPublisherTransceiver(a,b){return this.publisher.addTransceiver(a,b)}addPublisherTransceiverOfKind(a,b){return this.publisher.addTransceiverOfKind(a,b)}getMidForReceiver(a){let b=(this.subscriber?this.subscriber.getTransceivers():this.publisher.getTransceivers()).find(b=>b.receiver===a);return null==b?void 0:b.mid}addPublisherTrack(a){return this.publisher.addTrack(a)}createPublisherDataChannel(a,b){return this.publisher.createDataChannel(a,b)}getConnectedAddress(a){return a===fU.PUBLISHER||a===fU.SUBSCRIBER?this.publisher.getConnectedAddress():this.requiredTransports[0].getConnectedAddress()}get requiredTransports(){let a=[];return this.isPublisherConnectionRequired&&a.push(this.publisher),this.isSubscriberConnectionRequired&&this.subscriber&&a.push(this.subscriber),a}ensureTransportConnected(a,b){return gS(this,arguments,void 0,function(a,b){var c=this;let d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.peerConnectionTimeout;return function*(){if("connected"!==a.getConnectionState())return new Promise((a,e)=>gS(c,void 0,void 0,function*(){let c=()=>{this.log.warn("abort transport connection",this.logContext),h0.clearTimeout(f),e(hS.cancelled("room connection has been cancelled"))};(null==b?void 0:b.signal.aborted)&&c(),null==b||b.signal.addEventListener("abort",c);let f=h0.setTimeout(()=>{null==b||b.signal.removeEventListener("abort",c),e(hS.internal("could not establish pc connection"))},d);for(;this.state!==lz.CONNECTED;)if(yield ip(50),null==b?void 0:b.signal.aborted)return void e(hS.cancelled("room connection has been cancelled"));h0.clearTimeout(f),null==b||b.signal.removeEventListener("abort",c),a()}))}()})}}class jA{static fetchRegionSettings(a,b,c){return gS(this,void 0,void 0,function*(){let d=yield jA.fetchLock.lock();try{var e;let d=yield fetch("".concat((e=a,"".concat(e.protocol.replace("ws","http"),"//").concat(e.host,"/settings")),"/regions"),{headers:{authorization:"Bearer ".concat(b)},signal:c});if(d.ok){let a=function(a){var b;let c=a.get("Cache-Control");if(c){let a=null==(b=c.match(/(?:^|[,\s])max-age=(\d+)/))?void 0:b[1];if(a)return parseInt(a,10)}}(d.headers);return{regionSettings:yield d.json(),updatedAtInMs:Date.now(),maxAgeInMs:a?1e3*a:5e3}}if(401===d.status)throw hS.notAllowed("Could not fetch region settings: ".concat(d.statusText),d.status);throw hS.internal("Could not fetch region settings: ".concat(d.statusText))}catch(a){if(a instanceof hS)throw a;if(null==c?void 0:c.aborted)throw hS.cancelled("Region fetching was aborted");throw hS.serverUnreachable("Could not fetch region settings, ".concat(a instanceof Error?"".concat(a.name,": ").concat(a.message):a))}finally{d()}})}static scheduleRefetch(a,b,c){return gS(this,void 0,void 0,function*(){clearTimeout(jA.settingsTimeouts.get(a.hostname)),jA.settingsTimeouts.set(a.hostname,setTimeout(()=>gS(this,void 0,void 0,function*(){try{let c=yield jA.fetchRegionSettings(a,b);jA.updateCachedRegionSettings(a,b,c)}catch(d){if(d instanceof hS&&d.reason===ld.NotAllowed)return void gO.debug("token is not valid, cancelling auto region refresh");gO.debug("auto refetching of region settings failed",{error:d}),jA.scheduleRefetch(a,b,c)}}),c))})}static updateCachedRegionSettings(a,b,c){jA.cache.set(a.hostname,c),jA.scheduleRefetch(a,b,c.maxAgeInMs)}static stopRefetch(a){let b=jA.settingsTimeouts.get(a);b&&(clearTimeout(b),jA.settingsTimeouts.delete(a))}static scheduleCleanup(a){let b=jA.connectionTrackers.get(a);b&&(b.cleanupTimeout&&clearTimeout(b.cleanupTimeout),b.cleanupTimeout=setTimeout(()=>{let b=jA.connectionTrackers.get(a);b&&0===b.connectionCount&&(gO.debug("stopping region refetch after disconnect delay",{hostname:a}),jA.stopRefetch(a)),b&&(b.cleanupTimeout=void 0)},3e4))}static cancelCleanup(a){let b=jA.connectionTrackers.get(a);(null==b?void 0:b.cleanupTimeout)&&(clearTimeout(b.cleanupTimeout),b.cleanupTimeout=void 0)}notifyConnected(){let a=this.serverUrl.hostname,b=jA.connectionTrackers.get(a);b||(b={connectionCount:0},jA.connectionTrackers.set(a,b)),b.connectionCount++,jA.cancelCleanup(a)}notifyDisconnected(){let a=this.serverUrl.hostname,b=jA.connectionTrackers.get(a);b&&(b.connectionCount=Math.max(0,b.connectionCount-1),0===b.connectionCount&&jA.scheduleCleanup(a))}constructor(a,b){this.attemptedRegions=[],this.serverUrl=new URL(a),this.token=b}updateToken(a){this.token=a}isCloud(){return iB(this.serverUrl)}getServerUrl(){return this.serverUrl}fetchRegionSettings(a){return gS(this,void 0,void 0,function*(){return jA.fetchRegionSettings(this.serverUrl,this.token,a)})}getNextBestRegionUrl(a){return gS(this,void 0,void 0,function*(){if(!this.isCloud())throw Error("region availability is only supported for LiveKit Cloud domains");let b=jA.cache.get(this.serverUrl.hostname);(!b||Date.now()-b.updatedAtInMs>b.maxAgeInMs)&&(b=yield this.fetchRegionSettings(a),jA.updateCachedRegionSettings(this.serverUrl,this.token,b));let c=b.regionSettings.regions.filter(a=>!this.attemptedRegions.find(b=>b.url===a.url));if(!(c.length>0))return null;{let a=c[0];return this.attemptedRegions.push(a),gO.debug("next region: ".concat(a.region)),a.url}})}resetAttempts(){this.attemptedRegions=[]}setServerReportedRegions(a){jA.updateCachedRegionSettings(this.serverUrl,this.token,a)}}jA.cache=new Map,jA.settingsTimeouts=new Map,jA.connectionTrackers=new Map,jA.fetchLock=new du;class jB extends Error{constructor(a,b,c){super(b),this.code=a,this.message=jD(b,jB.MAX_MESSAGE_BYTES),this.data=c?jD(c,jB.MAX_DATA_BYTES):void 0}static fromProto(a){return new jB(a.code,a.message,a.data)}toProto(){return new ff({code:this.code,message:this.message,data:this.data})}static builtIn(a,b){return new jB(jB.ErrorCode[a],jB.ErrorMessage[a],b)}}function jC(a){return new TextEncoder().encode(a).length}function jD(a,b){if(jC(a)<=b)return a;let c=0,d=a.length,e=new TextEncoder;for(;c<d;){let f=Math.floor((c+d+1)/2);e.encode(a.slice(0,f)).length<=b?c=f:d=f-1}return a.slice(0,c)}function jE(a,b){let c,d;return b?("bytesReceived"in a?(c=a.bytesReceived,d=b.bytesReceived):"bytesSent"in a&&(c=a.bytesSent,d=b.bytesSent),void 0===c||void 0===d||void 0===a.timestamp||void 0===b.timestamp)?0:(c-d)*8e3/(a.timestamp-b.timestamp):0}jB.MAX_MESSAGE_BYTES=256,jB.MAX_DATA_BYTES=15360,jB.ErrorCode={APPLICATION_ERROR:1500,CONNECTION_TIMEOUT:1501,RESPONSE_TIMEOUT:1502,RECIPIENT_DISCONNECTED:1503,RESPONSE_PAYLOAD_TOO_LARGE:1504,SEND_FAILED:1505,UNSUPPORTED_METHOD:1400,RECIPIENT_NOT_FOUND:1401,REQUEST_PAYLOAD_TOO_LARGE:1402,UNSUPPORTED_SERVER:1403,UNSUPPORTED_VERSION:1404},jB.ErrorMessage={APPLICATION_ERROR:"Application error in method handler",CONNECTION_TIMEOUT:"Connection timeout",RESPONSE_TIMEOUT:"Response timeout",RECIPIENT_DISCONNECTED:"Recipient disconnected",RESPONSE_PAYLOAD_TOO_LARGE:"Response payload too large",SEND_FAILED:"Failed to send",UNSUPPORTED_METHOD:"Method not supported at destination",RECIPIENT_NOT_FOUND:"Recipient not found",REQUEST_PAYLOAD_TOO_LARGE:"Request payload too large",UNSUPPORTED_SERVER:"RPC not supported by server",UNSUPPORTED_VERSION:"Unsupported RPC version"};let jF="undefined"!=typeof MediaRecorder,jG=jF?MediaRecorder:class{constructor(){throw Error("MediaRecorder is not available in this environment")}};class jH extends jG{constructor(a,b){let c,d;if(!jF)throw Error("MediaRecorder is not available in this environment");super(new MediaStream([a.mediaStreamTrack]),b);const e=()=>{this.removeEventListener("dataavailable",c),this.removeEventListener("stop",e),this.removeEventListener("error",f),null==d||d.close(),d=void 0},f=a=>{null==d||d.error(a),this.removeEventListener("dataavailable",c),this.removeEventListener("stop",e),this.removeEventListener("error",f),d=void 0};this.byteStream=new ReadableStream({start:a=>{d=a,c=b=>gS(this,void 0,void 0,function*(){let c;if(b.data.arrayBuffer)c=new Uint8Array((yield b.data.arrayBuffer()));else if(b.data.byteArray)c=b.data.byteArray;else throw Error("no data available!");void 0!==d&&a.enqueue(c)}),this.addEventListener("dataavailable",c)},cancel:()=>{e()}}),this.addEventListener("stop",e),this.addEventListener("error",f)}}class jI extends ik{get sender(){return this._sender}set sender(a){this._sender=a}get constraints(){return this._constraints}get hasPreConnectBuffer(){return!!this.localTrackRecorder}constructor(a,b,c){let d=arguments.length>3&&void 0!==arguments[3]&&arguments[3],e=arguments.length>4?arguments[4]:void 0;super(a,b,e),this.manuallyStopped=!1,this._isUpstreamPaused=!1,this.handleTrackMuteEvent=()=>this.debouncedTrackMuteHandler().catch(()=>this.log.debug("track mute bounce got cancelled by an unmute event",this.logContext)),this.debouncedTrackMuteHandler=jm(()=>gS(this,void 0,void 0,function*(){yield this.pauseUpstream()}),5e3),this.handleTrackUnmuteEvent=()=>gS(this,void 0,void 0,function*(){this.debouncedTrackMuteHandler.cancel("unmute"),yield this.resumeUpstream()}),this.handleEnded=()=>{this.isInBackground&&(this.reacquireTrack=!0),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),this.emit(lj.Ended,this)},this.reacquireTrack=!1,this.providedByUser=d,this.muteLock=new du,this.pauseUpstreamLock=new du,this.trackChangeLock=new du,this.trackChangeLock.lock().then(b=>gS(this,void 0,void 0,function*(){try{yield this.setMediaStreamTrack(a,!0)}finally{b()}})),this._constraints=a.getConstraints(),c&&(this._constraints=c)}get id(){return this._mediaStreamTrack.id}get dimensions(){if(this.kind!==ik.Kind.Video)return;let{width:a,height:b}=this._mediaStreamTrack.getSettings();if(a&&b)return{width:a,height:b}}get isUpstreamPaused(){return this._isUpstreamPaused}get isUserProvided(){return this.providedByUser}get mediaStreamTrack(){var a,b;return null!=(b=null==(a=this.processor)?void 0:a.processedTrack)?b:this._mediaStreamTrack}get isLocal(){return!0}getSourceTrackSettings(){return this._mediaStreamTrack.getSettings()}setMediaStreamTrack(a,b){return gS(this,void 0,void 0,function*(){var c;let d;if(a!==this._mediaStreamTrack||b){if(this._mediaStreamTrack&&(this.attachedElements.forEach(a=>{im(this._mediaStreamTrack,a)}),this.debouncedTrackMuteHandler.cancel("new-track"),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent)),this.mediaStream=new MediaStream([a]),a&&(a.addEventListener("ended",this.handleEnded),a.addEventListener("mute",this.handleTrackMuteEvent),a.addEventListener("unmute",this.handleTrackUnmuteEvent),this._constraints=a.getConstraints()),this.processor&&a){if(this.log.debug("restarting processor",this.logContext),"unknown"===this.kind)throw TypeError("cannot set processor on track of unknown kind");this.processorElement&&(il(a,this.processorElement),this.processorElement.muted=!0),yield this.processor.restart({track:a,kind:this.kind,element:this.processorElement}),d=this.processor.processedTrack}this.sender&&(null==(c=this.sender.transport)?void 0:c.state)!=="closed"&&(yield this.sender.replaceTrack(null!=d?d:a)),this.providedByUser||this._mediaStreamTrack===a||this._mediaStreamTrack.stop(),this._mediaStreamTrack=a,a&&(this._mediaStreamTrack.enabled=!this.isMuted,yield this.resumeUpstream(),this.attachedElements.forEach(b=>{il(null!=d?d:a,b)}))}})}waitForDimensions(){return gS(this,arguments,void 0,function(){var a=this;let b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3;return function*(){var c;if(a.kind===ik.Kind.Audio)throw Error("cannot get dimensions for audio tracks");(null==(c=hN())?void 0:c.os)==="iOS"&&(yield ip(10));let d=Date.now();for(;Date.now()-d<b;){let b=a.dimensions;if(b)return b;yield ip(50)}throw new hU("unable to get track dimensions after timeout")}()})}setDeviceId(a){return gS(this,void 0,void 0,function*(){return this._constraints.deviceId===a&&this._mediaStreamTrack.getSettings().deviceId===iQ(a)||(this._constraints.deviceId=a,!!this.isMuted||(yield this.restartTrack(),iQ(a)===this._mediaStreamTrack.getSettings().deviceId))})}getDeviceId(){return gS(this,arguments,void 0,function(){var a=this;let b=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return function*(){if(a.source===ik.Source.ScreenShare)return;let{deviceId:c,groupId:d}=a._mediaStreamTrack.getSettings(),e=a.kind===ik.Kind.Audio?"audioinput":"videoinput";return b?i8.getInstance().normalizeDeviceId(e,c,d):c}()})}mute(){return gS(this,void 0,void 0,function*(){return this.setTrackMuted(!0),this})}unmute(){return gS(this,void 0,void 0,function*(){return this.setTrackMuted(!1),this})}replaceTrack(a,b){return gS(this,void 0,void 0,function*(){let c=yield this.trackChangeLock.lock();try{let c,d;if(!this.sender)throw new hU("unable to replace an unpublished track");return"boolean"==typeof b?c=b:void 0!==b&&(c=b.userProvidedTrack,d=b.stopProcessor),this.providedByUser=null==c||c,this.log.debug("replace MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(a),d&&this.processor&&(yield this.internalStopProcessor()),this}finally{c()}})}restart(a){return gS(this,void 0,void 0,function*(){this.manuallyStopped=!1;let b=yield this.trackChangeLock.lock();try{a||(a=this._constraints);let{deviceId:b,facingMode:c}=a,d=function(a,b){var c={};for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&0>b.indexOf(d)&&(c[d]=a[d]);if(null!=a&&"function"==typeof Object.getOwnPropertySymbols)for(var e=0,d=Object.getOwnPropertySymbols(a);e<d.length;e++)0>b.indexOf(d[e])&&Object.prototype.propertyIsEnumerable.call(a,d[e])&&(c[d[e]]=a[d[e]]);return c}(a,["deviceId","facingMode"]);this.log.debug("restarting track with constraints",Object.assign(Object.assign({},this.logContext),{constraints:a}));let e={audio:!1,video:!1};this.kind===ik.Kind.Video?e.video=!b&&!c||{deviceId:b,facingMode:c}:e.audio=!b||Object.assign({deviceId:b},d),this.attachedElements.forEach(a=>{im(this.mediaStreamTrack,a)}),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.stop();let f=(yield navigator.mediaDevices.getUserMedia(e)).getTracks()[0];return this.kind===ik.Kind.Video&&(yield f.applyConstraints(d)),f.addEventListener("ended",this.handleEnded),this.log.debug("re-acquired MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(f),this._constraints=a,this.emit(lj.Restarted,this),this.manuallyStopped&&(this.log.warn("track was stopped during a restart, stopping restarted track",this.logContext),this.stop()),this}finally{b()}})}setTrackMuted(a){this.log.debug("setting ".concat(this.kind," track ").concat(a?"muted":"unmuted"),this.logContext),(this.isMuted!==a||this._mediaStreamTrack.enabled===a)&&(this.isMuted=a,this._mediaStreamTrack.enabled=!a,this.emit(a?lj.Muted:lj.Unmuted,this))}get needsReAcquisition(){return"live"!==this._mediaStreamTrack.readyState||this._mediaStreamTrack.muted||!this._mediaStreamTrack.enabled||this.reacquireTrack}handleAppVisibilityChanged(){let a=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return gS(this,void 0,void 0,function*(){yield a.handleAppVisibilityChanged.call(this),iy()&&(this.log.debug("visibility changed, is in Background: ".concat(this.isInBackground),this.logContext),this.isInBackground||!this.needsReAcquisition||this.isUserProvided||this.isMuted||(this.log.debug("track needs to be reacquired, restarting ".concat(this.source),this.logContext),yield this.restart(),this.reacquireTrack=!1))})}stop(){var a;this.manuallyStopped=!0,super.stop(),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),null==(a=this.processor)||a.destroy(),this.processor=void 0}pauseUpstream(){return gS(this,void 0,void 0,function*(){var a;let b=yield this.pauseUpstreamLock.lock();try{if(!0===this._isUpstreamPaused)return;if(!this.sender)return void this.log.warn("unable to pause upstream for an unpublished track",this.logContext);this._isUpstreamPaused=!0,this.emit(lj.UpstreamPaused,this);let b=hN();if((null==b?void 0:b.name)==="Safari"&&0>iG(b.version,"12.0"))throw new hT("pauseUpstream is not supported on Safari < 12.");(null==(a=this.sender.transport)?void 0:a.state)!=="closed"&&(yield this.sender.replaceTrack(null))}finally{b()}})}resumeUpstream(){return gS(this,void 0,void 0,function*(){var a;let b=yield this.pauseUpstreamLock.lock();try{if(!1===this._isUpstreamPaused)return;if(!this.sender)return void this.log.warn("unable to resume upstream for an unpublished track",this.logContext);this._isUpstreamPaused=!1,this.emit(lj.UpstreamResumed,this),(null==(a=this.sender.transport)?void 0:a.state)!=="closed"&&(yield this.sender.replaceTrack(this.mediaStreamTrack))}finally{b()}})}getRTCStatsReport(){return gS(this,void 0,void 0,function*(){var a;if(null==(a=this.sender)?void 0:a.getStats)return yield this.sender.getStats()})}setProcessor(a){return gS(this,arguments,void 0,function(a){var b=this;let c=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return function*(){var d;let e=yield b.trackChangeLock.lock();try{b.log.debug("setting up processor",b.logContext);let e=document.createElement(b.kind),f={kind:b.kind,track:b._mediaStreamTrack,element:e,audioContext:b.audioContext};if(yield a.init(f),b.log.debug("processor initialized",b.logContext),b.processor&&(yield b.internalStopProcessor()),"unknown"===b.kind)throw TypeError("cannot set processor on track of unknown kind");if(il(b._mediaStreamTrack,e),e.muted=!0,e.play().catch(a=>{a instanceof DOMException&&"AbortError"===a.name?(b.log.warn("failed to play processor element, retrying",Object.assign(Object.assign({},b.logContext),{error:a})),setTimeout(()=>{e.play().catch(a=>{b.log.error("failed to play processor element",Object.assign(Object.assign({},b.logContext),{err:a}))})},100)):b.log.error("failed to play processor element",Object.assign(Object.assign({},b.logContext),{error:a}))}),b.processor=a,b.processorElement=e,b.processor.processedTrack){for(let a of b.attachedElements)a!==b.processorElement&&c&&(im(b._mediaStreamTrack,a),il(b.processor.processedTrack,a));yield null==(d=b.sender)?void 0:d.replaceTrack(b.processor.processedTrack)}b.emit(lj.TrackProcessorUpdate,b.processor)}finally{e()}}()})}getProcessor(){return this.processor}stopProcessor(){return gS(this,arguments,void 0,function(){var a=this;let b=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return function*(){let c=yield a.trackChangeLock.lock();try{yield a.internalStopProcessor(b)}finally{c()}}()})}internalStopProcessor(){return gS(this,arguments,void 0,function(){var a=this;let b=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return function*(){var c,d;a.processor&&(a.log.debug("stopping processor",a.logContext),null==(c=a.processor.processedTrack)||c.stop(),yield a.processor.destroy(),a.processor=void 0,b||(null==(d=a.processorElement)||d.remove(),a.processorElement=void 0),yield a._mediaStreamTrack.applyConstraints(a._constraints),yield a.setMediaStreamTrack(a._mediaStreamTrack,!0),a.emit(lj.TrackProcessorUpdate))}()})}startPreConnectBuffer(){let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;if(!jF)return void this.log.warn("MediaRecorder is not available, cannot start preconnect buffer",this.logContext);if(this.localTrackRecorder)return void this.log.warn("preconnect buffer already started");{let a="audio/webm;codecs=opus";MediaRecorder.isTypeSupported(a)||(a="video/mp4"),this.localTrackRecorder=new jH(this,{mimeType:a})}this.localTrackRecorder.start(a),this.autoStopPreConnectBuffer=setTimeout(()=>{this.log.warn("preconnect buffer timed out, stopping recording automatically",this.logContext),this.stopPreConnectBuffer()},1e4)}stopPreConnectBuffer(){clearTimeout(this.autoStopPreConnectBuffer),this.localTrackRecorder&&(this.localTrackRecorder.stop(),this.localTrackRecorder=void 0)}getPreConnectBuffer(){var a;return null==(a=this.localTrackRecorder)?void 0:a.byteStream}getPreConnectBufferMimeType(){var a;return null==(a=this.localTrackRecorder)?void 0:a.mimeType}}class jJ extends jI{get enhancedNoiseCancellation(){return this.isKrispNoiseFilterEnabled}constructor(a,b){let c=!(arguments.length>2)||void 0===arguments[2]||arguments[2],d=arguments.length>3?arguments[3]:void 0,e=arguments.length>4?arguments[4]:void 0;super(a,ik.Kind.Audio,b,c,e),this.stopOnMute=!1,this.isKrispNoiseFilterEnabled=!1,this.monitorSender=()=>gS(this,void 0,void 0,function*(){let a;if(!this.sender){this._currentBitrate=0;return}try{a=yield this.getSenderStats()}catch(a){this.log.error("could not get audio sender stats",Object.assign(Object.assign({},this.logContext),{error:a}));return}a&&this.prevStats&&(this._currentBitrate=jE(a,this.prevStats)),this.prevStats=a}),this.handleKrispNoiseFilterEnable=()=>{this.isKrispNoiseFilterEnabled=!0,this.log.debug("Krisp noise filter enabled",this.logContext),this.emit(lj.AudioTrackFeatureUpdate,this,eQ.TF_ENHANCED_NOISE_CANCELLATION,!0)},this.handleKrispNoiseFilterDisable=()=>{this.isKrispNoiseFilterEnabled=!1,this.log.debug("Krisp noise filter disabled",this.logContext),this.emit(lj.AudioTrackFeatureUpdate,this,eQ.TF_ENHANCED_NOISE_CANCELLATION,!1)},this.audioContext=d,this.checkForSilence()}mute(){let a=Object.create(null,{mute:{get:()=>super.mute}});return gS(this,void 0,void 0,function*(){let b=yield this.muteLock.lock();try{if(this.isMuted)return this.log.debug("Track already muted",this.logContext),this;return this.source===ik.Source.Microphone&&this.stopOnMute&&!this.isUserProvided&&(this.log.debug("stopping mic track",this.logContext),this._mediaStreamTrack.stop()),yield a.mute.call(this),this}finally{b()}})}unmute(){let a=Object.create(null,{unmute:{get:()=>super.unmute}});return gS(this,void 0,void 0,function*(){let b=yield this.muteLock.lock();try{if(!this.isMuted)return this.log.debug("Track already unmuted",this.logContext),this;let b=this._constraints.deviceId&&this._mediaStreamTrack.getSettings().deviceId!==iQ(this._constraints.deviceId);return this.source===ik.Source.Microphone&&(this.stopOnMute||"ended"===this._mediaStreamTrack.readyState||b)&&!this.isUserProvided&&(this.log.debug("reacquiring mic track",this.logContext),yield this.restartTrack()),yield a.unmute.call(this),this}finally{b()}})}restartTrack(a){return gS(this,void 0,void 0,function*(){let b;if(a){let c=ia({audio:a});"boolean"!=typeof c.audio&&(b=c.audio)}yield this.restart(b)})}restart(a){let b=Object.create(null,{restart:{get:()=>super.restart}});return gS(this,void 0,void 0,function*(){let c=yield b.restart.call(this,a);return this.checkForSilence(),c})}startMonitor(){!iz()||this.monitorInterval||(this.monitorInterval=setInterval(()=>{this.monitorSender()},2e3))}setProcessor(a){return gS(this,void 0,void 0,function*(){var b;let c=yield this.trackChangeLock.lock();try{if(!iA()&&!this.audioContext)throw Error("Audio context needs to be set on LocalAudioTrack in order to enable processors");this.processor&&(yield this.internalStopProcessor());let c={kind:this.kind,track:this._mediaStreamTrack,audioContext:this.audioContext};this.log.debug("setting up audio processor ".concat(a.name),this.logContext),yield a.init(c),this.processor=a,this.processor.processedTrack&&(yield null==(b=this.sender)?void 0:b.replaceTrack(this.processor.processedTrack),this.processor.processedTrack.addEventListener("enable-lk-krisp-noise-filter",this.handleKrispNoiseFilterEnable),this.processor.processedTrack.addEventListener("disable-lk-krisp-noise-filter",this.handleKrispNoiseFilterDisable)),this.emit(lj.TrackProcessorUpdate,this.processor)}finally{c()}})}setAudioContext(a){this.audioContext=a}getSenderStats(){return gS(this,void 0,void 0,function*(){var a;let b;if(null==(a=this.sender)?void 0:a.getStats)return(yield this.sender.getStats()).forEach(a=>{"outbound-rtp"===a.type&&(b={type:"audio",streamId:a.id,packetsSent:a.packetsSent,packetsLost:a.packetsLost,bytesSent:a.bytesSent,timestamp:a.timestamp,roundTripTime:a.roundTripTime,jitter:a.jitter})}),b})}checkForSilence(){return gS(this,void 0,void 0,function*(){let a=yield ib(this);return a&&(this.isMuted||this.log.debug("silence detected on local audio track",this.logContext),this.emit(lj.AudioSilenceDetected)),a})}}let jK=Object.values(h5),jL=Object.values(h6),jM=Object.values(h7),jN=[h5.h180,h5.h360],jO=[h6.h180,h6.h360],jP=["q","h","f"];function jQ(a,b,c,d){var e,f,g;let h,i=null==d?void 0:d.videoEncoding;a&&(i=null==d?void 0:d.screenShareEncoding);let j=null==d?void 0:d.simulcast,k=null==d?void 0:d.scalabilityMode,l=null==d?void 0:d.videoCodec;if(!i&&!j&&!k||!b||!c)return[{}];i||(i=function(a,b,c,d){let e=function(a,b,c){if(a)return jM;let d=b>c?b/c:c/b;return Math.abs(d-16/9)<Math.abs(d-4/3)?jK:jL}(a,b,c),{encoding:f}=e[0],g=Math.max(b,c);for(let a=0;a<e.length;a+=1){let b=e[a];if(f=b.encoding,b.width>=g)break}if(d)switch(d){case"av1":case"h265":(f=Object.assign({},f)).maxBitrate=.7*f.maxBitrate;break;case"vp9":(f=Object.assign({},f)).maxBitrate=.85*f.maxBitrate}return f}(a,b,c,l),gO.debug("using video encoding",i));let m=i.maxFramerate,n=new h1(b,c,i.maxBitrate,i.maxFramerate,i.priority);if(k&&is(l)){let a=new jU(k),b=[];if(a.spatial>3)throw Error("unsupported scalabilityMode: ".concat(k));let c=hN();if(ix()||iA()||(null==c?void 0:c.name)==="Chrome"&&0>iG(null==c?void 0:c.version,"113")){let d="h"==a.suffix?2:3,e=((g=c)||(g=hN()),(null==g?void 0:g.name)==="Safari"&&iG(g.version,"18.3")>0||(null==g?void 0:g.os)==="iOS"&&!!(null==g?void 0:g.osVersion)&&iG(g.osVersion,"18.3")>0);for(let c=0;c<a.spatial;c+=1)b.push({rid:jP[2-c],maxBitrate:i.maxBitrate/Math.pow(d,c),maxFramerate:n.encoding.maxFramerate,scaleResolutionDownBy:e?Math.pow(2,c):void 0});b[0].scalabilityMode=k}else b.push({maxBitrate:i.maxBitrate,maxFramerate:n.encoding.maxFramerate,scalabilityMode:k});return n.encoding.priority&&(b[0].priority=n.encoding.priority,b[0].networkPriority=n.encoding.priority),gO.debug("using svc encoding",{encodings:b}),b}if(!j)return[i];let o=[];if((o=a?null!=(e=jT(null==d?void 0:d.screenShareSimulcastLayers))?e:jR(a,n):null!=(f=jT(null==d?void 0:d.videoSimulcastLayers))?f:jR(a,n)).length>0){let a=o[0];o.length>1&&([,h]=o);let d=Math.max(b,c);if(d>=960&&h)return jS(b,c,[a,h,n],m);if(d>=480)return jS(b,c,[a,n],m)}return jS(b,c,[n])}function jR(a,b){if(a)return[{scaleResolutionDownBy:2,fps:b.encoding.maxFramerate}].map(a=>{var c,d;return new h1(Math.floor(b.width/a.scaleResolutionDownBy),Math.floor(b.height/a.scaleResolutionDownBy),Math.max(15e4,Math.floor(b.encoding.maxBitrate/(Math.pow(a.scaleResolutionDownBy,2)*((null!=(c=b.encoding.maxFramerate)?c:30)/(null!=(d=a.fps)?d:30))))),a.fps,b.encoding.priority)});let{width:c,height:d}=b,e=c>d?c/d:d/c;return Math.abs(e-16/9)<Math.abs(e-4/3)?jN:jO}function jS(a,b,c,d){let e=[];if(c.forEach((c,f)=>{if(f>=jP.length)return;let g=Math.min(a,b),h={rid:jP[f],scaleResolutionDownBy:Math.max(1,g/Math.min(c.width,c.height)),maxBitrate:c.encoding.maxBitrate},i=d&&c.encoding.maxFramerate?Math.min(d,c.encoding.maxFramerate):c.encoding.maxFramerate;i&&(h.maxFramerate=i);let j=iu()||0===f;c.encoding.priority&&j&&(h.priority=c.encoding.priority,h.networkPriority=c.encoding.priority),e.push(h)}),iA()&&"ios"===iE()){let a;e.forEach(b=>{a?b.maxFramerate&&b.maxFramerate>a&&(a=b.maxFramerate):a=b.maxFramerate});let b=!0;e.forEach(c=>{var d;c.maxFramerate!=a&&(b&&(b=!1,gO.info("Simulcast on iOS React-Native requires all encodings to share the same framerate.")),gO.info('Setting framerate of encoding "'.concat(null!=(d=c.rid)?d:"",'" to ').concat(a)),c.maxFramerate=a)})}return e}function jT(a){if(a)return a.sort((a,b)=>{let{encoding:c}=a,{encoding:d}=b;return c.maxBitrate>d.maxBitrate?1:c.maxBitrate<d.maxBitrate?-1:c.maxBitrate===d.maxBitrate&&c.maxFramerate&&d.maxFramerate?c.maxFramerate>d.maxFramerate?1:-1:0})}class jU{constructor(a){const b=a.match(/^L(\d)T(\d)(h|_KEY|_KEY_SHIFT){0,1}$/);if(!b)throw Error("invalid scalability mode");if(this.spatial=parseInt(b[1]),this.temporal=parseInt(b[2]),b.length>3)switch(b[3]){case"h":case"_KEY":case"_KEY_SHIFT":this.suffix=b[3]}}toString(){var a;return"L".concat(this.spatial,"T").concat(this.temporal).concat(null!=(a=this.suffix)?a:"")}}class jV extends jI{get sender(){return this._sender}set sender(a){this._sender=a,this.degradationPreference&&this.setDegradationPreference(this.degradationPreference)}constructor(a,b){let c=!(arguments.length>2)||void 0===arguments[2]||arguments[2],d=arguments.length>3?arguments[3]:void 0;super(a,ik.Kind.Video,b,c,d),this.simulcastCodecs=new Map,this.degradationPreference="balanced",this.isCpuConstrained=!1,this.optimizeForPerformance=!1,this.monitorSender=()=>gS(this,void 0,void 0,function*(){let a;if(!this.sender){this._currentBitrate=0;return}try{a=yield this.getSenderStats()}catch(a){this.log.error("could not get video sender stats",Object.assign(Object.assign({},this.logContext),{error:a}));return}let b=new Map(a.map(a=>[a.rid,a])),c=a.some(a=>"cpu"===a.qualityLimitationReason);if(c!==this.isCpuConstrained&&(this.isCpuConstrained=c,this.isCpuConstrained&&this.emit(lj.CpuConstrained)),this.prevStats){let a=0;b.forEach((b,c)=>{var d;let e=null==(d=this.prevStats)?void 0:d.get(c);a+=jE(b,e)}),this._currentBitrate=a}this.prevStats=b}),this.senderLock=new du}get isSimulcast(){return!!this.sender&&!!(this.sender.getParameters().encodings.length>1)}startMonitor(a){var b;if(this.signalClient=a,!iz())return;let c=null==(b=this.sender)?void 0:b.getParameters();c&&(this.encodings=c.encodings),this.monitorInterval||(this.monitorInterval=setInterval(()=>{this.monitorSender()},2e3))}stop(){this._mediaStreamTrack.getConstraints(),this.simulcastCodecs.forEach(a=>{a.mediaStreamTrack.stop()}),super.stop()}pauseUpstream(){let a=Object.create(null,{pauseUpstream:{get:()=>super.pauseUpstream}});return gS(this,void 0,void 0,function*(){yield a.pauseUpstream.call(this);try{for(var b,c,d,e,f,g,h=!0,i=gT(this.simulcastCodecs.values());!(b=(g=yield i.next()).done);h=!0)e=g.value,h=!1,yield null==(f=e.sender)?void 0:f.replaceTrack(null)}catch(a){c={error:a}}finally{try{!h&&!b&&(d=i.return)&&(yield d.call(i))}finally{if(c)throw c.error}}})}resumeUpstream(){let a=Object.create(null,{resumeUpstream:{get:()=>super.resumeUpstream}});return gS(this,void 0,void 0,function*(){yield a.resumeUpstream.call(this);try{for(var b,c,d,e,f,g,h=!0,i=gT(this.simulcastCodecs.values());!(b=(g=yield i.next()).done);h=!0)e=g.value,h=!1,yield null==(f=e.sender)?void 0:f.replaceTrack(e.mediaStreamTrack)}catch(a){c={error:a}}finally{try{!h&&!b&&(d=i.return)&&(yield d.call(i))}finally{if(c)throw c.error}}})}mute(){let a=Object.create(null,{mute:{get:()=>super.mute}});return gS(this,void 0,void 0,function*(){let b=yield this.muteLock.lock();try{if(this.isMuted)return this.log.debug("Track already muted",this.logContext),this;return this.source!==ik.Source.Camera||this.isUserProvided||(this.log.debug("stopping camera track",this.logContext),this._mediaStreamTrack.stop()),yield a.mute.call(this),this}finally{b()}})}unmute(){let a=Object.create(null,{unmute:{get:()=>super.unmute}});return gS(this,void 0,void 0,function*(){let b=yield this.muteLock.lock();try{if(!this.isMuted)return this.log.debug("Track already unmuted",this.logContext),this;return this.source!==ik.Source.Camera||this.isUserProvided||(this.log.debug("reacquiring camera track",this.logContext),yield this.restartTrack()),yield a.unmute.call(this),this}finally{b()}})}setTrackMuted(a){for(let b of(super.setTrackMuted(a),this.simulcastCodecs.values()))b.mediaStreamTrack.enabled=!a}getSenderStats(){return gS(this,void 0,void 0,function*(){var a;if(!(null==(a=this.sender)?void 0:a.getStats))return[];let b=[],c=yield this.sender.getStats();return c.forEach(a=>{var d;if("outbound-rtp"===a.type){let e={type:"video",streamId:a.id,frameHeight:a.frameHeight,frameWidth:a.frameWidth,framesPerSecond:a.framesPerSecond,framesSent:a.framesSent,firCount:a.firCount,pliCount:a.pliCount,nackCount:a.nackCount,packetsSent:a.packetsSent,bytesSent:a.bytesSent,qualityLimitationReason:a.qualityLimitationReason,qualityLimitationDurations:a.qualityLimitationDurations,qualityLimitationResolutionChanges:a.qualityLimitationResolutionChanges,rid:null!=(d=a.rid)?d:a.id,retransmittedPacketsSent:a.retransmittedPacketsSent,targetBitrate:a.targetBitrate,timestamp:a.timestamp},f=c.get(a.remoteId);f&&(e.jitter=f.jitter,e.packetsLost=f.packetsLost,e.roundTripTime=f.roundTripTime),b.push(e)}}),b.sort((a,b)=>{var c,d;return(null!=(c=b.frameWidth)?c:0)-(null!=(d=a.frameWidth)?d:0)}),b})}setPublishingQuality(a){let b=[];for(let c=lm.LOW;c<=lm.HIGH;c+=1)b.push(new gm({quality:c,enabled:c<=a}));this.log.debug("setting publishing quality. max quality ".concat(a),this.logContext),this.setPublishingLayers(is(this.codec),b)}restartTrack(a){return gS(this,void 0,void 0,function*(){let b;if(a){let c=ia({video:a});"boolean"!=typeof c.video&&(b=c.video)}yield this.restart(b),this.isCpuConstrained=!1;try{for(var c,d,e,f,g,h,i=!0,j=gT(this.simulcastCodecs.values());!(c=(h=yield j.next()).done);i=!0)f=h.value,i=!1,f.sender&&(null==(g=f.sender.transport)?void 0:g.state)!=="closed"&&(f.mediaStreamTrack=this.mediaStreamTrack.clone(),yield f.sender.replaceTrack(f.mediaStreamTrack))}catch(a){d={error:a}}finally{try{!i&&!c&&(e=j.return)&&(yield e.call(j))}finally{if(d)throw d.error}}})}setProcessor(a){let b=Object.create(null,{setProcessor:{get:()=>super.setProcessor}});return gS(this,arguments,void 0,function(a){var c=this;let d=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return function*(){if(yield b.setProcessor.call(c,a,d),null==(i=c.processor)?void 0:i.processedTrack)try{for(var e,f,g,h,i,j,k,l=!0,m=gT(c.simulcastCodecs.values());!(e=(k=yield m.next()).done);l=!0)h=k.value,l=!1,yield null==(j=h.sender)?void 0:j.replaceTrack(c.processor.processedTrack)}catch(a){f={error:a}}finally{try{!l&&!e&&(g=m.return)&&(yield g.call(m))}finally{if(f)throw f.error}}}()})}setDegradationPreference(a){return gS(this,void 0,void 0,function*(){if(this.degradationPreference=a,this.sender)try{this.log.debug("setting degradationPreference to ".concat(a),this.logContext);let b=this.sender.getParameters();b.degradationPreference=a,this.sender.setParameters(b)}catch(a){this.log.warn("failed to set degradationPreference",Object.assign({error:a},this.logContext))}})}addSimulcastTrack(a,b){if(this.simulcastCodecs.has(a))return void this.log.error("".concat(a," already added, skipping adding simulcast codec"),this.logContext);let c={codec:a,mediaStreamTrack:this.mediaStreamTrack.clone(),sender:void 0,encodings:b};return this.simulcastCodecs.set(a,c),c}setSimulcastTrackSender(a,b){let c=this.simulcastCodecs.get(a);c&&(c.sender=b,setTimeout(()=>{this.subscribedCodecs&&this.setPublishingCodecs(this.subscribedCodecs)},5e3))}setPublishingCodecs(a){return gS(this,void 0,void 0,function*(){var b,c,d,e,f,g,h;if(this.log.debug("setting publishing codecs",Object.assign(Object.assign({},this.logContext),{codecs:a,currentCodec:this.codec})),!this.codec&&a.length>0)return yield this.setPublishingLayers(is(a[0].codec),a[0].qualities),[];this.subscribedCodecs=a;let i=[];try{for(b=!0,c=gT(a);!(e=(d=yield c.next()).done);b=!0)if(h=d.value,b=!1,this.codec&&this.codec!==h.codec){let a=this.simulcastCodecs.get(h.codec);if(this.log.debug("try setPublishingCodec for ".concat(h.codec),Object.assign(Object.assign({},this.logContext),{simulcastCodecInfo:a})),a&&a.sender)a.encodings&&(this.log.debug("try setPublishingLayersForSender ".concat(h.codec),this.logContext),yield jW(a.sender,a.encodings,h.qualities,this.senderLock,is(h.codec),this.log,this.logContext));else for(let a of h.qualities)if(a.enabled){i.push(h.codec);break}}else yield this.setPublishingLayers(is(h.codec),h.qualities)}catch(a){f={error:a}}finally{try{!b&&!e&&(g=c.return)&&(yield g.call(c))}finally{if(f)throw f.error}}return i})}setPublishingLayers(a,b){return gS(this,void 0,void 0,function*(){this.optimizeForPerformance?this.log.info("skipping setPublishingLayers due to optimized publishing performance",Object.assign(Object.assign({},this.logContext),{qualities:b})):(this.log.debug("setting publishing layers",Object.assign(Object.assign({},this.logContext),{qualities:b})),this.sender&&this.encodings&&(yield jW(this.sender,this.encodings,b,this.senderLock,a,this.log,this.logContext)))})}prioritizePerformance(){return gS(this,void 0,void 0,function*(){if(!this.sender)throw Error("sender not found");let a=yield this.senderLock.lock();try{this.optimizeForPerformance=!0;let a=this.sender.getParameters();a.encodings=a.encodings.map((a,b)=>{var c;return Object.assign(Object.assign({},a),{active:0===b,scaleResolutionDownBy:Math.max(1,Math.ceil((null!=(c=this.mediaStreamTrack.getSettings().height)?c:360)/360)),scalabilityMode:0===b&&is(this.codec)?"L1T3":void 0,maxFramerate:15*(0===b),maxBitrate:0===b?a.maxBitrate:0})}),this.log.debug("setting performance optimised encodings",Object.assign(Object.assign({},this.logContext),{encodings:a.encodings})),this.encodings=a.encodings,yield this.sender.setParameters(a)}catch(a){this.log.error("failed to set performance optimised encodings",Object.assign(Object.assign({},this.logContext),{error:a})),this.optimizeForPerformance=!1}finally{a()}})}handleAppVisibilityChanged(){let a=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return gS(this,void 0,void 0,function*(){yield a.handleAppVisibilityChanged.call(this),iy()&&this.isInBackground&&this.source===ik.Source.Camera&&(this._mediaStreamTrack.enabled=!1)})}}function jW(a,b,c,d,e,f,g){return gS(this,void 0,void 0,function*(){let h=yield d.lock();f.debug("setPublishingLayersForSender",Object.assign(Object.assign({},g),{sender:a,qualities:c,senderEncodings:b}));try{let d=a.getParameters(),{encodings:h}=d;if(!h)return;if(h.length!==b.length)return void f.warn("cannot set publishing layers, encodings mismatch",Object.assign(Object.assign({},g),{encodings:h,senderEncodings:b}));let i=!1;e&&c.some(a=>a.enabled)&&c.forEach(a=>a.enabled=!0),h.forEach((a,d)=>{var e;let h=null!=(e=a.rid)?e:"";""===h&&(h="q");let j=jX(h),k=c.find(a=>a.quality===j);k&&a.active!==k.enabled&&(i=!0,a.active=k.enabled,f.debug("setting layer ".concat(k.quality," to ").concat(a.active?"enabled":"disabled"),g),iu()&&(k.enabled?(a.scaleResolutionDownBy=b[d].scaleResolutionDownBy,a.maxBitrate=b[d].maxBitrate,a.maxFrameRate=b[d].maxFrameRate):(a.scaleResolutionDownBy=4,a.maxBitrate=10,a.maxFrameRate=2)))}),i&&(d.encodings=h,f.debug("setting encodings",Object.assign(Object.assign({},g),{encodings:d.encodings})),yield a.setParameters(d))}finally{h()}})}function jX(a){switch(a){case"f":default:return lm.HIGH;case"h":return lm.MEDIUM;case"q":return lm.LOW}}function jY(a,b,c,d){if(!c)return[new e_({quality:lm.HIGH,width:a,height:b,bitrate:0,ssrc:0})];if(d){let d=new jU(c[0].scalabilityMode),e=[],f="h"==d.suffix?1.5:2,g="h"==d.suffix?2:3;for(let h=0;h<d.spatial;h+=1)e.push(new e_({quality:Math.min(lm.HIGH,d.spatial-1)-h,width:Math.ceil(a/Math.pow(f,h)),height:Math.ceil(b/Math.pow(f,h)),bitrate:c[0].maxBitrate?Math.ceil(c[0].maxBitrate/Math.pow(g,h)):0,ssrc:0}));return e}return c.map(c=>{var d,e,f;let g=null!=(d=c.scaleResolutionDownBy)?d:1;return new e_({quality:jX(null!=(e=c.rid)?e:""),width:Math.ceil(a/g),height:Math.ceil(b/g),bitrate:null!=(f=c.maxBitrate)?f:0,ssrc:0})})}let jZ="_lossy",j$="_reliable",j_="leave-reconnect";(k$=lA||(lA={}))[k$.New=0]="New",k$[k$.Connected=1]="Connected",k$[k$.Disconnected=2]="Disconnected",k$[k$.Reconnecting=3]="Reconnecting",k$[k$.Closed=4]="Closed";class j0 extends gV.EventEmitter{get isClosed(){return this._isClosed}get pendingReconnect(){return!!this.reconnectTimeout}constructor(a){var b;super(),this.options=a,this.rtcConfig={},this.peerConnectionTimeout=jy.peerConnectionTimeout,this.fullReconnectOnNext=!1,this.latestRemoteOfferId=0,this.subscriberPrimary=!1,this.pcState=lA.New,this._isClosed=!0,this.pendingTrackResolvers={},this.reconnectAttempts=0,this.reconnectStart=0,this.attemptingReconnect=!1,this.joinAttempts=0,this.maxJoinAttempts=1,this.shouldFailNext=!1,this.log=gO,this.reliableDataSequence=1,this.reliableMessageBuffer=new jf,this.reliableReceivedState=new jg(3e4),this.lossyDataStatCurrentBytes=0,this.lossyDataStatByterate=0,this.lossyDataDropCount=0,this.midToTrackId={},this.isWaitingForNetworkReconnect=!1,this.handleDataChannel=a=>gS(this,[a],void 0,function(a){var b=this;let{channel:c}=a;return function*(){if(c){if(c.label===j$)b.reliableDCSub=c;else{if(c.label!==jZ)return;b.lossyDCSub=c}b.log.debug("on data channel ".concat(c.id,", ").concat(c.label),b.logContext),c.onmessage=b.handleDataMessage}}()}),this.handleDataMessage=a=>gS(this,void 0,void 0,function*(){var b,c,d,e,f;let g=yield this.dataProcessLock.lock();try{let g;if(a.data instanceof ArrayBuffer)g=a.data;else{if(!(a.data instanceof Blob))return void this.log.error("unsupported data type",Object.assign(Object.assign({},this.logContext),{data:a.data}));g=yield a.data.arrayBuffer()}let h=e1.fromBinary(new Uint8Array(g));if(h.sequence>0&&""!==h.participantSid){let a=this.reliableReceivedState.get(h.participantSid);if(a&&h.sequence<=a)return;this.reliableReceivedState.set(h.participantSid,h.sequence)}if((null==(b=h.value)?void 0:b.case)==="speaker")this.emit(li.ActiveSpeakersUpdate,h.value.value.speakers);else if((null==(c=h.value)?void 0:c.case)==="encryptedPacket"){if(!this.e2eeManager)return void this.log.error("Received encrypted packet but E2EE not set up",this.logContext);let a=yield null==(d=this.e2eeManager)?void 0:d.handleEncryptedData(h.value.value.encryptedValue,h.value.value.iv,h.participantIdentity,h.value.value.keyIndex),b=e4.fromBinary(a.payload),c=new e1({value:b.value,participantIdentity:h.participantIdentity,participantSid:h.participantSid});(null==(e=c.value)?void 0:e.case)==="user"&&j1(c,c.value.value),this.emit(li.DataPacketReceived,c,h.value.value.encryptionType)}else(null==(f=h.value)?void 0:f.case)==="user"&&j1(h,h.value.value),this.emit(li.DataPacketReceived,h,eY.NONE)}finally{g()}}),this.handleDataError=a=>{let b=0===a.currentTarget.maxRetransmits?"lossy":"reliable";if(a instanceof ErrorEvent&&a.error){let{error:c}=a.error;this.log.error("DataChannel error on ".concat(b,": ").concat(a.message),Object.assign(Object.assign({},this.logContext),{error:c}))}else this.log.error("Unknown DataChannel error on ".concat(b),Object.assign(Object.assign({},this.logContext),{event:a}))},this.handleBufferedAmountLow=a=>{let b=0===a.currentTarget.maxRetransmits?e2.LOSSY:e2.RELIABLE;this.updateAndEmitDCBufferStatus(b)},this.handleDisconnect=(a,b)=>{if(this._isClosed)return;this.log.warn("".concat(a," disconnected"),this.logContext),0===this.reconnectAttempts&&(this.reconnectStart=Date.now());let c=a=>{this.log.warn("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(a,"ms. giving up"),this.logContext),this.emit(li.Disconnected),this.close()},d=Date.now()-this.reconnectStart,e=this.getNextRetryDelay({elapsedMs:d,retryCount:this.reconnectAttempts});null===e?c(d):(a===j_&&(e=0),this.log.debug("reconnecting in ".concat(e,"ms"),this.logContext),this.clearReconnectTimeout(),this.token&&this.regionUrlProvider&&this.regionUrlProvider.updateToken(this.token),this.reconnectTimeout=h0.setTimeout(()=>this.attemptReconnect(b).finally(()=>this.reconnectTimeout=void 0),e))},this.waitForRestarted=()=>new Promise((a,b)=>{this.pcState===lA.Connected&&a();let c=()=>{this.off(li.Disconnected,d),a()},d=()=>{this.off(li.Restarted,c),b()};this.once(li.Restarted,c),this.once(li.Disconnected,d)}),this.updateAndEmitDCBufferStatus=a=>{if(a===e2.RELIABLE){let b=this.dataChannelForKind(a);b&&this.reliableMessageBuffer.alignBufferedAmount(b.bufferedAmount)}let b=this.isBufferStatusLow(a);void 0!==b&&b!==this.dcBufferStatus.get(a)&&(this.dcBufferStatus.set(a,b),this.emit(li.DCBufferStatusChanged,b,a))},this.isBufferStatusLow=a=>{let b=this.dataChannelForKind(a);if(b)return b.bufferedAmount<=b.bufferedAmountLowThreshold},this.handleBrowserOnLine=()=>gS(this,void 0,void 0,function*(){!this.url||(yield fetch(iR(this.url),{method:"HEAD"}).then(a=>a.ok).catch(()=>!1))&&(this.log.info("detected network reconnected"),(this.client.currentState===lt.RECONNECTING||this.isWaitingForNetworkReconnect&&this.client.currentState===lt.CONNECTED)&&(this.clearReconnectTimeout(),this.attemptReconnect(eO.RR_SIGNAL_DISCONNECTED),this.isWaitingForNetworkReconnect=!1))}),this.handleBrowserOffline=()=>gS(this,void 0,void 0,function*(){if(this.url)try{yield Promise.race([fetch(iR(this.url),{method:"HEAD"}),ip(4e3).then(()=>Promise.reject())])}catch(a){!1===window.navigator.onLine&&(this.log.info("detected network interruption"),this.isWaitingForNetworkReconnect=!0)}}),this.log=gP(null!=(b=a.loggerName)?b:la.Engine),this.loggerOptions={loggerName:a.loggerName,loggerContextCb:()=>this.logContext},this.client=new jc(void 0,this.loggerOptions),this.client.signalLatency=this.options.expSignalLatency,this.reconnectPolicy=this.options.reconnectPolicy,this.closingLock=new du,this.dataProcessLock=new du,this.dcBufferStatus=new Map([[e2.LOSSY,!0],[e2.RELIABLE,!0]]),this.client.onParticipantUpdate=a=>this.emit(li.ParticipantUpdate,a),this.client.onConnectionQuality=a=>this.emit(li.ConnectionQualityUpdate,a),this.client.onRoomUpdate=a=>this.emit(li.RoomUpdate,a),this.client.onSubscriptionError=a=>this.emit(li.SubscriptionError,a),this.client.onSubscriptionPermissionUpdate=a=>this.emit(li.SubscriptionPermissionUpdate,a),this.client.onSpeakersChanged=a=>this.emit(li.SpeakersChanged,a),this.client.onStreamStateUpdate=a=>this.emit(li.StreamStateChanged,a),this.client.onRequestResponse=a=>this.emit(li.SignalRequestResponse,a)}get logContext(){var a,b,c,d,e,f;return{room:null==(b=null==(a=this.latestJoinResponse)?void 0:a.room)?void 0:b.name,roomID:null==(d=null==(c=this.latestJoinResponse)?void 0:c.room)?void 0:d.sid,participant:null==(f=null==(e=this.latestJoinResponse)?void 0:e.participant)?void 0:f.identity,pID:this.participantSid}}join(a,b,c,d){return gS(this,void 0,void 0,function*(){this.url=a,this.token=b,this.signalOpts=c,this.maxJoinAttempts=c.maxRetries;try{this.joinAttempts+=1,this.setupSignalClientCallbacks();let e=yield this.client.join(a,b,c,d);return this._isClosed=!1,this.latestJoinResponse=e,this.subscriberPrimary=e.subscriberPrimary,this.pcManager||(yield this.configure(e)),(!this.subscriberPrimary||e.fastPublish)&&this.negotiate().catch(a=>{gO.error(a,this.logContext)}),this.registerOnLineListener(),this.clientConfiguration=e.clientConfiguration,this.emit(li.SignalConnected,e),e}catch(e){if(e instanceof hS&&e.reason===ld.ServerUnreachable&&(this.log.warn("Couldn't connect to server, attempt ".concat(this.joinAttempts," of ").concat(this.maxJoinAttempts),this.logContext),this.joinAttempts<this.maxJoinAttempts))return this.join(a,b,c,d);throw e}})}close(){return gS(this,void 0,void 0,function*(){let a=yield this.closingLock.lock();if(this.isClosed)return void a();try{this._isClosed=!0,this.joinAttempts=0,this.emit(li.Closing),this.removeAllListeners(),this.deregisterOnLineListener(),this.clearPendingReconnect(),this.cleanupLossyDataStats(),yield this.cleanupPeerConnections(),yield this.cleanupClient()}finally{a()}})}cleanupPeerConnections(){return gS(this,void 0,void 0,function*(){var a;yield null==(a=this.pcManager)?void 0:a.close(),this.pcManager=void 0;let b=a=>{a&&(a.close(),a.onbufferedamountlow=null,a.onclose=null,a.onclosing=null,a.onerror=null,a.onmessage=null,a.onopen=null)};b(this.lossyDC),b(this.lossyDCSub),b(this.reliableDC),b(this.reliableDCSub),this.lossyDC=void 0,this.lossyDCSub=void 0,this.reliableDC=void 0,this.reliableDCSub=void 0,this.reliableMessageBuffer=new jf,this.reliableDataSequence=1,this.reliableReceivedState.clear()})}cleanupLossyDataStats(){this.lossyDataStatByterate=0,this.lossyDataStatCurrentBytes=0,this.lossyDataStatInterval&&(clearInterval(this.lossyDataStatInterval),this.lossyDataStatInterval=void 0),this.lossyDataDropCount=0}cleanupClient(){return gS(this,void 0,void 0,function*(){yield this.client.close(),this.client.resetCallbacks()})}addTrack(a){if(this.pendingTrackResolvers[a.cid])throw new hU("a track with the same ID has already been published");return new Promise((b,c)=>{let d=setTimeout(()=>{delete this.pendingTrackResolvers[a.cid],c(hS.timeout("publication of local track timed out, no response from server"))},1e4);this.pendingTrackResolvers[a.cid]={resolve:a=>{clearTimeout(d),b(a)},reject:()=>{clearTimeout(d),c(Error("Cancelled publication by calling unpublish"))}},this.client.sendAddTrack(a)})}removeTrack(a){if(a.track&&this.pendingTrackResolvers[a.track.id]){let{reject:b}=this.pendingTrackResolvers[a.track.id];b&&b(),delete this.pendingTrackResolvers[a.track.id]}try{return this.pcManager.removeTrack(a),!0}catch(a){this.log.warn("failed to remove track",Object.assign(Object.assign({},this.logContext),{error:a}))}return!1}updateMuteStatus(a,b){this.client.sendMuteTrack(a,b)}get dataSubscriberReadyState(){var a;return null==(a=this.reliableDCSub)?void 0:a.readyState}getConnectedServerAddress(){return gS(this,void 0,void 0,function*(){var a;return null==(a=this.pcManager)?void 0:a.getConnectedAddress()})}setRegionUrlProvider(a){this.regionUrlProvider=a}configure(a){return gS(this,void 0,void 0,function*(){var b,c,d;if(this.pcManager&&this.pcManager.currentState!==lz.NEW)return;this.participantSid=null==(b=a.participant)?void 0:b.sid;let e=this.makeRTCConfiguration(a);this.pcManager=new jz(e,this.options.singlePeerConnection?"publisher-only":a.subscriberPrimary?"subscriber-primary":"publisher-primary",this.loggerOptions),this.emit(li.TransportsCreated,this.pcManager.publisher,this.pcManager.subscriber),this.pcManager.onIceCandidate=(a,b)=>{this.client.sendIceCandidate(a,b)},this.pcManager.onPublisherOffer=(a,b)=>{this.client.sendOffer(a,b)},this.pcManager.onDataChannel=this.handleDataChannel,this.pcManager.onStateChange=(b,c,d)=>gS(this,void 0,void 0,function*(){if(this.log.debug("primary PC state changed ".concat(b),this.logContext),["closed","disconnected","failed"].includes(c)&&(this.publisherConnectionPromise=void 0),b===lz.CONNECTED){let b=this.pcState===lA.New;this.pcState=lA.Connected,b&&this.emit(li.Connected,a)}else b===lz.FAILED&&(this.pcState===lA.Connected||this.pcState===lA.Reconnecting)&&(this.pcState=lA.Disconnected,this.handleDisconnect("peerconnection failed","failed"===d?eO.RR_SUBSCRIBER_FAILED:eO.RR_PUBLISHER_FAILED));let e=this.client.isDisconnected||this.client.currentState===lt.RECONNECTING,f=[lz.FAILED,lz.CLOSING,lz.CLOSED].includes(b);e&&f&&!this._isClosed&&this.emit(li.Offline)}),this.pcManager.onTrack=a=>{0!==a.streams.length&&this.emit(li.MediaTrackAdded,a.track,a.streams[0],a.receiver)},void 0!==(d=null==(c=a.serverInfo)?void 0:c.protocol)&&d>13||this.createDataChannels()})}setupSignalClientCallbacks(){this.client.onAnswer=(a,b,c)=>gS(this,void 0,void 0,function*(){this.pcManager&&(this.log.debug("received server answer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:a.type,sdp:a.sdp,midToTrackId:c})),this.midToTrackId=c,yield this.pcManager.setPublisherAnswer(a,b))}),this.client.onTrickle=(a,b)=>{this.pcManager&&(this.log.debug("got ICE candidate from peer",Object.assign(Object.assign({},this.logContext),{candidate:a,target:b})),this.pcManager.addIceCandidate(a,b))},this.client.onOffer=(a,b,c)=>gS(this,void 0,void 0,function*(){if(this.latestRemoteOfferId=b,!this.pcManager)return;this.midToTrackId=c;let d=yield this.pcManager.createSubscriberAnswerFromOffer(a,b);d&&this.client.sendAnswer(d,b)}),this.client.onLocalTrackPublished=a=>{var b;if(this.log.debug("received trackPublishedResponse",Object.assign(Object.assign({},this.logContext),{cid:a.cid,track:null==(b=a.track)?void 0:b.sid})),!this.pendingTrackResolvers[a.cid])return void this.log.error("missing track resolver for ".concat(a.cid),Object.assign(Object.assign({},this.logContext),{cid:a.cid}));let{resolve:c}=this.pendingTrackResolvers[a.cid];delete this.pendingTrackResolvers[a.cid],c(a.track)},this.client.onLocalTrackUnpublished=a=>{this.emit(li.LocalTrackUnpublished,a)},this.client.onLocalTrackSubscribed=a=>{this.emit(li.LocalTrackSubscribed,a)},this.client.onTokenRefresh=a=>{var b;this.token=a,null==(b=this.regionUrlProvider)||b.updateToken(a)},this.client.onRemoteMuteChanged=(a,b)=>{this.emit(li.RemoteMute,a,b)},this.client.onSubscribedQualityUpdate=a=>{this.emit(li.SubscribedQualityUpdate,a)},this.client.onRoomMoved=a=>{var b;this.participantSid=null==(b=a.participant)?void 0:b.sid,this.latestJoinResponse&&(this.latestJoinResponse.room=a.room),this.emit(li.RoomMoved,a)},this.client.onMediaSectionsRequirement=a=>{var b,c;let d={direction:"recvonly"};for(let c=0;c<a.numAudios;c++)null==(b=this.pcManager)||b.addPublisherTransceiverOfKind("audio",d);for(let b=0;b<a.numVideos;b++)null==(c=this.pcManager)||c.addPublisherTransceiverOfKind("video",d);this.negotiate()},this.client.onClose=()=>{this.handleDisconnect("signal",eO.RR_SIGNAL_DISCONNECTED)},this.client.onLeave=a=>{switch(this.log.debug("client leave request",Object.assign(Object.assign({},this.logContext),{reason:null==a?void 0:a.reason})),a.regions&&this.regionUrlProvider&&(this.log.debug("updating regions",this.logContext),this.regionUrlProvider.setServerReportedRegions({updatedAtInMs:Date.now(),maxAgeInMs:5e3,regionSettings:a.regions})),a.action){case gc.DISCONNECT:this.emit(li.Disconnected,null==a?void 0:a.reason),this.close();break;case gc.RECONNECT:this.fullReconnectOnNext=!0,this.handleDisconnect(j_);break;case gc.RESUME:this.handleDisconnect(j_)}}}makeRTCConfiguration(a){var b;let c=Object.assign({},this.rtcConfig);if((null==(b=this.signalOpts)?void 0:b.e2eeEnabled)&&(this.log.debug("E2EE - setting up transports with insertable streams",this.logContext),c.encodedInsertableStreams=!0),a.iceServers&&!c.iceServers){let b=[];a.iceServers.forEach(a=>{let c={urls:a.urls};a.username&&(c.username=a.username),a.credential&&(c.credential=a.credential),b.push(c)}),c.iceServers=b}return a.clientConfiguration&&a.clientConfiguration.forceRelay===eM.ENABLED&&(c.iceTransportPolicy="relay"),c.sdpSemantics="unified-plan",c.continualGatheringPolicy="gather_continually",c}createDataChannels(){this.pcManager&&(this.lossyDC&&(this.lossyDC.onmessage=null,this.lossyDC.onerror=null),this.reliableDC&&(this.reliableDC.onmessage=null,this.reliableDC.onerror=null),this.lossyDC=this.pcManager.createPublisherDataChannel(jZ,{ordered:!1,maxRetransmits:0}),this.reliableDC=this.pcManager.createPublisherDataChannel(j$,{ordered:!0}),this.lossyDC.onmessage=this.handleDataMessage,this.reliableDC.onmessage=this.handleDataMessage,this.lossyDC.onerror=this.handleDataError,this.reliableDC.onerror=this.handleDataError,this.lossyDC.bufferedAmountLowThreshold=65535,this.reliableDC.bufferedAmountLowThreshold=65535,this.lossyDC.onbufferedamountlow=this.handleBufferedAmountLow,this.reliableDC.onbufferedamountlow=this.handleBufferedAmountLow,this.cleanupLossyDataStats(),this.lossyDataStatInterval=setInterval(()=>{this.lossyDataStatByterate=this.lossyDataStatCurrentBytes,this.lossyDataStatCurrentBytes=0;let a=this.dataChannelForKind(e2.LOSSY);a&&(a.bufferedAmountLowThreshold=Math.min(Math.max(this.lossyDataStatByterate/10,8192),262144))},1e3))}createSender(a,b,c){return gS(this,void 0,void 0,function*(){if(iq())return yield this.createTransceiverRTCRtpSender(a,b,c);if(ir())return this.log.warn("using add-track fallback",this.logContext),yield this.createRTCRtpSender(a.mediaStreamTrack);throw new hW("Required webRTC APIs not supported on this device")})}createSimulcastSender(a,b,c,d){return gS(this,void 0,void 0,function*(){if(iq())return this.createSimulcastTransceiverSender(a,b,c,d);if(ir())return this.log.debug("using add-track fallback",this.logContext),this.createRTCRtpSender(a.mediaStreamTrack);throw new hW("Cannot stream on this device")})}createTransceiverRTCRtpSender(a,b,c){return gS(this,void 0,void 0,function*(){if(!this.pcManager)throw new hW("publisher is closed");let d=[];a.mediaStream&&d.push(a.mediaStream),iX(a)&&(a.codec=b.videoCodec);let e={direction:"sendonly",streams:d};return c&&(e.sendEncodings=c),(yield this.pcManager.addPublisherTransceiver(a.mediaStreamTrack,e)).sender})}createSimulcastTransceiverSender(a,b,c,d){return gS(this,void 0,void 0,function*(){if(!this.pcManager)throw new hW("publisher is closed");let e={direction:"sendonly"};d&&(e.sendEncodings=d);let f=yield this.pcManager.addPublisherTransceiver(b.mediaStreamTrack,e);if(c.videoCodec)return a.setSimulcastTrackSender(c.videoCodec,f.sender),f.sender})}createRTCRtpSender(a){return gS(this,void 0,void 0,function*(){if(!this.pcManager)throw new hW("publisher is closed");return this.pcManager.addPublisherTrack(a)})}attemptReconnect(a){return gS(this,void 0,void 0,function*(){var b,c,d;if(!this._isClosed){if(this.attemptingReconnect)return void gO.warn("already attempting reconnect, returning early",this.logContext);((null==(b=this.clientConfiguration)?void 0:b.resumeConnection)===eM.DISABLED||(null!=(d=null==(c=this.pcManager)?void 0:c.currentState)?d:lz.NEW)===lz.NEW)&&(this.fullReconnectOnNext=!0);try{this.attemptingReconnect=!0,this.fullReconnectOnNext?yield this.restartConnection():yield this.resumeConnection(a),this.clearPendingReconnect(),this.fullReconnectOnNext=!1}catch(b){this.reconnectAttempts+=1;let a=!0;b instanceof hW?(this.log.debug("received unrecoverable error",Object.assign(Object.assign({},this.logContext),{error:b})),a=!1):b instanceof h_||(this.fullReconnectOnNext=!0),a?this.handleDisconnect("reconnect",eO.RR_UNKNOWN):(this.log.info("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(Date.now()-this.reconnectStart,"ms. giving up"),this.logContext),this.emit(li.Disconnected),yield this.close())}finally{this.attemptingReconnect=!1}}})}getNextRetryDelay(a){try{return this.reconnectPolicy.nextRetryDelayInMs(a)}catch(a){this.log.warn("encountered error in reconnect policy",Object.assign(Object.assign({},this.logContext),{error:a}))}return null}restartConnection(a){return gS(this,void 0,void 0,function*(){var b,c,d;try{let c;if(!this.url||!this.token)throw new hW("could not reconnect, url or token not saved");this.log.info("reconnecting, attempt: ".concat(this.reconnectAttempts),this.logContext),this.emit(li.Restarting),this.client.isDisconnected||(yield this.client.sendLeave()),yield this.cleanupPeerConnections(),yield this.cleanupClient();try{if(!this.signalOpts)throw this.log.warn("attempted connection restart, without signal options present",this.logContext),new h_;c=yield this.join(null!=a?a:this.url,this.token,this.signalOpts)}catch(a){if(a instanceof hS&&a.reason===ld.NotAllowed)throw new hW("could not reconnect, token might be expired");throw new h_}if(this.shouldFailNext)throw this.shouldFailNext=!1,Error("simulated failure");if(this.client.setReconnected(),this.emit(li.SignalRestarted,c),yield this.waitForPCReconnected(),this.client.currentState!==lt.CONNECTED)throw new h_("Signal connection got severed during reconnect");null==(b=this.regionUrlProvider)||b.resetAttempts(),this.emit(li.Restarted)}catch(b){let a=yield null==(c=this.regionUrlProvider)?void 0:c.getNextBestRegionUrl();if(a)return void(yield this.restartConnection(a));throw null==(d=this.regionUrlProvider)||d.resetAttempts(),b}})}resumeConnection(a){return gS(this,void 0,void 0,function*(){var b;let c;if(!this.url||!this.token)throw new hW("could not reconnect, url or token not saved");if(!this.pcManager)throw new hW("publisher and subscriber connections unset");this.log.info("resuming signal connection, attempt ".concat(this.reconnectAttempts),this.logContext),this.emit(li.Resuming);try{this.setupSignalClientCallbacks(),c=yield this.client.reconnect(this.url,this.token,this.participantSid,a)}catch(b){let a="";if(b instanceof Error&&(a=b.message,this.log.error(b.message,Object.assign(Object.assign({},this.logContext),{error:b}))),b instanceof hS&&b.reason===ld.NotAllowed)throw new hW("could not reconnect, token might be expired");if(b instanceof hS&&b.reason===ld.LeaveRequest)throw b;throw new h_(a)}if(this.emit(li.SignalResumed),c){let a=this.makeRTCConfiguration(c);this.pcManager.updateConfiguration(a),this.latestJoinResponse&&(this.latestJoinResponse.serverInfo=c.serverInfo)}else this.log.warn("Did not receive reconnect response",this.logContext);if(this.shouldFailNext)throw this.shouldFailNext=!1,Error("simulated failure");if(yield this.pcManager.triggerIceRestart(),yield this.waitForPCReconnected(),this.client.currentState!==lt.CONNECTED)throw new h_("Signal connection got severed during reconnect");this.client.setReconnected(),(null==(b=this.reliableDC)?void 0:b.readyState)==="open"&&null===this.reliableDC.id&&this.createDataChannels(),(null==c?void 0:c.lastMessageSeq)&&this.resendReliableMessagesForResume(c.lastMessageSeq),this.emit(li.Resumed)})}waitForPCInitialConnection(a,b){return gS(this,void 0,void 0,function*(){if(!this.pcManager)throw new hW("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(b,a)})}waitForPCReconnected(){return gS(this,void 0,void 0,function*(){this.pcState=lA.Reconnecting,this.log.debug("waiting for peer connection to reconnect",this.logContext);try{if(yield ip(2e3),!this.pcManager)throw new hW("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(void 0,this.peerConnectionTimeout),this.pcState=lA.Connected}catch(a){throw this.pcState=lA.Disconnected,hS.internal("could not establish PC connection, ".concat(a.message))}})}publishRpcResponse(a,b,c,d){return gS(this,void 0,void 0,function*(){let e=new e1({destinationIdentities:[a],kind:e2.RELIABLE,value:{case:"rpcResponse",value:new fe({requestId:b,value:d?{case:"error",value:d.toProto()}:{case:"payload",value:null!=c?c:""}})}});yield this.sendDataPacket(e,e2.RELIABLE)})}publishRpcAck(a,b){return gS(this,void 0,void 0,function*(){let c=new e1({destinationIdentities:[a],kind:e2.RELIABLE,value:{case:"rpcAck",value:new fd({requestId:b})}});yield this.sendDataPacket(c,e2.RELIABLE)})}sendDataPacket(a,b){return gS(this,void 0,void 0,function*(){if(yield this.ensurePublisherConnected(b),this.e2eeManager&&this.e2eeManager.isDataChannelEncryptionEnabled){let b=function(a){var b,c,d,e,f;if((null==(b=a.value)?void 0:b.case)!=="sipDtmf"&&(null==(c=a.value)?void 0:c.case)!=="metrics"&&(null==(d=a.value)?void 0:d.case)!=="speaker"&&(null==(e=a.value)?void 0:e.case)!=="transcription"&&(null==(f=a.value)?void 0:f.case)!=="encryptedPacket")return new e4({value:a.value})}(a);if(b){let c=yield this.e2eeManager.encryptData(b.toBinary());a.value={case:"encryptedPacket",value:new e3({encryptedValue:c.payload,iv:c.iv,keyIndex:c.keyIndex})}}}b===e2.RELIABLE&&(a.sequence=this.reliableDataSequence,this.reliableDataSequence+=1);let c=a.toBinary(),d=this.dataChannelForKind(b);if(d){if(b===e2.RELIABLE)yield this.waitForBufferStatusLow(b),this.reliableMessageBuffer.push({data:c,sequence:a.sequence});else{if(!this.isBufferStatusLow(b)){this.lossyDataDropCount+=1,this.lossyDataDropCount%100==0&&this.log.warn("dropping lossy data channel messages, total dropped: ".concat(this.lossyDataDropCount),this.logContext);return}this.lossyDataStatCurrentBytes+=c.byteLength}if(this.attemptingReconnect)return;d.send(c)}this.updateAndEmitDCBufferStatus(b)})}resendReliableMessagesForResume(a){return gS(this,void 0,void 0,function*(){yield this.ensurePublisherConnected(e2.RELIABLE);let b=this.dataChannelForKind(e2.RELIABLE);b&&(this.reliableMessageBuffer.popToSequence(a),this.reliableMessageBuffer.getAll().forEach(a=>{b.send(a.data)})),this.updateAndEmitDCBufferStatus(e2.RELIABLE)})}waitForBufferStatusLow(a){return new Promise((b,c)=>gS(this,void 0,void 0,function*(){if(this.isBufferStatusLow(a))b();else{let d=()=>c("Engine closed");for(this.once(li.Closing,d);!this.dcBufferStatus.get(a);)yield ip(10);this.off(li.Closing,d),b()}}))}ensureDataTransportConnected(a){return gS(this,arguments,void 0,function(a){var b=this;let c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.subscriberPrimary;return function*(){var d;if(!b.pcManager)throw new hW("PC manager is closed");let e=c?b.pcManager.subscriber:b.pcManager.publisher,f=c?"Subscriber":"Publisher";if(!e)throw hS.internal("".concat(f," connection not set"));let g=!1;c||b.dataChannelForKind(a,c)||(b.createDataChannels(),g=!0),g||c||b.pcManager.publisher.isICEConnected||"checking"===b.pcManager.publisher.getICEConnectionState()||(g=!0),g&&b.negotiate().catch(a=>{gO.error(a,b.logContext)});let h=b.dataChannelForKind(a,c);if((null==h?void 0:h.readyState)==="open")return;let i=new Date().getTime()+b.peerConnectionTimeout;for(;new Date().getTime()<i;){if(e.isICEConnected&&(null==(d=b.dataChannelForKind(a,c))?void 0:d.readyState)==="open")return;yield ip(50)}throw hS.internal("could not establish ".concat(f," connection, state: ").concat(e.getICEConnectionState()))}()})}ensurePublisherConnected(a){return gS(this,void 0,void 0,function*(){this.publisherConnectionPromise||(this.publisherConnectionPromise=this.ensureDataTransportConnected(a,!1)),yield this.publisherConnectionPromise})}verifyTransport(){return!!this.pcManager&&this.pcManager.currentState===lz.CONNECTED&&!!this.client.ws&&this.client.ws.readyState!==WebSocket.CLOSED}negotiate(){return gS(this,void 0,void 0,function*(){return new Promise((a,b)=>gS(this,void 0,void 0,function*(){if(!this.pcManager)return void b(new hX("PC manager is closed"));this.pcManager.requirePublisher(),0!=this.pcManager.publisher.getTransceivers().length||this.lossyDC||this.reliableDC||this.createDataChannels();let c=new AbortController,d=()=>{c.abort(),this.log.debug("engine disconnected while negotiation was ongoing",this.logContext),a()};this.isClosed&&b("cannot negotiate on closed engine"),this.on(li.Closing,d),this.pcManager.publisher.once(jp,a=>{let b=new Map;a.forEach(a=>{let c=a.codec.toLowerCase();h3.includes(c)&&b.set(a.payload,c)}),this.emit(li.RTPVideoMapUpdate,b)});try{yield this.pcManager.negotiate(c),a()}catch(a){a instanceof hX&&(this.fullReconnectOnNext=!0),this.handleDisconnect("negotiation",eO.RR_UNKNOWN),b(a)}finally{this.off(li.Closing,d)}}))})}dataChannelForKind(a,b){if(b){if(a===e2.LOSSY)return this.lossyDCSub;if(a===e2.RELIABLE)return this.reliableDCSub}else{if(a===e2.LOSSY)return this.lossyDC;if(a===e2.RELIABLE)return this.reliableDC}}sendSyncState(a,b){var c,d,e,f;let g;if(!this.pcManager)return void this.log.warn("sync state cannot be sent without peer connection setup",this.logContext);let h=this.pcManager.publisher.getLocalDescription(),i=this.pcManager.publisher.getRemoteDescription(),j=null==(c=this.pcManager.subscriber)?void 0:c.getRemoteDescription(),k=null==(d=this.pcManager.subscriber)?void 0:d.getLocalDescription(),l=null==(f=null==(e=this.signalOpts)?void 0:e.autoSubscribe)||f,m=[],n=[];a.forEach(a=>{a.isDesired!==l&&m.push(a.trackSid),a.isEnabled||n.push(a.trackSid)}),this.client.sendSyncState(new gu({answer:this.options.singlePeerConnection?i?je({sdp:i.sdp,type:i.type}):void 0:k?je({sdp:k.sdp,type:k.type}):void 0,offer:this.options.singlePeerConnection?h?je({sdp:h.sdp,type:h.type}):void 0:j?je({sdp:j.sdp,type:j.type}):void 0,subscription:new f7({trackSids:m,subscribe:!l,participantTracks:[]}),publishTracks:(g=[],b.forEach(a=>{void 0!==a.track&&g.push(new f3({cid:a.track.mediaStreamID,track:a.trackInfo}))}),g),dataChannels:this.dataChannelsInfo(),trackSidsDisabled:n,datachannelReceiveStates:this.reliableReceivedState.map((a,b)=>new gv({publisherSid:b,lastSeq:a}))}))}failNext(){this.shouldFailNext=!0}dataChannelsInfo(){let a=[],b=(b,c)=>{(null==b?void 0:b.id)!==void 0&&null!==b.id&&a.push(new gw({label:b.label,id:b.id,target:c}))};return b(this.dataChannelForKind(e2.LOSSY),fU.PUBLISHER),b(this.dataChannelForKind(e2.RELIABLE),fU.PUBLISHER),b(this.dataChannelForKind(e2.LOSSY,!0),fU.SUBSCRIBER),b(this.dataChannelForKind(e2.RELIABLE,!0),fU.SUBSCRIBER),a}clearReconnectTimeout(){this.reconnectTimeout&&h0.clearTimeout(this.reconnectTimeout)}clearPendingReconnect(){this.clearReconnectTimeout(),this.reconnectAttempts=0}registerOnLineListener(){iz()&&(window.addEventListener("online",this.handleBrowserOnLine),window.addEventListener("offline",this.handleBrowserOffline))}deregisterOnLineListener(){iz()&&(window.removeEventListener("online",this.handleBrowserOnLine),window.removeEventListener("offline",this.handleBrowserOffline))}getTrackIdForReceiver(a){var b;let c=null==(b=this.pcManager)?void 0:b.getMidForReceiver(a);if(c){let a=Object.entries(this.midToTrackId).find(a=>{let[b]=a;return b===c});if(a)return a[1]}}}function j1(a,b){let c=a.participantIdentity?a.participantIdentity:b.participantIdentity;a.participantIdentity=c,b.participantIdentity=c;let d=0!==a.destinationIdentities.length?a.destinationIdentities:b.destinationIdentities;a.destinationIdentities=d,b.destinationIdentities=d}class j2{get info(){return this._info}validateBytesReceived(){let a=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if("number"==typeof this.totalByteSize&&0!==this.totalByteSize){if(a&&this.bytesReceived<this.totalByteSize)throw new h$("Not enough chunk(s) received - expected ".concat(this.totalByteSize," bytes of data total, only received ").concat(this.bytesReceived," bytes"),le.Incomplete);else if(this.bytesReceived>this.totalByteSize)throw new h$("Extra chunk(s) received - expected ".concat(this.totalByteSize," bytes of data total, received ").concat(this.bytesReceived," bytes"),le.LengthExceeded)}}constructor(a,b,c,d){this.reader=b,this.totalByteSize=c,this._info=a,this.bytesReceived=0,this.outOfBandFailureRejectingFuture=d}}class j3 extends j2{handleChunkReceived(a){var b;this.bytesReceived+=a.content.byteLength,this.validateBytesReceived();let c=this.totalByteSize?this.bytesReceived/this.totalByteSize:void 0;null==(b=this.onProgress)||b.call(this,c)}[Symbol.asyncIterator](){let a=this.reader.getReader(),b=new iP,c=null,d=null;if(this.signal){let a=this.signal;d=()=>{var c;null==(c=b.reject)||c.call(b,a.reason)},a.addEventListener("abort",d),c=a}let e=()=>{a.releaseLock(),c&&d&&c.removeEventListener("abort",d),this.signal=void 0};return{next:()=>gS(this,void 0,void 0,function*(){var c,d;try{let{done:e,value:f}=yield Promise.race([a.read(),b.promise,null!=(d=null==(c=this.outOfBandFailureRejectingFuture)?void 0:c.promise)?d:new Promise(()=>{})]);if(e)return this.validateBytesReceived(!0),{done:!0,value:void 0};return this.handleChunkReceived(f),{done:!1,value:f.content}}catch(a){throw e(),a}}),return(){return gS(this,void 0,void 0,function*(){return e(),{done:!0,value:void 0}})}}}withAbortSignal(a){return this.signal=a,this}readAll(){return gS(this,arguments,void 0,function(){var a=this;let b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function*(){var c,d,e,f;let g=new Set,h=b.signal?a.withAbortSignal(b.signal):a;try{for(var i,j=!0,k=gT(h);!(c=(i=yield k.next()).done);j=!0)f=i.value,j=!1,g.add(f)}catch(a){d={error:a}}finally{try{!j&&!c&&(e=k.return)&&(yield e.call(k))}finally{if(d)throw d.error}}return Array.from(g)}()})}}class j4 extends j2{constructor(a,b,c,d){super(a,b,c,d),this.receivedChunks=new Map}handleChunkReceived(a){var b;let c=iT(a.chunkIndex),d=this.receivedChunks.get(c);if(d&&d.version>a.version)return;this.receivedChunks.set(c,a),this.bytesReceived+=a.content.byteLength,this.validateBytesReceived();let e=this.totalByteSize?this.bytesReceived/this.totalByteSize:void 0;null==(b=this.onProgress)||b.call(this,e)}[Symbol.asyncIterator](){let a=this.reader.getReader(),b=new TextDecoder("utf-8",{fatal:!0}),c=new iP,d=null,e=null;if(this.signal){let a=this.signal;e=()=>{var b;null==(b=c.reject)||b.call(c,a.reason)},a.addEventListener("abort",e),d=a}let f=()=>{a.releaseLock(),d&&e&&d.removeEventListener("abort",e),this.signal=void 0};return{next:()=>gS(this,void 0,void 0,function*(){var d,e;try{let{done:f,value:g}=yield Promise.race([a.read(),c.promise,null!=(e=null==(d=this.outOfBandFailureRejectingFuture)?void 0:d.promise)?e:new Promise(()=>{})]);if(f)return this.validateBytesReceived(!0),{done:!0,value:void 0};{let a;this.handleChunkReceived(g);try{a=b.decode(g.content)}catch(a){throw new h$("Cannot decode datastream chunk ".concat(g.chunkIndex," as text: ").concat(a),le.DecodeFailed)}return{done:!1,value:a}}}catch(a){throw f(),a}}),return(){return gS(this,void 0,void 0,function*(){return f(),{done:!0,value:void 0}})}}}withAbortSignal(a){return this.signal=a,this}readAll(){return gS(this,arguments,void 0,function(){var a=this;let b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function*(){var c,d,e,f;let g="",h=b.signal?a.withAbortSignal(b.signal):a;try{for(var i,j=!0,k=gT(h);!(c=(i=yield k.next()).done);j=!0)f=i.value,j=!1,g+=f}catch(a){d={error:a}}finally{try{!j&&!c&&(e=k.return)&&(yield e.call(k))}finally{if(d)throw d.error}}return g}()})}}class j5{constructor(){this.log=gO,this.byteStreamControllers=new Map,this.textStreamControllers=new Map,this.byteStreamHandlers=new Map,this.textStreamHandlers=new Map}registerTextStreamHandler(a,b){if(this.textStreamHandlers.has(a))throw new h$('A text stream handler for topic "'.concat(a,'" has already been set.'),le.HandlerAlreadyRegistered);this.textStreamHandlers.set(a,b)}unregisterTextStreamHandler(a){this.textStreamHandlers.delete(a)}registerByteStreamHandler(a,b){if(this.byteStreamHandlers.has(a))throw new h$('A byte stream handler for topic "'.concat(a,'" has already been set.'),le.HandlerAlreadyRegistered);this.byteStreamHandlers.set(a,b)}unregisterByteStreamHandler(a){this.byteStreamHandlers.delete(a)}clearControllers(){this.byteStreamControllers.clear(),this.textStreamControllers.clear()}validateParticipantHasNoActiveDataStreams(a){var b,c,d,e;let f=Array.from(this.textStreamControllers.entries()).filter(b=>b[1].sendingParticipantIdentity===a),g=Array.from(this.byteStreamControllers.entries()).filter(b=>b[1].sendingParticipantIdentity===a);if(f.length>0||g.length>0){let h=new h$("Participant ".concat(a," unexpectedly disconnected in the middle of sending data"),le.AbnormalEnd);for(let[a,d]of g)null==(c=(b=d.outOfBandFailureRejectingFuture).reject)||c.call(b,h),this.byteStreamControllers.delete(a);for(let[a,b]of f)null==(e=(d=b.outOfBandFailureRejectingFuture).reject)||e.call(d,h),this.textStreamControllers.delete(a)}}handleDataStreamPacket(a,b){return gS(this,void 0,void 0,function*(){switch(a.value.case){case"streamHeader":return this.handleStreamHeader(a.value.value,a.participantIdentity,b);case"streamChunk":return this.handleStreamChunk(a.value.value,b);case"streamTrailer":return this.handleStreamTrailer(a.value.value,b);default:throw Error('DataPacket of value "'.concat(a.value.case,'" is not data stream related!'))}})}handleStreamHeader(a,b,c){return gS(this,void 0,void 0,function*(){var d;if("byteHeader"===a.contentHeader.case){let e,f=this.byteStreamHandlers.get(a.topic);if(!f)return void this.log.debug("ignoring incoming byte stream due to no handler for topic",a.topic);let g=new iP;g.promise.catch(a=>{this.log.error(a)});let h={id:a.streamId,name:null!=(d=a.contentHeader.value.name)?d:"unknown",mimeType:a.mimeType,size:a.totalLength?Number(a.totalLength):void 0,topic:a.topic,timestamp:iT(a.timestamp),attributes:a.attributes,encryptionType:c},i=new ReadableStream({start:c=>{if(e=c,this.textStreamControllers.has(a.streamId))throw new h$("A data stream read is already in progress for a stream with id ".concat(a.streamId,"."),le.AlreadyOpened);this.byteStreamControllers.set(a.streamId,{info:h,controller:e,startTime:Date.now(),sendingParticipantIdentity:b,outOfBandFailureRejectingFuture:g})}});f(new j3(h,i,iT(a.totalLength),g),{identity:b})}else if("textHeader"===a.contentHeader.case){let d,e=this.textStreamHandlers.get(a.topic);if(!e)return void this.log.debug("ignoring incoming text stream due to no handler for topic",a.topic);let f=new iP;f.promise.catch(a=>{this.log.error(a)});let g={id:a.streamId,mimeType:a.mimeType,size:a.totalLength?Number(a.totalLength):void 0,topic:a.topic,timestamp:Number(a.timestamp),attributes:a.attributes,encryptionType:c},h=new ReadableStream({start:c=>{if(d=c,this.textStreamControllers.has(a.streamId))throw new h$("A data stream read is already in progress for a stream with id ".concat(a.streamId,"."),le.AlreadyOpened);this.textStreamControllers.set(a.streamId,{info:g,controller:d,startTime:Date.now(),sendingParticipantIdentity:b,outOfBandFailureRejectingFuture:f})}});e(new j4(g,h,iT(a.totalLength),f),{identity:b})}})}handleStreamChunk(a,b){let c=this.byteStreamControllers.get(a.streamId);c&&(c.info.encryptionType!==b?(c.controller.error(new h$("Encryption type mismatch for stream ".concat(a.streamId,". Expected ").concat(b,", got ").concat(c.info.encryptionType),le.EncryptionTypeMismatch)),this.byteStreamControllers.delete(a.streamId)):a.content.length>0&&c.controller.enqueue(a));let d=this.textStreamControllers.get(a.streamId);d&&(d.info.encryptionType!==b?(d.controller.error(new h$("Encryption type mismatch for stream ".concat(a.streamId,". Expected ").concat(b,", got ").concat(d.info.encryptionType),le.EncryptionTypeMismatch)),this.textStreamControllers.delete(a.streamId)):a.content.length>0&&d.controller.enqueue(a))}handleStreamTrailer(a,b){let c=this.textStreamControllers.get(a.streamId);c&&(c.info.encryptionType!==b?c.controller.error(new h$("Encryption type mismatch for stream ".concat(a.streamId,". Expected ").concat(b,", got ").concat(c.info.encryptionType),le.EncryptionTypeMismatch)):(c.info.attributes=Object.assign(Object.assign({},c.info.attributes),a.attributes),c.controller.close(),this.textStreamControllers.delete(a.streamId)));let d=this.byteStreamControllers.get(a.streamId);d&&(d.info.encryptionType!==b?d.controller.error(new h$("Encryption type mismatch for stream ".concat(a.streamId,". Expected ").concat(b,", got ").concat(d.info.encryptionType),le.EncryptionTypeMismatch)):(d.info.attributes=Object.assign(Object.assign({},d.info.attributes),a.attributes),d.controller.close()),this.byteStreamControllers.delete(a.streamId))}}class j6{constructor(a,b,c){this.writableStream=a,this.defaultWriter=a.getWriter(),this.onClose=c,this.info=b}write(a){return this.defaultWriter.write(a)}close(){return gS(this,void 0,void 0,function*(){var a;yield this.defaultWriter.close(),this.defaultWriter.releaseLock(),null==(a=this.onClose)||a.call(this)})}}class j7 extends j6{}class j8 extends j6{}class j9{constructor(a,b){this.engine=a,this.log=b}setupEngine(a){this.engine=a}sendText(a,b){return gS(this,void 0,void 0,function*(){var c;let d=crypto.randomUUID(),e=new TextEncoder().encode(a).byteLength,f=null==(c=null==b?void 0:b.attachments)?void 0:c.map(()=>crypto.randomUUID()),g=Array(f?f.length+1:1).fill(0),h=(a,c)=>{var d;g[c]=a;let e=g.reduce((a,b)=>a+b,0);null==(d=null==b?void 0:b.onProgress)||d.call(b,e)},i=yield this.streamText({streamId:d,totalSize:e,destinationIdentities:null==b?void 0:b.destinationIdentities,topic:null==b?void 0:b.topic,attachedStreamIds:f,attributes:null==b?void 0:b.attributes});return yield i.write(a),h(1,0),yield i.close(),(null==b?void 0:b.attachments)&&f&&(yield Promise.all(b.attachments.map((a,c)=>gS(this,void 0,void 0,function*(){return this._sendFile(f[c],a,{topic:b.topic,mimeType:a.type,onProgress:a=>{h(a,c+1)}})})))),i.info})}streamText(a){return gS(this,void 0,void 0,function*(){var b,c,d;let e=null!=(b=null==a?void 0:a.streamId)?b:crypto.randomUUID(),f={id:e,mimeType:"text/plain",timestamp:Date.now(),topic:null!=(c=null==a?void 0:a.topic)?c:"",size:null==a?void 0:a.totalSize,attributes:null==a?void 0:a.attributes,encryptionType:(null==(d=this.engine.e2eeManager)?void 0:d.isDataChannelEncryptionEnabled)?eY.GCM:eY.NONE},g=new fs({streamId:e,mimeType:f.mimeType,topic:f.topic,timestamp:iU(f.timestamp),totalLength:iU(null==a?void 0:a.totalSize),attributes:f.attributes,contentHeader:{case:"textHeader",value:new fq({version:null==a?void 0:a.version,attachedStreamIds:null==a?void 0:a.attachedStreamIds,replyToStreamId:null==a?void 0:a.replyToStreamId,operationType:(null==a?void 0:a.type)==="update"?fp.UPDATE:fp.CREATE})}}),h=null==a?void 0:a.destinationIdentities,i=new e1({destinationIdentities:h,value:{case:"streamHeader",value:g}});yield this.engine.sendDataPacket(i,e2.RELIABLE);let j=0,k=this.engine,l=new WritableStream({write(a){return gS(this,void 0,void 0,function*(){for(let b of function(a,b){let c=[],d=new TextEncoder().encode(a);for(;d.length>15e3;){let a=15e3;for(;a>0;){let b=d[a];if(void 0!==b&&(192&b)!=128)break;a--}c.push(d.slice(0,a)),d=d.slice(a)}return d.length>0&&c.push(d),c}(a,0)){let a=new e1({destinationIdentities:h,value:{case:"streamChunk",value:new ft({content:b,streamId:e,chunkIndex:iU(j)})}});yield k.sendDataPacket(a,e2.RELIABLE),j+=1}})},close(){return gS(this,void 0,void 0,function*(){let a=new e1({destinationIdentities:h,value:{case:"streamTrailer",value:new fu({streamId:e})}});yield k.sendDataPacket(a,e2.RELIABLE)})},abort(a){console.log("Sink error:",a)}}),m=()=>gS(this,void 0,void 0,function*(){yield n.close()});k.once(li.Closing,m);let n=new j7(l,f,()=>this.engine.off(li.Closing,m));return n})}sendFile(a,b){return gS(this,void 0,void 0,function*(){let c=crypto.randomUUID();return yield this._sendFile(c,a,b),{id:c}})}_sendFile(a,b,c){return gS(this,void 0,void 0,function*(){var d;let e=yield this.streamBytes({streamId:a,totalSize:b.size,name:b.name,mimeType:null!=(d=null==c?void 0:c.mimeType)?d:b.type,topic:null==c?void 0:c.topic,destinationIdentities:null==c?void 0:c.destinationIdentities}),f=b.stream().getReader();for(;;){let{done:a,value:b}=yield f.read();if(a)break;yield e.write(b)}return yield e.close(),e.info})}streamBytes(a){return gS(this,void 0,void 0,function*(){var b,c,d,e,f,g;let h=null!=(b=null==a?void 0:a.streamId)?b:crypto.randomUUID(),i=null==a?void 0:a.destinationIdentities,j={id:h,mimeType:null!=(c=null==a?void 0:a.mimeType)?c:"application/octet-stream",topic:null!=(d=null==a?void 0:a.topic)?d:"",timestamp:Date.now(),attributes:null==a?void 0:a.attributes,size:null==a?void 0:a.totalSize,name:null!=(e=null==a?void 0:a.name)?e:"unknown",encryptionType:(null==(f=this.engine.e2eeManager)?void 0:f.isDataChannelEncryptionEnabled)?eY.GCM:eY.NONE},k=new e1({destinationIdentities:i,value:{case:"streamHeader",value:new fs({totalLength:iU(null!=(g=j.size)?g:0),mimeType:j.mimeType,streamId:h,topic:j.topic,timestamp:iU(Date.now()),attributes:j.attributes,contentHeader:{case:"byteHeader",value:new fr({name:j.name})}})}});yield this.engine.sendDataPacket(k,e2.RELIABLE);let l=0,m=new du,n=this.engine,o=this.log;return new j8(new WritableStream({write(a){return gS(this,void 0,void 0,function*(){let b=yield m.lock(),c=0;try{for(;c<a.byteLength;){let b=a.slice(c,c+15e3),d=new e1({destinationIdentities:i,value:{case:"streamChunk",value:new ft({content:b,streamId:h,chunkIndex:iU(l)})}});yield n.sendDataPacket(d,e2.RELIABLE),l+=1,c+=b.byteLength}}finally{b()}})},close(){return gS(this,void 0,void 0,function*(){let a=new e1({destinationIdentities:i,value:{case:"streamTrailer",value:new fu({streamId:h})}});yield n.sendDataPacket(a,e2.RELIABLE)})},abort(a){o.error("Sink error:",a)}}),j)})}}class ka extends ik{constructor(a,b,c,d,e){super(a,c,e),this.sid=b,this.receiver=d}get isLocal(){return!1}setMuted(a){this.isMuted!==a&&(this.isMuted=a,this._mediaStreamTrack.enabled=!a,this.emit(a?lj.Muted:lj.Unmuted,this))}setMediaStream(a){this.mediaStream=a;let b=c=>{c.track===this._mediaStreamTrack&&(a.removeEventListener("removetrack",b),this.receiver&&"playoutDelayHint"in this.receiver&&(this.receiver.playoutDelayHint=void 0),this.receiver=void 0,this._currentBitrate=0,this.emit(lj.Ended,this))};a.addEventListener("removetrack",b)}start(){this.startMonitor(),super.enable()}stop(){this.stopMonitor(),super.disable()}getRTCStatsReport(){return gS(this,void 0,void 0,function*(){var a;if(null==(a=this.receiver)?void 0:a.getStats)return yield this.receiver.getStats()})}setPlayoutDelay(a){this.receiver?"playoutDelayHint"in this.receiver?this.receiver.playoutDelayHint=a:this.log.warn("Playout delay not supported in this browser"):this.log.warn("Cannot set playout delay, track already ended")}getPlayoutDelay(){if(this.receiver)if("playoutDelayHint"in this.receiver)return this.receiver.playoutDelayHint;else this.log.warn("Playout delay not supported in this browser");else this.log.warn("Cannot get playout delay, track already ended");return 0}startMonitor(){this.monitorInterval||(this.monitorInterval=setInterval(()=>this.monitorReceiver(),2e3)),"undefined"!=typeof RTCRtpReceiver&&"getSynchronizationSources"in RTCRtpReceiver&&this.registerTimeSyncUpdate()}registerTimeSyncUpdate(){let a=()=>{var b;this.timeSyncHandle=requestAnimationFrame(()=>a());let c=null==(b=this.receiver)?void 0:b.getSynchronizationSources()[0];if(c){let{timestamp:a,rtpTimestamp:b}=c;b&&this.rtpTimestamp!==b&&(this.emit(lj.TimeSyncUpdate,{timestamp:a,rtpTimestamp:b}),this.rtpTimestamp=b)}};a()}}class kb extends ka{constructor(a,b,c,d,e,f){super(a,b,ik.Kind.Audio,c,f),this.monitorReceiver=()=>gS(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}let a=yield this.getReceiverStats();a&&this.prevStats&&this.receiver&&(this._currentBitrate=jE(a,this.prevStats)),this.prevStats=a}),this.audioContext=d,this.webAudioPluginNodes=[],e&&(this.sinkId=e.deviceId)}setVolume(a){var b;for(let c of this.attachedElements)this.audioContext?null==(b=this.gainNode)||b.gain.setTargetAtTime(a,0,.1):c.volume=a;iA()&&this._mediaStreamTrack._setVolume(a),this.elementVolume=a}getVolume(){if(this.elementVolume)return this.elementVolume;if(iA())return 1;let a=0;return this.attachedElements.forEach(b=>{b.volume>a&&(a=b.volume)}),a}setSinkId(a){return gS(this,void 0,void 0,function*(){this.sinkId=a,yield Promise.all(this.attachedElements.map(b=>{if(it(b))return b.setSinkId(a)}))})}attach(a){let b=0===this.attachedElements.length;return a?super.attach(a):a=super.attach(),this.sinkId&&it(a)&&a.setSinkId(this.sinkId).catch(a=>{this.log.error("Failed to set sink id on remote audio track",a,this.logContext)}),this.audioContext&&b&&(this.log.debug("using audio context mapping",this.logContext),this.connectWebAudio(this.audioContext,a),a.volume=0,a.muted=!0),this.elementVolume&&this.setVolume(this.elementVolume),a}detach(a){let b;return a?(b=super.detach(a),this.audioContext&&(this.attachedElements.length>0?this.connectWebAudio(this.audioContext,this.attachedElements[0]):this.disconnectWebAudio())):(b=super.detach(),this.disconnectWebAudio()),b}setAudioContext(a){this.audioContext=a,a&&this.attachedElements.length>0?this.connectWebAudio(a,this.attachedElements[0]):a||this.disconnectWebAudio()}setWebAudioPlugins(a){this.webAudioPluginNodes=a,this.attachedElements.length>0&&this.audioContext&&this.connectWebAudio(this.audioContext,this.attachedElements[0])}connectWebAudio(a,b){this.disconnectWebAudio(),this.sourceNode=a.createMediaStreamSource(b.srcObject);let c=this.sourceNode;this.webAudioPluginNodes.forEach(a=>{c.connect(a),c=a}),this.gainNode=a.createGain(),c.connect(this.gainNode),this.gainNode.connect(a.destination),this.elementVolume&&this.gainNode.gain.setTargetAtTime(this.elementVolume,0,.1),"running"!==a.state&&a.resume().then(()=>{"running"!==a.state&&this.emit(lj.AudioPlaybackFailed,Error("Audio Context couldn't be started automatically"))}).catch(a=>{this.emit(lj.AudioPlaybackFailed,a)})}disconnectWebAudio(){var a,b;null==(a=this.gainNode)||a.disconnect(),null==(b=this.sourceNode)||b.disconnect(),this.gainNode=void 0,this.sourceNode=void 0}getReceiverStats(){return gS(this,void 0,void 0,function*(){let a;if(this.receiver&&this.receiver.getStats)return(yield this.receiver.getStats()).forEach(b=>{"inbound-rtp"===b.type&&(a={type:"audio",streamId:b.id,timestamp:b.timestamp,jitter:b.jitter,bytesReceived:b.bytesReceived,concealedSamples:b.concealedSamples,concealmentEvents:b.concealmentEvents,silentConcealedSamples:b.silentConcealedSamples,silentConcealmentEvents:b.silentConcealmentEvents,totalAudioEnergy:b.totalAudioEnergy,totalSamplesDuration:b.totalSamplesDuration})}),a})}}class kc extends ka{constructor(a,b,c,d,e){super(a,b,ik.Kind.Video,c,e),this.elementInfos=[],this.monitorReceiver=()=>gS(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}let a=yield this.getReceiverStats();a&&this.prevStats&&this.receiver&&(this._currentBitrate=jE(a,this.prevStats)),this.prevStats=a}),this.debouncedHandleResize=jm(()=>{this.updateDimensions()},100),this.adaptiveStreamSettings=d}get isAdaptiveStream(){return void 0!==this.adaptiveStreamSettings}setStreamState(a){super.setStreamState(a),this.log.debug("setStreamState",a),this.isAdaptiveStream&&a===ik.StreamState.Active&&this.updateVisibility()}get mediaStreamTrack(){return this._mediaStreamTrack}setMuted(a){super.setMuted(a),this.attachedElements.forEach(b=>{a?im(this._mediaStreamTrack,b):il(this._mediaStreamTrack,b)})}attach(a){if(a?super.attach(a):a=super.attach(),this.adaptiveStreamSettings&&void 0===this.elementInfos.find(b=>b.element===a)){let b=new kd(a);this.observeElementInfo(b)}return a}observeElementInfo(a){this.adaptiveStreamSettings&&void 0===this.elementInfos.find(b=>b===a)?(a.handleResize=()=>{this.debouncedHandleResize()},a.handleVisibilityChanged=()=>{this.updateVisibility()},this.elementInfos.push(a),a.observe(),this.debouncedHandleResize(),this.updateVisibility()):this.log.warn("visibility resize observer not triggered",this.logContext)}stopObservingElementInfo(a){if(!this.isAdaptiveStream)return void this.log.warn("stopObservingElementInfo ignored",this.logContext);for(let b of this.elementInfos.filter(b=>b===a))b.stopObserving();this.elementInfos=this.elementInfos.filter(b=>b!==a),this.updateVisibility(),this.debouncedHandleResize()}detach(a){let b=[];if(a)return this.stopObservingElement(a),super.detach(a);for(let a of b=super.detach())this.stopObservingElement(a);return b}getDecoderImplementation(){var a;return null==(a=this.prevStats)?void 0:a.decoderImplementation}getReceiverStats(){return gS(this,void 0,void 0,function*(){let a;if(!this.receiver||!this.receiver.getStats)return;let b=yield this.receiver.getStats(),c="",d=new Map;return b.forEach(b=>{"inbound-rtp"===b.type?(c=b.codecId,a={type:"video",streamId:b.id,framesDecoded:b.framesDecoded,framesDropped:b.framesDropped,framesReceived:b.framesReceived,packetsReceived:b.packetsReceived,packetsLost:b.packetsLost,frameWidth:b.frameWidth,frameHeight:b.frameHeight,pliCount:b.pliCount,firCount:b.firCount,nackCount:b.nackCount,jitter:b.jitter,timestamp:b.timestamp,bytesReceived:b.bytesReceived,decoderImplementation:b.decoderImplementation}):"codec"===b.type&&d.set(b.id,b)}),a&&""!==c&&d.get(c)&&(a.mimeType=d.get(c).mimeType),a})}stopObservingElement(a){for(let b of this.elementInfos.filter(b=>b.element===a))this.stopObservingElementInfo(b)}handleAppVisibilityChanged(){let a=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return gS(this,void 0,void 0,function*(){yield a.handleAppVisibilityChanged.call(this),this.isAdaptiveStream&&this.updateVisibility()})}updateVisibility(a){var b,c;let d=this.elementInfos.reduce((a,b)=>Math.max(a,b.visibilityChangedAt||0),0),e=(null==(c=null==(b=this.adaptiveStreamSettings)?void 0:b.pauseVideoInBackground)||!!c)&&this.isInBackground,f=this.elementInfos.some(a=>a.pictureInPicture),g=this.elementInfos.some(a=>a.visible)&&!e||f;if(this.lastVisible!==g||a){if(!g&&Date.now()-d<100)return void h0.setTimeout(()=>{this.updateVisibility()},100);this.lastVisible=g,this.emit(lj.VisibilityChanged,g,this)}}updateDimensions(){var a,b;let c=0,d=0,e=this.getPixelDensity();for(let a of this.elementInfos){let b=a.width()*e,f=a.height()*e;b+f>c+d&&(c=b,d=f)}((null==(a=this.lastDimensions)?void 0:a.width)!==c||(null==(b=this.lastDimensions)?void 0:b.height)!==d)&&(this.lastDimensions={width:c,height:d},this.emit(lj.VideoDimensionsChanged,this.lastDimensions,this))}getPixelDensity(){var a;let b=null==(a=this.adaptiveStreamSettings)?void 0:a.pixelDensity;return"screen"===b?iF():b?b:iF()>2?2:1}}class kd{get visible(){return this.isPiP||this.isIntersecting}get pictureInPicture(){return this.isPiP}constructor(a,b){this.onVisibilityChanged=a=>{var b;let{target:c,isIntersecting:d}=a;c===this.element&&(this.isIntersecting=d,this.isPiP=ke(this.element),this.visibilityChangedAt=Date.now(),null==(b=this.handleVisibilityChanged)||b.call(this))},this.onEnterPiP=()=>{var a,b,c;null==(b=null==(a=window.documentPictureInPicture)?void 0:a.window)||b.addEventListener("pagehide",this.onLeavePiP),this.isPiP=ke(this.element),null==(c=this.handleVisibilityChanged)||c.call(this)},this.onLeavePiP=()=>{var a;this.isPiP=ke(this.element),null==(a=this.handleVisibilityChanged)||a.call(this)},this.element=a,this.isIntersecting=null!=b?b:kf(a),this.isPiP=iz()&&ke(a),this.visibilityChangedAt=0}width(){return this.element.clientWidth}height(){return this.element.clientHeight}observe(){var a,b,c;this.isIntersecting=kf(this.element),this.isPiP=ke(this.element),this.element.handleResize=()=>{var a;null==(a=this.handleResize)||a.call(this)},this.element.handleVisibilityChanged=this.onVisibilityChanged,iM().observe(this.element),iK().observe(this.element),this.element.addEventListener("enterpictureinpicture",this.onEnterPiP),this.element.addEventListener("leavepictureinpicture",this.onLeavePiP),null==(a=window.documentPictureInPicture)||a.addEventListener("enter",this.onEnterPiP),null==(c=null==(b=window.documentPictureInPicture)?void 0:b.window)||c.addEventListener("pagehide",this.onLeavePiP)}stopObserving(){var a,b,c,d,e;null==(a=iM())||a.unobserve(this.element),null==(b=iK())||b.unobserve(this.element),this.element.removeEventListener("enterpictureinpicture",this.onEnterPiP),this.element.removeEventListener("leavepictureinpicture",this.onLeavePiP),null==(c=window.documentPictureInPicture)||c.removeEventListener("enter",this.onEnterPiP),null==(e=null==(d=window.documentPictureInPicture)?void 0:d.window)||e.removeEventListener("pagehide",this.onLeavePiP)}}function ke(a){var b,c;return document.pictureInPictureElement===a||null!=(b=window.documentPictureInPicture)&&!!b.window&&kf(a,null==(c=window.documentPictureInPicture)?void 0:c.window)}function kf(a,b){let c=b||window,d=a.offsetTop,e=a.offsetLeft,f=a.offsetWidth,g=a.offsetHeight,{hidden:h}=a,{display:i}=getComputedStyle(a);for(;a.offsetParent;)d+=(a=a.offsetParent).offsetTop,e+=a.offsetLeft;return d<c.pageYOffset+c.innerHeight&&e<c.pageXOffset+c.innerWidth&&d+g>c.pageYOffset&&e+f>c.pageXOffset&&!h&&"none"!==i}class kg extends gV.EventEmitter{constructor(a,b,c,d){var e;super(),this.metadataMuted=!1,this.encryption=eY.NONE,this.log=gO,this.handleMuted=()=>{this.emit(lj.Muted)},this.handleUnmuted=()=>{this.emit(lj.Unmuted)},this.log=gP(null!=(e=null==d?void 0:d.loggerName)?e:la.Publication),this.loggerContextCb=this.loggerContextCb,this.setMaxListeners(100),this.kind=a,this.trackSid=b,this.trackName=c,this.source=ik.Source.Unknown}setTrack(a){this.track&&(this.track.off(lj.Muted,this.handleMuted),this.track.off(lj.Unmuted,this.handleUnmuted)),this.track=a,a&&(a.on(lj.Muted,this.handleMuted),a.on(lj.Unmuted,this.handleUnmuted))}get logContext(){var a;return Object.assign(Object.assign({},null==(a=this.loggerContextCb)?void 0:a.call(this)),ig(this))}get isMuted(){return this.metadataMuted}get isEnabled(){return!0}get isSubscribed(){return void 0!==this.track}get isEncrypted(){return this.encryption!==eY.NONE}get audioTrack(){if(iW(this.track))return this.track}get videoTrack(){if(iX(this.track))return this.track}updateInfo(a){this.trackSid=a.sid,this.trackName=a.name,this.source=ik.sourceFromProto(a.source),this.mimeType=a.mimeType,this.kind===ik.Kind.Video&&a.width>0&&(this.dimensions={width:a.width,height:a.height},this.simulcasted=a.simulcast),this.encryption=a.encryption,this.trackInfo=a,this.log.debug("update publication info",Object.assign(Object.assign({},this.logContext),{info:a}))}}(k0=(k_=kg||(kg={})).SubscriptionStatus||(k_.SubscriptionStatus={})).Desired="desired",k0.Subscribed="subscribed",k0.Unsubscribed="unsubscribed",(k1=k_.PermissionStatus||(k_.PermissionStatus={})).Allowed="allowed",k1.NotAllowed="not_allowed";class kh extends kg{get isUpstreamPaused(){var a;return null==(a=this.track)?void 0:a.isUpstreamPaused}constructor(a,b,c,d){super(a,b.sid,b.name,d),this.track=void 0,this.handleTrackEnded=()=>{this.emit(lj.Ended)},this.handleCpuConstrained=()=>{this.track&&iX(this.track)&&this.emit(lj.CpuConstrained,this.track)},this.updateInfo(b),this.setTrack(c)}setTrack(a){this.track&&(this.track.off(lj.Ended,this.handleTrackEnded),this.track.off(lj.CpuConstrained,this.handleCpuConstrained)),super.setTrack(a),a&&(a.on(lj.Ended,this.handleTrackEnded),a.on(lj.CpuConstrained,this.handleCpuConstrained))}get isMuted(){return this.track?this.track.isMuted:super.isMuted}get audioTrack(){return super.audioTrack}get videoTrack(){return super.videoTrack}get isLocal(){return!0}mute(){return gS(this,void 0,void 0,function*(){var a;return null==(a=this.track)?void 0:a.mute()})}unmute(){return gS(this,void 0,void 0,function*(){var a;return null==(a=this.track)?void 0:a.unmute()})}pauseUpstream(){return gS(this,void 0,void 0,function*(){var a;yield null==(a=this.track)?void 0:a.pauseUpstream()})}resumeUpstream(){return gS(this,void 0,void 0,function*(){var a;yield null==(a=this.track)?void 0:a.resumeUpstream()})}getTrackFeatures(){var a;if(!iW(this.track))return[];{let b=this.track.getSourceTrackSettings(),c=new Set;return b.autoGainControl&&c.add(eQ.TF_AUTO_GAIN_CONTROL),b.echoCancellation&&c.add(eQ.TF_ECHO_CANCELLATION),b.noiseSuppression&&c.add(eQ.TF_NOISE_SUPPRESSION),b.channelCount&&b.channelCount>1&&c.add(eQ.TF_STEREO),(null==(a=this.options)?void 0:a.dtx)||c.add(eQ.TF_NO_DTX),this.track.enhancedNoiseCancellation&&c.add(eQ.TF_ENHANCED_NOISE_CANCELLATION),Array.from(c.values())}}}function ki(a,b){return gS(this,void 0,void 0,function*(){null!=a||(a={});let c=!1,{audioProcessor:d,videoProcessor:e,optionsWithoutProcessor:f}=ih(a),g=f.audio,h=f.video;if(d&&"object"==typeof f.audio&&(f.audio.processor=d),e&&"object"==typeof f.video&&(f.video.processor=e),a.audio&&"object"==typeof f.audio&&"string"==typeof f.audio.deviceId){let a=f.audio.deviceId;f.audio.deviceId={exact:a},c=!0,g=Object.assign(Object.assign({},f.audio),{deviceId:{ideal:a}})}if(f.video&&"object"==typeof f.video&&"string"==typeof f.video.deviceId){let a=f.video.deviceId;f.video.deviceId={exact:a},c=!0,h=Object.assign(Object.assign({},f.video),{deviceId:{ideal:a}})}!0===f.audio?f.audio={deviceId:"default"}:"object"==typeof f.audio&&null!==f.audio&&(f.audio=Object.assign(Object.assign({},f.audio),{deviceId:f.audio.deviceId||"default"})),!0===f.video?f.video={deviceId:"default"}:"object"!=typeof f.video||f.video.deviceId||(f.video.deviceId="default");let i=h8(f,jv,jw),j=ia(i),k=navigator.mediaDevices.getUserMedia(j);f.audio&&(i8.userMediaPromiseMap.set("audioinput",k),k.catch(()=>i8.userMediaPromiseMap.delete("audioinput"))),f.video&&(i8.userMediaPromiseMap.set("videoinput",k),k.catch(()=>i8.userMediaPromiseMap.delete("videoinput")));try{let a=yield k;return yield Promise.all(a.getTracks().map(c=>gS(this,void 0,void 0,function*(){let f,g="audio"===c.kind,h=g?i.audio:i.video;"boolean"!=typeof h&&h||(h={});let k=g?j.audio:j.video;"boolean"!=typeof k&&(f=k);let l=c.getSettings().deviceId;(null==f?void 0:f.deviceId)&&iQ(f.deviceId)!==l?f.deviceId=l:f||(f={deviceId:l});let m=function(a,b,c){switch(a.kind){case"audio":return new jJ(a,b,!1,void 0,c);case"video":return new jV(a,b,!1,c);default:throw new hU("unsupported track type: ".concat(a.kind))}}(c,f,b);return m.kind===ik.Kind.Video?m.source=ik.Source.Camera:m.kind===ik.Kind.Audio&&(m.source=ik.Source.Microphone),m.mediaStream=a,iW(m)&&d?yield m.setProcessor(d):iX(m)&&e&&(yield m.setProcessor(e)),m})))}catch(d){if(!c)throw d;return ki(Object.assign(Object.assign({},a),{audio:g,video:h}),b)}})}(k2=lB||(lB={})).Excellent="excellent",k2.Good="good",k2.Poor="poor",k2.Lost="lost",k2.Unknown="unknown";class kj extends gV.EventEmitter{get logContext(){var a,b;return Object.assign({},null==(b=null==(a=this.loggerOptions)?void 0:a.loggerContextCb)?void 0:b.call(a))}get isEncrypted(){return this.trackPublications.size>0&&Array.from(this.trackPublications.values()).every(a=>a.isEncrypted)}get isAgent(){var a;return(null==(a=this.permissions)?void 0:a.agent)||this.kind===eW.AGENT}get isActive(){var a;return(null==(a=this.participantInfo)?void 0:a.state)===eV.ACTIVE}get kind(){return this._kind}get attributes(){return Object.freeze(Object.assign({},this._attributes))}constructor(a,b,c,d,e,f){var g;let h=arguments.length>6&&void 0!==arguments[6]?arguments[6]:eW.STANDARD;super(),this.audioLevel=0,this.isSpeaking=!1,this._connectionQuality=lB.Unknown,this.log=gO,this.log=gP(null!=(g=null==f?void 0:f.loggerName)?g:la.Participant),this.loggerOptions=f,this.setMaxListeners(100),this.sid=a,this.identity=b,this.name=c,this.metadata=d,this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.trackPublications=new Map,this._kind=h,this._attributes=null!=e?e:{}}getTrackPublications(){return Array.from(this.trackPublications.values())}getTrackPublication(a){for(let[,b]of this.trackPublications)if(b.source===a)return b}getTrackPublicationByName(a){for(let[,b]of this.trackPublications)if(b.trackName===a)return b}waitUntilActive(){return this.isActive?Promise.resolve():(this.activeFuture||(this.activeFuture=new iP,this.once(lh.Active,()=>{var a,b;null==(b=null==(a=this.activeFuture)?void 0:a.resolve)||b.call(a),this.activeFuture=void 0})),this.activeFuture.promise)}get connectionQuality(){return this._connectionQuality}get isCameraEnabled(){var a;let b=this.getTrackPublication(ik.Source.Camera);return!(null==(a=null==b?void 0:b.isMuted)||a)}get isMicrophoneEnabled(){var a;let b=this.getTrackPublication(ik.Source.Microphone);return!(null==(a=null==b?void 0:b.isMuted)||a)}get isScreenShareEnabled(){return!!this.getTrackPublication(ik.Source.ScreenShare)}get isLocal(){return!1}get joinedAt(){return this.participantInfo?new Date(1e3*Number.parseInt(this.participantInfo.joinedAt.toString())):new Date}updateInfo(a){var b;return(!this.participantInfo||this.participantInfo.sid!==a.sid||!(this.participantInfo.version>a.version))&&(this.identity=a.identity,this.sid=a.sid,this._setName(a.name),this._setMetadata(a.metadata),this._setAttributes(a.attributes),a.state===eV.ACTIVE&&(null==(b=this.participantInfo)?void 0:b.state)!==eV.ACTIVE&&this.emit(lh.Active),a.permission&&this.setPermissions(a.permission),this.participantInfo=a,!0)}_setMetadata(a){let b=this.metadata!==a,c=this.metadata;this.metadata=a,b&&this.emit(lh.ParticipantMetadataChanged,c)}_setName(a){let b=this.name!==a;this.name=a,b&&this.emit(lh.ParticipantNameChanged,a)}_setAttributes(a){let b=function(a,b){var c;void 0===a&&(a={}),void 0===b&&(b={});let d=[...Object.keys(b),...Object.keys(a)],e={};for(let f of d)a[f]!==b[f]&&(e[f]=null!=(c=b[f])?c:"");return e}(this.attributes,a);this._attributes=a,Object.keys(b).length>0&&this.emit(lh.AttributesChanged,b)}setPermissions(a){var b,c,d,e,f,g;let h=this.permissions,i=a.canPublish!==(null==(b=this.permissions)?void 0:b.canPublish)||a.canSubscribe!==(null==(c=this.permissions)?void 0:c.canSubscribe)||a.canPublishData!==(null==(d=this.permissions)?void 0:d.canPublishData)||a.hidden!==(null==(e=this.permissions)?void 0:e.hidden)||a.recorder!==(null==(f=this.permissions)?void 0:f.recorder)||a.canPublishSources.length!==this.permissions.canPublishSources.length||a.canPublishSources.some((a,b)=>{var c;return a!==(null==(c=this.permissions)?void 0:c.canPublishSources[b])})||a.canSubscribeMetrics!==(null==(g=this.permissions)?void 0:g.canSubscribeMetrics);return this.permissions=a,i&&this.emit(lh.ParticipantPermissionsChanged,h),i}setIsSpeaking(a){a!==this.isSpeaking&&(this.isSpeaking=a,a&&(this.lastSpokeAt=new Date),this.emit(lh.IsSpeakingChanged,a))}setConnectionQuality(a){let b=this._connectionQuality;this._connectionQuality=function(a){switch(a){case eL.EXCELLENT:return lB.Excellent;case eL.GOOD:return lB.Good;case eL.POOR:return lB.Poor;case eL.LOST:return lB.Lost;default:return lB.Unknown}}(a),b!==this._connectionQuality&&this.emit(lh.ConnectionQualityChanged,this._connectionQuality)}setDisconnected(){var a,b;this.activeFuture&&(null==(b=(a=this.activeFuture).reject)||b.call(a,Error("Participant disconnected")),this.activeFuture=void 0)}setAudioContext(a){this.audioContext=a,this.audioTrackPublications.forEach(b=>iW(b.track)&&b.track.setAudioContext(a))}addTrackPublication(a){switch(a.on(lj.Muted,()=>{this.emit(lh.TrackMuted,a)}),a.on(lj.Unmuted,()=>{this.emit(lh.TrackUnmuted,a)}),a.track&&(a.track.sid=a.trackSid),this.trackPublications.set(a.trackSid,a),a.kind){case ik.Kind.Audio:this.audioTrackPublications.set(a.trackSid,a);break;case ik.Kind.Video:this.videoTrackPublications.set(a.trackSid,a)}}}class kk extends kj{constructor(a,b,c,d,e,f){super(a,b,void 0,void 0,void 0,{loggerName:d.loggerName,loggerContextCb:()=>this.engine.logContext}),this.pendingPublishing=new Set,this.pendingPublishPromises=new Map,this.participantTrackPermissions=[],this.allParticipantsAllowedToSubscribe=!0,this.encryptionType=eY.NONE,this.enabledPublishVideoCodecs=[],this.pendingAcks=new Map,this.pendingResponses=new Map,this.handleReconnecting=()=>{this.reconnectFuture||(this.reconnectFuture=new iP)},this.handleReconnected=()=>{var a,b;null==(b=null==(a=this.reconnectFuture)?void 0:a.resolve)||b.call(a),this.reconnectFuture=void 0,this.updateTrackSubscriptionPermissions()},this.handleClosing=()=>{var a,b,c,d,e,f;this.reconnectFuture&&(this.reconnectFuture.promise.catch(a=>this.log.warn(a.message,this.logContext)),null==(b=null==(a=this.reconnectFuture)?void 0:a.reject)||b.call(a,Error("Got disconnected during reconnection attempt")),this.reconnectFuture=void 0),this.signalConnectedFuture&&(null==(d=(c=this.signalConnectedFuture).reject)||d.call(c,Error("Got disconnected without signal connected")),this.signalConnectedFuture=void 0),null==(f=null==(e=this.activeAgentFuture)?void 0:e.reject)||f.call(e,Error("Got disconnected without active agent present")),this.activeAgentFuture=void 0,this.firstActiveAgent=void 0},this.handleSignalConnected=a=>{var b,c;a.participant&&this.updateInfo(a.participant),this.signalConnectedFuture||(this.signalConnectedFuture=new iP),null==(c=(b=this.signalConnectedFuture).resolve)||c.call(b)},this.handleSignalRequestResponse=a=>{let{requestId:b,reason:c,message:d}=a,e=this.pendingSignalRequests.get(b);e&&(c!==gE.OK&&e.reject(new hZ(d,c)),this.pendingSignalRequests.delete(b))},this.handleDataPacket=a=>{switch(a.value.case){case"rpcResponse":let b=a.value.value,c=null,d=null;"payload"===b.value.case?c=b.value.value:"error"===b.value.case&&(d=jB.fromProto(b.value.value)),this.handleIncomingRpcResponse(b.requestId,c,d);break;case"rpcAck":let e=a.value.value;this.handleIncomingRpcAck(e.requestId)}},this.updateTrackSubscriptionPermissions=()=>{this.log.debug("updating track subscription permissions",Object.assign(Object.assign({},this.logContext),{allParticipantsAllowed:this.allParticipantsAllowedToSubscribe,participantTrackPermissions:this.participantTrackPermissions})),this.engine.client.sendUpdateSubscriptionPermissions(this.allParticipantsAllowedToSubscribe,this.participantTrackPermissions.map(a=>(function(a){var b,c,d;if(!a.participantSid&&!a.participantIdentity)throw Error("Invalid track permission, must provide at least one of participantIdentity and participantSid");return new gq({participantIdentity:null!=(b=a.participantIdentity)?b:"",participantSid:null!=(c=a.participantSid)?c:"",allTracks:null!=(d=a.allowAll)&&d,trackSids:a.allowedTrackSids||[]})})(a)))},this.onTrackUnmuted=a=>{this.onTrackMuted(a,a.isUpstreamPaused)},this.onTrackMuted=(a,b)=>{(void 0===b&&(b=!0),a.sid)?this.engine.updateMuteStatus(a.sid,b):this.log.error("could not update mute status for unpublished track",Object.assign(Object.assign({},this.logContext),ig(a)))},this.onTrackUpstreamPaused=a=>{this.log.debug("upstream paused",Object.assign(Object.assign({},this.logContext),ig(a))),this.onTrackMuted(a,!0)},this.onTrackUpstreamResumed=a=>{this.log.debug("upstream resumed",Object.assign(Object.assign({},this.logContext),ig(a))),this.onTrackMuted(a,a.isMuted)},this.onTrackFeatureUpdate=a=>{let b=this.audioTrackPublications.get(a.sid);b?this.engine.client.sendUpdateLocalAudioTrack(b.trackSid,b.getTrackFeatures()):this.log.warn("Could not update local audio track settings, missing publication for track ".concat(a.sid),this.logContext)},this.onTrackCpuConstrained=(a,b)=>{this.log.debug("track cpu constrained",Object.assign(Object.assign({},this.logContext),ig(b))),this.emit(lh.LocalTrackCpuConstrained,a,b)},this.handleSubscribedQualityUpdate=a=>gS(this,void 0,void 0,function*(){if(!(null==(h=this.roomOptions)?void 0:h.dynacast))return;let b=this.videoTrackPublications.get(a.trackSid);if(!b)return void this.log.warn("received subscribed quality update for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:a.trackSid}));if(!b.videoTrack)return;let c=yield b.videoTrack.setPublishingCodecs(a.subscribedCodecs);try{for(var d,e,f,g,h,i,j=!0,k=gT(c);!(d=(i=yield k.next()).done);j=!0)g=i.value,j=!1,h4(g)&&(this.log.debug("publish ".concat(g," for ").concat(b.videoTrack.sid),Object.assign(Object.assign({},this.logContext),ig(b))),yield this.publishAdditionalCodecForTrack(b.videoTrack,g,b.options))}catch(a){e={error:a}}finally{try{!j&&!d&&(f=k.return)&&(yield f.call(k))}finally{if(e)throw e.error}}}),this.handleLocalTrackUnpublished=a=>{let b=this.trackPublications.get(a.trackSid);b?this.unpublishTrack(b.track):this.log.warn("received unpublished event for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:a.trackSid}))},this.handleTrackEnded=a=>gS(this,void 0,void 0,function*(){if(a.source===ik.Source.ScreenShare||a.source===ik.Source.ScreenShareAudio)this.log.debug("unpublishing local track due to TrackEnded",Object.assign(Object.assign({},this.logContext),ig(a))),this.unpublishTrack(a);else if(a.isUserProvided)yield a.mute();else if(iZ(a)||iY(a))try{if(iz())try{let b=yield null==navigator?void 0:navigator.permissions.query({name:a.source===ik.Source.Camera?"camera":"microphone"});if(b&&"denied"===b.state)throw this.log.warn("user has revoked access to ".concat(a.source),Object.assign(Object.assign({},this.logContext),ig(a))),b.onchange=()=>{"denied"!==b.state&&(a.isMuted||a.restartTrack(),b.onchange=null)},Error("GetUserMedia Permission denied")}catch(a){}a.isMuted||(this.log.debug("track ended, attempting to use a different device",Object.assign(Object.assign({},this.logContext),ig(a))),iZ(a)?yield a.restartTrack({deviceId:"default"}):yield a.restartTrack())}catch(b){this.log.warn("could not restart track, muting instead",Object.assign(Object.assign({},this.logContext),ig(a))),yield a.mute()}}),this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.trackPublications=new Map,this.engine=c,this.roomOptions=d,this.setupEngine(c),this.activeDeviceMap=new Map([["audioinput","default"],["videoinput","default"],["audiooutput","default"]]),this.pendingSignalRequests=new Map,this.rpcHandlers=e,this.roomOutgoingDataStreamManager=f}get lastCameraError(){return this.cameraError}get lastMicrophoneError(){return this.microphoneError}get isE2EEEnabled(){return this.encryptionType!==eY.NONE}getTrackPublication(a){let b=super.getTrackPublication(a);if(b)return b}getTrackPublicationByName(a){let b=super.getTrackPublicationByName(a);if(b)return b}setupEngine(a){var b;this.engine=a,this.engine.on(li.RemoteMute,(a,b)=>{let c=this.trackPublications.get(a);c&&c.track&&(b?c.mute():c.unmute())}),(null==(b=this.signalConnectedFuture)?void 0:b.isResolved)&&(this.signalConnectedFuture=void 0),this.engine.on(li.Connected,this.handleReconnected).on(li.SignalConnected,this.handleSignalConnected).on(li.SignalRestarted,this.handleReconnected).on(li.SignalResumed,this.handleReconnected).on(li.Restarting,this.handleReconnecting).on(li.Resuming,this.handleReconnecting).on(li.LocalTrackUnpublished,this.handleLocalTrackUnpublished).on(li.SubscribedQualityUpdate,this.handleSubscribedQualityUpdate).on(li.Closing,this.handleClosing).on(li.SignalRequestResponse,this.handleSignalRequestResponse).on(li.DataPacketReceived,this.handleDataPacket)}setMetadata(a){return gS(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({metadata:a})})}setName(a){return gS(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({name:a})})}setAttributes(a){return gS(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({attributes:a})})}requestMetadataUpdate(a){return gS(this,arguments,void 0,function(a){var b=this;let{metadata:c,name:d,attributes:e}=a;return function*(){return new Promise((a,f)=>gS(b,void 0,void 0,function*(){var b,g;try{let h=!1,i=yield this.engine.client.sendUpdateLocalMetadata(null!=(b=null!=c?c:this.metadata)?b:"",null!=(g=null!=d?d:this.name)?g:"",e),j=performance.now();for(this.pendingSignalRequests.set(i,{resolve:a,reject:a=>{f(a),h=!0},values:{name:d,metadata:c,attributes:e}});performance.now()-j<5e3&&!h;){if((!d||this.name===d)&&(!c||this.metadata===c)&&(!e||Object.entries(e).every(a=>{let[b,c]=a;return this.attributes[b]===c||""===c&&!this.attributes[b]}))){this.pendingSignalRequests.delete(i),a();return}yield ip(50)}f(new hZ("Request to update local metadata timed out","TimeoutError"))}catch(a){a instanceof Error&&f(a)}}))}()})}setCameraEnabled(a,b,c){return this.setTrackEnabled(ik.Source.Camera,a,b,c)}setMicrophoneEnabled(a,b,c){return this.setTrackEnabled(ik.Source.Microphone,a,b,c)}setScreenShareEnabled(a,b,c){return this.setTrackEnabled(ik.Source.ScreenShare,a,b,c)}setE2EEEnabled(a){return gS(this,void 0,void 0,function*(){this.encryptionType=a?eY.GCM:eY.NONE,yield this.republishAllTracks(void 0,!1)})}setTrackEnabled(a,b,c,d){return gS(this,void 0,void 0,function*(){this.log.debug("setTrackEnabled",Object.assign(Object.assign({},this.logContext),{source:a,enabled:b})),this.republishPromise&&(yield this.republishPromise);let e=this.getTrackPublication(a);if(b)if(e)yield e.unmute();else{let b;if(this.pendingPublishing.has(a)){let b=yield this.waitForPendingPublicationOfSource(a);return b||this.log.info("waiting for pending publication promise timed out",Object.assign(Object.assign({},this.logContext),{source:a})),yield null==b?void 0:b.unmute(),b}this.pendingPublishing.add(a);try{switch(a){case ik.Source.Camera:b=yield this.createTracks({video:null==c||c});break;case ik.Source.Microphone:b=yield this.createTracks({audio:null==c||c});break;case ik.Source.ScreenShare:b=yield this.createScreenTracks(Object.assign({},c));break;default:throw new hU(a)}}catch(c){throw null==b||b.forEach(a=>{a.stop()}),c instanceof Error&&this.emit(lh.MediaDevicesError,c,id(a)),this.pendingPublishing.delete(a),c}for(let d of b){let b=Object.assign(Object.assign({},this.roomOptions.publishDefaults),c);a===ik.Source.Microphone&&iW(d)&&b.preConnectBuffer&&(this.log.info("starting preconnect buffer for microphone",Object.assign({},this.logContext)),d.startPreConnectBuffer())}try{let a=[];for(let c of b)this.log.info("publishing track",Object.assign(Object.assign({},this.logContext),ig(c))),a.push(this.publishTrack(c,d));let c=yield Promise.all(a);[e]=c}catch(a){throw null==b||b.forEach(a=>{a.stop()}),a}finally{this.pendingPublishing.delete(a)}}else if(!(null==e?void 0:e.track)&&this.pendingPublishing.has(a)&&((e=yield this.waitForPendingPublicationOfSource(a))||this.log.info("waiting for pending publication promise timed out",Object.assign(Object.assign({},this.logContext),{source:a}))),e&&e.track)if(a===ik.Source.ScreenShare){e=yield this.unpublishTrack(e.track);let a=this.getTrackPublication(ik.Source.ScreenShareAudio);a&&a.track&&this.unpublishTrack(a.track)}else yield e.mute();return e})}enableCameraAndMicrophone(){return gS(this,void 0,void 0,function*(){if(!(this.pendingPublishing.has(ik.Source.Camera)||this.pendingPublishing.has(ik.Source.Microphone))){this.pendingPublishing.add(ik.Source.Camera),this.pendingPublishing.add(ik.Source.Microphone);try{let a=yield this.createTracks({audio:!0,video:!0});yield Promise.all(a.map(a=>this.publishTrack(a)))}finally{this.pendingPublishing.delete(ik.Source.Camera),this.pendingPublishing.delete(ik.Source.Microphone)}}})}createTracks(a){return gS(this,void 0,void 0,function*(){var b,c;null!=a||(a={});let d=h8(a,null==(b=this.roomOptions)?void 0:b.audioCaptureDefaults,null==(c=this.roomOptions)?void 0:c.videoCaptureDefaults);try{return(yield ki(d,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext})).map(a=>(iW(a)&&(this.microphoneError=void 0,a.setAudioContext(this.audioContext),a.source=ik.Source.Microphone,this.emit(lh.AudioStreamAcquired)),iX(a)&&(this.cameraError=void 0,a.source=ik.Source.Camera),a))}catch(b){throw b instanceof Error&&(a.audio&&(this.microphoneError=b),a.video&&(this.cameraError=b)),b}})}createScreenTracks(a){return gS(this,void 0,void 0,function*(){var b,c,d;let e,f;if(void 0===a&&(a={}),void 0===navigator.mediaDevices.getDisplayMedia)throw new hT("getDisplayMedia not supported");void 0!==a.resolution||(null==(e=hN())?void 0:e.name)==="Safari"&&e.version.startsWith("17.")||(null==e?void 0:e.os)==="iOS"&&(null==e?void 0:e.osVersion)&&iG(e.osVersion,"17")>=0||(a.resolution=h7.h1080fps30.resolution);let g=(f=null==(c=(b=a).video)||c,b.resolution&&b.resolution.width>0&&b.resolution.height>0&&(f="boolean"==typeof f?{}:f,f=iw()?Object.assign(Object.assign({},f),{width:{max:b.resolution.width},height:{max:b.resolution.height},frameRate:b.resolution.frameRate}):Object.assign(Object.assign({},f),{width:{ideal:b.resolution.width},height:{ideal:b.resolution.height},frameRate:b.resolution.frameRate})),{audio:null!=(d=b.audio)&&d,video:f,controller:b.controller,selfBrowserSurface:b.selfBrowserSurface,surfaceSwitching:b.surfaceSwitching,systemAudio:b.systemAudio,preferCurrentTab:b.preferCurrentTab}),h=yield navigator.mediaDevices.getDisplayMedia(g),i=h.getVideoTracks();if(0===i.length)throw new hU("no video track found");let j=new jV(i[0],void 0,!1,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});j.source=ik.Source.ScreenShare,a.contentHint&&(j.mediaStreamTrack.contentHint=a.contentHint);let k=[j];if(h.getAudioTracks().length>0){this.emit(lh.AudioStreamAcquired);let a=new jJ(h.getAudioTracks()[0],void 0,!1,this.audioContext,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});a.source=ik.Source.ScreenShareAudio,k.push(a)}return k})}publishTrack(a,b){return gS(this,void 0,void 0,function*(){return this.publishOrRepublishTrack(a,b)})}publishOrRepublishTrack(a,b){return gS(this,arguments,void 0,function(a,b){var c=this;let d=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return function*(){var e,f;let g,h;if(iZ(a)&&a.setAudioContext(c.audioContext),yield null==(e=c.reconnectFuture)?void 0:e.promise,c.republishPromise&&!d&&(yield c.republishPromise),iV(a)&&c.pendingPublishPromises.has(a)&&(yield c.pendingPublishPromises.get(a)),a instanceof MediaStreamTrack)g=a.getConstraints();else{let b;switch(g=a.constraints,a.source){case ik.Source.Microphone:b="audioinput";break;case ik.Source.Camera:b="videoinput"}b&&c.activeDeviceMap.has(b)&&(g=Object.assign(Object.assign({},g),{deviceId:c.activeDeviceMap.get(b)}))}if(a instanceof MediaStreamTrack)switch(a.kind){case"audio":a=new jJ(a,g,!0,c.audioContext,{loggerName:c.roomOptions.loggerName,loggerContextCb:()=>c.logContext});break;case"video":a=new jV(a,g,!0,{loggerName:c.roomOptions.loggerName,loggerContextCb:()=>c.logContext});break;default:throw new hU("unsupported MediaStreamTrack kind ".concat(a.kind))}else a.updateLoggerOptions({loggerName:c.roomOptions.loggerName,loggerContextCb:()=>c.logContext});if(c.trackPublications.forEach(b=>{b.track&&b.track===a&&(h=b)}),h)return c.log.warn("track has already been published, skipping",Object.assign(Object.assign({},c.logContext),ig(h))),h;let i=Object.assign(Object.assign({},c.roomOptions.publishDefaults),b),j="channelCount"in a.mediaStreamTrack.getSettings()&&2===a.mediaStreamTrack.getSettings().channelCount||2===a.mediaStreamTrack.getConstraints().channelCount,k=null!=(f=i.forceStereo)?f:j;k&&(void 0===i.dtx&&c.log.info("Opus DTX will be disabled for stereo tracks by default. Enable them explicitly to make it work.",Object.assign(Object.assign({},c.logContext),ig(a))),void 0===i.red&&c.log.info("Opus RED will be disabled for stereo tracks by default. Enable them explicitly to make it work."),null!=i.dtx||(i.dtx=!1),null!=i.red||(i.red=!1)),!function(){let a=hN(),b="17.2";if(a)if("Safari"!==a.name&&"iOS"!==a.os)return!0;else if("iOS"===a.os&&a.osVersion&&iG(a.osVersion,b)>=0)return!0;else if("Safari"===a.name&&iG(a.version,b)>=0)return!0;else return!1}()&&c.roomOptions.e2ee&&(c.log.info("End-to-end encryption is set up, simulcast publishing will be disabled on Safari versions and iOS browsers running iOS < v17.2",Object.assign({},c.logContext)),i.simulcast=!1),i.source&&(a.source=i.source);let l=new Promise((b,d)=>gS(c,void 0,void 0,function*(){try{if(this.engine.client.currentState!==lt.CONNECTED){this.log.debug("deferring track publication until signal is connected",Object.assign(Object.assign({},this.logContext),{track:ig(a)}));let c=!1,e=setTimeout(()=>{c=!0,a.stop(),d(new hY("publishing rejected as engine not connected within timeout",408))},15e3);if(yield this.waitUntilEngineConnected(),clearTimeout(e),c)return;let f=yield this.publish(a,i,k);b(f)}else try{let c=yield this.publish(a,i,k);b(c)}catch(a){d(a)}}catch(a){d(a)}}));c.pendingPublishPromises.set(a,l);try{return yield l}catch(a){throw a}finally{c.pendingPublishPromises.delete(a)}}()})}waitUntilEngineConnected(){return this.signalConnectedFuture||(this.signalConnectedFuture=new iP),this.signalConnectedFuture.promise}hasPermissionsToPublish(a){if(!this.permissions)return this.log.warn("no permissions present for publishing track",Object.assign(Object.assign({},this.logContext),ig(a))),!1;let{canPublish:b,canPublishSources:c}=this.permissions;return!!(b&&(0===c.length||c.map(a=>(function(a){switch(a){case eJ.CAMERA:return ik.Source.Camera;case eJ.MICROPHONE:return ik.Source.Microphone;case eJ.SCREEN_SHARE:return ik.Source.ScreenShare;case eJ.SCREEN_SHARE_AUDIO:return ik.Source.ScreenShareAudio;default:return ik.Source.Unknown}})(a)).includes(a.source)))||(this.log.warn("insufficient permissions to publish",Object.assign(Object.assign({},this.logContext),ig(a))),!1)}publish(a,b,c){return gS(this,void 0,void 0,function*(){var d,e,f,g,h,i,j,k,l,m;let n,o;if(!this.hasPermissionsToPublish(a))throw new hY("failed to publish track, insufficient permissions",403);Array.from(this.trackPublications.values()).find(b=>iV(a)&&b.source===a.source)&&a.source!==ik.Source.Unknown&&this.log.info("publishing a second track with the same source: ".concat(a.source),Object.assign(Object.assign({},this.logContext),ig(a))),b.stopMicTrackOnMute&&iW(a)&&(a.stopOnMute=!0),a.source===ik.Source.ScreenShare&&iu()&&(b.simulcast=!1),"av1"===b.videoCodec&&!function(){if(!("getCapabilities"in RTCRtpSender)||iw()||iu())return!1;let a=RTCRtpSender.getCapabilities("video"),b=!1;if(a){for(let c of a.codecs)if("video/av1"===c.mimeType.toLowerCase()){b=!0;break}}return b}()&&(b.videoCodec=void 0),"vp9"===b.videoCodec&&!function(){if(!("getCapabilities"in RTCRtpSender)||iu())return!1;if(iw()){let a=hN();if((null==a?void 0:a.version)&&0>iG(a.version,"16")||(null==a?void 0:a.os)==="iOS"&&(null==a?void 0:a.osVersion)&&0>iG(a.osVersion,"16"))return!1}let a=RTCRtpSender.getCapabilities("video"),b=!1;if(a){for(let c of a.codecs)if("video/vp9"===c.mimeType.toLowerCase()){b=!0;break}}return b}()&&(b.videoCodec=void 0),void 0===b.videoCodec&&(b.videoCodec="vp8"),this.enabledPublishVideoCodecs.length>0&&!this.enabledPublishVideoCodecs.some(a=>b.videoCodec===ie(a.mime))&&(b.videoCodec=ie(this.enabledPublishVideoCodecs[0].mime));let p=b.videoCodec;a.on(lj.Muted,this.onTrackMuted),a.on(lj.Unmuted,this.onTrackUnmuted),a.on(lj.Ended,this.handleTrackEnded),a.on(lj.UpstreamPaused,this.onTrackUpstreamPaused),a.on(lj.UpstreamResumed,this.onTrackUpstreamResumed),a.on(lj.AudioTrackFeatureUpdate,this.onTrackFeatureUpdate);let q=[],r=!(null==(d=b.dtx)||d),s=a.getSourceTrackSettings();s.autoGainControl&&q.push(eQ.TF_AUTO_GAIN_CONTROL),s.echoCancellation&&q.push(eQ.TF_ECHO_CANCELLATION),s.noiseSuppression&&q.push(eQ.TF_NOISE_SUPPRESSION),s.channelCount&&s.channelCount>1&&q.push(eQ.TF_STEREO),r&&q.push(eQ.TF_NO_DTX),iZ(a)&&a.hasPreConnectBuffer&&q.push(eQ.TF_PRECONNECT_BUFFER);let t=new f$({cid:a.mediaStreamTrack.id,name:b.name,type:ik.kindToProto(a.kind),muted:a.isMuted,source:ik.sourceToProto(a.source),disableDtx:r,encryption:this.encryptionType,stereo:c,disableRed:this.isE2EEEnabled||!(null==(e=b.red)||e),stream:null==b?void 0:b.stream,backupCodecPolicy:null==b?void 0:b.backupCodecPolicy,audioFeatures:q});if(a.kind===ik.Kind.Video){let c={width:0,height:0};try{c=yield a.waitForDimensions()}catch(d){let b=null!=(g=null==(f=this.roomOptions.videoCaptureDefaults)?void 0:f.resolution)?g:h5.h720.resolution;c={width:b.width,height:b.height},this.log.error("could not determine track dimensions, using defaults",Object.assign(Object.assign(Object.assign({},this.logContext),ig(a)),{dims:c}))}t.width=c.width,t.height=c.height,iY(a)&&(is(p)&&(a.source===ik.Source.ScreenShare&&(b.scalabilityMode="L1T3","contentHint"in a.mediaStreamTrack&&(a.mediaStreamTrack.contentHint="motion",this.log.info("forcing contentHint to motion for screenshare with SVC codecs",Object.assign(Object.assign({},this.logContext),ig(a))))),b.scalabilityMode=null!=(h=b.scalabilityMode)?h:"L3T3_KEY"),t.simulcastCodecs=[new fZ({codec:p,cid:a.mediaStreamTrack.id})],!0===b.backupCodec&&(b.backupCodec={codec:"vp8"}),b.backupCodec&&p!==b.backupCodec.codec&&t.encryption===eY.NONE&&(this.roomOptions.dynacast||(this.roomOptions.dynacast=!0),t.simulcastCodecs.push(new fZ({codec:b.backupCodec.codec,cid:""})))),n=jQ(a.source===ik.Source.ScreenShare,t.width,t.height,b),t.layers=jY(t.width,t.height,n,is(b.videoCodec))}else a.kind===ik.Kind.Audio&&(n=[{maxBitrate:null==(i=b.audioPreset)?void 0:i.maxBitrate,priority:null!=(k=null==(j=b.audioPreset)?void 0:j.priority)?k:"high",networkPriority:null!=(m=null==(l=b.audioPreset)?void 0:l.priority)?m:"high"}]);if(!this.engine||this.engine.isClosed)throw new hW("cannot publish track when not connected");let u=()=>gS(this,void 0,void 0,function*(){var c,d;if(!this.engine.pcManager)throw new hW("pcManager is not ready");if(a.sender=yield this.engine.createSender(a,b,n),this.emit(lh.LocalSenderCreated,a.sender,a),iY(a)&&(null!=b.degradationPreference||(b.degradationPreference=a.source===ik.Source.ScreenShare||a.constraints.height&&iQ(a.constraints.height)>=1080?"maintain-resolution":"balanced"),a.setDegradationPreference(b.degradationPreference)),n)if(iu()&&a.kind===ik.Kind.Audio){let b;for(let c of this.engine.pcManager.publisher.getTransceivers())if(c.sender===a.sender){b=c;break}b&&this.engine.pcManager.publisher.setTrackCodecBitrate({transceiver:b,codec:"opus",maxbr:(null==(c=n[0])?void 0:c.maxBitrate)?n[0].maxBitrate/1e3:0})}else a.codec&&is(a.codec)&&(null==(d=n[0])?void 0:d.maxBitrate)&&this.engine.pcManager.publisher.setTrackCodecBitrate({cid:t.cid,codec:a.codec,maxbr:n[0].maxBitrate/1e3});yield this.engine.negotiate()}),v=new Promise((b,c)=>gS(this,void 0,void 0,function*(){var d;try{o=yield this.engine.addTrack(t),b(o)}catch(b){a.sender&&(null==(d=this.engine.pcManager)?void 0:d.publisher)&&(this.engine.pcManager.publisher.removeTrack(a.sender),yield this.engine.negotiate().catch(b=>{this.log.error("failed to negotiate after removing track due to failed add track request",Object.assign(Object.assign(Object.assign({},this.logContext),ig(a)),{error:b}))})),c(b)}}));if(this.enabledPublishVideoCodecs.length>0)o=(yield Promise.all([v,u()]))[0];else{let c;if((o=yield v).codecs.forEach(a=>{void 0===c&&(c=a.mimeType)}),c&&a.kind===ik.Kind.Video){let d=ie(c);d!==p&&(this.log.debug("falling back to server selected codec",Object.assign(Object.assign(Object.assign({},this.logContext),ig(a)),{codec:d})),b.videoCodec=d,n=jQ(a.source===ik.Source.ScreenShare,t.width,t.height,b))}yield u()}let w=new kh(a.kind,o,a,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});if(w.on(lj.CpuConstrained,a=>this.onTrackCpuConstrained(a,w)),w.options=b,a.sid=o.sid,this.log.debug("publishing ".concat(a.kind," with encodings"),Object.assign(Object.assign({},this.logContext),{encodings:n,trackInfo:o})),iY(a)?a.startMonitor(this.engine.client):iZ(a)&&a.startMonitor(),this.addTrackPublication(w),this.emit(lh.LocalTrackPublished,w),iZ(a)&&o.audioFeatures.includes(eQ.TF_PRECONNECT_BUFFER)){let b=a.getPreConnectBuffer(),c=a.getPreConnectBufferMimeType();this.on(lh.LocalTrackSubscribed,b=>{if(b.trackSid===o.sid){if(!a.hasPreConnectBuffer)return void this.log.warn("subscribe event came to late, buffer already closed",this.logContext);this.log.debug("finished recording preconnect buffer",Object.assign(Object.assign({},this.logContext),ig(a))),a.stopPreConnectBuffer()}}),b&&new Promise((d,e)=>gS(this,void 0,void 0,function*(){try{this.log.debug("waiting for agent",Object.assign(Object.assign({},this.logContext),ig(a)));let o=setTimeout(()=>{e(Error("agent not active within 10 seconds"))},1e4),p=yield this.waitUntilActiveAgentPresent();clearTimeout(o),this.log.debug("sending preconnect buffer",Object.assign(Object.assign({},this.logContext),ig(a)));let q=yield this.streamBytes({name:"preconnect-buffer",mimeType:c,topic:"lk.agent.pre-connect-audio-buffer",destinationIdentities:[p.identity],attributes:{trackId:w.trackSid,sampleRate:String(null!=(j=s.sampleRate)?j:"48000"),channels:String(null!=(k=s.channelCount)?k:"1")}});try{for(var f,g,h,i,j,k,l,m=!0,n=gT(b);!(f=(l=yield n.next()).done);m=!0)i=l.value,m=!1,yield q.write(i)}catch(a){g={error:a}}finally{try{!m&&!f&&(h=n.return)&&(yield h.call(n))}finally{if(g)throw g.error}}yield q.close(),d()}catch(a){e(a)}})).then(()=>{this.log.debug("preconnect buffer sent successfully",Object.assign(Object.assign({},this.logContext),ig(a)))}).catch(b=>{this.log.error("error sending preconnect buffer",Object.assign(Object.assign(Object.assign({},this.logContext),ig(a)),{error:b}))})}return w})}get isLocal(){return!0}publishAdditionalCodecForTrack(a,b,c){return gS(this,void 0,void 0,function*(){var d;let e;if(this.encryptionType!==eY.NONE)return;if(this.trackPublications.forEach(b=>{b.track&&b.track===a&&(e=b)}),!e)throw new hU("track is not published");if(!iY(a))throw new hU("track is not a video track");let f=Object.assign(Object.assign({},null==(d=this.roomOptions)?void 0:d.publishDefaults),c),g=function(a,b,c){var d,e,f,g;if(!c.backupCodec||!0===c.backupCodec||c.backupCodec.codec===c.videoCodec)return;b!==c.backupCodec.codec&&gO.warn("requested a different codec than specified as backup",{serverRequested:b,backup:c.backupCodec.codec}),c.videoCodec=b,c.videoEncoding=c.backupCodec.encoding;let h=a.mediaStreamTrack.getSettings(),i=null!=(d=h.width)?d:null==(e=a.dimensions)?void 0:e.width,j=null!=(f=h.height)?f:null==(g=a.dimensions)?void 0:g.height;return a.source===ik.Source.ScreenShare&&c.simulcast&&(c.simulcast=!1),jQ(a.source===ik.Source.ScreenShare,i,j,c)}(a,b,f);if(!g)return void this.log.info("backup codec has been disabled, ignoring request to add additional codec for track",Object.assign(Object.assign({},this.logContext),ig(a)));let h=a.addSimulcastTrack(b,g);if(!h)return;let i=new f$({cid:h.mediaStreamTrack.id,type:ik.kindToProto(a.kind),muted:a.isMuted,source:ik.sourceToProto(a.source),sid:a.sid,simulcastCodecs:[{codec:f.videoCodec,cid:h.mediaStreamTrack.id}]});if(i.layers=jY(i.width,i.height,g),!this.engine||this.engine.isClosed)throw new hW("cannot publish track when not connected");let j=()=>gS(this,void 0,void 0,function*(){yield this.engine.createSimulcastSender(a,h,f,g),yield this.engine.negotiate()}),k=(yield Promise.all([this.engine.addTrack(i),j()]))[0];this.log.debug("published ".concat(b," for track ").concat(a.sid),Object.assign(Object.assign({},this.logContext),{encodings:g,trackInfo:k}))})}unpublishTrack(a,b){return gS(this,void 0,void 0,function*(){var c,d;if(iV(a)){let b=this.pendingPublishPromises.get(a);b&&(this.log.info("awaiting publish promise before attempting to unpublish",Object.assign(Object.assign({},this.logContext),ig(a))),yield b)}let e=this.getPublicationForTrack(a),f=e?ig(e):void 0;if(this.log.debug("unpublishing track",Object.assign(Object.assign({},this.logContext),f)),!e||!e.track)return void this.log.warn("track was not unpublished because no publication was found",Object.assign(Object.assign({},this.logContext),f));(a=e.track).off(lj.Muted,this.onTrackMuted),a.off(lj.Unmuted,this.onTrackUnmuted),a.off(lj.Ended,this.handleTrackEnded),a.off(lj.UpstreamPaused,this.onTrackUpstreamPaused),a.off(lj.UpstreamResumed,this.onTrackUpstreamResumed),a.off(lj.AudioTrackFeatureUpdate,this.onTrackFeatureUpdate),void 0===b&&(b=null==(d=null==(c=this.roomOptions)?void 0:c.stopLocalTrackOnUnpublish)||d),b?a.stop():a.stopMonitor();let g=!1,h=a.sender;if(a.sender=void 0,this.engine.pcManager&&this.engine.pcManager.currentState<lz.FAILED&&h)try{for(let a of this.engine.pcManager.publisher.getTransceivers())a.sender===h&&(a.direction="inactive",g=!0);if(this.engine.removeTrack(h)&&(g=!0),iY(a)){for(let[,b]of a.simulcastCodecs)b.sender&&(this.engine.removeTrack(b.sender)&&(g=!0),b.sender=void 0);a.simulcastCodecs.clear()}}catch(a){this.log.warn("failed to unpublish track",Object.assign(Object.assign(Object.assign({},this.logContext),f),{error:a}))}switch(this.trackPublications.delete(e.trackSid),e.kind){case ik.Kind.Audio:this.audioTrackPublications.delete(e.trackSid);break;case ik.Kind.Video:this.videoTrackPublications.delete(e.trackSid)}return this.emit(lh.LocalTrackUnpublished,e),e.setTrack(void 0),g&&(yield this.engine.negotiate()),e})}unpublishTracks(a){return gS(this,void 0,void 0,function*(){return(yield Promise.all(a.map(a=>this.unpublishTrack(a)))).filter(a=>!!a)})}republishAllTracks(a){return gS(this,arguments,void 0,function(a){var b=this;let c=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return function*(){b.republishPromise&&(yield b.republishPromise),b.republishPromise=new Promise((d,e)=>gS(b,void 0,void 0,function*(){try{let b=[];this.trackPublications.forEach(c=>{c.track&&(a&&(c.options=Object.assign(Object.assign({},c.options),a)),b.push(c))}),yield Promise.all(b.map(a=>gS(this,void 0,void 0,function*(){let b=a.track;yield this.unpublishTrack(b,!1),c&&!b.isMuted&&b.source!==ik.Source.ScreenShare&&b.source!==ik.Source.ScreenShareAudio&&(iZ(b)||iY(b))&&!b.isUserProvided&&(this.log.debug("restarting existing track",Object.assign(Object.assign({},this.logContext),{track:a.trackSid})),yield b.restartTrack()),yield this.publishOrRepublishTrack(b,a.options,!0)}))),d()}catch(a){e(a)}finally{this.republishPromise=void 0}})),yield b.republishPromise}()})}publishData(a){return gS(this,arguments,void 0,function(a){var b=this;let c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function*(){let d=c.reliable?e2.RELIABLE:e2.LOSSY,e=c.destinationIdentities,f=c.topic,g=new e1({kind:d,value:{case:"user",value:new e7({participantIdentity:b.identity,payload:a,destinationIdentities:e,topic:f})}});yield b.engine.sendDataPacket(g,d)}()})}publishDtmf(a,b){return gS(this,void 0,void 0,function*(){let c=new e1({kind:e2.RELIABLE,value:{case:"sipDtmf",value:new e8({code:a,digit:b})}});yield this.engine.sendDataPacket(c,e2.RELIABLE)})}sendChatMessage(a,b){return gS(this,void 0,void 0,function*(){let c={id:crypto.randomUUID(),message:a,timestamp:Date.now(),attachedFiles:null==b?void 0:b.attachments},d=new e1({value:{case:"chatMessage",value:new fb(Object.assign(Object.assign({},c),{timestamp:dN.parse(c.timestamp)}))}});return yield this.engine.sendDataPacket(d,e2.RELIABLE),this.emit(lh.ChatMessage,c),c})}editChatMessage(a,b){return gS(this,void 0,void 0,function*(){let c=Object.assign(Object.assign({},b),{message:a,editTimestamp:Date.now()}),d=new e1({value:{case:"chatMessage",value:new fb(Object.assign(Object.assign({},c),{timestamp:dN.parse(c.timestamp),editTimestamp:dN.parse(c.editTimestamp)}))}});return yield this.engine.sendDataPacket(d,e2.RELIABLE),this.emit(lh.ChatMessage,c),c})}sendText(a,b){return gS(this,void 0,void 0,function*(){return this.roomOutgoingDataStreamManager.sendText(a,b)})}streamText(a){return gS(this,void 0,void 0,function*(){return this.roomOutgoingDataStreamManager.streamText(a)})}sendFile(a,b){return gS(this,void 0,void 0,function*(){return this.roomOutgoingDataStreamManager.sendFile(a,b)})}streamBytes(a){return gS(this,void 0,void 0,function*(){return this.roomOutgoingDataStreamManager.streamBytes(a)})}performRpc(a){return gS(this,arguments,void 0,function(a){var b=this;let{destinationIdentity:c,method:d,payload:e,responseTimeout:f=15e3}=a;return function*(){return new Promise((a,g)=>gS(b,void 0,void 0,function*(){var b,h,i,j;if(jC(e)>15360)return void g(jB.builtIn("REQUEST_PAYLOAD_TOO_LARGE"));if((null==(h=null==(b=this.engine.latestJoinResponse)?void 0:b.serverInfo)?void 0:h.version)&&0>iG(null==(j=null==(i=this.engine.latestJoinResponse)?void 0:i.serverInfo)?void 0:j.version,"1.8.0"))return void g(jB.builtIn("UNSUPPORTED_SERVER"));let k=Math.max(f,8e3),l=crypto.randomUUID();yield this.publishRpcRequest(c,l,d,e,k);let m=setTimeout(()=>{this.pendingAcks.delete(l),g(jB.builtIn("CONNECTION_TIMEOUT")),this.pendingResponses.delete(l),clearTimeout(n)},7e3);this.pendingAcks.set(l,{resolve:()=>{clearTimeout(m)},participantIdentity:c});let n=setTimeout(()=>{this.pendingResponses.delete(l),g(jB.builtIn("RESPONSE_TIMEOUT"))},f);this.pendingResponses.set(l,{resolve:(b,c)=>{clearTimeout(n),this.pendingAcks.has(l)&&(this.log.warn("RPC response received before ack",l),this.pendingAcks.delete(l),clearTimeout(m)),c?g(c):a(null!=b?b:"")},participantIdentity:c})}))}()})}registerRpcMethod(a,b){this.rpcHandlers.has(a)&&this.log.warn("you're overriding the RPC handler for method ".concat(a,", in the future this will throw an error")),this.rpcHandlers.set(a,b)}unregisterRpcMethod(a){this.rpcHandlers.delete(a)}setTrackSubscriptionPermissions(a){let b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this.participantTrackPermissions=b,this.allParticipantsAllowedToSubscribe=a,this.engine.client.isDisconnected||this.updateTrackSubscriptionPermissions()}handleIncomingRpcAck(a){let b=this.pendingAcks.get(a);b?(b.resolve(),this.pendingAcks.delete(a)):console.error("Ack received for unexpected RPC request",a)}handleIncomingRpcResponse(a,b,c){let d=this.pendingResponses.get(a);d?(d.resolve(b,c),this.pendingResponses.delete(a)):console.error("Response received for unexpected RPC request",a)}publishRpcRequest(a,b,c,d,e){return gS(this,void 0,void 0,function*(){let f=new e1({destinationIdentities:[a],kind:e2.RELIABLE,value:{case:"rpcRequest",value:new fc({id:b,method:c,payload:d,responseTimeoutMs:e,version:1})}});yield this.engine.sendDataPacket(f,e2.RELIABLE)})}handleParticipantDisconnected(a){for(let[b,{participantIdentity:c}]of this.pendingAcks)c===a&&this.pendingAcks.delete(b);for(let[b,{participantIdentity:c,resolve:d}]of this.pendingResponses)c===a&&(d(null,jB.builtIn("RECIPIENT_DISCONNECTED")),this.pendingResponses.delete(b))}setEnabledPublishCodecs(a){this.enabledPublishVideoCodecs=a.filter(a=>"video"===a.mime.split("/")[0].toLowerCase())}updateInfo(a){return!!super.updateInfo(a)&&(a.tracks.forEach(a=>{var b,c;let d=this.trackPublications.get(a.sid);if(d){let e=d.isMuted||null!=(c=null==(b=d.track)?void 0:b.isUpstreamPaused)&&c;e!==a.muted&&(this.log.debug("updating server mute state after reconcile",Object.assign(Object.assign(Object.assign({},this.logContext),ig(d)),{mutedOnServer:e})),this.engine.client.sendMuteTrack(a.sid,e))}}),!0)}setActiveAgent(a){var b,c,d,e;this.firstActiveAgent=a,a&&!this.firstActiveAgent&&(this.firstActiveAgent=a),a?null==(c=null==(b=this.activeAgentFuture)?void 0:b.resolve)||c.call(b,a):null==(e=null==(d=this.activeAgentFuture)?void 0:d.reject)||e.call(d,Error("Agent disconnected")),this.activeAgentFuture=void 0}waitUntilActiveAgentPresent(){return this.firstActiveAgent?Promise.resolve(this.firstActiveAgent):(this.activeAgentFuture||(this.activeAgentFuture=new iP),this.activeAgentFuture.promise)}getPublicationForTrack(a){let b;return this.trackPublications.forEach(c=>{let d=c.track;d&&(a instanceof MediaStreamTrack?(iZ(d)||iY(d))&&d.mediaStreamTrack===a&&(b=c):a===d&&(b=c))}),b}waitForPendingPublicationOfSource(a){return gS(this,void 0,void 0,function*(){let b=Date.now();for(;Date.now()<b+1e4;){let b=Array.from(this.pendingPublishPromises.entries()).find(b=>{let[c]=b;return c.source===a});if(b)return b[1];yield ip(20)}})}}class kl extends kg{constructor(a,b,c,d){super(a,b.sid,b.name,d),this.track=void 0,this.allowed=!0,this.requestedDisabled=void 0,this.visible=!0,this.handleEnded=a=>{this.setTrack(void 0),this.emit(lj.Ended,a)},this.handleVisibilityChange=a=>{this.log.debug("adaptivestream video visibility ".concat(this.trackSid,", visible=").concat(a),this.logContext),this.visible=a,this.emitTrackUpdate()},this.handleVideoDimensionsChange=a=>{this.log.debug("adaptivestream video dimensions ".concat(a.width,"x").concat(a.height),this.logContext),this.videoDimensionsAdaptiveStream=a,this.emitTrackUpdate()},this.subscribed=c,this.updateInfo(b)}setSubscribed(a){let b=this.subscriptionStatus,c=this.permissionStatus;this.subscribed=a,a&&(this.allowed=!0);let d=new f7({trackSids:[this.trackSid],subscribe:this.subscribed,participantTracks:[new fg({participantSid:"",trackSids:[this.trackSid]})]});this.emit(lj.UpdateSubscription,d),this.emitSubscriptionUpdateIfChanged(b),this.emitPermissionUpdateIfChanged(c)}get subscriptionStatus(){return!1===this.subscribed?kg.SubscriptionStatus.Unsubscribed:super.isSubscribed?kg.SubscriptionStatus.Subscribed:kg.SubscriptionStatus.Desired}get permissionStatus(){return this.allowed?kg.PermissionStatus.Allowed:kg.PermissionStatus.NotAllowed}get isSubscribed(){return!1!==this.subscribed&&super.isSubscribed}get isDesired(){return!1!==this.subscribed}get isEnabled(){return void 0!==this.requestedDisabled?!this.requestedDisabled:!this.isAdaptiveStream||this.visible}get isLocal(){return!1}setEnabled(a){this.isManualOperationAllowed()&&!a!==this.requestedDisabled&&(this.requestedDisabled=!a,this.emitTrackUpdate())}setVideoQuality(a){this.isManualOperationAllowed()&&this.requestedMaxQuality!==a&&(this.requestedMaxQuality=a,this.requestedVideoDimensions=void 0,this.emitTrackUpdate())}setVideoDimensions(a){var b,c;this.isManualOperationAllowed()&&((null==(b=this.requestedVideoDimensions)?void 0:b.width)!==a.width||(null==(c=this.requestedVideoDimensions)?void 0:c.height)!==a.height)&&(i_(this.track)&&(this.requestedVideoDimensions=a),this.requestedMaxQuality=void 0,this.emitTrackUpdate())}setVideoFPS(a){this.isManualOperationAllowed()&&i_(this.track)&&this.fps!==a&&(this.fps=a,this.emitTrackUpdate())}get videoQuality(){var a;return null!=(a=this.requestedMaxQuality)?a:lm.HIGH}setTrack(a){let b=this.subscriptionStatus,c=this.permissionStatus,d=this.track;d!==a&&(d&&(d.off(lj.VideoDimensionsChanged,this.handleVideoDimensionsChange),d.off(lj.VisibilityChanged,this.handleVisibilityChange),d.off(lj.Ended,this.handleEnded),d.detach(),d.stopMonitor(),this.emit(lj.Unsubscribed,d)),super.setTrack(a),a&&(a.sid=this.trackSid,a.on(lj.VideoDimensionsChanged,this.handleVideoDimensionsChange),a.on(lj.VisibilityChanged,this.handleVisibilityChange),a.on(lj.Ended,this.handleEnded),this.emit(lj.Subscribed,a)),this.emitPermissionUpdateIfChanged(c),this.emitSubscriptionUpdateIfChanged(b))}setAllowed(a){let b=this.subscriptionStatus,c=this.permissionStatus;this.allowed=a,this.emitPermissionUpdateIfChanged(c),this.emitSubscriptionUpdateIfChanged(b)}setSubscriptionError(a){this.emit(lj.SubscriptionFailed,a)}updateInfo(a){super.updateInfo(a);let b=this.metadataMuted;this.metadataMuted=a.muted,this.track?this.track.setMuted(a.muted):b!==a.muted&&this.emit(a.muted?lj.Muted:lj.Unmuted)}emitSubscriptionUpdateIfChanged(a){let b=this.subscriptionStatus;a!==b&&this.emit(lj.SubscriptionStatusChanged,b,a)}emitPermissionUpdateIfChanged(a){this.permissionStatus!==a&&this.emit(lj.SubscriptionPermissionChanged,this.permissionStatus,a)}isManualOperationAllowed(){return!!this.isDesired||(this.log.warn("cannot update track settings when not subscribed",this.logContext),!1)}get isAdaptiveStream(){return i_(this.track)&&this.track.isAdaptiveStream}emitTrackUpdate(){let a=new f8({trackSids:[this.trackSid],disabled:!this.isEnabled,fps:this.fps});if(this.kind===ik.Kind.Video){let e=this.requestedVideoDimensions;if(void 0!==this.videoDimensionsAdaptiveStream)if(e)ii(this.videoDimensionsAdaptiveStream,e)&&(this.log.debug("using adaptive stream dimensions instead of requested",Object.assign(Object.assign({},this.logContext),this.videoDimensionsAdaptiveStream)),e=this.videoDimensionsAdaptiveStream);else if(void 0!==this.requestedMaxQuality&&this.trackInfo){var b,c,d;let a=(b=this.trackInfo,c=this.requestedMaxQuality,null==(d=b.layers)?void 0:d.find(a=>a.quality===c));a&&ii(this.videoDimensionsAdaptiveStream,a)&&(this.log.debug("using adaptive stream dimensions instead of max quality layer",Object.assign(Object.assign({},this.logContext),this.videoDimensionsAdaptiveStream)),e=this.videoDimensionsAdaptiveStream)}else this.log.debug("using adaptive stream dimensions",Object.assign(Object.assign({},this.logContext),this.videoDimensionsAdaptiveStream)),e=this.videoDimensionsAdaptiveStream;e?(a.width=Math.ceil(e.width),a.height=Math.ceil(e.height)):void 0!==this.requestedMaxQuality?(this.log.debug("using requested max quality",Object.assign(Object.assign({},this.logContext),{quality:this.requestedMaxQuality})),a.quality=this.requestedMaxQuality):(this.log.debug("using default quality",Object.assign(Object.assign({},this.logContext),{quality:lm.HIGH})),a.quality=lm.HIGH)}this.emit(lj.UpdateSettings,a)}}class km extends kj{static fromParticipantInfo(a,b,c){return new km(a,b.sid,b.identity,b.name,b.metadata,b.attributes,c,b.kind)}get logContext(){return Object.assign(Object.assign({},super.logContext),{rpID:this.sid,remoteParticipant:this.identity})}constructor(a,b,c,d,e,f,g){let h=arguments.length>7&&void 0!==arguments[7]?arguments[7]:eW.STANDARD;super(b,c||"",d,e,f,g,h),this.signalClient=a,this.trackPublications=new Map,this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.volumeMap=new Map}addTrackPublication(a){super.addTrackPublication(a),a.on(lj.UpdateSettings,b=>{this.log.debug("send update settings",Object.assign(Object.assign(Object.assign({},this.logContext),ig(a)),{settings:b})),this.signalClient.sendUpdateTrackSettings(b)}),a.on(lj.UpdateSubscription,a=>{a.participantTracks.forEach(a=>{a.participantSid=this.sid}),this.signalClient.sendUpdateSubscription(a)}),a.on(lj.SubscriptionPermissionChanged,b=>{this.emit(lh.TrackSubscriptionPermissionChanged,a,b)}),a.on(lj.SubscriptionStatusChanged,b=>{this.emit(lh.TrackSubscriptionStatusChanged,a,b)}),a.on(lj.Subscribed,b=>{this.emit(lh.TrackSubscribed,b,a)}),a.on(lj.Unsubscribed,b=>{this.emit(lh.TrackUnsubscribed,b,a)}),a.on(lj.SubscriptionFailed,b=>{this.emit(lh.TrackSubscriptionFailed,a.trackSid,b)})}getTrackPublication(a){let b=super.getTrackPublication(a);if(b)return b}getTrackPublicationByName(a){let b=super.getTrackPublicationByName(a);if(b)return b}setVolume(a){let b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ik.Source.Microphone;this.volumeMap.set(b,a);let c=this.getTrackPublication(b);c&&c.track&&c.track.setVolume(a)}getVolume(){let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ik.Source.Microphone,b=this.getTrackPublication(a);return b&&b.track?b.track.getVolume():this.volumeMap.get(a)}addSubscribedMediaTrack(a,b,c,d,e,f){let g,h=this.getTrackPublicationBySid(b);if(h||b.startsWith("TR")||this.trackPublications.forEach(b=>{h||a.kind!==b.kind.toString()||(h=b)}),!h){if(0===f){this.log.error("could not find published track",Object.assign(Object.assign({},this.logContext),{trackSid:b})),this.emit(lh.TrackSubscriptionFailed,b);return}void 0===f&&(f=20),setTimeout(()=>{this.addSubscribedMediaTrack(a,b,c,d,e,f-1)},150);return}if("ended"===a.readyState){this.log.error("unable to subscribe because MediaStreamTrack is ended. Do not call MediaStreamTrack.stop()",Object.assign(Object.assign({},this.logContext),ig(h))),this.emit(lh.TrackSubscriptionFailed,b);return}return(g="video"===a.kind?new kc(a,b,d,e):new kb(a,b,d,this.audioContext,this.audioOutput)).source=h.source,g.isMuted=h.isMuted,g.setMediaStream(c),g.start(),h.setTrack(g),this.volumeMap.has(h.source)&&i$(g)&&iW(g)&&g.setVolume(this.volumeMap.get(h.source)),h}get hasMetadata(){return!!this.participantInfo}getTrackPublicationBySid(a){return this.trackPublications.get(a)}updateInfo(a){if(!super.updateInfo(a))return!1;let b=new Map,c=new Map;return a.tracks.forEach(a=>{var d,e;let f=this.getTrackPublicationBySid(a.sid);if(f)f.updateInfo(a);else{let b=ik.kindFromProto(a.type);if(!b)return;(f=new kl(b,a,null==(d=this.signalClient.connectOptions)?void 0:d.autoSubscribe,{loggerContextCb:()=>this.logContext,loggerName:null==(e=this.loggerOptions)?void 0:e.loggerName})).updateInfo(a),c.set(a.sid,f);let g=Array.from(this.trackPublications.values()).find(a=>a.source===(null==f?void 0:f.source));g&&f.source!==ik.Source.Unknown&&this.log.debug("received a second track publication for ".concat(this.identity," with the same source: ").concat(f.source),Object.assign(Object.assign({},this.logContext),{oldTrack:ig(g),newTrack:ig(f)})),this.addTrackPublication(f)}b.set(a.sid,f)}),this.trackPublications.forEach(a=>{b.has(a.trackSid)||(this.log.trace("detected removed track on remote participant, unpublishing",Object.assign(Object.assign({},this.logContext),ig(a))),this.unpublishTrack(a.trackSid,!0))}),c.forEach(a=>{this.emit(lh.TrackPublished,a)}),!0}unpublishTrack(a,b){let c=this.trackPublications.get(a);if(!c)return;let{track:d}=c;switch(d&&(d.stop(),c.setTrack(void 0)),this.trackPublications.delete(a),c.kind){case ik.Kind.Audio:this.audioTrackPublications.delete(a);break;case ik.Kind.Video:this.videoTrackPublications.delete(a)}b&&this.emit(lh.TrackUnpublished,c)}setAudioOutput(a){return gS(this,void 0,void 0,function*(){this.audioOutput=a;let b=[];this.audioTrackPublications.forEach(c=>{var d;iW(c.track)&&i$(c.track)&&b.push(c.track.setSinkId(null!=(d=a.deviceId)?d:"default"))}),yield Promise.all(b)})}emit(a){for(var b=arguments.length,c=Array(b>1?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];return this.log.trace("participant event",Object.assign(Object.assign({},this.logContext),{event:a,args:c})),super.emit(a,...c)}}(k3=lC||(lC={})).Disconnected="disconnected",k3.Connecting="connecting",k3.Connected="connected",k3.Reconnecting="reconnecting",k3.SignalReconnecting="signalReconnecting";class kn extends gV.EventEmitter{get hasE2EESetup(){return void 0!==this.e2eeManager}constructor(a){var b,c,d,e;if(super(),b=this,this.state=lC.Disconnected,this.activeSpeakers=[],this.isE2EEEnabled=!1,this.audioEnabled=!0,this.isVideoPlaybackBlocked=!1,this.log=gO,this.bufferedEvents=[],this.isResuming=!1,this.rpcHandlers=new Map,this.connect=(a,b,c)=>gS(this,void 0,void 0,function*(){var d;if(!("undefined"!=typeof RTCPeerConnection&&(iq()||ir())))if(iA())throw Error("WebRTC isn't detected, have you called registerGlobals?");else throw Error("LiveKit doesn't seem to be supported on this browser. Try to update your browser and make sure no browser extensions are disabling webRTC.");let e=yield this.disconnectLock.lock();if(this.state===lC.Connected)return this.log.info("already connected to room ".concat(this.name),this.logContext),e(),Promise.resolve();if(this.connectFuture)return e(),this.connectFuture.promise;this.setAndEmitConnectionState(lC.Connecting),(null==(d=this.regionUrlProvider)?void 0:d.getServerUrl().toString())!==i0(a)&&(this.regionUrl=void 0,this.regionUrlProvider=void 0),iB(new URL(a))&&(void 0===this.regionUrlProvider?this.regionUrlProvider=new jA(a,b):this.regionUrlProvider.updateToken(b),this.regionUrlProvider.fetchRegionSettings().then(a=>{var b;null==(b=this.regionUrlProvider)||b.setServerReportedRegions(a)}).catch(a=>{this.log.warn("could not fetch region settings",Object.assign(Object.assign({},this.logContext),{error:a}))}));let f=(d,g,h)=>gS(this,void 0,void 0,function*(){var i,j;this.abortController&&this.abortController.abort();let k=new AbortController;this.abortController=k,null==e||e();try{if(yield i6.getInstance().getBackOffPromise(a),k.signal.aborted)throw hS.cancelled("Connection attempt aborted");yield this.attemptConnection(null!=h?h:a,b,c,k),this.abortController=void 0,d()}catch(b){if(this.regionUrlProvider&&b instanceof hS&&b.reason!==ld.Cancelled&&b.reason!==ld.NotAllowed){let c=null;try{this.log.debug("Fetching next region"),c=yield this.regionUrlProvider.getNextBestRegionUrl(null==(i=this.abortController)?void 0:i.signal)}catch(a){if(a instanceof hS&&(401===a.status||a.reason===ld.Cancelled)){this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),g(a);return}}[ld.InternalError,ld.ServerUnreachable,ld.Timeout].includes(b.reason)&&(this.log.debug("Adding failed connection attempt to back off"),i6.getInstance().addFailedConnectionAttempt(a)),!c||(null==(j=this.abortController)?void 0:j.signal.aborted)?(this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,iS(b)),g(b)):(this.log.info("Initial connection failed with ConnectionError: ".concat(b.message,". Retrying with another region: ").concat(c),this.logContext),this.recreateEngine(),yield f(d,g,c))}else{let a=eN.UNKNOWN_REASON;b instanceof hS&&(a=iS(b)),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,a),g(b)}}}),g=this.regionUrl;return this.regionUrl=void 0,this.connectFuture=new iP((a,b)=>{f(a,b,g)},()=>{this.clearConnectionFutures()}),this.connectFuture.promise}),this.connectSignal=(a,b,c,d,e,f)=>gS(this,void 0,void 0,function*(){var g,h,i;let j=yield c.join(a,b,{autoSubscribe:d.autoSubscribe,adaptiveStream:"object"==typeof e.adaptiveStream||e.adaptiveStream,maxRetries:d.maxRetries,e2eeEnabled:!!this.e2eeManager,websocketTimeout:d.websocketTimeout,singlePeerConnection:e.singlePeerConnection},f.signal),k=j.serverInfo;if(k||(k={version:j.serverVersion,region:j.serverRegion}),this.serverInfo=k,this.log.debug("connected to Livekit Server ".concat(Object.entries(k).map(a=>{let[b,c]=a;return"".concat(b,": ").concat(c)}).join(", ")),{room:null==(g=j.room)?void 0:g.name,roomSid:null==(h=j.room)?void 0:h.sid,identity:null==(i=j.participant)?void 0:i.identity}),!k.version)throw new hV("unknown server version");return"0.15.1"===k.version&&this.options.dynacast&&(this.log.debug("disabling dynacast due to server version",this.logContext),e.dynacast=!1),j}),this.applyJoinResponse=a=>{let b=a.participant;if(this.localParticipant.sid=b.sid,this.localParticipant.identity=b.identity,this.localParticipant.setEnabledPublishCodecs(a.enabledPublishCodecs),this.e2eeManager)try{this.e2eeManager.setSifTrailer(a.sifTrailer)}catch(a){this.log.error(a instanceof Error?a.message:"Could not set SifTrailer",Object.assign(Object.assign({},this.logContext),{error:a}))}this.handleParticipantUpdates([b,...a.otherParticipants]),a.room&&this.handleRoomUpdate(a.room)},this.attemptConnection=(a,b,c,d)=>gS(this,void 0,void 0,function*(){var e,f;this.state===lC.Reconnecting||this.isResuming||(null==(e=this.engine)?void 0:e.pendingReconnect)?(this.log.info("Reconnection attempt replaced by new connection attempt",this.logContext),this.recreateEngine()):this.maybeCreateEngine(),(null==(f=this.regionUrlProvider)?void 0:f.isCloud())&&this.engine.setRegionUrlProvider(this.regionUrlProvider),this.acquireAudioContext(),this.connOptions=Object.assign(Object.assign({},jy),c),this.connOptions.rtcConfig&&(this.engine.rtcConfig=this.connOptions.rtcConfig),this.connOptions.peerConnectionTimeout&&(this.engine.peerConnectionTimeout=this.connOptions.peerConnectionTimeout);try{let c=yield this.connectSignal(a,b,this.engine,this.connOptions,this.options,d);this.applyJoinResponse(c),this.setupLocalParticipantEvents(),this.emit(lg.SignalConnected)}catch(b){yield this.engine.close(),this.recreateEngine();let a=d.signal.aborted?hS.cancelled("Signal connection aborted"):hS.serverUnreachable("could not establish signal connection");throw b instanceof Error&&(a.message="".concat(a.message,": ").concat(b.message)),b instanceof hS&&(a.reason=b.reason,a.status=b.status),this.log.debug("error trying to establish signal connection",Object.assign(Object.assign({},this.logContext),{error:b})),a}if(d.signal.aborted)throw yield this.engine.close(),this.recreateEngine(),hS.cancelled("Connection attempt aborted");try{yield this.engine.waitForPCInitialConnection(this.connOptions.peerConnectionTimeout,d)}catch(a){throw yield this.engine.close(),this.recreateEngine(),a}iz()&&this.options.disconnectOnPageLeave&&(window.addEventListener("pagehide",this.onPageLeave),window.addEventListener("beforeunload",this.onPageLeave)),iz()&&window.addEventListener("freeze",this.onPageLeave),this.setAndEmitConnectionState(lC.Connected),this.emit(lg.Connected),i6.getInstance().resetFailedConnectionAttempts(a),this.registerConnectionReconcile(),this.regionUrlProvider&&this.regionUrlProvider.notifyConnected()}),this.disconnect=function(){for(var a=arguments.length,c=Array(a),d=0;d<a;d++)c[d]=arguments[d];return gS(b,[...c],void 0,function(){var a=this;let b=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return function*(){var c,d,e;let f=yield a.disconnectLock.lock();try{if(a.state===lC.Disconnected)return void a.log.debug("already disconnected",a.logContext);if(a.log.info("disconnect from room",Object.assign({},a.logContext)),a.state===lC.Connecting||a.state===lC.Reconnecting||a.isResuming){let b="Abort connection attempt due to user initiated disconnect";a.log.warn(b,a.logContext),null==(c=a.abortController)||c.abort(b),null==(e=null==(d=a.connectFuture)?void 0:d.reject)||e.call(d,hS.cancelled("Client initiated disconnect")),a.connectFuture=void 0}a.engine&&(a.engine.client.isDisconnected||(yield a.engine.client.sendLeave()),yield a.engine.close()),a.handleDisconnect(b,eN.CLIENT_INITIATED),a.engine=void 0}finally{f()}}()})},this.onPageLeave=()=>gS(this,void 0,void 0,function*(){this.log.info("Page leave detected, disconnecting",this.logContext),yield this.disconnect()}),this.startAudio=()=>gS(this,void 0,void 0,function*(){let a=[],b=hN();if(b&&"iOS"===b.os){let b="livekit-dummy-audio-el",c=document.getElementById(b);if(!c){(c=document.createElement("audio")).id=b,c.autoplay=!0,c.hidden=!0;let a=iO();a.enabled=!0;let d=new MediaStream([a]);c.srcObject=d,document.addEventListener("visibilitychange",()=>{c&&(c.srcObject=document.hidden?null:d,document.hidden||(this.log.debug("page visible again, triggering startAudio to resume playback and update playback status",this.logContext),this.startAudio()))}),document.body.append(c),this.once(lg.Disconnected,()=>{null==c||c.remove(),c=null})}a.push(c)}this.remoteParticipants.forEach(b=>{b.audioTrackPublications.forEach(b=>{b.track&&b.track.attachedElements.forEach(b=>{a.push(b)})})});try{yield Promise.all([this.acquireAudioContext(),...a.map(a=>(a.muted=!1,a.play()))]),this.handleAudioPlaybackStarted()}catch(a){throw this.handleAudioPlaybackFailed(a),a}}),this.startVideo=()=>gS(this,void 0,void 0,function*(){let a=[];for(let b of this.remoteParticipants.values())b.videoTrackPublications.forEach(b=>{var c;null==(c=b.track)||c.attachedElements.forEach(b=>{a.includes(b)||a.push(b)})});yield Promise.all(a.map(a=>a.play())).then(()=>{this.handleVideoPlaybackStarted()}).catch(a=>{"NotAllowedError"===a.name?this.handleVideoPlaybackFailed():this.log.warn("Resuming video playback failed, make sure you call `startVideo` directly in a user gesture handler",this.logContext)})}),this.handleRestarting=()=>{for(let a of(this.clearConnectionReconcile(),this.isResuming=!1,this.remoteParticipants.values()))this.handleParticipantDisconnected(a.identity,a);this.setAndEmitConnectionState(lC.Reconnecting)&&this.emit(lg.Reconnecting)},this.handleSignalRestarted=a=>gS(this,void 0,void 0,function*(){this.log.debug("signal reconnected to server, region ".concat(a.serverRegion),Object.assign(Object.assign({},this.logContext),{region:a.serverRegion})),this.bufferedEvents=[],this.applyJoinResponse(a);try{yield this.localParticipant.republishAllTracks(void 0,!0)}catch(a){this.log.error("error trying to re-publish tracks after reconnection",Object.assign(Object.assign({},this.logContext),{error:a}))}try{yield this.engine.waitForRestarted(),this.log.debug("fully reconnected to server",Object.assign(Object.assign({},this.logContext),{region:a.serverRegion}))}catch(a){return}this.setAndEmitConnectionState(lC.Connected),this.emit(lg.Reconnected),this.registerConnectionReconcile(),this.emitBufferedEvents()}),this.handleParticipantUpdates=a=>{a.forEach(a=>{var b;if(a.identity===this.localParticipant.identity)return void this.localParticipant.updateInfo(a);""===a.identity&&(a.identity=null!=(b=this.sidToIdentity.get(a.sid))?b:"");let c=this.remoteParticipants.get(a.identity);a.state===eV.DISCONNECTED?this.handleParticipantDisconnected(a.identity,c):c=this.getOrCreateParticipant(a.identity,a)})},this.handleActiveSpeakersUpdate=a=>{let b=[],c={};a.forEach(a=>{if(c[a.sid]=!0,a.sid===this.localParticipant.sid)this.localParticipant.audioLevel=a.level,this.localParticipant.setIsSpeaking(!0),b.push(this.localParticipant);else{let c=this.getRemoteParticipantBySid(a.sid);c&&(c.audioLevel=a.level,c.setIsSpeaking(!0),b.push(c))}}),c[this.localParticipant.sid]||(this.localParticipant.audioLevel=0,this.localParticipant.setIsSpeaking(!1)),this.remoteParticipants.forEach(a=>{c[a.sid]||(a.audioLevel=0,a.setIsSpeaking(!1))}),this.activeSpeakers=b,this.emitWhenConnected(lg.ActiveSpeakersChanged,b)},this.handleSpeakersChanged=a=>{let b=new Map;this.activeSpeakers.forEach(a=>{let c=this.remoteParticipants.get(a.identity);c&&c.sid!==a.sid||b.set(a.sid,a)}),a.forEach(a=>{let c=this.getRemoteParticipantBySid(a.sid);a.sid===this.localParticipant.sid&&(c=this.localParticipant),c&&(c.audioLevel=a.level,c.setIsSpeaking(a.active),a.active?b.set(a.sid,c):b.delete(a.sid))});let c=Array.from(b.values());c.sort((a,b)=>b.audioLevel-a.audioLevel),this.activeSpeakers=c,this.emitWhenConnected(lg.ActiveSpeakersChanged,c)},this.handleStreamStateUpdate=a=>{a.streamStates.forEach(a=>{let b=this.getRemoteParticipantBySid(a.participantSid);if(!b)return;let c=b.getTrackPublicationBySid(a.trackSid);if(!c||!c.track)return;let d=ik.streamStateFromProto(a.state);c.track.setStreamState(d),d!==c.track.streamState&&(b.emit(lh.TrackStreamStateChanged,c,c.track.streamState),this.emitWhenConnected(lg.TrackStreamStateChanged,c,c.track.streamState,b))})},this.handleSubscriptionPermissionUpdate=a=>{let b=this.getRemoteParticipantBySid(a.participantSid);if(!b)return;let c=b.getTrackPublicationBySid(a.trackSid);c&&c.setAllowed(a.allowed)},this.handleSubscriptionError=a=>{let b=Array.from(this.remoteParticipants.values()).find(b=>b.trackPublications.has(a.trackSid));if(!b)return;let c=b.getTrackPublicationBySid(a.trackSid);c&&c.setSubscriptionError(a.err)},this.handleDataPacket=(a,b)=>{let c=this.remoteParticipants.get(a.participantIdentity);if("user"===a.value.case)this.handleUserPacket(c,a.value.value,a.kind,b);else if("transcription"===a.value.case)this.handleTranscription(c,a.value.value);else if("sipDtmf"===a.value.case)this.handleSipDtmf(c,a.value.value);else if("chatMessage"===a.value.case)this.handleChatMessage(c,a.value.value);else if("metrics"===a.value.case)this.handleMetrics(a.value.value,c);else if("streamHeader"===a.value.case||"streamChunk"===a.value.case||"streamTrailer"===a.value.case)this.handleDataStream(a,b);else if("rpcRequest"===a.value.case){let b=a.value.value;this.handleIncomingRpcRequest(a.participantIdentity,b.id,b.method,b.payload,b.responseTimeoutMs,b.version)}},this.handleUserPacket=(a,b,c,d)=>{this.emit(lg.DataReceived,b.payload,a,c,b.topic,d),null==a||a.emit(lh.DataReceived,b.payload,c,d)},this.handleSipDtmf=(a,b)=>{this.emit(lg.SipDTMFReceived,b,a),null==a||a.emit(lh.SipDTMFReceived,b)},this.handleTranscription=(a,b)=>{var c;let d=b.transcribedParticipantIdentity===this.localParticipant.identity?this.localParticipant:this.getParticipantByIdentity(b.transcribedParticipantIdentity),e=null==d?void 0:d.trackPublications.get(b.trackId),f=(c=this.transcriptionReceivedTimes,b.segments.map(a=>{var b;let{id:d,text:e,language:f,startTime:g,endTime:h,final:i}=a,j=null!=(b=c.get(d))?b:Date.now(),k=Date.now();return i?c.delete(d):c.set(d,j),{id:d,text:e,startTime:Number.parseInt(g.toString()),endTime:Number.parseInt(h.toString()),final:i,language:f,firstReceivedTime:j,lastReceivedTime:k}}));null==e||e.emit(lj.TranscriptionReceived,f),null==d||d.emit(lh.TranscriptionReceived,f,e),this.emit(lg.TranscriptionReceived,f,d,e)},this.handleChatMessage=(a,b)=>{let c=function(a){let{id:b,timestamp:c,message:d,editTimestamp:e}=a;return{id:b,timestamp:Number.parseInt(c.toString()),editTimestamp:e?Number.parseInt(e.toString()):void 0,message:d}}(b);this.emit(lg.ChatMessage,c,a)},this.handleMetrics=(a,b)=>{this.emit(lg.MetricsReceived,a,b)},this.handleDataStream=(a,b)=>{this.incomingDataStreamManager.handleDataStreamPacket(a,b)},this.bufferedSegments=new Map,this.handleAudioPlaybackStarted=()=>{this.canPlaybackAudio||(this.audioEnabled=!0,this.emit(lg.AudioPlaybackStatusChanged,!0))},this.handleAudioPlaybackFailed=a=>{this.log.warn("could not playback audio",Object.assign(Object.assign({},this.logContext),{error:a})),this.canPlaybackAudio&&(this.audioEnabled=!1,this.emit(lg.AudioPlaybackStatusChanged,!1))},this.handleVideoPlaybackStarted=()=>{this.isVideoPlaybackBlocked&&(this.isVideoPlaybackBlocked=!1,this.emit(lg.VideoPlaybackStatusChanged,!0))},this.handleVideoPlaybackFailed=()=>{this.isVideoPlaybackBlocked||(this.isVideoPlaybackBlocked=!0,this.emit(lg.VideoPlaybackStatusChanged,!1))},this.handleDeviceChange=()=>gS(this,void 0,void 0,function*(){var a;(null==(a=hN())?void 0:a.os)!=="iOS"&&(yield this.selectDefaultDevices()),this.emit(lg.MediaDevicesChanged)}),this.handleRoomUpdate=a=>{let b=this.roomInfo;this.roomInfo=a,b&&b.metadata!==a.metadata&&this.emitWhenConnected(lg.RoomMetadataChanged,a.metadata),(null==b?void 0:b.activeRecording)!==a.activeRecording&&this.emitWhenConnected(lg.RecordingStatusChanged,a.activeRecording)},this.handleConnectionQualityUpdate=a=>{a.updates.forEach(a=>{if(a.participantSid===this.localParticipant.sid)return void this.localParticipant.setConnectionQuality(a.quality);let b=this.getRemoteParticipantBySid(a.participantSid);b&&b.setConnectionQuality(a.quality)})},this.onLocalParticipantMetadataChanged=a=>{this.emit(lg.ParticipantMetadataChanged,a,this.localParticipant)},this.onLocalParticipantNameChanged=a=>{this.emit(lg.ParticipantNameChanged,a,this.localParticipant)},this.onLocalAttributesChanged=a=>{this.emit(lg.ParticipantAttributesChanged,a,this.localParticipant)},this.onLocalTrackMuted=a=>{this.emit(lg.TrackMuted,a,this.localParticipant)},this.onLocalTrackUnmuted=a=>{this.emit(lg.TrackUnmuted,a,this.localParticipant)},this.onTrackProcessorUpdate=a=>{var b;null==(b=null==a?void 0:a.onPublish)||b.call(a,this)},this.onLocalTrackPublished=a=>gS(this,void 0,void 0,function*(){var b,c,d,e,f,g;null==(b=a.track)||b.on(lj.TrackProcessorUpdate,this.onTrackProcessorUpdate),null==(c=a.track)||c.on(lj.Restarted,this.onLocalTrackRestarted),null==(f=null==(e=null==(d=a.track)?void 0:d.getProcessor())?void 0:e.onPublish)||f.call(e,this),this.emit(lg.LocalTrackPublished,a,this.localParticipant),iZ(a.track)&&(yield a.track.checkForSilence())&&this.emit(lg.LocalAudioSilenceDetected,a);let h=yield null==(g=a.track)?void 0:g.getDeviceId(!1),i=id(a.source);i&&h&&h!==this.localParticipant.activeDeviceMap.get(i)&&(this.localParticipant.activeDeviceMap.set(i,h),this.emit(lg.ActiveDeviceChanged,i,h))}),this.onLocalTrackUnpublished=a=>{var b,c;null==(b=a.track)||b.off(lj.TrackProcessorUpdate,this.onTrackProcessorUpdate),null==(c=a.track)||c.off(lj.Restarted,this.onLocalTrackRestarted),this.emit(lg.LocalTrackUnpublished,a,this.localParticipant)},this.onLocalTrackRestarted=a=>gS(this,void 0,void 0,function*(){let b=yield a.getDeviceId(!1),c=id(a.source);c&&b&&b!==this.localParticipant.activeDeviceMap.get(c)&&(this.log.debug("local track restarted, setting ".concat(c," ").concat(b," active"),this.logContext),this.localParticipant.activeDeviceMap.set(c,b),this.emit(lg.ActiveDeviceChanged,c,b))}),this.onLocalConnectionQualityChanged=a=>{this.emit(lg.ConnectionQualityChanged,a,this.localParticipant)},this.onMediaDevicesError=(a,b)=>{this.emit(lg.MediaDevicesError,a,b)},this.onLocalParticipantPermissionsChanged=a=>{this.emit(lg.ParticipantPermissionsChanged,a,this.localParticipant)},this.onLocalChatMessageSent=a=>{this.emit(lg.ChatMessage,a,this.localParticipant)},this.setMaxListeners(100),this.remoteParticipants=new Map,this.sidToIdentity=new Map,this.options=Object.assign(Object.assign({},jx),a),this.log=gP(null!=(c=this.options.loggerName)?c:la.Room),this.transcriptionReceivedTimes=new Map,this.options.audioCaptureDefaults=Object.assign(Object.assign({},jv),null==a?void 0:a.audioCaptureDefaults),this.options.videoCaptureDefaults=Object.assign(Object.assign({},jw),null==a?void 0:a.videoCaptureDefaults),this.options.publishDefaults=Object.assign(Object.assign({},ju),null==a?void 0:a.publishDefaults),this.maybeCreateEngine(),this.incomingDataStreamManager=new j5,this.outgoingDataStreamManager=new j9(this.engine,this.log),this.disconnectLock=new du,this.localParticipant=new kk("","",this.engine,this.options,this.rpcHandlers,this.outgoingDataStreamManager),(this.options.e2ee||this.options.encryption)&&this.setupE2EE(),this.engine.e2eeManager=this.e2eeManager,this.options.videoCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("videoinput",iQ(this.options.videoCaptureDefaults.deviceId)),this.options.audioCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("audioinput",iQ(this.options.audioCaptureDefaults.deviceId)),(null==(d=this.options.audioOutput)?void 0:d.deviceId)&&this.switchActiveDevice("audiooutput",iQ(this.options.audioOutput.deviceId)).catch(a=>this.log.warn("Could not set audio output: ".concat(a.message),this.logContext)),iz()){const a=new AbortController;null==(e=navigator.mediaDevices)||e.addEventListener("devicechange",this.handleDeviceChange,{signal:a.signal}),kn.cleanupRegistry&&kn.cleanupRegistry.register(this,()=>{a.abort()})}}registerTextStreamHandler(a,b){return this.incomingDataStreamManager.registerTextStreamHandler(a,b)}unregisterTextStreamHandler(a){return this.incomingDataStreamManager.unregisterTextStreamHandler(a)}registerByteStreamHandler(a,b){return this.incomingDataStreamManager.registerByteStreamHandler(a,b)}unregisterByteStreamHandler(a){return this.incomingDataStreamManager.unregisterByteStreamHandler(a)}registerRpcMethod(a,b){if(this.rpcHandlers.has(a))throw Error("RPC handler already registered for method ".concat(a,", unregisterRpcMethod before trying to register again"));this.rpcHandlers.set(a,b)}unregisterRpcMethod(a){this.rpcHandlers.delete(a)}setE2EEEnabled(a){return gS(this,void 0,void 0,function*(){if(this.e2eeManager)yield Promise.all([this.localParticipant.setE2EEEnabled(a)]),""!==this.localParticipant.identity&&this.e2eeManager.setParticipantCryptorEnabled(a,this.localParticipant.identity);else throw Error("e2ee not configured, please set e2ee settings within the room options")})}setupE2EE(){var a;let b=!!this.options.encryption,c=this.options.encryption||this.options.e2ee;c&&("e2eeManager"in c?(this.e2eeManager=c.e2eeManager,this.e2eeManager.isDataChannelEncryptionEnabled=b):this.e2eeManager=new i5(c,b),this.e2eeManager.on(lp.ParticipantEncryptionStatusChanged,(a,b)=>{b.isLocal&&(this.isE2EEEnabled=a),this.emit(lg.ParticipantEncryptionStatusChanged,a,b)}),this.e2eeManager.on(lp.EncryptionError,(a,b)=>{let c=b?this.getParticipantByIdentity(b):void 0;this.emit(lg.EncryptionError,a,c)}),null==(a=this.e2eeManager)||a.setup(this))}get logContext(){var a;return{room:this.name,roomID:null==(a=this.roomInfo)?void 0:a.sid,participant:this.localParticipant.identity,pID:this.localParticipant.sid}}get isRecording(){var a,b;return null!=(b=null==(a=this.roomInfo)?void 0:a.activeRecording)&&b}getSid(){return gS(this,void 0,void 0,function*(){return this.state===lC.Disconnected?"":this.roomInfo&&""!==this.roomInfo.sid?this.roomInfo.sid:new Promise((a,b)=>{let c=b=>{""!==b.sid&&(this.engine.off(li.RoomUpdate,c),a(b.sid))};this.engine.on(li.RoomUpdate,c),this.once(lg.Disconnected,()=>{this.engine.off(li.RoomUpdate,c),b("Room disconnected before room server id was available")})})})}get name(){var a,b;return null!=(b=null==(a=this.roomInfo)?void 0:a.name)?b:""}get metadata(){var a;return null==(a=this.roomInfo)?void 0:a.metadata}get numParticipants(){var a,b;return null!=(b=null==(a=this.roomInfo)?void 0:a.numParticipants)?b:0}get numPublishers(){var a,b;return null!=(b=null==(a=this.roomInfo)?void 0:a.numPublishers)?b:0}maybeCreateEngine(){(!this.engine||this.engine.isClosed)&&(this.engine=new j0(this.options),this.engine.e2eeManager=this.e2eeManager,this.engine.on(li.ParticipantUpdate,this.handleParticipantUpdates).on(li.RoomUpdate,this.handleRoomUpdate).on(li.SpeakersChanged,this.handleSpeakersChanged).on(li.StreamStateChanged,this.handleStreamStateUpdate).on(li.ConnectionQualityUpdate,this.handleConnectionQualityUpdate).on(li.SubscriptionError,this.handleSubscriptionError).on(li.SubscriptionPermissionUpdate,this.handleSubscriptionPermissionUpdate).on(li.MediaTrackAdded,(a,b,c)=>{this.onTrackAdded(a,b,c)}).on(li.Disconnected,a=>{this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,a)}).on(li.ActiveSpeakersUpdate,this.handleActiveSpeakersUpdate).on(li.DataPacketReceived,this.handleDataPacket).on(li.Resuming,()=>{this.clearConnectionReconcile(),this.isResuming=!0,this.log.info("Resuming signal connection",this.logContext),this.setAndEmitConnectionState(lC.SignalReconnecting)&&this.emit(lg.SignalReconnecting)}).on(li.Resumed,()=>{this.registerConnectionReconcile(),this.isResuming=!1,this.log.info("Resumed signal connection",this.logContext),this.updateSubscriptions(),this.emitBufferedEvents(),this.setAndEmitConnectionState(lC.Connected)&&this.emit(lg.Reconnected)}).on(li.SignalResumed,()=>{this.bufferedEvents=[],(this.state===lC.Reconnecting||this.isResuming)&&this.sendSyncState()}).on(li.Restarting,this.handleRestarting).on(li.SignalRestarted,this.handleSignalRestarted).on(li.Offline,()=>{this.setAndEmitConnectionState(lC.Reconnecting)&&this.emit(lg.Reconnecting)}).on(li.DCBufferStatusChanged,(a,b)=>{this.emit(lg.DCBufferStatusChanged,a,b)}).on(li.LocalTrackSubscribed,a=>{let b=this.localParticipant.getTrackPublications().find(b=>{let{trackSid:c}=b;return c===a});b?(this.localParticipant.emit(lh.LocalTrackSubscribed,b),this.emitWhenConnected(lg.LocalTrackSubscribed,b,this.localParticipant)):this.log.warn("could not find local track subscription for subscribed event",this.logContext)}).on(li.RoomMoved,a=>{this.log.debug("room moved",a),a.room&&this.handleRoomUpdate(a.room),this.remoteParticipants.forEach((a,b)=>{this.handleParticipantDisconnected(b,a)}),this.emit(lg.Moved,a.room.name),a.participant?this.handleParticipantUpdates([a.participant,...a.otherParticipants]):this.handleParticipantUpdates(a.otherParticipants)}),this.localParticipant&&this.localParticipant.setupEngine(this.engine),this.e2eeManager&&this.e2eeManager.setupEngine(this.engine),this.outgoingDataStreamManager&&this.outgoingDataStreamManager.setupEngine(this.engine))}static getLocalDevices(a){let b=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return i8.getInstance().getDevices(a,b)}prepareConnection(a,b){return gS(this,void 0,void 0,function*(){if(this.state===lC.Disconnected){this.log.debug("prepareConnection to ".concat(a),this.logContext);try{if(iB(new URL(a))&&b){this.regionUrlProvider=new jA(a,b);let c=yield this.regionUrlProvider.getNextBestRegionUrl();c&&this.state===lC.Disconnected&&(this.regionUrl=c,yield fetch(iR(c),{method:"HEAD"}),this.log.debug("prepared connection to ".concat(c),this.logContext))}else yield fetch(iR(a),{method:"HEAD"})}catch(a){this.log.warn("could not prepare connection",Object.assign(Object.assign({},this.logContext),{error:a}))}}})}getParticipantByIdentity(a){return this.localParticipant.identity===a?this.localParticipant:this.remoteParticipants.get(a)}clearConnectionFutures(){this.connectFuture=void 0}simulateScenario(a,b){return gS(this,void 0,void 0,function*(){let c,d=()=>gS(this,void 0,void 0,function*(){});switch(a){case"signal-reconnect":yield this.engine.client.handleOnClose("simulate disconnect");break;case"speaker":c=new gx({scenario:{case:"speakerUpdate",value:3}});break;case"node-failure":c=new gx({scenario:{case:"nodeFailure",value:!0}});break;case"server-leave":c=new gx({scenario:{case:"serverLeave",value:!0}});break;case"migration":c=new gx({scenario:{case:"migration",value:!0}});break;case"resume-reconnect":this.engine.failNext(),yield this.engine.client.handleOnClose("simulate resume-disconnect");break;case"disconnect-signal-on-resume":d=()=>gS(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),c=new gx({scenario:{case:"disconnectSignalOnResume",value:!0}});break;case"disconnect-signal-on-resume-no-messages":d=()=>gS(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),c=new gx({scenario:{case:"disconnectSignalOnResumeNoMessages",value:!0}});break;case"full-reconnect":this.engine.fullReconnectOnNext=!0,yield this.engine.client.handleOnClose("simulate full-reconnect");break;case"force-tcp":case"force-tls":c=new gx({scenario:{case:"switchCandidateProtocol",value:"force-tls"===a?2:1}}),d=()=>gS(this,void 0,void 0,function*(){let a=this.engine.client.onLeave;a&&a(new gb({reason:eN.CLIENT_INITIATED,action:gc.RECONNECT}))});break;case"subscriber-bandwidth":if(void 0===b||"number"!=typeof b)throw Error("subscriber-bandwidth requires a number as argument");c=new gx({scenario:{case:"subscriberBandwidth",value:iU(b)}});break;case"leave-full-reconnect":c=new gx({scenario:{case:"leaveRequestFullReconnect",value:!0}})}c&&(yield this.engine.client.sendSimulateScenario(c),yield d())})}get canPlaybackAudio(){return this.audioEnabled}get canPlaybackVideo(){return!this.isVideoPlaybackBlocked}getActiveDevice(a){return this.localParticipant.activeDeviceMap.get(a)}switchActiveDevice(a,b){return gS(this,arguments,void 0,function(a,b){var c=this;let d=!(arguments.length>2)||void 0===arguments[2]||arguments[2];return function*(){var e,f,g,h,i,j;let k=!0,l=!1,m=d?{exact:b}:b;if("audioinput"===a){l=0===c.localParticipant.audioTrackPublications.size;let b=null!=(e=c.getActiveDevice(a))?e:c.options.audioCaptureDefaults.deviceId;c.options.audioCaptureDefaults.deviceId=m;let d=Array.from(c.localParticipant.audioTrackPublications.values()).filter(a=>a.source===ik.Source.Microphone);try{k=(yield Promise.all(d.map(a=>{var b;return null==(b=a.audioTrack)?void 0:b.setDeviceId(m)}))).every(a=>!0===a)}catch(a){throw c.options.audioCaptureDefaults.deviceId=b,a}let f=d.some(a=>{var b,c;return null!=(c=null==(b=a.track)?void 0:b.isMuted)&&c});k&&f&&(l=!0)}else if("videoinput"===a){l=0===c.localParticipant.videoTrackPublications.size;let b=null!=(f=c.getActiveDevice(a))?f:c.options.videoCaptureDefaults.deviceId;c.options.videoCaptureDefaults.deviceId=m;let d=Array.from(c.localParticipant.videoTrackPublications.values()).filter(a=>a.source===ik.Source.Camera);try{k=(yield Promise.all(d.map(a=>{var b;return null==(b=a.videoTrack)?void 0:b.setDeviceId(m)}))).every(a=>!0===a)}catch(a){throw c.options.videoCaptureDefaults.deviceId=b,a}let e=d.some(a=>{var b,c;return null!=(c=null==(b=a.track)?void 0:b.isMuted)&&c});k&&e&&(l=!0)}else if("audiooutput"===a){if(l=!0,!it()&&!c.options.webAudioMix||c.options.webAudioMix&&c.audioContext&&!("setSinkId"in c.audioContext))throw Error("cannot switch audio output, the current browser does not support it");c.options.webAudioMix&&(b=null!=(g=yield i8.getInstance().normalizeDeviceId("audiooutput",b))?g:""),null!=(j=c.options).audioOutput||(j.audioOutput={});let d=null!=(h=c.getActiveDevice(a))?h:c.options.audioOutput.deviceId;c.options.audioOutput.deviceId=b;try{c.options.webAudioMix&&(null==(i=c.audioContext)||i.setSinkId(b)),yield Promise.all(Array.from(c.remoteParticipants.values()).map(a=>a.setAudioOutput({deviceId:b})))}catch(a){throw c.options.audioOutput.deviceId=d,a}}return l&&(c.localParticipant.activeDeviceMap.set(a,b),c.emit(lg.ActiveDeviceChanged,a,b)),k}()})}setupLocalParticipantEvents(){this.localParticipant.on(lh.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).on(lh.ParticipantNameChanged,this.onLocalParticipantNameChanged).on(lh.AttributesChanged,this.onLocalAttributesChanged).on(lh.TrackMuted,this.onLocalTrackMuted).on(lh.TrackUnmuted,this.onLocalTrackUnmuted).on(lh.LocalTrackPublished,this.onLocalTrackPublished).on(lh.LocalTrackUnpublished,this.onLocalTrackUnpublished).on(lh.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).on(lh.MediaDevicesError,this.onMediaDevicesError).on(lh.AudioStreamAcquired,this.startAudio).on(lh.ChatMessage,this.onLocalChatMessageSent).on(lh.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged)}recreateEngine(){var a;null==(a=this.engine)||a.close(),this.engine=void 0,this.isResuming=!1,this.remoteParticipants.clear(),this.sidToIdentity.clear(),this.bufferedEvents=[],this.maybeCreateEngine()}onTrackAdded(a,b,c){var d;let e,f;if(this.state===lC.Connecting||this.state===lC.Reconnecting){let d=()=>{this.log.debug("deferring on track for later",{mediaTrackId:a.id,mediaStreamId:b.id,tracksInStream:b.getTracks().map(a=>a.id)}),this.onTrackAdded(a,b,c),e()},e=()=>{this.off(lg.Reconnected,d),this.off(lg.Connected,d),this.off(lg.Disconnected,e)};this.once(lg.Reconnected,d),this.once(lg.Connected,d),this.once(lg.Disconnected,e);return}if(this.state===lC.Disconnected)return void this.log.warn("skipping incoming track after Room disconnected",this.logContext);if("ended"===a.readyState)return void this.log.info("skipping incoming track as it already ended",this.logContext);let g=(f=(d=b.id).split("|")).length>1?[f[0],d.substr(f[0].length+1)]:[d,""],h=g[0],i=g[1],j=a.id;if(i&&i.startsWith("TR")&&(j=i),h===this.localParticipant.sid)return void this.log.warn("tried to create RemoteParticipant for local participant",this.logContext);let k=Array.from(this.remoteParticipants.values()).find(a=>a.sid===h);if(!k)return void this.log.error("Tried to add a track for a participant, that's not present. Sid: ".concat(h),this.logContext);if(!j.startsWith("TR")){let a=this.engine.getTrackIdForReceiver(c);if(!a)return void this.log.error("Tried to add a track whose 'sid' could not be found for a participant, that's not present. Sid: ".concat(h),this.logContext);j=a}j.startsWith("TR")||this.log.warn("Tried to add a track whose 'sid' could not be determined for a participant, that's not present. Sid: ".concat(h,", streamId: ").concat(i,", trackId: ").concat(j),Object.assign(Object.assign({},this.logContext),{rpID:h,streamId:i,trackId:j})),this.options.adaptiveStream&&(e="object"==typeof this.options.adaptiveStream?this.options.adaptiveStream:{});let l=k.addSubscribedMediaTrack(a,j,b,c,e);(null==l?void 0:l.isEncrypted)&&!this.e2eeManager&&this.emit(lg.EncryptionError,Error("Encrypted ".concat(l.source," track received from participant ").concat(k.sid,", but room does not have encryption enabled!")))}handleDisconnect(){var a;let b=!(arguments.length>0)||void 0===arguments[0]||arguments[0],c=arguments.length>1?arguments[1]:void 0;if(this.clearConnectionReconcile(),this.isResuming=!1,this.bufferedEvents=[],this.transcriptionReceivedTimes.clear(),this.incomingDataStreamManager.clearControllers(),this.state!==lC.Disconnected){this.regionUrl=void 0,this.regionUrlProvider&&this.regionUrlProvider.notifyDisconnected();try{this.remoteParticipants.forEach(a=>{a.trackPublications.forEach(b=>{a.unpublishTrack(b.trackSid)})}),this.localParticipant.trackPublications.forEach(a=>{var c,d,e;a.track&&this.localParticipant.unpublishTrack(a.track,b),b?(null==(c=a.track)||c.detach(),null==(d=a.track)||d.stop()):null==(e=a.track)||e.stopMonitor()}),this.localParticipant.off(lh.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).off(lh.ParticipantNameChanged,this.onLocalParticipantNameChanged).off(lh.AttributesChanged,this.onLocalAttributesChanged).off(lh.TrackMuted,this.onLocalTrackMuted).off(lh.TrackUnmuted,this.onLocalTrackUnmuted).off(lh.LocalTrackPublished,this.onLocalTrackPublished).off(lh.LocalTrackUnpublished,this.onLocalTrackUnpublished).off(lh.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).off(lh.MediaDevicesError,this.onMediaDevicesError).off(lh.AudioStreamAcquired,this.startAudio).off(lh.ChatMessage,this.onLocalChatMessageSent).off(lh.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged),this.localParticipant.trackPublications.clear(),this.localParticipant.videoTrackPublications.clear(),this.localParticipant.audioTrackPublications.clear(),this.remoteParticipants.clear(),this.sidToIdentity.clear(),this.activeSpeakers=[],this.audioContext&&"boolean"==typeof this.options.webAudioMix&&(this.audioContext.close(),this.audioContext=void 0),iz()&&(window.removeEventListener("beforeunload",this.onPageLeave),window.removeEventListener("pagehide",this.onPageLeave),window.removeEventListener("freeze",this.onPageLeave),null==(a=navigator.mediaDevices)||a.removeEventListener("devicechange",this.handleDeviceChange))}finally{this.setAndEmitConnectionState(lC.Disconnected),this.emit(lg.Disconnected,c)}}}handleParticipantDisconnected(a,b){var c;this.remoteParticipants.delete(a),b&&(this.incomingDataStreamManager.validateParticipantHasNoActiveDataStreams(a),b.trackPublications.forEach(a=>{b.unpublishTrack(a.trackSid,!0)}),this.emit(lg.ParticipantDisconnected,b),b.setDisconnected(),null==(c=this.localParticipant)||c.handleParticipantDisconnected(b.identity))}handleIncomingRpcRequest(a,b,c,d,e,f){return gS(this,void 0,void 0,function*(){if(yield this.engine.publishRpcAck(a,b),1!==f)return void(yield this.engine.publishRpcResponse(a,b,null,jB.builtIn("UNSUPPORTED_VERSION")));let g=this.rpcHandlers.get(c);if(!g)return void(yield this.engine.publishRpcResponse(a,b,null,jB.builtIn("UNSUPPORTED_METHOD")));let h=null,i=null;try{let f=yield g({requestId:b,callerIdentity:a,payload:d,responseTimeout:e});jC(f)>15360?(h=jB.builtIn("RESPONSE_PAYLOAD_TOO_LARGE"),this.log.warn("RPC Response payload too large for ".concat(c))):i=f}catch(a){a instanceof jB?h=a:(this.log.warn("Uncaught error returned by RPC handler for ".concat(c,". Returning APPLICATION_ERROR instead."),a),h=jB.builtIn("APPLICATION_ERROR"))}yield this.engine.publishRpcResponse(a,b,i,h)})}selectDefaultDevices(){return gS(this,void 0,void 0,function*(){var a,b,c;let d=i8.getInstance().previousDevices,e=yield i8.getInstance().getDevices(void 0,!1),f=hN();if((null==f?void 0:f.name)==="Chrome"&&"iOS"!==f.os)for(let a of e){let b=d.find(b=>b.deviceId===a.deviceId);b&&""!==b.label&&b.kind===a.kind&&b.label!==a.label&&"default"===this.getActiveDevice(a.kind)&&this.emit(lg.ActiveDeviceChanged,a.kind,a.deviceId)}for(let f of["audiooutput","audioinput","videoinput"]){let g="audioinput"===f?ik.Source.Microphone:"videoinput"===f?ik.Source.Camera:ik.Source.Unknown,h=this.localParticipant.getTrackPublication(g);if(h&&(null==(a=h.track)?void 0:a.isUserProvided))continue;let i=e.filter(a=>a.kind===f),j=this.getActiveDevice(f);if(j===(null==(b=d.filter(a=>a.kind===f)[0])?void 0:b.deviceId)&&i.length>0&&(null==(c=i[0])?void 0:c.deviceId)!==j){yield this.switchActiveDevice(f,i[0].deviceId);continue}("audioinput"!==f||ix())&&"videoinput"!==f&&(!(i.length>0)||i.find(a=>a.deviceId===this.getActiveDevice(f))||"audiooutput"===f&&ix()||(yield this.switchActiveDevice(f,i[0].deviceId)))}})}acquireAudioContext(){return gS(this,void 0,void 0,function*(){var a,b;if("boolean"!=typeof this.options.webAudioMix&&this.options.webAudioMix.audioContext?this.audioContext=this.options.webAudioMix.audioContext:this.audioContext&&"closed"!==this.audioContext.state||(this.audioContext=null!=(a=ic())?a:void 0),this.options.webAudioMix&&this.remoteParticipants.forEach(a=>a.setAudioContext(this.audioContext)),this.localParticipant.setAudioContext(this.audioContext),this.audioContext&&"suspended"===this.audioContext.state)try{yield Promise.race([this.audioContext.resume(),ip(200)])}catch(a){this.log.warn("Could not resume audio context",Object.assign(Object.assign({},this.logContext),{error:a}))}let c=(null==(b=this.audioContext)?void 0:b.state)==="running";c!==this.canPlaybackAudio&&(this.audioEnabled=c,this.emit(lg.AudioPlaybackStatusChanged,c))})}createParticipant(a,b){var c;let d;return d=b?km.fromParticipantInfo(this.engine.client,b,{loggerContextCb:()=>this.logContext,loggerName:this.options.loggerName}):new km(this.engine.client,"",a,void 0,void 0,void 0,{loggerContextCb:()=>this.logContext,loggerName:this.options.loggerName}),this.options.webAudioMix&&d.setAudioContext(this.audioContext),(null==(c=this.options.audioOutput)?void 0:c.deviceId)&&d.setAudioOutput(this.options.audioOutput).catch(a=>this.log.warn("Could not set audio output: ".concat(a.message),this.logContext)),d}getOrCreateParticipant(a,b){if(this.remoteParticipants.has(a)){let c=this.remoteParticipants.get(a);return b&&c.updateInfo(b)&&this.sidToIdentity.set(b.sid,b.identity),c}let c=this.createParticipant(a,b);return this.remoteParticipants.set(a,c),this.sidToIdentity.set(b.sid,b.identity),this.emitWhenConnected(lg.ParticipantConnected,c),c.on(lh.TrackPublished,a=>{this.emitWhenConnected(lg.TrackPublished,a,c)}).on(lh.TrackSubscribed,(a,b)=>{a.kind===ik.Kind.Audio?(a.on(lj.AudioPlaybackStarted,this.handleAudioPlaybackStarted),a.on(lj.AudioPlaybackFailed,this.handleAudioPlaybackFailed)):a.kind===ik.Kind.Video&&(a.on(lj.VideoPlaybackFailed,this.handleVideoPlaybackFailed),a.on(lj.VideoPlaybackStarted,this.handleVideoPlaybackStarted)),this.emit(lg.TrackSubscribed,a,b,c)}).on(lh.TrackUnpublished,a=>{this.emit(lg.TrackUnpublished,a,c)}).on(lh.TrackUnsubscribed,(a,b)=>{this.emit(lg.TrackUnsubscribed,a,b,c)}).on(lh.TrackMuted,a=>{this.emitWhenConnected(lg.TrackMuted,a,c)}).on(lh.TrackUnmuted,a=>{this.emitWhenConnected(lg.TrackUnmuted,a,c)}).on(lh.ParticipantMetadataChanged,a=>{this.emitWhenConnected(lg.ParticipantMetadataChanged,a,c)}).on(lh.ParticipantNameChanged,a=>{this.emitWhenConnected(lg.ParticipantNameChanged,a,c)}).on(lh.AttributesChanged,a=>{this.emitWhenConnected(lg.ParticipantAttributesChanged,a,c)}).on(lh.ConnectionQualityChanged,a=>{this.emitWhenConnected(lg.ConnectionQualityChanged,a,c)}).on(lh.ParticipantPermissionsChanged,a=>{this.emitWhenConnected(lg.ParticipantPermissionsChanged,a,c)}).on(lh.TrackSubscriptionStatusChanged,(a,b)=>{this.emitWhenConnected(lg.TrackSubscriptionStatusChanged,a,b,c)}).on(lh.TrackSubscriptionFailed,(a,b)=>{this.emit(lg.TrackSubscriptionFailed,a,c,b)}).on(lh.TrackSubscriptionPermissionChanged,(a,b)=>{this.emitWhenConnected(lg.TrackSubscriptionPermissionChanged,a,b,c)}).on(lh.Active,()=>{this.emitWhenConnected(lg.ParticipantActive,c),c.kind===eW.AGENT&&this.localParticipant.setActiveAgent(c)}),b&&c.updateInfo(b),c}sendSyncState(){let a=Array.from(this.remoteParticipants.values()).reduce((a,b)=>(a.push(...b.getTrackPublications()),a),[]),b=this.localParticipant.getTrackPublications();this.engine.sendSyncState(a,b)}updateSubscriptions(){for(let b of this.remoteParticipants.values())for(let c of b.videoTrackPublications.values()){var a;c.isSubscribed&&(a=c)&&!a.isLocal&&c.emitTrackUpdate()}}getRemoteParticipantBySid(a){let b=this.sidToIdentity.get(a);if(b)return this.remoteParticipants.get(b)}registerConnectionReconcile(){this.clearConnectionReconcile();let a=0;this.connectionReconcileInterval=h0.setInterval(()=>{this.engine&&!this.engine.isClosed&&this.engine.verifyTransport()?a=0:(a++,this.log.warn("detected connection state mismatch",Object.assign(Object.assign({},this.logContext),{numFailures:a,engine:this.engine?{closed:this.engine.isClosed,transportsConnected:this.engine.verifyTransport()}:void 0})),a>=3&&(this.recreateEngine(),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,eN.STATE_MISMATCH)))},4e3)}clearConnectionReconcile(){this.connectionReconcileInterval&&h0.clearInterval(this.connectionReconcileInterval)}setAndEmitConnectionState(a){return a!==this.state&&(this.state=a,this.emit(lg.ConnectionStateChanged,this.state),!0)}emitBufferedEvents(){this.bufferedEvents.forEach(a=>{let[b,c]=a;this.emit(b,...c)}),this.bufferedEvents=[]}emitWhenConnected(a){for(var b=arguments.length,c=Array(b>1?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];if(this.state===lC.Reconnecting||this.isResuming||!this.engine||this.engine.pendingReconnect)this.bufferedEvents.push([a,c]);else if(this.state===lC.Connected)return this.emit(a,...c);return!1}simulateParticipants(a){return gS(this,void 0,void 0,function*(){var b,c;let d=Object.assign({audio:!0,video:!0,useRealTracks:!1},a.publish),e=Object.assign({count:9,audio:!1,video:!0,aspectRatios:[1.66,1.7,1.3]},a.participants);if(this.handleDisconnect(),this.roomInfo=new eR({sid:"RM_SIMULATED",name:"simulated-room",emptyTimeout:0,maxParticipants:0,creationTime:dN.parse(new Date().getTime()),metadata:"",numParticipants:1,numPublishers:1,turnPassword:"",enabledCodecs:[],activeRecording:!1}),this.localParticipant.updateInfo(new eU({identity:"simulated-local",name:"local-name"})),this.setupLocalParticipantEvents(),this.emit(lg.SignalConnected),this.emit(lg.Connected),this.setAndEmitConnectionState(lC.Connected),d.video){let a=new kh(ik.Kind.Video,new e$({source:eJ.CAMERA,sid:Math.floor(1e4*Math.random()).toString(),type:eI.AUDIO,name:"video-dummy"}),new jV(d.useRealTracks?(yield window.navigator.mediaDevices.getUserMedia({video:!0})).getVideoTracks()[0]:iN(160*(null!=(b=e.aspectRatios[0])?b:1),160,!0,!0),void 0,!1,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(a),this.localParticipant.emit(lh.LocalTrackPublished,a)}if(d.audio){let a=new kh(ik.Kind.Audio,new e$({source:eJ.MICROPHONE,sid:Math.floor(1e4*Math.random()).toString(),type:eI.AUDIO}),new jJ(d.useRealTracks?(yield navigator.mediaDevices.getUserMedia({audio:!0})).getAudioTracks()[0]:iO(),void 0,!1,this.audioContext,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(a),this.localParticipant.emit(lh.LocalTrackPublished,a)}for(let a=0;a<e.count-1;a+=1){let b=new eU({sid:Math.floor(1e4*Math.random()).toString(),identity:"simulated-".concat(a),state:eV.ACTIVE,tracks:[],joinedAt:dN.parse(Date.now())}),d=this.getOrCreateParticipant(b.identity,b);if(e.video){let f=iN(160*(null!=(c=e.aspectRatios[a%e.aspectRatios.length])?c:1),160,!1,!0),g=new e$({source:eJ.CAMERA,sid:Math.floor(1e4*Math.random()).toString(),type:eI.AUDIO});d.addSubscribedMediaTrack(f,g.sid,new MediaStream([f]),new RTCRtpReceiver),b.tracks=[...b.tracks,g]}if(e.audio){let a=iO(),c=new e$({source:eJ.MICROPHONE,sid:Math.floor(1e4*Math.random()).toString(),type:eI.AUDIO});d.addSubscribedMediaTrack(a,c.sid,new MediaStream([a]),new RTCRtpReceiver),b.tracks=[...b.tracks,c]}d.updateInfo(b)}})}emit(a){for(var b=arguments.length,c=Array(b>1?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];if(a!==lg.ActiveSpeakersChanged&&a!==lg.TranscriptionReceived){let b=(function a(b){return b.map(b=>{if(b)return Array.isArray(b)?a(b):"object"==typeof b?"logContext"in b?b.logContext:void 0:b})})(c).filter(a=>void 0!==a);(a===lg.TrackSubscribed||a===lg.TrackUnsubscribed)&&this.log.trace("subscribe trace: ".concat(a),Object.assign(Object.assign({},this.logContext),{event:a,args:b})),this.log.debug("room event ".concat(a),Object.assign(Object.assign({},this.logContext),{event:a,args:b}))}return super.emit(a,...c)}}kn.cleanupRegistry="undefined"!=typeof FinalizationRegistry&&new FinalizationRegistry(a=>{a()}),(k4=lD||(lD={}))[k4.IDLE=0]="IDLE",k4[k4.RUNNING=1]="RUNNING",k4[k4.SKIPPED=2]="SKIPPED",k4[k4.SUCCESS=3]="SUCCESS",k4[k4.FAILED=4]="FAILED";class ko extends gV.EventEmitter{constructor(a,b){let c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};super(),this.status=lD.IDLE,this.logs=[],this.options={},this.url=a,this.token=b,this.name=this.constructor.name,this.room=new kn(c.roomOptions),this.connectOptions=c.connectOptions,this.options=c}run(a){return gS(this,void 0,void 0,function*(){if(this.status!==lD.IDLE)throw Error("check is running already");this.setStatus(lD.RUNNING);try{yield this.perform()}catch(a){a instanceof Error&&(this.options.errorsAsWarnings?this.appendWarning(a.message):this.appendError(a.message))}return yield this.disconnect(),yield new Promise(a=>setTimeout(a,500)),this.status!==lD.SKIPPED&&this.setStatus(this.isSuccess()?lD.SUCCESS:lD.FAILED),a&&a(),this.getInfo()})}isSuccess(){return!this.logs.some(a=>"error"===a.level)}connect(a){return gS(this,void 0,void 0,function*(){return this.room.state===lC.Connected||(a||(a=this.url),yield this.room.connect(a,this.token,this.connectOptions)),this.room})}disconnect(){return gS(this,void 0,void 0,function*(){this.room&&this.room.state!==lC.Disconnected&&(yield this.room.disconnect(),yield new Promise(a=>setTimeout(a,500)))})}skip(){this.setStatus(lD.SKIPPED)}switchProtocol(a){return gS(this,void 0,void 0,function*(){let b=!1,c=!1;if(this.room.on(lg.Reconnecting,()=>{b=!0}),this.room.once(lg.Reconnected,()=>{c=!0}),this.room.simulateScenario("force-".concat(a)),yield new Promise(a=>setTimeout(a,1e3)),!b)return;let d=Date.now()+1e4;for(;Date.now()<d;){if(c)return;yield ip(100)}throw Error("Could not reconnect using ".concat(a," protocol after 10 seconds"))})}appendMessage(a){this.logs.push({level:"info",message:a}),this.emit("update",this.getInfo())}appendWarning(a){this.logs.push({level:"warning",message:a}),this.emit("update",this.getInfo())}appendError(a){this.logs.push({level:"error",message:a}),this.emit("update",this.getInfo())}setStatus(a){this.status=a,this.emit("update",this.getInfo())}get engine(){var a;return null==(a=this.room)?void 0:a.engine}getInfo(){return{logs:this.logs,name:this.name,status:this.status,description:this.description}}}function kp(a,b,c){var d;return(b="symbol"==typeof(d=function(a,b){if("object"!=typeof a||!a)return a;var c=a[Symbol.toPrimitive];if(void 0!==c){var d=c.call(a,b);if("object"!=typeof d)return d;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===b?String:Number)(a)}(b,"string"))?d:d+"")in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}gV.EventEmitter,new TextEncoder,new TextDecoder;class kq extends Error{constructor(a,b){var c;super(a,b),kp(this,"code","ERR_JOSE_GENERIC"),this.name=this.constructor.name,null==(c=Error.captureStackTrace)||c.call(Error,this,this.constructor)}}kp(kq,"code","ERR_JOSE_GENERIC"),kp(class extends kq{constructor(a,b){let c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"unspecified",d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"unspecified";super(a,{cause:{claim:c,reason:d,payload:b}}),kp(this,"code","ERR_JWT_CLAIM_VALIDATION_FAILED"),kp(this,"claim",void 0),kp(this,"reason",void 0),kp(this,"payload",void 0),this.claim=c,this.reason=d,this.payload=b}},"code","ERR_JWT_CLAIM_VALIDATION_FAILED"),kp(class extends kq{constructor(a,b){let c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"unspecified",d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"unspecified";super(a,{cause:{claim:c,reason:d,payload:b}}),kp(this,"code","ERR_JWT_EXPIRED"),kp(this,"claim",void 0),kp(this,"reason",void 0),kp(this,"payload",void 0),this.claim=c,this.reason=d,this.payload=b}},"code","ERR_JWT_EXPIRED"),kp(class extends kq{constructor(){super(...arguments),kp(this,"code","ERR_JOSE_ALG_NOT_ALLOWED")}},"code","ERR_JOSE_ALG_NOT_ALLOWED"),kp(class extends kq{constructor(){super(...arguments),kp(this,"code","ERR_JOSE_NOT_SUPPORTED")}},"code","ERR_JOSE_NOT_SUPPORTED"),kp(class extends kq{constructor(){let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"decryption operation failed",b=arguments.length>1?arguments[1]:void 0;super(a,b),kp(this,"code","ERR_JWE_DECRYPTION_FAILED")}},"code","ERR_JWE_DECRYPTION_FAILED"),kp(class extends kq{constructor(){super(...arguments),kp(this,"code","ERR_JWE_INVALID")}},"code","ERR_JWE_INVALID"),kp(class extends kq{constructor(){super(...arguments),kp(this,"code","ERR_JWS_INVALID")}},"code","ERR_JWS_INVALID"),kp(class extends kq{constructor(){super(...arguments),kp(this,"code","ERR_JWT_INVALID")}},"code","ERR_JWT_INVALID"),kp(class extends kq{constructor(){super(...arguments),kp(this,"code","ERR_JWK_INVALID")}},"code","ERR_JWK_INVALID"),kp(class extends kq{constructor(){super(...arguments),kp(this,"code","ERR_JWKS_INVALID")}},"code","ERR_JWKS_INVALID"),kp(class extends kq{constructor(){let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"no applicable key found in the JSON Web Key Set",b=arguments.length>1?arguments[1]:void 0;super(a,b),kp(this,"code","ERR_JWKS_NO_MATCHING_KEY")}},"code","ERR_JWKS_NO_MATCHING_KEY"),kp(class extends kq{constructor(){let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"multiple matching keys found in the JSON Web Key Set",b=arguments.length>1?arguments[1]:void 0;super(a,b),kp(this,Symbol.asyncIterator,void 0),kp(this,"code","ERR_JWKS_MULTIPLE_MATCHING_KEYS")}},"code","ERR_JWKS_MULTIPLE_MATCHING_KEYS"),kp(class extends kq{constructor(){let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"request timed out",b=arguments.length>1?arguments[1]:void 0;super(a,b),kp(this,"code","ERR_JWKS_TIMEOUT")}},"code","ERR_JWKS_TIMEOUT"),kp(class extends kq{constructor(){let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"signature verification failed",b=arguments.length>1?arguments[1]:void 0;super(a,b),kp(this,"code","ERR_JWS_SIGNATURE_VERIFICATION_FAILED")}},"code","ERR_JWS_SIGNATURE_VERIFICATION_FAILED");var kr="u">typeof globalThis?globalThis:a.g;function ks(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var kt,ku,kv,kw,kx,ky,kz,kA,kB,kC,kD,kE,kF,kG,kH,kI,kJ,kK,kL,kM,kN,kO,kP,kQ,kR,kS,kT,kU,kV,kW,kX,kY,kZ,k$,k_,k0,k1,k2,k3,k4,k5,k6,k7,k8,k9,la,lb,lc,ld,le,lf,lg,lh,li,lj,lk,ll,lm,ln,lo,lp,lq,lr,ls,lt,lu,lv,lw,lx,ly,lz,lA,lB,lC,lD,lE,lF={exports:{}},lG=lF.exports;let lH=ks((lE||(lE=1,m8=function(){var a=function(){},b="undefined",c=["trace","debug","info","warn","error"],d={},e=null;function f(a,b){var c=a[b];if("function"==typeof c.bind)return c.bind(a);try{return Function.prototype.bind.call(c,a)}catch{return function(){return Function.prototype.apply.apply(c,[a,arguments])}}}function g(){for(var d=this.getLevel(),e=0;e<c.length;e++){var f=c[e];this[f]=e<d?a:this.methodFactory(f,d,this.name)}if(this.log=this.debug,typeof console===b&&d<this.levels.SILENT)return"No console available for logging"}function h(a){return function(){typeof console!==b&&(g.call(this),this[a].apply(this,arguments))}}function i(c,d,e){var g;return"debug"===(g=c)&&(g="log"),typeof console!==b&&(void 0!==console[g]?f(console,g):void 0!==console.log?f(console,"log"):a)||h.apply(this,arguments)}function j(a,b){var f,h,j,k=this;function l(){}function m(a){var b=a;if("string"==typeof b&&void 0!==k.levels[b.toUpperCase()]&&(b=k.levels[b.toUpperCase()]),"number"==typeof b&&b>=0&&b<=k.levels.SILENT)return b;throw TypeError("log.setLevel() called with invalid level: "+a)}k.name=a,k.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},k.methodFactory=b||i,k.getLevel=function(){return j??h??f},k.setLevel=function(a,b){return j=m(a),!1!==b&&(c[j]||"silent").toUpperCase(),g.call(k)},k.setDefaultLevel=function(a){h=m(a),l()||k.setLevel(a,!1)},k.resetLevel=function(){j=null,g.call(k)},k.enableAll=function(a){k.setLevel(k.levels.TRACE,a)},k.disableAll=function(a){k.setLevel(k.levels.SILENT,a)},k.rebuild=function(){if(e!==k&&(f=m(e.getLevel())),g.call(k),e===k)for(var a in d)d[a].rebuild()},f=m(e?e.getLevel():"WARN");var n=l();null!=n&&(j=m(n)),g.call(k)}return(e=new j).getLogger=function(a){if("symbol"!=typeof a&&"string"!=typeof a||""===a)throw TypeError("You must supply a name when creating a logger.");var b=d[a];return b||(b=d[a]=new j(a,e.methodFactory)),b},e.noConflict=function(){return e},e.getLoggers=function(){return d},e.default=e,e},lF.exports?lF.exports=m8():lG.log=m8()),lF.exports));var lI=function(a,b){return(lI=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)Object.prototype.hasOwnProperty.call(b,c)&&(a[c]=b[c])})(a,b)};function lJ(a,b){if("function"!=typeof b&&null!==b)throw TypeError("Class extends value "+String(b)+" is not a constructor or null");function c(){this.constructor=a}lI(a,b),a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)}function lK(a,b){var c,d,e,f={label:0,sent:function(){if(1&e[0])throw e[1];return e[1]},trys:[],ops:[]},g=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return g.next=h(0),g.throw=h(1),g.return=h(2),"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function h(h){return function(i){var j=[h,i];if(c)throw TypeError("Generator is already executing.");for(;g&&(g=0,j[0]&&(f=0)),f;)try{if(c=1,d&&(e=2&j[0]?d.return:j[0]?d.throw||((e=d.return)&&e.call(d),0):d.next)&&!(e=e.call(d,j[1])).done)return e;switch(d=0,e&&(j=[2&j[0],e.value]),j[0]){case 0:case 1:e=j;break;case 4:return f.label++,{value:j[1],done:!1};case 5:f.label++,d=j[1],j=[0];continue;case 7:j=f.ops.pop(),f.trys.pop();continue;default:if(!(e=(e=f.trys).length>0&&e[e.length-1])&&(6===j[0]||2===j[0])){f=0;continue}if(3===j[0]&&(!e||j[1]>e[0]&&j[1]<e[3])){f.label=j[1];break}if(6===j[0]&&f.label<e[1]){f.label=e[1],e=j;break}if(e&&f.label<e[2]){f.label=e[2],f.ops.push(j);break}e[2]&&f.ops.pop(),f.trys.pop();continue}j=b.call(a,f)}catch(a){j=[6,a],d=0}finally{c=e=0}if(5&j[0])throw j[1];return{value:j[0]?j[1]:void 0,done:!0}}}}function lL(a){var b="function"==typeof Symbol&&Symbol.iterator,c=b&&a[b],d=0;if(c)return c.call(a);if(a&&"number"==typeof a.length)return{next:function(){return a&&d>=a.length&&(a=void 0),{value:a&&a[d++],done:!a}}};throw TypeError(b?"Object is not iterable.":"Symbol.iterator is not defined.")}function lM(a,b){var c="function"==typeof Symbol&&a[Symbol.iterator];if(!c)return a;var d,e,f=c.call(a),g=[];try{for(;(void 0===b||b-- >0)&&!(d=f.next()).done;)g.push(d.value)}catch(a){e={error:a}}finally{try{d&&!d.done&&(c=f.return)&&c.call(f)}finally{if(e)throw e.error}}return g}function lN(a,b,c){if(c||2==arguments.length)for(var d,e=0,f=b.length;e<f;e++)!d&&e in b||(d||(d=Array.prototype.slice.call(b,0,e)),d[e]=b[e]);return a.concat(d||Array.prototype.slice.call(b))}function lO(a){return this instanceof lO?(this.v=a,this):new lO(a)}function lP(a){return"function"==typeof a}function lQ(a){var b=a(function(a){Error.call(a),a.stack=Error().stack});return b.prototype=Object.create(Error.prototype),b.prototype.constructor=b,b}var lR=lQ(function(a){return function(b){a(this),this.message=b?b.length+` errors occurred during unsubscription:
`+b.map(function(a,b){return b+1+") "+a.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=b}});function lS(a,b){if(a){var c=a.indexOf(b);0<=c&&a.splice(c,1)}}var lT=function(){var a;function b(a){this.initialTeardown=a,this.closed=!1,this._parentage=null,this._finalizers=null}return b.prototype.unsubscribe=function(){var a,b,c,d,e;if(!this.closed){this.closed=!0;var f=this._parentage;if(f)if(this._parentage=null,Array.isArray(f))try{for(var g=lL(f),h=g.next();!h.done;h=g.next())h.value.remove(this)}catch(b){a={error:b}}finally{try{h&&!h.done&&(b=g.return)&&b.call(g)}finally{if(a)throw a.error}}else f.remove(this);var i=this.initialTeardown;if(lP(i))try{i()}catch(a){e=a instanceof lR?a.errors:[a]}var j=this._finalizers;if(j){this._finalizers=null;try{for(var k=lL(j),l=k.next();!l.done;l=k.next()){var m=l.value;try{lW(m)}catch(a){e=e??[],a instanceof lR?e=lN(lN([],lM(e)),lM(a.errors)):e.push(a)}}}catch(a){c={error:a}}finally{try{l&&!l.done&&(d=k.return)&&d.call(k)}finally{if(c)throw c.error}}}if(e)throw new lR(e)}},b.prototype.add=function(a){var c;if(a&&a!==this)if(this.closed)lW(a);else{if(a instanceof b){if(a.closed||a._hasParent(this))return;a._addParent(this)}(this._finalizers=null!=(c=this._finalizers)?c:[]).push(a)}},b.prototype._hasParent=function(a){var b=this._parentage;return b===a||Array.isArray(b)&&b.includes(a)},b.prototype._addParent=function(a){var b=this._parentage;this._parentage=Array.isArray(b)?(b.push(a),b):b?[b,a]:a},b.prototype._removeParent=function(a){var b=this._parentage;b===a?this._parentage=null:Array.isArray(b)&&lS(b,a)},b.prototype.remove=function(a){var c=this._finalizers;c&&lS(c,a),a instanceof b&&a._removeParent(this)},(a=new b).closed=!0,b.EMPTY=a,b}(),lU=lT.EMPTY;function lV(a){return a instanceof lT||a&&"closed"in a&&lP(a.remove)&&lP(a.add)&&lP(a.unsubscribe)}function lW(a){lP(a)?a():a.unsubscribe()}var lX=void 0,lY=function(a,b){for(var c=[],d=2;d<arguments.length;d++)c[d-2]=arguments[d];return setTimeout.apply(void 0,lN([a,b],lM(c)))};function lZ(a){lY(function(){throw a})}function l$(){}var l_=function(a){function b(b){var c=a.call(this)||this;return c.isStopped=!1,b?(c.destination=b,lV(b)&&b.add(c)):c.destination=l2,c}return lJ(b,a),b.create=function(a,b,c){return new l1(a,b,c)},b.prototype.next=function(a){this.isStopped||this._next(a)},b.prototype.error=function(a){this.isStopped||(this.isStopped=!0,this._error(a))},b.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},b.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,a.prototype.unsubscribe.call(this),this.destination=null)},b.prototype._next=function(a){this.destination.next(a)},b.prototype._error=function(a){try{this.destination.error(a)}finally{this.unsubscribe()}},b.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},b}(lT),l0=function(){function a(a){this.partialObserver=a}return a.prototype.next=function(a){var b=this.partialObserver;if(b.next)try{b.next(a)}catch(a){lZ(a)}},a.prototype.error=function(a){var b=this.partialObserver;if(b.error)try{b.error(a)}catch(a){lZ(a)}else lZ(a)},a.prototype.complete=function(){var a=this.partialObserver;if(a.complete)try{a.complete()}catch(a){lZ(a)}},a}(),l1=function(a){function b(b,c,d){var e=a.call(this)||this;return e.destination=new l0(lP(b)||!b?{next:b??void 0,error:c??void 0,complete:d??void 0}:b),e}return lJ(b,a),b}(l_),l2={closed:!0,next:l$,error:function(a){throw a},complete:l$},l3="function"==typeof Symbol&&Symbol.observable||"@@observable";function l4(a){return a}var l5=function(){function a(a){a&&(this._subscribe=a)}return a.prototype.lift=function(b){var c=new a;return c.source=this,c.operator=b,c},a.prototype.subscribe=function(a,b,c){var d,e,f=this,g=!function(a){return a&&a instanceof l_||a&&lP(a.next)&&lP(a.error)&&lP(a.complete)&&lV(a)}(a)?new l1(a,b,c):a;return d=f.operator,e=f.source,g.add(d?d.call(g,e):e?f._subscribe(g):f._trySubscribe(g)),g},a.prototype._trySubscribe=function(a){try{return this._subscribe(a)}catch(b){a.error(b)}},a.prototype.forEach=function(a,b){var c=this;return new(b=l6(b))(function(b,d){var e=new l1({next:function(b){try{a(b)}catch(a){d(a),e.unsubscribe()}},error:d,complete:b});c.subscribe(e)})},a.prototype._subscribe=function(a){var b;return null==(b=this.source)?void 0:b.subscribe(a)},a.prototype[l3]=function(){return this},a.prototype.pipe=function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];return(0===a.length?l4:1===a.length?a[0]:function(b){return a.reduce(function(a,b){return b(a)},b)})(this)},a.prototype.toPromise=function(a){var b=this;return new(a=l6(a))(function(a,c){var d;b.subscribe(function(a){return d=a},function(a){return c(a)},function(){return a(d)})})},a.create=function(b){return new a(b)},a}();function l6(a){var b;return null!=(b=a??lX)?b:Promise}function l7(a){return function(b){if(lP(null==b?void 0:b.lift))return b.lift(function(b){try{return a(b,this)}catch(a){this.error(a)}});throw TypeError("Unable to lift unknown Observable type")}}function l8(a,b,c,d,e){return new l9(a,b,c,d,e)}var l9=function(a){function b(b,c,d,e,f,g){var h=a.call(this,b)||this;return h.onFinalize=f,h.shouldUnsubscribe=g,h._next=c?function(a){try{c(a)}catch(a){b.error(a)}}:a.prototype._next,h._error=e?function(a){try{e(a)}catch(a){b.error(a)}finally{this.unsubscribe()}}:a.prototype._error,h._complete=d?function(){try{d()}catch(a){b.error(a)}finally{this.unsubscribe()}}:a.prototype._complete,h}return lJ(b,a),b.prototype.unsubscribe=function(){var b;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var c=this.closed;a.prototype.unsubscribe.call(this),c||null==(b=this.onFinalize)||b.call(this)}},b}(l_),ma=lQ(function(a){return function(){a(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),mb=function(a){function b(){var b=a.call(this)||this;return b.closed=!1,b.currentObservers=null,b.observers=[],b.isStopped=!1,b.hasError=!1,b.thrownError=null,b}return lJ(b,a),b.prototype.lift=function(a){var b=new mc(this,this);return b.operator=a,b},b.prototype._throwIfClosed=function(){if(this.closed)throw new ma},b.prototype.next=function(a){var b,c;if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));try{for(var d=lL(this.currentObservers),e=d.next();!e.done;e=d.next())e.value.next(a)}catch(a){b={error:a}}finally{try{e&&!e.done&&(c=d.return)&&c.call(d)}finally{if(b)throw b.error}}}},b.prototype.error=function(a){if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=a;for(var b=this.observers;b.length;)b.shift().error(a)}},b.prototype.complete=function(){if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;for(var a=this.observers;a.length;)a.shift().complete()}},b.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(b.prototype,"observed",{get:function(){var a;return(null==(a=this.observers)?void 0:a.length)>0},enumerable:!1,configurable:!0}),b.prototype._trySubscribe=function(b){return this._throwIfClosed(),a.prototype._trySubscribe.call(this,b)},b.prototype._subscribe=function(a){return this._throwIfClosed(),this._checkFinalizedStatuses(a),this._innerSubscribe(a)},b.prototype._innerSubscribe=function(a){var b=this,c=this.hasError,d=this.isStopped,e=this.observers;return c||d?lU:(this.currentObservers=null,e.push(a),new lT(function(){b.currentObservers=null,lS(e,a)}))},b.prototype._checkFinalizedStatuses=function(a){var b=this.hasError,c=this.thrownError,d=this.isStopped;b?a.error(c):d&&a.complete()},b.prototype.asObservable=function(){var a=new l5;return a.source=this,a},b.create=function(a,b){return new mc(a,b)},b}(l5),mc=function(a){function b(b,c){var d=a.call(this)||this;return d.destination=b,d.source=c,d}return lJ(b,a),b.prototype.next=function(a){var b,c;null==(c=null==(b=this.destination)?void 0:b.next)||c.call(b,a)},b.prototype.error=function(a){var b,c;null==(c=null==(b=this.destination)?void 0:b.error)||c.call(b,a)},b.prototype.complete=function(){var a,b;null==(b=null==(a=this.destination)?void 0:a.complete)||b.call(a)},b.prototype._subscribe=function(a){var b,c;return null!=(c=null==(b=this.source)?void 0:b.subscribe(a))?c:lU},b}(mb),md=(function(a){function b(b){var c=a.call(this)||this;return c._value=b,c}lJ(b,a),Object.defineProperty(b.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),b.prototype._subscribe=function(b){var c=a.prototype._subscribe.call(this,b);return c.closed||b.next(this._value),c},b.prototype.getValue=function(){var a=this.hasError,b=this.thrownError,c=this._value;if(a)throw b;return this._throwIfClosed(),c},b.prototype.next=function(b){a.prototype.next.call(this,this._value=b)}}(mb),function(){return Date.now()}),me=function(a){function b(b,c){return a.call(this)||this}return lJ(b,a),b.prototype.schedule=function(a,b){return this},b}(lT),mf=function(a,b){for(var c=[],d=2;d<arguments.length;d++)c[d-2]=arguments[d];return setInterval.apply(void 0,lN([a,b],lM(c)))},mg=function(a){function b(b,c){var d=a.call(this,b,c)||this;return d.scheduler=b,d.work=c,d.pending=!1,d}return lJ(b,a),b.prototype.schedule=function(a,b){if(void 0===b&&(b=0),this.closed)return this;this.state=a;var c,d=this.id,e=this.scheduler;return null!=d&&(this.id=this.recycleAsyncId(e,d,b)),this.pending=!0,this.delay=b,this.id=null!=(c=this.id)?c:this.requestAsyncId(e,this.id,b),this},b.prototype.requestAsyncId=function(a,b,c){return void 0===c&&(c=0),mf(a.flush.bind(a,this),c)},b.prototype.recycleAsyncId=function(a,b,c){if(void 0===c&&(c=0),null!=c&&this.delay===c&&!1===this.pending)return b;null!=b&&clearInterval(b)},b.prototype.execute=function(a,b){if(this.closed)return Error("executing a cancelled action");this.pending=!1;var c=this._execute(a,b);if(c)return c;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},b.prototype._execute=function(a,b){var c,d=!1;try{this.work(a)}catch(a){d=!0,c=a||Error("Scheduled action threw falsy error")}if(d)return this.unsubscribe(),c},b.prototype.unsubscribe=function(){if(!this.closed){var b=this.id,c=this.scheduler,d=c.actions;this.work=this.state=this.scheduler=null,this.pending=!1,lS(d,this),null!=b&&(this.id=this.recycleAsyncId(c,b,null)),this.delay=null,a.prototype.unsubscribe.call(this)}},b}(me),mh=function(){function a(b,c){void 0===c&&(c=a.now),this.schedulerActionCtor=b,this.now=c}return a.prototype.schedule=function(a,b,c){return void 0===b&&(b=0),new this.schedulerActionCtor(this,a).schedule(c,b)},a.now=md,a}();function mi(a){var b;return(b=a[a.length-1])&&lP(b.schedule)?a.pop():void 0}new(function(a){function b(b,c){void 0===c&&(c=mh.now);var d=a.call(this,b,c)||this;return d.actions=[],d._active=!1,d}return lJ(b,a),b.prototype.flush=function(a){var b,c=this.actions;if(this._active)return void c.push(a);this._active=!0;do if(b=a.execute(a.state,a.delay))break;while(a=c.shift())if(this._active=!1,b){for(;a=c.shift();)a.unsubscribe();throw b}},b}(mh))(mg);var mj=function(a){return a&&"number"==typeof a.length&&"function"!=typeof a};function mk(a){return lP(null==a?void 0:a.then)}function ml(a){return Symbol.asyncIterator&&lP(null==a?void 0:a[Symbol.asyncIterator])}function mm(a){return TypeError("You provided "+(null!==a&&"object"==typeof a?"an invalid object":"'"+a+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}var mn="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function mo(a){return lP(null==a?void 0:a[mn])}function mp(a){return function(a,b,c){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var d,e=c.apply(a,b||[]),f=[];return d=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),g("next"),g("throw"),g("return",function(a){return function(b){return Promise.resolve(b).then(a,j)}}),d[Symbol.asyncIterator]=function(){return this},d;function g(a,b){e[a]&&(d[a]=function(b){return new Promise(function(c,d){f.push([a,b,c,d])>1||h(a,b)})},b&&(d[a]=b(d[a])))}function h(a,b){try{var c;(c=e[a](b)).value instanceof lO?Promise.resolve(c.value.v).then(i,j):k(f[0][2],c)}catch(a){k(f[0][3],a)}}function i(a){h("next",a)}function j(a){h("throw",a)}function k(a,b){a(b),f.shift(),f.length&&h(f[0][0],f[0][1])}}(this,arguments,function(){var b,c,d;return lK(this,function(e){switch(e.label){case 0:b=a.getReader(),e.label=1;case 1:e.trys.push([1,,9,10]),e.label=2;case 2:return[4,lO(b.read())];case 3:return d=(c=e.sent()).value,c.done?[4,lO(void 0)]:[3,5];case 4:return[2,e.sent()];case 5:return[4,lO(d)];case 6:return[4,e.sent()];case 7:return e.sent(),[3,2];case 8:return[3,10];case 9:return b.releaseLock(),[7];case 10:return[2]}})})}function mq(a){return lP(null==a?void 0:a.getReader)}function mr(a){if(a instanceof l5)return a;if(null!=a){var b,c,d,e;if(lP(a[l3])){return b=a,new l5(function(a){var c=b[l3]();if(lP(c.subscribe))return c.subscribe(a);throw TypeError("Provided object does not correctly implement Symbol.observable")})}if(mj(a)){return c=a,new l5(function(a){for(var b=0;b<c.length&&!a.closed;b++)a.next(c[b]);a.complete()})}if(mk(a)){return d=a,new l5(function(a){d.then(function(b){a.closed||(a.next(b),a.complete())},function(b){return a.error(b)}).then(null,lZ)})}if(ml(a))return ms(a);if(mo(a)){return e=a,new l5(function(a){var b,c;try{for(var d=lL(e),f=d.next();!f.done;f=d.next()){var g=f.value;if(a.next(g),a.closed)return}}catch(a){b={error:a}}finally{try{f&&!f.done&&(c=d.return)&&c.call(d)}finally{if(b)throw b.error}}a.complete()})}if(mq(a))return ms(mp(a))}throw mm(a)}function ms(a){return new l5(function(b){(function(a,b){var c,d,e,f,g,h,i,j;return g=this,h=void 0,i=void 0,j=function(){var g;return lK(this,function(h){switch(h.label){case 0:h.trys.push([0,5,6,11]),c=function(a){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var b,c=a[Symbol.asyncIterator];return c?c.call(a):(a=lL(a),b={},d("next"),d("throw"),d("return"),b[Symbol.asyncIterator]=function(){return this},b);function d(c){b[c]=a[c]&&function(b){return new Promise(function(d,e){var f,g,h;f=d,g=e,h=(b=a[c](b)).done,Promise.resolve(b.value).then(function(a){f({value:a,done:h})},g)})}}}(a),h.label=1;case 1:return[4,c.next()];case 2:if((d=h.sent()).done)return[3,4];if(g=d.value,b.next(g),b.closed)return[2];h.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return e={error:h.sent()},[3,11];case 6:return h.trys.push([6,,9,10]),d&&!d.done&&(f=c.return)?[4,f.call(c)]:[3,8];case 7:h.sent(),h.label=8;case 8:return[3,10];case 9:if(e)throw e.error;return[7];case 10:return[7];case 11:return b.complete(),[2]}})},new(i||(i=Promise))(function(a,b){function c(a){try{e(j.next(a))}catch(a){b(a)}}function d(a){try{e(j.throw(a))}catch(a){b(a)}}function e(b){var e;b.done?a(b.value):((e=b.value)instanceof i?e:new i(function(a){a(e)})).then(c,d)}e((j=j.apply(g,h||[])).next())})})(a,b).catch(function(a){return b.error(a)})})}function mt(a,b,c,d,e){void 0===d&&(d=0),void 0===e&&(e=!1);var f=b.schedule(function(){c(),e?a.add(this.schedule(null,d)):this.unsubscribe()},d);if(a.add(f),!e)return f}function mu(a,b){return void 0===b&&(b=0),l7(function(c,d){c.subscribe(l8(d,function(c){return mt(d,a,function(){return d.next(c)},b)},function(){return mt(d,a,function(){return d.complete()},b)},function(c){return mt(d,a,function(){return d.error(c)},b)}))})}function mv(a,b){return void 0===b&&(b=0),l7(function(c,d){d.add(a.schedule(function(){return c.subscribe(d)},b))})}function mw(a,b){if(!a)throw Error("Iterable cannot be null");return new l5(function(c){mt(c,b,function(){var d=a[Symbol.asyncIterator]();mt(c,b,function(){d.next().then(function(a){a.done?c.complete():c.next(a.value)})},0,!0)})})}function mx(a,b){return l7(function(c,d){var e=0;c.subscribe(l8(d,function(c){d.next(a.call(b,c,e++))}))})}function my(){for(var a,b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];return(function a(b,c,d){return void 0===d&&(d=1/0),lP(c)?a(function(a,d){return mx(function(b,e){return c(a,b,d,e)})(mr(b(a,d)))},d):("number"==typeof c&&(d=c),l7(function(a,c){var e,f,g,h,i,j,k;return e=d,f=[],g=0,h=0,i=!1,j=function(){!i||f.length||g||c.complete()},k=function(a){g++;var d=!1;mr(b(a,h++)).subscribe(l8(c,function(a){c.next(a)},function(){d=!0},void 0,function(){if(d)try{for(g--;f.length&&g<e;)!function(){var a=f.shift();k(a)}();j()}catch(a){c.error(a)}}))},a.subscribe(l8(c,function(a){return g<e?k(a):f.push(a)},function(){i=!0,j()})),function(){}}))})(l4,1)((a=mi(b))?function(a,b){if(null!=a){if(lP(a[l3]))return mr(a).pipe(mv(b),mu(b));if(mj(a))return new l5(function(c){var d=0;return b.schedule(function(){d===a.length?c.complete():(c.next(a[d++]),c.closed||this.schedule())})});if(mk(a))return mr(a).pipe(mv(b),mu(b));if(ml(a))return mw(a,b);if(mo(a))return new l5(function(c){var d;return mt(c,b,function(){d=a[mn](),mt(c,b,function(){var a,b,e;try{b=(a=d.next()).value,e=a.done}catch(a){c.error(a);return}e?c.complete():c.next(b)},0,!0)}),function(){return lP(null==d?void 0:d.return)&&d.return()}});if(mq(a))return mw(mp(a),b)}throw mm(a)}(b,a):mr(b))}lQ(function(a){return function(b){void 0===b&&(b=null),a(this),this.message="Timeout has occurred",this.name="TimeoutError",this.info=b}});function mz(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];var c=mi(a);return l7(function(b,d){(c?my(a,b,c):my(a,b)).subscribe(d)})}Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;function mA(a){var b,c,d;return!(typeof a>"u")&&(!!(b=a)&&b.hasOwnProperty("participant")&&b.hasOwnProperty("source")&&b.hasOwnProperty("track")&&"u">typeof(null==(c=b.publication)?void 0:c.track)||!!(d=a)&&d.hasOwnProperty("participant")&&d.hasOwnProperty("source")&&d.hasOwnProperty("publication")&&"u">typeof d.publication)}function mB(a){var b;if("string"==typeof a||"number"==typeof a)return`${a}`;if((b=a)&&b.hasOwnProperty("participant")&&b.hasOwnProperty("source")&&typeof b.publication>"u")return`${a.participant.identity}_${a.source}_placeholder`;if(mA(a))return`${a.participant.identity}_${a.publication.source}_${a.publication.trackSid}`;throw Error(`Can't generate a id for the given track reference: ${a}`)}var mC=[lg.ConnectionStateChanged,lg.RoomMetadataChanged,lg.ActiveSpeakersChanged,lg.ConnectionQualityChanged,lg.ParticipantConnected,lg.ParticipantDisconnected,lg.ParticipantPermissionsChanged,lg.ParticipantMetadataChanged,lg.ParticipantNameChanged,lg.ParticipantAttributesChanged,lg.TrackMuted,lg.TrackUnmuted,lg.TrackPublished,lg.TrackUnpublished,lg.TrackStreamStateChanged,lg.TrackSubscriptionFailed,lg.TrackSubscriptionPermissionChanged,lg.TrackSubscriptionStatusChanged,lg.LocalTrackPublished,lg.LocalTrackUnpublished],mD=([...(lh.TrackPublished,lh.TrackUnpublished,lh.TrackMuted,lh.TrackUnmuted,lh.TrackStreamStateChanged,lh.TrackSubscribed,lh.TrackUnsubscribed,lh.TrackSubscriptionPermissionChanged,lh.TrackSubscriptionFailed,lh.LocalTrackPublished,lh.LocalTrackUnpublished,[lh.ConnectionQualityChanged,lh.IsSpeakingChanged,lh.ParticipantMetadataChanged,lh.ParticipantPermissionsChanged,lh.TrackMuted,lh.TrackUnmuted,lh.TrackPublished,lh.TrackUnpublished,lh.TrackStreamStateChanged,lh.TrackSubscriptionFailed,lh.TrackSubscriptionPermissionChanged,lh.TrackSubscriptionStatusChanged]),lh.LocalTrackPublished,lh.LocalTrackUnpublished],lH.getLogger("lk-components-js"));mD.setDefaultLevel("WARN");var mE=((m=mE||{}).AgentState="lk.agent.state",m.PublishOnBehalf="lk.publish_on_behalf",m.TranscriptionFinal="lk.transcription_final",m.TranscriptionSegmentId="lk.segment_id",m.TranscribedTrackId="lk.transcribed_track_id",m);function mF(a){return"object"==typeof a}function mG(a){return Array.isArray(a)&&a.filter(mF).length>0}function mH(a){return`lk-${a}`}function mI(a){if(mA(a))return a.publication;{let{source:b,name:c,participant:d}=a;if(b&&c)return d.getTrackPublications().find(a=>a.source===b&&a.trackName===c);if(c)return d.getTrackPublicationByName(c);if(b)return d.getTrackPublication(b);throw Error("At least one of source and name needs to be defined")}}function mJ(a,...b){return new l5(c=>{let d=()=>{c.next(a)};return b.forEach(b=>{a.on(b,d)}),()=>{b.forEach(b=>{a.off(b,d)})}}).pipe(mz(a))}function mK(a,...b){return new l5(c=>{let d=()=>{c.next(a)};return b.forEach(b=>{a.on(b,d)}),()=>{b.forEach(b=>{a.off(b,d)})}}).pipe(mz(a))}function mL(a){return mK(a,lh.TrackMuted,lh.TrackUnmuted,lh.ParticipantPermissionsChanged,lh.TrackPublished,lh.TrackUnpublished,lh.LocalTrackPublished,lh.LocalTrackUnpublished,lh.MediaDevicesError,lh.TrackSubscriptionStatusChanged).pipe(mx(a=>{let{isMicrophoneEnabled:b,isCameraEnabled:c,isScreenShareEnabled:d}=a,e=a.getTrackPublication(ik.Source.Microphone);return{isCameraEnabled:c,isMicrophoneEnabled:b,isScreenShareEnabled:d,cameraTrack:a.getTrackPublication(ik.Source.Camera),microphoneTrack:e,participant:a}}))}function mM(a){var b,c,d,e;return mK(a.participant,lh.TrackMuted,lh.TrackUnmuted,lh.TrackSubscribed,lh.TrackUnsubscribed,lh.LocalTrackPublished,lh.LocalTrackUnpublished).pipe(mx(b=>{var c,d;let e=null!=(c=a.publication)?c:b.getTrackPublication(a.source);return null==(d=null==e?void 0:e.isMuted)||d}),mz(null==(e=null!=(d=null==(b=a.publication)?void 0:b.isMuted)?d:null==(c=a.participant.getTrackPublication(a.source))?void 0:c.isMuted)||e))}function mN(a,b,c=!0){let d=[a.localParticipant,...Array.from(a.remoteParticipants.values())],e=[];return d.forEach(a=>{b.forEach(b=>{let d=Array.from(a.trackPublications.values()).filter(a=>a.source===b&&(!c||a.track)).map(b=>({participant:a,publication:b,source:b.source}));e.push(...d)})}),{trackReferences:e,participants:d}}var{load:mO,save:mP}=(m9="lk-user-choices",{load:()=>(function(a){if(typeof localStorage>"u")return void mD.error("Local storage is not available.");try{let b=localStorage.getItem(a);if(!b)return void mD.warn(`Item with key ${a} does not exist in local storage.`);return JSON.parse(b)}catch(a){mD.error(`Error getting item from local storage: ${a}`);return}})(m9),save:a=>(function(a,b){if(typeof localStorage>"u")return void mD.error("Local storage is not available.");try{if(b){let c=Object.fromEntries(Object.entries(b).filter(([,a])=>""!==a));localStorage.setItem(a,JSON.stringify(c))}}catch(a){mD.error(`Error setting item to local storage: ${a}`)}})(m9,a)});t.createContext(void 0);let mQ=t.createContext(void 0);function mR(){return t.useContext(mQ)}function mS(a){let b=mR(),c=a??b;if(!c)throw Error("No TrackRef, make sure you are inside a TrackRefContext or pass the TrackRef explicitly");return c}let mT=t.createContext(void 0);function mU(a){let b=t.useContext(mT),c=mR(),d=a??b??(null==c?void 0:c.participant);if(!d)throw Error("No participant provided, make sure you are inside a participant context or pass the participant explicitly");return d}let mV=t.createContext(void 0);function mW(){let a=t.useContext(mV);if(!a)throw Error("tried to access room context outside of livekit room component");return a}function mX(a){let b=t.useContext(mV),c=a??b;if(!c)throw Error("No room provided, make sure you are inside a Room context or pass the room explicitly");return c}t.createContext(void 0);let mY=t.createContext(void 0);function mZ(){for(var a,b,c=0,d="",e=arguments.length;c<e;c++)(a=arguments[c])&&(b=function a(b){var c,d,e="";if("string"==typeof b||"number"==typeof b)e+=b;else if("object"==typeof b)if(Array.isArray(b)){var f=b.length;for(c=0;c<f;c++)b[c]&&(d=a(b[c]))&&(e&&(e+=" "),e+=d)}else for(d in b)b[d]&&(e&&(e+=" "),e+=d);return e}(a))&&(d&&(d+=" "),d+=b);return d}function m$(...a){let b={...a[0]};for(let c=1;c<a.length;c++){let d=a[c];for(let a in d){let c=b[a],e=d[a];"function"==typeof c&&"function"==typeof e&&"o"===a[0]&&"n"===a[1]&&a.charCodeAt(2)>=65&&90>=a.charCodeAt(2)?b[a]=function(...a){return(...b)=>{for(let c of a)if("function"==typeof c)try{c(...b)}catch(a){console.error(a)}}}(c,e):("className"===a||"UNSAFE_className"===a)&&"string"==typeof c&&"string"==typeof e?b[a]=mZ(c,e):b[a]=void 0!==e?e:c}}return b}function m_(a){return void 0!==a}function m0(...a){return m$(...a.filter(m_))}function m1(a,b){return"processor"===a&&b&&"object"==typeof b&&"name"in b?b.name:"e2ee"===a&&b?"e2ee-enabled":b}let m2={connect:!0,audio:!1,video:!1},m3=t.forwardRef(function(a,b){let{room:c,htmlProps:d}=function(a){let{token:b,serverUrl:c,options:d,room:e,connectOptions:f,connect:g,audio:h,video:i,screen:j,onConnected:k,onDisconnected:l,onError:m,onMediaDeviceFailure:n,onEncryptionError:o,simulateParticipants:p,...q}={...m2,...a};d&&e&&mD.warn("when using a manually created room, the options object will be ignored. set the desired options directly when creating the room instead.");let[r,s]=t.useState(),u=t.useRef(g);t.useEffect(()=>{s(e??new kn(d))},[e,JSON.stringify(d,m1)]);let v=t.useMemo(()=>{let{className:a}={className:"lk-room-container"};return m$(q,{className:a})},[q]);return t.useEffect(()=>{if(!r)return;let a=()=>{let a=r.localParticipant;mD.debug("trying to publish local tracks"),Promise.all([a.setMicrophoneEnabled(!!h,"boolean"!=typeof h?h:void 0),a.setCameraEnabled(!!i,"boolean"!=typeof i?i:void 0),a.setScreenShareEnabled(!!j,"boolean"!=typeof j?j:void 0)]).catch(a=>{mD.warn(a),null==m||m(a)})},b=(a,b)=>{let c=lf.getFailure(a);null==n||n(c,b)},c=a=>{null==o||o(a)},d=a=>{null==l||l(a)},e=()=>{null==k||k()};return r.on(lg.SignalConnected,a).on(lg.MediaDevicesError,b).on(lg.EncryptionError,c).on(lg.Disconnected,d).on(lg.Connected,e),()=>{r.off(lg.SignalConnected,a).off(lg.MediaDevicesError,b).off(lg.EncryptionError,c).off(lg.Disconnected,d).off(lg.Connected,e)}},[r,h,i,j,m,o,n,k,l]),t.useEffect(()=>{if(r){if(p)return void r.simulateParticipants({participants:{count:p},publish:{audio:!0,useRealTracks:!0}});if(g){if(u.current=!0,mD.debug("connecting"),!b)return void mD.debug("no token yet");if(!c){mD.warn("no livekit url provided"),null==m||m(Error("no livekit url provided"));return}r.connect(c,b,f).catch(a=>{mD.warn(a),!0===u.current&&(null==m||m(a))})}else mD.debug("disconnecting because connect is false"),u.current=!1,r.disconnect()}},[g,b,JSON.stringify(f),r,m,c,p]),t.useEffect(()=>{if(r)return()=>{mD.info("disconnecting on onmount"),r.disconnect()}},[r]),{room:r,htmlProps:v}}(a);return t.createElement("div",{ref:b,...d},c&&t.createElement(mV.Provider,{value:c},t.createElement(mY.Provider,{value:a.featureFlags},a.children)))});function m4(a,b,c=!0){let[d,e]=t.useState(b);return t.useEffect(()=>{c&&e(b)},[a,c]),d}function m5(a={}){let b=mX(a.room),[c,d]=t.useState(b.localParticipant),[e,f]=t.useState(c.isMicrophoneEnabled),[g,h]=t.useState(c.isCameraEnabled),[i,j]=t.useState(c.isScreenShareEnabled),[k,l]=t.useState(c.lastMicrophoneError),[m,n]=t.useState(c.lastCameraError),[o,p]=t.useState(void 0),[q,r]=t.useState(void 0),s=a=>{h(a.isCameraEnabled),f(a.isMicrophoneEnabled),j(a.isScreenShareEnabled),r(a.cameraTrack),p(a.microphoneTrack),l(a.participant.lastMicrophoneError),n(a.participant.lastCameraError),d(a.participant)};return t.useEffect(()=>{let a=mL(b.localParticipant).subscribe(s);return()=>a.unsubscribe()},[b]),{isMicrophoneEnabled:e,isScreenShareEnabled:i,isCameraEnabled:g,microphoneTrack:o,cameraTrack:q,lastMicrophoneError:k,lastCameraError:m,localParticipant:c}}function m6(a=[ik.Source.Camera,ik.Source.Microphone,ik.Source.ScreenShare,ik.Source.ScreenShareAudio,ik.Source.Unknown],b={}){let c=mX(b.room),[d,e]=t.useState([]),[f,g]=t.useState([]),h=t.useMemo(()=>a.map(a=>mF(a)?a.source:a),[JSON.stringify(a)]);return t.useEffect(()=>{var a,d,f;let i,j,k=(i=null!=(d=(a={additionalRoomEvents:b.updateOnlyOn,onlySubscribed:b.onlySubscribed}).additionalRoomEvents)?d:mC,j=null==(f=a.onlySubscribed)||f,mJ(c,...Array.from(new Set([lg.ParticipantConnected,lg.ParticipantDisconnected,lg.ConnectionStateChanged,lg.LocalTrackPublished,lg.LocalTrackUnpublished,lg.TrackPublished,lg.TrackUnpublished,lg.TrackSubscriptionStatusChanged,...i]).values())).pipe(mx(a=>{let b=mN(a,h,j);return mD.debug(`TrackReference[] was updated. (length ${b.trackReferences.length})`,b),b}),mz(mN(c,h,j)))).subscribe(({trackReferences:a,participants:b})=>{mD.debug("setting track bundles",a,b),e(a),g(b)});return()=>k.unsubscribe()},[c,JSON.stringify(b.onlySubscribed),JSON.stringify(b.updateOnlyOn),JSON.stringify(a)]),t.useMemo(()=>{if(!mG(a))return d;{let b=function(a,b){let c=new Map;if(mG(a)){let d=a.filter(a=>a.withPlaceholder).map(a=>a.source);b.forEach(a=>{let b=a.getTrackPublications().map(a=>{var b;return null==(b=a.track)?void 0:b.source}).filter(a=>void 0!==a),e=Array.from(function(a,b){let c=new Set(a);for(let a of b)c.delete(a);return c}(new Set(d),new Set(b)));e.length>0&&c.set(a.identity,e)})}return c}(a,f),c=Array.from(d);return f.forEach(a=>{b.has(a.identity)&&(b.get(a.identity)??[]).forEach(b=>{d.find(({participant:c,publication:d})=>a.identity===c.identity&&d.source===b)||(mD.debug(`Add ${b} placeholder for participant ${a.identity}.`),c.push({participant:a,source:b}))})}),c}},[d,f,a])}let m7={bands:5,loPass:100,hiPass:600,updateInterval:32,analyserOptions:{fftSize:2048}};mE.AgentState;var m8,m9,na,nb={exports:{}};!function(){if(na)return nb.exports;na=1;var a,b="object"==typeof Reflect?Reflect:null,c=b&&"function"==typeof b.apply?b.apply:function(a,b,c){return Function.prototype.apply.call(a,b,c)};a=b&&"function"==typeof b.ownKeys?b.ownKeys:Object.getOwnPropertySymbols?function(a){return Object.getOwnPropertyNames(a).concat(Object.getOwnPropertySymbols(a))}:function(a){return Object.getOwnPropertyNames(a)};var d=Number.isNaN||function(a){return a!=a};function e(){e.init.call(this)}nb.exports=e,nb.exports.once=function(a,b){return new Promise(function(c,d){var e,f,g;function h(c){a.removeListener(b,i),d(c)}function i(){"function"==typeof a.removeListener&&a.removeListener("error",h),c([].slice.call(arguments))}o(a,b,i,{once:!0}),"error"!==b&&(e=a,f=h,g={once:!0},"function"==typeof e.on&&o(e,"error",f,g))})},e.EventEmitter=e,e.prototype._events=void 0,e.prototype._eventsCount=0,e.prototype._maxListeners=void 0;var f=10;function g(a){if("function"!=typeof a)throw TypeError('The "listener" argument must be of type Function. Received type '+typeof a)}function h(a){return void 0===a._maxListeners?e.defaultMaxListeners:a._maxListeners}function i(a,b,c,d){var e,f,i;if(g(c),void 0===(f=a._events)?(f=a._events=Object.create(null),a._eventsCount=0):(void 0!==f.newListener&&(a.emit("newListener",b,c.listener?c.listener:c),f=a._events),i=f[b]),void 0===i)i=f[b]=c,++a._eventsCount;else if("function"==typeof i?i=f[b]=d?[c,i]:[i,c]:d?i.unshift(c):i.push(c),(e=h(a))>0&&i.length>e&&!i.warned){i.warned=!0;var j=Error("Possible EventEmitter memory leak detected. "+i.length+" "+String(b)+" listeners added. Use emitter.setMaxListeners() to increase limit");j.name="MaxListenersExceededWarning",j.emitter=a,j.type=b,j.count=i.length,console&&console.warn&&console.warn(j)}return a}function j(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0==arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function k(a,b,c){var d={fired:!1,wrapFn:void 0,target:a,type:b,listener:c},e=j.bind(d);return e.listener=c,d.wrapFn=e,e}function l(a,b,c){var d=a._events;if(void 0===d)return[];var e=d[b];return void 0===e?[]:"function"==typeof e?c?[e.listener||e]:[e]:c?function(a){for(var b=Array(a.length),c=0;c<b.length;++c)b[c]=a[c].listener||a[c];return b}(e):n(e,e.length)}function m(a){var b=this._events;if(void 0!==b){var c=b[a];if("function"==typeof c)return 1;if(void 0!==c)return c.length}return 0}function n(a,b){for(var c=Array(b),d=0;d<b;++d)c[d]=a[d];return c}function o(a,b,c,d){if("function"==typeof a.on)d.once?a.once(b,c):a.on(b,c);else if("function"==typeof a.addEventListener)a.addEventListener(b,function e(f){d.once&&a.removeEventListener(b,e),c(f)});else throw TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof a)}Object.defineProperty(e,"defaultMaxListeners",{enumerable:!0,get:function(){return f},set:function(a){if("number"!=typeof a||a<0||d(a))throw RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+a+".");f=a}}),e.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},e.prototype.setMaxListeners=function(a){if("number"!=typeof a||a<0||d(a))throw RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+a+".");return this._maxListeners=a,this},e.prototype.getMaxListeners=function(){return h(this)},e.prototype.emit=function(a){for(var b=[],d=1;d<arguments.length;d++)b.push(arguments[d]);var e="error"===a,f=this._events;if(void 0!==f)e=e&&void 0===f.error;else if(!e)return!1;if(e){if(b.length>0&&(g=b[0]),g instanceof Error)throw g;var g,h=Error("Unhandled error."+(g?" ("+g.message+")":""));throw h.context=g,h}var i=f[a];if(void 0===i)return!1;if("function"==typeof i)c(i,this,b);else for(var j=i.length,k=n(i,j),d=0;d<j;++d)c(k[d],this,b);return!0},e.prototype.addListener=function(a,b){return i(this,a,b,!1)},e.prototype.on=e.prototype.addListener,e.prototype.prependListener=function(a,b){return i(this,a,b,!0)},e.prototype.once=function(a,b){return g(b),this.on(a,k(this,a,b)),this},e.prototype.prependOnceListener=function(a,b){return g(b),this.prependListener(a,k(this,a,b)),this},e.prototype.removeListener=function(a,b){var c,d,e,f,h;if(g(b),void 0===(d=this._events)||void 0===(c=d[a]))return this;if(c===b||c.listener===b)0==--this._eventsCount?this._events=Object.create(null):(delete d[a],d.removeListener&&this.emit("removeListener",a,c.listener||b));else if("function"!=typeof c){for(e=-1,f=c.length-1;f>=0;f--)if(c[f]===b||c[f].listener===b){h=c[f].listener,e=f;break}if(e<0)return this;0===e?c.shift():function(a,b){for(;b+1<a.length;b++)a[b]=a[b+1];a.pop()}(c,e),1===c.length&&(d[a]=c[0]),void 0!==d.removeListener&&this.emit("removeListener",a,h||b)}return this},e.prototype.off=e.prototype.removeListener,e.prototype.removeAllListeners=function(a){var b,c,d;if(void 0===(c=this._events))return this;if(void 0===c.removeListener)return 0==arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==c[a]&&(0==--this._eventsCount?this._events=Object.create(null):delete c[a]),this;if(0==arguments.length){var e,f=Object.keys(c);for(d=0;d<f.length;++d)"removeListener"!==(e=f[d])&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(b=c[a]))this.removeListener(a,b);else if(void 0!==b)for(d=b.length-1;d>=0;d--)this.removeListener(a,b[d]);return this},e.prototype.listeners=function(a){return l(this,a,!0)},e.prototype.rawListeners=function(a){return l(this,a,!1)},e.listenerCount=function(a,b){return"function"==typeof a.listenerCount?a.listenerCount(b):m.call(a,b)},e.prototype.listenerCount=m,e.prototype.eventNames=function(){return this._eventsCount>0?a(this._events):[]},nb.exports}();var nc=((n=nc||{}).CameraChanged="cameraChanged",n.MicrophoneChanged="microphoneChanged",n.StateChanged="stateChanged",n),nd=((o=nd||{}).ConnectionStateChanged="connectionStateChanged",o.MediaDevicesError="mediaDevicesError",o.EncryptionError="encryptionError",o),ne=((p=ne||{}).MessageReceived="messageReceived",p);let nf=a=>t.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor",...a},t.createElement("path",{d:"M1.354.646a.5.5 0 1 0-.708.708l14 14a.5.5 0 0 0 .708-.708L11 10.293V4.5A1.5 1.5 0 0 0 9.5 3H3.707zM0 4.5a1.5 1.5 0 0 1 .943-1.393l9.532 9.533c-.262.224-.603.36-.975.36h-8A1.5 1.5 0 0 1 0 11.5z"}),t.createElement("path",{d:"m15.2 3.6-2.8 2.1a1 1 0 0 0-.4.8v3a1 1 0 0 0 .4.8l2.8 2.1a.5.5 0 0 0 .8-.4V4a.5.5 0 0 0-.8-.4z"})),ng=a=>t.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor",...a},t.createElement("path",{d:"M0 4.5A1.5 1.5 0 0 1 1.5 3h8A1.5 1.5 0 0 1 11 4.5v7A1.5 1.5 0 0 1 9.5 13h-8A1.5 1.5 0 0 1 0 11.5zM15.2 3.6l-2.8 2.1a1 1 0 0 0-.4.8v3a1 1 0 0 0 .4.8l2.8 2.1a.5.5 0 0 0 .8-.4V4a.5.5 0 0 0-.8-.4z"})),nh=a=>t.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor",...a},t.createElement("path",{d:"M12.227 11.52a5.477 5.477 0 0 0 1.246-2.97.5.5 0 0 0-.995-.1 4.478 4.478 0 0 1-.962 2.359l-1.07-1.07C10.794 9.247 11 8.647 11 8V3a3 3 0 0 0-6 0v1.293L1.354.646a.5.5 0 1 0-.708.708l14 14a.5.5 0 0 0 .708-.708zM8 12.5c.683 0 1.33-.152 1.911-.425l.743.743c-.649.359-1.378.59-2.154.66V15h2a.5.5 0 0 1 0 1h-5a.5.5 0 0 1 0-1h2v-1.522a5.502 5.502 0 0 1-4.973-4.929.5.5 0 0 1 .995-.098A4.5 4.5 0 0 0 8 12.5z"}),t.createElement("path",{d:"M8.743 10.907 5 7.164V8a3 3 0 0 0 3.743 2.907z"})),ni=a=>t.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor",...a},t.createElement("path",{fillRule:"evenodd",d:"M2.975 8.002a.5.5 0 0 1 .547.449 4.5 4.5 0 0 0 8.956 0 .5.5 0 1 1 .995.098A5.502 5.502 0 0 1 8.5 13.478V15h2a.5.5 0 0 1 0 1h-5a.5.5 0 0 1 0-1h2v-1.522a5.502 5.502 0 0 1-4.973-4.929.5.5 0 0 1 .448-.547z",clipRule:"evenodd"}),t.createElement("path",{d:"M5 3a3 3 0 1 1 6 0v5a3 3 0 0 1-6 0z"})),nj=a=>t.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor",...a},t.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),t.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"})),nk=a=>t.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor",...a},t.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),t.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),t.createElement("g",{opacity:.25},t.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),t.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}))),nl=a=>t.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor",...a},t.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),t.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),t.createElement("g",{opacity:.25},t.createElement("path",{d:"M6 6.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),t.createElement("path",{d:"M6 6.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),t.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}))),nm=a=>t.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor",...a},t.createElement("g",{opacity:.25},t.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-4Zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-9Zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5V.5Z"}),t.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-4Zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-9Zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5V.5Z"}))),nn=a=>t.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:20,height:16,fill:"none",...a},t.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M0 2.75A2.75 2.75 0 0 1 2.75 0h14.5A2.75 2.75 0 0 1 20 2.75v10.5A2.75 2.75 0 0 1 17.25 16H2.75A2.75 2.75 0 0 1 0 13.25V2.75ZM2.75 1.5c-.69 0-1.25.56-1.25 1.25v10.5c0 .69.56 1.25 1.25 1.25h14.5c.69 0 1.25-.56 1.25-1.25V2.75c0-.69-.56-1.25-1.25-1.25H2.75Z",clipRule:"evenodd"}),t.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M9.47 4.22a.75.75 0 0 1 1.06 0l2.25 2.25a.75.75 0 0 1-1.06 1.06l-.97-.97v4.69a.75.75 0 0 1-1.5 0V6.56l-.97.97a.75.75 0 0 1-1.06-1.06l2.25-2.25Z",clipRule:"evenodd"})),no=a=>t.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:20,height:16,fill:"none",...a},t.createElement("g",{fill:"currentColor"},t.createElement("path",{d:"M7.28 4.22a.75.75 0 0 0-1.06 1.06L8.94 8l-2.72 2.72a.75.75 0 1 0 1.06 1.06L10 9.06l2.72 2.72a.75.75 0 1 0 1.06-1.06L11.06 8l2.72-2.72a.75.75 0 0 0-1.06-1.06L10 6.94z"}),t.createElement("path",{fillRule:"evenodd",d:"M2.75 0A2.75 2.75 0 0 0 0 2.75v10.5A2.75 2.75 0 0 0 2.75 16h14.5A2.75 2.75 0 0 0 20 13.25V2.75A2.75 2.75 0 0 0 17.25 0zM1.5 2.75c0-.69.56-1.25 1.25-1.25h14.5c.69 0 1.25.56 1.25 1.25v10.5c0 .69-.56 1.25-1.25 1.25H2.75c-.69 0-1.25-.56-1.25-1.25z",clipRule:"evenodd"})));function np(a,b={}){let[c,d]=t.useState(mI(a)),[e,f]=t.useState(null==c?void 0:c.isMuted),[g,h]=t.useState(null==c?void 0:c.isSubscribed),[i,j]=t.useState(null==c?void 0:c.track),[k,l]=t.useState("landscape"),m=t.useRef(),{className:n,trackObserver:o}=t.useMemo(()=>{let b,c;return b=mI(a),c=mL(a.participant).pipe(mx(()=>mI(a)),mz(b)),{className:mH(a.source===ik.Source.Camera||a.source===ik.Source.ScreenShare?"participant-media-video":"participant-media-audio"),trackObserver:c}},[a.participant.sid??a.participant.identity,a.source,mA(a)&&a.publication.trackSid]);return t.useEffect(()=>{let a=o.subscribe(a=>{mD.debug("update track",a),d(a),f(null==a?void 0:a.isMuted),h(null==a?void 0:a.isSubscribed),j(null==a?void 0:a.track)});return()=>null==a?void 0:a.unsubscribe()},[o]),t.useEffect(()=>{var c,d;return i&&(m.current&&i.detach(m.current),null!=(c=b.element)&&c.current&&!(a.participant.isLocal&&(null==i?void 0:i.kind)==="audio")&&i.attach(b.element.current)),m.current=null==(d=b.element)?void 0:d.current,()=>{m.current&&(null==i||i.detach(m.current))}},[i,b.element]),t.useEffect(()=>{var a,b;"number"==typeof(null==(a=null==c?void 0:c.dimensions)?void 0:a.width)&&"number"==typeof(null==(b=null==c?void 0:c.dimensions)?void 0:b.height)&&l(c.dimensions.width>c.dimensions.height?"landscape":"portrait")},[c]),{publication:c,isMuted:e,isSubscribed:g,track:i,elementProps:m0(b.props,{className:n,"data-lk-local-participant":a.participant.isLocal,"data-lk-source":null==c?void 0:c.source,...(null==c?void 0:c.kind)==="video"&&{"data-lk-orientation":k}})}}let nq=ks(function(){if(r)return q;r=1;var a=NaN,b=/^\s+|\s+$/g,c=/^[-+]0x[0-9a-f]+$/i,d=/^0b[01]+$/i,e=/^0o[0-7]+$/i,f=parseInt,g="object"==typeof kr&&kr&&kr.Object===Object&&kr,h="object"==typeof self&&self&&self.Object===Object&&self,i=g||h||Function("return this")(),j=Object.prototype.toString,k=Math.max,l=Math.min,m=function(){return i.Date.now()};function n(a){var b=typeof a;return!!a&&("object"==b||"function"==b)}function o(g){if("number"==typeof g)return g;if("symbol"==typeof(h=g)||h&&"object"==typeof h&&"[object Symbol]"==j.call(h))return a;if(n(g)){var h,i="function"==typeof g.valueOf?g.valueOf():g;g=n(i)?i+"":i}if("string"!=typeof g)return 0===g?g:+g;g=g.replace(b,"");var k=d.test(g);return k||e.test(g)?f(g.slice(2),k?2:8):c.test(g)?a:+g}return q=function(a,b,c){var d,e,f,g,h,i,j=0,p=!1,q=!1,r=!0;if("function"!=typeof a)throw TypeError("Expected a function");function s(b){var c=d,f=e;return d=e=void 0,j=b,g=a.apply(f,c)}function t(a){var c=a-i,d=a-j;return void 0===i||c>=b||c<0||q&&d>=f}function u(){var a,c,d,e=m();if(t(e))return v(e);h=setTimeout(u,(a=e-i,c=e-j,d=b-a,q?l(d,f-c):d))}function v(a){return h=void 0,r&&d?s(a):(d=e=void 0,g)}function w(){var a,c=m(),f=t(c);if(d=arguments,e=this,i=c,f){if(void 0===h)return j=a=i,h=setTimeout(u,b),p?s(a):g;if(q)return h=setTimeout(u,b),s(i)}return void 0===h&&(h=setTimeout(u,b)),g}return b=o(b)||0,n(c)&&(p=!!c.leading,f=(q="maxWait"in c)?k(o(c.maxWait)||0,b):f,r="trailing"in c?!!c.trailing:r),w.cancel=function(){void 0!==h&&clearTimeout(h),j=0,d=i=e=h=void 0},w.flush=function(){return void 0===h?g:v(m())},w}}()),nr=t.forwardRef(function({onTrackClick:a,onClick:b,onSubscriptionStatusChanged:c,trackRef:d,manageSubscription:e,...f},g){let h=mS(d),i=t.useRef(null);t.useImperativeHandle(g,()=>i.current);let j=function({threshold:a=0,root:b=null,rootMargin:c="0%",freezeOnceVisible:d=!1,initialIsIntersecting:e=!1,onChange:f}={}){var g;let[h,i]=(0,t.useState)(null),[j,k]=(0,t.useState)(()=>({isIntersecting:e,entry:void 0})),l=(0,t.useRef)();l.current=f;let m=(null==(g=j.entry)?void 0:g.isIntersecting)&&d;(0,t.useEffect)(()=>{if(!h||!("IntersectionObserver"in window)||m)return;let d=new IntersectionObserver(a=>{let b=Array.isArray(d.thresholds)?d.thresholds:[d.thresholds];a.forEach(a=>{let c=a.isIntersecting&&b.some(b=>a.intersectionRatio>=b);k({isIntersecting:c,entry:a}),l.current&&l.current(c,a)})},{threshold:a,root:b,rootMargin:c});return d.observe(h),()=>{d.disconnect()}},[h,JSON.stringify(a),b,c,m,d]);let n=(0,t.useRef)(null);(0,t.useEffect)(()=>{var a;h||null==(a=j.entry)||!a.target||d||m||n.current===j.entry.target||(n.current=j.entry.target,k({isIntersecting:e,entry:void 0}))},[h,j.entry,d,m,e]);let o=[i,!!j.isIntersecting,j.entry];return o.ref=o[0],o.isIntersecting=o[1],o.entry=o[2],o}({root:i.current}),[k]=function(a,b,c){let d=a instanceof Function?a():a,[e,f]=(0,t.useState)(d),g=(0,t.useRef)(d),h=function(a,b=500,c){var d;let e,f=(0,t.useRef)();d=()=>{f.current&&f.current.cancel()},(e=(0,t.useRef)(d)).current=d,(0,t.useEffect)(()=>()=>{e.current()},[]);let g=(0,t.useMemo)(()=>{let d=nq(a,b,c),e=(...a)=>d(...a);return e.cancel=()=>{d.cancel()},e.isPending=()=>!!f.current,e.flush=()=>d.flush(),e},[a,b,c]);return(0,t.useEffect)(()=>{f.current=nq(a,b,c)},[a,b,c]),g}(f,3e3,void 0);return g.current===d||(h(d),g.current=d),[e,h]}(j,0);t.useEffect(()=>{e&&h.publication instanceof kl&&(null==k?void 0:k.isIntersecting)===!1&&(null==j?void 0:j.isIntersecting)===!1&&h.publication.setSubscribed(!1)},[k,h,e]),t.useEffect(()=>{e&&h.publication instanceof kl&&(null==j?void 0:j.isIntersecting)===!0&&h.publication.setSubscribed(!0)},[j,h,e]);let{elementProps:l,publication:m,isSubscribed:n}=np(h,{element:i,props:f});return t.useEffect(()=>{null==c||c(!!n)},[n,c]),t.createElement("video",{ref:i,...l,muted:!0,onClick:c=>{null==b||b(c),null==a||a({participant:null==h?void 0:h.participant,track:m})}})}),ns=t.forwardRef(function({trackRef:a,onSubscriptionStatusChanged:b,volume:c,...d},e){let f=mS(a),g=t.useRef(null);t.useImperativeHandle(e,()=>g.current);let{elementProps:h,isSubscribed:i,track:j,publication:k}=np(f,{element:g,props:d});return t.useEffect(()=>{null==b||b(!!i)},[i,b]),t.useEffect(()=>{void 0===j||void 0===c||(j instanceof kb?j.setVolume(c):mD.warn("Volume can only be set on remote audio tracks."))},[c,j]),t.useEffect(()=>{void 0===k||void 0===d.muted||(k instanceof kl?k.setEnabled(!d.muted):mD.warn("Can only call setEnabled on remote track publications."))},[d.muted,k,j]),t.createElement("audio",{ref:g,...h})});function nt({room:a,volume:b,muted:c}){let d=m6([ik.Source.Microphone,ik.Source.ScreenShareAudio,ik.Source.Unknown],{updateOnlyOn:[],onlySubscribed:!0,room:a}).filter(a=>!a.participant.isLocal&&a.publication.kind===ik.Kind.Audio);return t.createElement("div",{style:{display:"none"}},d.map(a=>t.createElement(ns,{key:mB(a),trackRef:a,volume:b,muted:c})))}let nu=a=>[[Math.floor(a/2)],[-1]],nv=new Map([["connecting",2e3],["initializing",2e3],["listening",500],["thinking",150]]);var nw=globalThis?.document?t.useLayoutEffect:()=>{},nx=a=>{var b;let c,d,{present:e,children:f}=a,g=function(a){var b,c;let[d,e]=t.useState(),f=t.useRef({}),g=t.useRef(a),h=t.useRef("none"),[i,j]=(b=a?"mounted":"unmounted",c={mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}},t.useReducer((a,b)=>c[a][b]??a,b));return t.useEffect(()=>{let a=ny(f.current);h.current="mounted"===i?a:"none"},[i]),nw(()=>{let b=f.current,c=g.current;if(c!==a){let d=h.current,e=ny(b);a?j("MOUNT"):"none"===e||b?.display==="none"?j("UNMOUNT"):c&&d!==e?j("ANIMATION_OUT"):j("UNMOUNT"),g.current=a}},[a,j]),nw(()=>{if(d){let a,b=d.ownerDocument.defaultView??window,c=c=>{let e=ny(f.current).includes(c.animationName);if(c.target===d&&e&&(j("ANIMATION_END"),!g.current)){let c=d.style.animationFillMode;d.style.animationFillMode="forwards",a=b.setTimeout(()=>{"forwards"===d.style.animationFillMode&&(d.style.animationFillMode=c)})}},e=a=>{a.target===d&&(h.current=ny(f.current))};return d.addEventListener("animationstart",e),d.addEventListener("animationcancel",c),d.addEventListener("animationend",c),()=>{b.clearTimeout(a),d.removeEventListener("animationstart",e),d.removeEventListener("animationcancel",c),d.removeEventListener("animationend",c)}}j("ANIMATION_END")},[d,j]),{isPresent:["mounted","unmountSuspended"].includes(i),ref:t.useCallback(a=>{a&&(f.current=getComputedStyle(a)),e(a)},[])}}(e),h="function"==typeof f?f({present:g.isPresent}):t.Children.only(f),i=w(g.ref,(b=h,(d=(c=Object.getOwnPropertyDescriptor(b.props,"ref")?.get)&&"isReactWarning"in c&&c.isReactWarning)?b.ref:(d=(c=Object.getOwnPropertyDescriptor(b,"ref")?.get)&&"isReactWarning"in c&&c.isReactWarning)?b.props.ref:b.props.ref||b.ref));return"function"==typeof f||g.isPresent?t.cloneElement(h,{ref:i}):null};function ny(a){return a?.animationName||"none"}function nz(a){let b=t.useRef(a);return t.useEffect(()=>{b.current=a}),t.useMemo(()=>(...a)=>b.current?.(...a),[])}nx.displayName="Presence";var nA=t.createContext(void 0);function nB(a,b,{checkForDefaultPrevented:c=!0}={}){return function(d){if(a?.(d),!1===c||!d.defaultPrevented)return b?.(d)}}var nC="ScrollArea",[nD,nE]=function(a,b=[]){let c=[],d=()=>{let b=c.map(a=>t.createContext(a));return function(c){let d=c?.[a]||b;return t.useMemo(()=>({[`__scope${a}`]:{...c,[a]:d}}),[c,d])}};return d.scopeName=a,[function(b,d){let e=t.createContext(d),f=c.length;c=[...c,d];let g=b=>{let{scope:c,children:d,...g}=b,h=c?.[a]?.[f]||e,i=t.useMemo(()=>g,Object.values(g));return(0,s.jsx)(h.Provider,{value:i,children:d})};return g.displayName=b+"Provider",[g,function(c,g){let h=g?.[a]?.[f]||e,i=t.useContext(h);if(i)return i;if(void 0!==d)return d;throw Error(`\`${c}\` must be used within \`${b}\``)}]},function(...a){let b=a[0];if(1===a.length)return b;let c=()=>{let c=a.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(a){let d=c.reduce((b,{useScope:c,scopeName:d})=>{let e=c(a)[`__scope${d}`];return{...b,...e}},{});return t.useMemo(()=>({[`__scope${b.scopeName}`]:d}),[d])}};return c.scopeName=b.scopeName,c}(d,...b)]}(nC),[nF,nG]=nD(nC),nH=t.forwardRef((a,b)=>{let c,{__scopeScrollArea:d,type:e="hover",dir:f,scrollHideDelay:g=600,...h}=a,[i,j]=t.useState(null),[k,l]=t.useState(null),[m,n]=t.useState(null),[o,p]=t.useState(null),[q,r]=t.useState(null),[u,v]=t.useState(0),[x,y]=t.useState(0),[z,A]=t.useState(!1),[B,C]=t.useState(!1),D=w(b,a=>j(a)),E=(c=t.useContext(nA),f||c||"ltr");return(0,s.jsx)(nF,{scope:d,type:e,dir:E,scrollHideDelay:g,scrollArea:i,viewport:k,onViewportChange:l,content:m,onContentChange:n,scrollbarX:o,onScrollbarXChange:p,scrollbarXEnabled:z,onScrollbarXEnabledChange:A,scrollbarY:q,onScrollbarYChange:r,scrollbarYEnabled:B,onScrollbarYEnabledChange:C,onCornerWidthChange:v,onCornerHeightChange:y,children:(0,s.jsx)(aN.div,{dir:E,...h,ref:D,style:{position:"relative","--radix-scroll-area-corner-width":u+"px","--radix-scroll-area-corner-height":x+"px",...a.style}})})});nH.displayName=nC;var nI="ScrollAreaViewport",nJ=t.forwardRef((a,b)=>{let{__scopeScrollArea:c,children:d,nonce:e,...f}=a,g=nG(nI,c),h=w(b,t.useRef(null),g.onViewportChange);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:e}),(0,s.jsx)(aN.div,{"data-radix-scroll-area-viewport":"",...f,ref:h,style:{overflowX:g.scrollbarXEnabled?"scroll":"hidden",overflowY:g.scrollbarYEnabled?"scroll":"hidden",...a.style},children:(0,s.jsx)("div",{ref:g.onContentChange,style:{minWidth:"100%",display:"table"},children:d})})]})});nJ.displayName=nI;var nK="ScrollAreaScrollbar",nL=t.forwardRef((a,b)=>{let{forceMount:c,...d}=a,e=nG(nK,a.__scopeScrollArea),{onScrollbarXEnabledChange:f,onScrollbarYEnabledChange:g}=e,h="horizontal"===a.orientation;return t.useEffect(()=>(h?f(!0):g(!0),()=>{h?f(!1):g(!1)}),[h,f,g]),"hover"===e.type?(0,s.jsx)(nM,{...d,ref:b,forceMount:c}):"scroll"===e.type?(0,s.jsx)(nN,{...d,ref:b,forceMount:c}):"auto"===e.type?(0,s.jsx)(nO,{...d,ref:b,forceMount:c}):"always"===e.type?(0,s.jsx)(nP,{...d,ref:b}):null});nL.displayName=nK;var nM=t.forwardRef((a,b)=>{let{forceMount:c,...d}=a,e=nG(nK,a.__scopeScrollArea),[f,g]=t.useState(!1);return t.useEffect(()=>{let a=e.scrollArea,b=0;if(a){let c=()=>{window.clearTimeout(b),g(!0)},d=()=>{b=window.setTimeout(()=>g(!1),e.scrollHideDelay)};return a.addEventListener("pointerenter",c),a.addEventListener("pointerleave",d),()=>{window.clearTimeout(b),a.removeEventListener("pointerenter",c),a.removeEventListener("pointerleave",d)}}},[e.scrollArea,e.scrollHideDelay]),(0,s.jsx)(nx,{present:c||f,children:(0,s.jsx)(nO,{"data-state":f?"visible":"hidden",...d,ref:b})})}),nN=t.forwardRef((a,b)=>{var c;let{forceMount:d,...e}=a,f=nG(nK,a.__scopeScrollArea),g="horizontal"===a.orientation,h=n5(()=>j("SCROLL_END"),100),[i,j]=(c={hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}},t.useReducer((a,b)=>c[a][b]??a,"hidden"));return t.useEffect(()=>{if("idle"===i){let a=window.setTimeout(()=>j("HIDE"),f.scrollHideDelay);return()=>window.clearTimeout(a)}},[i,f.scrollHideDelay,j]),t.useEffect(()=>{let a=f.viewport,b=g?"scrollLeft":"scrollTop";if(a){let c=a[b],d=()=>{let d=a[b];c!==d&&(j("SCROLL"),h()),c=d};return a.addEventListener("scroll",d),()=>a.removeEventListener("scroll",d)}},[f.viewport,g,j,h]),(0,s.jsx)(nx,{present:d||"hidden"!==i,children:(0,s.jsx)(nP,{"data-state":"hidden"===i?"hidden":"visible",...e,ref:b,onPointerEnter:nB(a.onPointerEnter,()=>j("POINTER_ENTER")),onPointerLeave:nB(a.onPointerLeave,()=>j("POINTER_LEAVE"))})})}),nO=t.forwardRef((a,b)=>{let c=nG(nK,a.__scopeScrollArea),{forceMount:d,...e}=a,[f,g]=t.useState(!1),h="horizontal"===a.orientation,i=n5(()=>{if(c.viewport){let a=c.viewport.offsetWidth<c.viewport.scrollWidth,b=c.viewport.offsetHeight<c.viewport.scrollHeight;g(h?a:b)}},10);return n6(c.viewport,i),n6(c.content,i),(0,s.jsx)(nx,{present:d||f,children:(0,s.jsx)(nP,{"data-state":f?"visible":"hidden",...e,ref:b})})}),nP=t.forwardRef((a,b)=>{let{orientation:c="vertical",...d}=a,e=nG(nK,a.__scopeScrollArea),f=t.useRef(null),g=t.useRef(0),[h,i]=t.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),j=n0(h.viewport,h.content),k={...d,sizes:h,onSizesChange:i,hasThumb:!!(j>0&&j<1),onThumbChange:a=>f.current=a,onThumbPointerUp:()=>g.current=0,onThumbPointerDown:a=>g.current=a};function l(a,b){return function(a,b,c,d="ltr"){let e=n1(c),f=b||e/2,g=c.scrollbar.paddingStart+f,h=c.scrollbar.size-c.scrollbar.paddingEnd-(e-f),i=c.content-c.viewport;return n3([g,h],"ltr"===d?[0,i]:[-1*i,0])(a)}(a,g.current,h,b)}return"horizontal"===c?(0,s.jsx)(nQ,{...k,ref:b,onThumbPositionChange:()=>{if(e.viewport&&f.current){let a=n2(e.viewport.scrollLeft,h,e.dir);f.current.style.transform=`translate3d(${a}px, 0, 0)`}},onWheelScroll:a=>{e.viewport&&(e.viewport.scrollLeft=a)},onDragScroll:a=>{e.viewport&&(e.viewport.scrollLeft=l(a,e.dir))}}):"vertical"===c?(0,s.jsx)(nR,{...k,ref:b,onThumbPositionChange:()=>{if(e.viewport&&f.current){let a=n2(e.viewport.scrollTop,h);f.current.style.transform=`translate3d(0, ${a}px, 0)`}},onWheelScroll:a=>{e.viewport&&(e.viewport.scrollTop=a)},onDragScroll:a=>{e.viewport&&(e.viewport.scrollTop=l(a))}}):null}),nQ=t.forwardRef((a,b)=>{let{sizes:c,onSizesChange:d,...e}=a,f=nG(nK,a.__scopeScrollArea),[g,h]=t.useState(),i=t.useRef(null),j=w(b,i,f.onScrollbarXChange);return t.useEffect(()=>{i.current&&h(getComputedStyle(i.current))},[i]),(0,s.jsx)(nU,{"data-orientation":"horizontal",...e,ref:j,sizes:c,style:{bottom:0,left:"rtl"===f.dir?"var(--radix-scroll-area-corner-width)":0,right:"ltr"===f.dir?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":n1(c)+"px",...a.style},onThumbPointerDown:b=>a.onThumbPointerDown(b.x),onDragScroll:b=>a.onDragScroll(b.x),onWheelScroll:(b,c)=>{if(f.viewport){var d,e;let g=f.viewport.scrollLeft+b.deltaX;a.onWheelScroll(g),d=g,e=c,d>0&&d<e&&b.preventDefault()}},onResize:()=>{i.current&&f.viewport&&g&&d({content:f.viewport.scrollWidth,viewport:f.viewport.offsetWidth,scrollbar:{size:i.current.clientWidth,paddingStart:n_(g.paddingLeft),paddingEnd:n_(g.paddingRight)}})}})}),nR=t.forwardRef((a,b)=>{let{sizes:c,onSizesChange:d,...e}=a,f=nG(nK,a.__scopeScrollArea),[g,h]=t.useState(),i=t.useRef(null),j=w(b,i,f.onScrollbarYChange);return t.useEffect(()=>{i.current&&h(getComputedStyle(i.current))},[i]),(0,s.jsx)(nU,{"data-orientation":"vertical",...e,ref:j,sizes:c,style:{top:0,right:"ltr"===f.dir?0:void 0,left:"rtl"===f.dir?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":n1(c)+"px",...a.style},onThumbPointerDown:b=>a.onThumbPointerDown(b.y),onDragScroll:b=>a.onDragScroll(b.y),onWheelScroll:(b,c)=>{if(f.viewport){var d,e;let g=f.viewport.scrollTop+b.deltaY;a.onWheelScroll(g),d=g,e=c,d>0&&d<e&&b.preventDefault()}},onResize:()=>{i.current&&f.viewport&&g&&d({content:f.viewport.scrollHeight,viewport:f.viewport.offsetHeight,scrollbar:{size:i.current.clientHeight,paddingStart:n_(g.paddingTop),paddingEnd:n_(g.paddingBottom)}})}})}),[nS,nT]=nD(nK),nU=t.forwardRef((a,b)=>{let{__scopeScrollArea:c,sizes:d,hasThumb:e,onThumbChange:f,onThumbPointerUp:g,onThumbPointerDown:h,onThumbPositionChange:i,onDragScroll:j,onWheelScroll:k,onResize:l,...m}=a,n=nG(nK,c),[o,p]=t.useState(null),q=w(b,a=>p(a)),r=t.useRef(null),u=t.useRef(""),v=n.viewport,x=d.content-d.viewport,y=nz(k),z=nz(i),A=n5(l,10);function B(a){r.current&&j({x:a.clientX-r.current.left,y:a.clientY-r.current.top})}return t.useEffect(()=>{let a=a=>{let b=a.target;o?.contains(b)&&y(a,x)};return document.addEventListener("wheel",a,{passive:!1}),()=>document.removeEventListener("wheel",a,{passive:!1})},[v,o,x,y]),t.useEffect(z,[d,z]),n6(o,A),n6(n.content,A),(0,s.jsx)(nS,{scope:c,scrollbar:o,hasThumb:e,onThumbChange:nz(f),onThumbPointerUp:nz(g),onThumbPositionChange:z,onThumbPointerDown:nz(h),children:(0,s.jsx)(aN.div,{...m,ref:q,style:{position:"absolute",...m.style},onPointerDown:nB(a.onPointerDown,a=>{0===a.button&&(a.target.setPointerCapture(a.pointerId),r.current=o.getBoundingClientRect(),u.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",n.viewport&&(n.viewport.style.scrollBehavior="auto"),B(a))}),onPointerMove:nB(a.onPointerMove,B),onPointerUp:nB(a.onPointerUp,a=>{let b=a.target;b.hasPointerCapture(a.pointerId)&&b.releasePointerCapture(a.pointerId),document.body.style.webkitUserSelect=u.current,n.viewport&&(n.viewport.style.scrollBehavior=""),r.current=null})})})}),nV="ScrollAreaThumb",nW=t.forwardRef((a,b)=>{let{forceMount:c,...d}=a,e=nT(nV,a.__scopeScrollArea);return(0,s.jsx)(nx,{present:c||e.hasThumb,children:(0,s.jsx)(nX,{ref:b,...d})})}),nX=t.forwardRef((a,b)=>{let{__scopeScrollArea:c,style:d,...e}=a,f=nG(nV,c),g=nT(nV,c),{onThumbPositionChange:h}=g,i=w(b,a=>g.onThumbChange(a)),j=t.useRef(void 0),k=n5(()=>{j.current&&(j.current(),j.current=void 0)},100);return t.useEffect(()=>{let a=f.viewport;if(a){let b=()=>{k(),j.current||(j.current=n4(a,h),h())};return h(),a.addEventListener("scroll",b),()=>a.removeEventListener("scroll",b)}},[f.viewport,k,h]),(0,s.jsx)(aN.div,{"data-state":g.hasThumb?"visible":"hidden",...e,ref:i,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...d},onPointerDownCapture:nB(a.onPointerDownCapture,a=>{let b=a.target.getBoundingClientRect(),c=a.clientX-b.left,d=a.clientY-b.top;g.onThumbPointerDown({x:c,y:d})}),onPointerUp:nB(a.onPointerUp,g.onThumbPointerUp)})});nW.displayName=nV;var nY="ScrollAreaCorner",nZ=t.forwardRef((a,b)=>{let c=nG(nY,a.__scopeScrollArea),d=!!(c.scrollbarX&&c.scrollbarY);return"scroll"!==c.type&&d?(0,s.jsx)(n$,{...a,ref:b}):null});nZ.displayName=nY;var n$=t.forwardRef((a,b)=>{let{__scopeScrollArea:c,...d}=a,e=nG(nY,c),[f,g]=t.useState(0),[h,i]=t.useState(0),j=!!(f&&h);return n6(e.scrollbarX,()=>{let a=e.scrollbarX?.offsetHeight||0;e.onCornerHeightChange(a),i(a)}),n6(e.scrollbarY,()=>{let a=e.scrollbarY?.offsetWidth||0;e.onCornerWidthChange(a),g(a)}),j?(0,s.jsx)(aN.div,{...d,ref:b,style:{width:f,height:h,position:"absolute",right:"ltr"===e.dir?0:void 0,left:"rtl"===e.dir?0:void 0,bottom:0,...a.style}}):null});function n_(a){return a?parseInt(a,10):0}function n0(a,b){let c=a/b;return isNaN(c)?0:c}function n1(a){let b=n0(a.viewport,a.content),c=a.scrollbar.paddingStart+a.scrollbar.paddingEnd;return Math.max((a.scrollbar.size-c)*b,18)}function n2(a,b,c="ltr"){let d=n1(b),e=b.scrollbar.paddingStart+b.scrollbar.paddingEnd,f=b.scrollbar.size-e,g=b.content-b.viewport,h=function(a,[b,c]){return Math.min(c,Math.max(b,a))}(a,"ltr"===c?[0,g]:[-1*g,0]);return n3([0,g],[0,f-d])(h)}function n3(a,b){return c=>{if(a[0]===a[1]||b[0]===b[1])return b[0];let d=(b[1]-b[0])/(a[1]-a[0]);return b[0]+d*(c-a[0])}}var n4=(a,b=()=>{})=>{let c={left:a.scrollLeft,top:a.scrollTop},d=0;return!function e(){let f={left:a.scrollLeft,top:a.scrollTop},g=c.left!==f.left,h=c.top!==f.top;(g||h)&&b(),c=f,d=window.requestAnimationFrame(e)}(),()=>window.cancelAnimationFrame(d)};function n5(a,b){let c=nz(a),d=t.useRef(0);return t.useEffect(()=>()=>window.clearTimeout(d.current),[]),t.useCallback(()=>{window.clearTimeout(d.current),d.current=window.setTimeout(c,b)},[c,b])}function n6(a,b){let c=nz(b);nw(()=>{let b=0;if(a){let d=new ResizeObserver(()=>{cancelAnimationFrame(b),b=window.requestAnimationFrame(c)});return d.observe(a),()=>{window.cancelAnimationFrame(b),d.unobserve(a)}}},[a,c])}function n7({className:a,children:b,...c}){return(0,s.jsxs)(nH,{"data-slot":"scroll-area",className:aJ("relative",a),...c,children:[(0,s.jsx)(nJ,{"data-slot":"scroll-area-viewport",className:"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1",children:b}),(0,s.jsx)(n8,{}),(0,s.jsx)(nZ,{})]})}function n8({className:a,orientation:b="vertical",...c}){return(0,s.jsx)(nL,{"data-slot":"scroll-area-scrollbar",orientation:b,className:aJ("flex touch-none p-px transition-colors select-none","vertical"===b&&"h-full w-2.5 border-l border-l-transparent","horizontal"===b&&"h-2.5 flex-col border-t border-t-transparent",a),...c,children:(0,s.jsx)(nW,{"data-slot":"scroll-area-thumb",className:"bg-border relative flex-1 rounded-full"})})}let n9=aY("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),oa=aY("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);function ob({participantName:a,onClose:b}){let[c,d]=(0,t.useState)([]),[e,f]=(0,t.useState)(""),g=(0,t.useRef)(null);(0,t.useEffect)(()=>{g.current&&(g.current.scrollTop=g.current.scrollHeight)},[c]);let h=(0,t.useCallback)(b=>{if(b.preventDefault(),!e.trim())return;let c={id:Date.now().toString(),sender:a,content:e.trim(),timestamp:new Date,isLocal:!0};d(a=>[...a,c]),f("")},[e,a]);return(0,t.useCallback)((a,b)=>{let c={id:Date.now().toString(),sender:a,content:b,timestamp:new Date,isLocal:!1};d(a=>[...a,c])},[]),(0,s.jsxs)("div",{className:"flex flex-col h-full",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between px-4 py-3 border-b border-border",children:[(0,s.jsx)("h2",{className:"font-medium text-foreground",children:"Chat"}),(0,s.jsx)(aL,{variant:"ghost",size:"icon",onClick:b,className:"h-8 w-8 lg:hidden",children:(0,s.jsx)(n9,{className:"h-4 w-4"})})]}),(0,s.jsx)(n7,{className:"flex-1 p-4",ref:g,children:0===c.length?(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-center text-muted-foreground",children:[(0,s.jsx)("p",{className:"text-sm",children:"No messages yet"}),(0,s.jsx)("p",{className:"text-xs mt-1",children:"Start the conversation!"})]}):(0,s.jsx)("div",{className:"space-y-4",children:c.map(a=>(0,s.jsx)(oc,{message:a},a.id))})}),(0,s.jsx)("form",{onSubmit:h,className:"p-4 border-t border-border",children:(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(aM,{value:e,onChange:a=>f(a.target.value),placeholder:"Type a message...",className:"flex-1 bg-input border-border text-foreground placeholder:text-muted-foreground"}),(0,s.jsx)(aL,{type:"submit",size:"icon",disabled:!e.trim(),className:"bg-primary text-primary-foreground hover:bg-primary/90",children:(0,s.jsx)(oa,{className:"h-4 w-4"})})]})})]})}function oc({message:a}){return(0,s.jsxs)("div",{className:aJ("flex flex-col gap-1",a.isLocal&&"items-end"),children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"text-xs font-medium text-muted-foreground",children:a.isLocal?"You":a.sender}),(0,s.jsx)("span",{className:"text-xs text-muted-foreground/60",children:a.timestamp.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),(0,s.jsx)("div",{className:aJ("max-w-[80%] px-3 py-2 rounded-lg text-sm",a.isLocal?"bg-primary text-primary-foreground rounded-br-none":"bg-secondary text-secondary-foreground rounded-bl-none"),children:a.content})]})}let od=aY("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]),oe=aY("MicOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M18.89 13.23A7.12 7.12 0 0 0 19 12v-2",key:"80xlxr"}],["path",{d:"M5 10v2a7 7 0 0 0 12 5",key:"p2k8kg"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]),of=aY("VideoOff",[["path",{d:"M10.66 6H14a2 2 0 0 1 2 2v2.5l5.248-3.062A.5.5 0 0 1 22 7.87v8.196",key:"w8jjjt"}],["path",{d:"M16 16a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h2",key:"1xawa7"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),og=aY("Pin",[["path",{d:"M12 17v5",key:"bb1du9"}],["path",{d:"M9 10.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24V16a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V7a1 1 0 0 1 1-1 2 2 0 0 0 0-4H8a2 2 0 0 0 0 4 1 1 0 0 1 1 1z",key:"1nkz8b"}]]);function oh({tracks:a}){let b=(0,t.useMemo)(()=>a.filter(a=>a.source===ik.Source.Camera||a.source===ik.Source.ScreenShare),[a]),c=(0,t.useMemo)(()=>{let a=b.length;return 1===a?"grid-cols-1":2===a?"grid-cols-1 md:grid-cols-2":a<=4?"grid-cols-2":a<=6?"grid-cols-2 md:grid-cols-3":"grid-cols-2 md:grid-cols-3 lg:grid-cols-4"},[b.length]);return 0===b.length?(0,s.jsx)("div",{className:"h-full flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center text-muted-foreground",children:[(0,s.jsx)(of,{className:"h-16 w-16 mx-auto mb-4 opacity-50"}),(0,s.jsx)("p",{className:"text-lg",children:"No video streams available"}),(0,s.jsx)("p",{className:"text-sm",children:"Waiting for participants to enable video..."})]})}):(0,s.jsx)("div",{className:aJ("grid gap-4 h-full auto-rows-fr",c),children:b.map(a=>(0,s.jsx)(oi,{trackRef:a},a.participant.sid+a.source))})}function oi({trackRef:a}){let{participant:b,publication:c,source:d}=a,e=d===ik.Source.ScreenShare;return c?.track?.isMuted,(0,s.jsxs)("div",{className:"relative rounded-lg overflow-hidden bg-secondary aspect-video",children:[c?.track?(0,s.jsx)(nr,{trackRef:a,className:"w-full h-full object-cover"}):(0,s.jsx)("div",{className:"w-full h-full flex items-center justify-center bg-secondary",children:(0,s.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,s.jsx)("div",{className:"h-16 w-16 rounded-full bg-primary/20 flex items-center justify-center",children:(0,s.jsx)("span",{className:"text-2xl font-semibold text-primary",children:b.name?.[0]?.toUpperCase()||b.identity?.[0]?.toUpperCase()||"?"})}),(0,s.jsx)(of,{className:"h-5 w-5 text-muted-foreground"})]})}),(0,s.jsx)("div",{className:"absolute bottom-0 left-0 right-0 p-3 bg-gradient-to-t from-black/80 to-transparent",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[e&&(0,s.jsx)(og,{className:"h-4 w-4 text-primary"}),(0,s.jsx)("span",{className:"text-sm font-medium text-white truncate",children:e?`${b.name||b.identity}'s screen`:b.name||b.identity}),b.isLocal&&(0,s.jsx)("span",{className:"text-xs px-1.5 py-0.5 rounded bg-primary/20 text-primary",children:"You"})]}),(0,s.jsx)("div",{className:"flex items-center gap-1",children:b.isMicrophoneEnabled?(0,s.jsx)(od,{className:"h-4 w-4 text-white"}):(0,s.jsx)(oe,{className:"h-4 w-4 text-destructive"})})]})})]})}let oj=aY("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]),ok=aY("MonitorOff",[["path",{d:"M17 17H4a2 2 0 0 1-2-2V5c0-1.5 1-2 1-2",key:"k0q8oc"}],["path",{d:"M22 15V5a2 2 0 0 0-2-2H9",key:"cp1ac0"}],["path",{d:"M8 21h8",key:"1ev6f3"}],["path",{d:"M12 17v4",key:"1riwvh"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),ol=aY("PhoneOff",[["path",{d:"M10.68 13.31a16 16 0 0 0 3.41 2.6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7 2 2 0 0 1 1.72 2v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.42 19.42 0 0 1-3.33-2.67m-2.67-3.34a19.79 19.79 0 0 1-3.07-8.63A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91",key:"z86iuo"}],["line",{x1:"22",x2:"2",y1:"2",y2:"22",key:"11kh81"}]]);function om({onLeave:a}){let{localParticipant:b}=m5(),c=mW(),d=b.isMicrophoneEnabled,e=b.isCameraEnabled,f=b.isScreenShareEnabled,g=async()=>{await b.setMicrophoneEnabled(!d)},h=async()=>{await b.setCameraEnabled(!e)},i=async()=>{await b.setScreenShareEnabled(!f)};return(0,s.jsx)("div",{className:"flex items-center justify-center gap-2 px-4 py-4 bg-card border-t border-border",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(aL,{variant:d?"secondary":"destructive",size:"lg",onClick:g,className:aJ("rounded-full h-12 w-12",d&&"bg-secondary hover:bg-secondary/80"),children:d?(0,s.jsx)(od,{className:"h-5 w-5"}):(0,s.jsx)(oe,{className:"h-5 w-5"})}),(0,s.jsx)(aL,{variant:e?"secondary":"destructive",size:"lg",onClick:h,className:aJ("rounded-full h-12 w-12",e&&"bg-secondary hover:bg-secondary/80"),children:e?(0,s.jsx)(aZ,{className:"h-5 w-5"}):(0,s.jsx)(of,{className:"h-5 w-5"})}),(0,s.jsx)(aL,{variant:f?"default":"secondary",size:"lg",onClick:i,className:aJ("rounded-full h-12 w-12",f&&"bg-primary hover:bg-primary/90"),children:f?(0,s.jsx)(ok,{className:"h-5 w-5"}):(0,s.jsx)(oj,{className:"h-5 w-5"})}),(0,s.jsx)("div",{className:"w-px h-8 bg-border mx-2"}),(0,s.jsxs)(aL,{variant:"destructive",size:"lg",onClick:()=>{c.disconnect(),a()},className:"rounded-full h-12 px-6",children:[(0,s.jsx)(ol,{className:"h-5 w-5 mr-2"}),"Leave"]})]})})}function on({participants:a,localParticipant:b}){return(0,s.jsx)(n7,{className:"flex-1",children:(0,s.jsx)("div",{className:"p-2 space-y-1",children:a.map(a=>(0,s.jsx)(oo,{participant:a,isLocal:a.sid===b?.sid},a.sid))})})}function oo({participant:a,isLocal:b}){let c=a.isMicrophoneEnabled,d=a.isCameraEnabled;return(0,s.jsxs)("div",{className:"flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-secondary/50 transition-colors",children:[(0,s.jsx)("div",{className:"h-8 w-8 rounded-full bg-primary/20 flex items-center justify-center flex-shrink-0",children:(0,s.jsx)("span",{className:"text-sm font-medium text-primary",children:a.name?.[0]?.toUpperCase()||a.identity?.[0]?.toUpperCase()||"?"})}),(0,s.jsx)("div",{className:"flex-1 min-w-0",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"text-sm font-medium text-foreground truncate",children:a.name||a.identity}),b&&(0,s.jsx)("span",{className:"text-xs px-1.5 py-0.5 rounded bg-primary/20 text-primary",children:"You"})]})}),(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[c?(0,s.jsx)(od,{className:"h-4 w-4 text-muted-foreground"}):(0,s.jsx)(oe,{className:"h-4 w-4 text-destructive"}),d?(0,s.jsx)(aZ,{className:"h-4 w-4 text-muted-foreground"}):(0,s.jsx)(of,{className:"h-4 w-4 text-destructive"})]})]})}let op=aY("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);function oq({serverUrl:a,token:b,roomName:c,participantName:d,onLeave:e}){let[f,g]=(0,t.useState)(!0),[h,i]=(0,t.useState)(!1);return(0,s.jsxs)(m3,{serverUrl:a,token:b,connect:!0,onDisconnected:e,className:"h-screen flex flex-col bg-background","data-lk-theme":"default",children:[(0,s.jsx)(or,{roomName:c,participantName:d,showChat:f,setShowChat:g,showParticipants:h,setShowParticipants:i,onLeave:e}),(0,s.jsx)(nt,{})]})}function or({roomName:a,participantName:b,showChat:c,setShowChat:d,showParticipants:e,setShowParticipants:f,onLeave:g}){let h=function(a={}){let b=function(a={}){let b=mX(a.room),[c,d]=t.useState([]);return t.useEffect(()=>{let c=(function(a,b={}){var c;let d,e=new l5(a=>(d=a,()=>g.unsubscribe())).pipe(mz(Array.from(a.remoteParticipants.values()))),f=null!=(c=b.additionalRoomEvents)?c:mC,g=mJ(a,...Array.from(new Set([lg.ParticipantConnected,lg.ParticipantDisconnected,lg.ConnectionStateChanged,...f]))).subscribe(a=>null==d?void 0:d.next(Array.from(a.remoteParticipants.values())));return a.remoteParticipants.size>0&&(null==d||d.next(Array.from(a.remoteParticipants.values()))),e})(b,{additionalRoomEvents:a.updateOnlyOn}).subscribe(d);return()=>c.unsubscribe()},[b,JSON.stringify(a.updateOnlyOn)]),c}(a),{localParticipant:c}=m5(a);return t.useMemo(()=>[c,...b],[c,b])}(),{localParticipant:i}=m5();mW();let j=m6([{source:ik.Source.Camera,withPlaceholder:!0},{source:ik.Source.ScreenShare,withPlaceholder:!1}],{onlySubscribed:!1});return(0,s.jsxs)("div",{className:"flex flex-col h-screen",children:[(0,s.jsxs)("header",{className:"flex items-center justify-between px-4 py-3 bg-card border-b border-border",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"h-2 w-2 rounded-full bg-green-500 animate-pulse"}),(0,s.jsx)("h1",{className:"text-lg font-semibold text-foreground",children:a}),(0,s.jsxs)("span",{className:"text-sm text-muted-foreground",children:[h.length," participant",1!==h.length?"s":""]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)(aL,{variant:e?"default":"outline",size:"sm",onClick:()=>f(!e),className:"hidden md:flex",children:[(0,s.jsx)(a$,{className:"h-4 w-4 mr-2"}),"Participants"]}),(0,s.jsxs)(aL,{variant:c?"default":"outline",size:"sm",onClick:()=>d(!c),children:[(0,s.jsx)(op,{className:"h-4 w-4 mr-2"}),"Chat"]})]})]}),(0,s.jsxs)("div",{className:"flex-1 flex overflow-hidden",children:[e&&(0,s.jsxs)("aside",{className:"hidden md:flex w-64 flex-col border-r border-border bg-card",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between px-4 py-3 border-b border-border",children:[(0,s.jsx)("h2",{className:"font-medium text-foreground",children:"Participants"}),(0,s.jsx)(aL,{variant:"ghost",size:"icon",onClick:()=>f(!1),className:"h-8 w-8",children:(0,s.jsx)(n9,{className:"h-4 w-4"})})]}),(0,s.jsx)(on,{participants:h,localParticipant:i})]}),(0,s.jsx)("main",{className:aJ("flex-1 p-4 overflow-hidden",c&&"lg:mr-80"),children:(0,s.jsx)(oh,{tracks:j})}),c&&(0,s.jsx)("aside",{className:"fixed right-0 top-[57px] bottom-[72px] w-full lg:w-80 flex flex-col bg-card border-l border-border z-10 lg:z-0",children:(0,s.jsx)(ob,{participantName:b,onClose:()=>d(!1)})})]}),(0,s.jsx)(om,{onLeave:g})]})}var os=a.i(36395);function ot(){let{user:a,loading:b,isAuthenticated:c,login:d}=(0,os.useAuth)(),[e,f]=(0,t.useState)(null);return b?(0,s.jsx)("main",{className:"min-h-screen bg-background flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(a_,{className:"h-8 w-8 animate-spin mx-auto mb-4 text-primary"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Loading..."})]})}):e?(0,s.jsx)("main",{className:"min-h-screen bg-background",children:(0,s.jsx)(oq,{serverUrl:e.serverUrl,token:e.token,roomName:e.roomName,participantName:e.participantName,onLeave:()=>{f(null)}})}):c?(0,s.jsx)("main",{className:"min-h-screen bg-background",children:(0,s.jsx)(dr,{onJoin:a=>{f(a)},user:a})}):(0,s.jsx)("main",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:(0,s.jsxs)(aQ,{className:"w-full max-w-md bg-card border-border",children:[(0,s.jsxs)(aR,{className:"text-center",children:[(0,s.jsx)(aS,{className:"text-2xl font-bold text-foreground",children:"Video Chat"}),(0,s.jsx)(aT,{className:"text-muted-foreground",children:"Please log in to continue"})]}),(0,s.jsx)(aU,{children:(0,s.jsx)(aL,{onClick:d,className:"w-full bg-primary text-primary-foreground hover:bg-primary/90",children:"Login with Zitadel"})})]})})}a.s(["default",()=>ot],60350)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__52c7d806._.js.map